[{"event":{"type":"analyzeStart","reason":"The user delegated full planning and requested a comprehensive requirements analysis for a political/economic discussion board platform. Generate a complete specification covering purpose, user roles, core features (threads, comments, moderation, reactions, reputation, reporting, content taxonomy, search, notifications), community governance tools, safety/compliance, internationalization, privacy/security, analytics, and scalability. Include data models, business rules, API surface outline, and development scope/priorities. Where assumptions are made, state them and propose sensible defaults for a v1 MVP and future phases.","step":0,"created_at":"2025-08-15T02:34:53.769Z"},"tokenUsage":{"aggregate":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeScenario","prefix":"civicDebateBoard","language":"en-US","roles":[{"name":"member","description":"Authenticated community participant who can create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules."},{"name":"verifiedMember","description":"Identity- or expertise-verified participant with elevated trust level; may create expert-tagged posts, host AMAs, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while remaining subject to all policies."},{"name":"factChecker","description":"Trusted role allowed to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes; cannot apply sanctions directly."},{"name":"moderator","description":"Role responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, handling appeals within scope, and maintaining community health."},{"name":"admin","description":"Top-level role managing platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions plus administrative operations."}],"files":[{"reason":"To provide a navigable overview of all documents with clear links and reading order for stakeholders.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","Document List and Descriptions","Reading Order and Dependencies"],"audience":"general","keyQuestions":["What documents exist and in what order should they be read?","How are documents related?"],"detailLevel":"high-level overview","constraints":["Must list every document with descriptive link text","Must include developer autonomy note at the very end as a blockquote per guidelines"]},{"reason":"Establish the vision, scope, and business model to align all stakeholders before detailing requirements.","filename":"01-service-vision-and-overview.md","documentType":"service-overview","outline":["Executive Summary","Objectives and Success Criteria","Target Users and Use Cases","Service Scope and Boundaries","Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)","Assumptions and Constraints","Out of Scope"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who are the users and what are the core goals?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","02-market-problem-and-value-proposition.md","06-functional-requirements.md","10-business-model-and-analytics.md"],"constraints":["Must include Business Model section with Why/How/What","Use natural language only; avoid technical implementation details"]},{"reason":"Clarify the specific market gap, user pains, and differentiators to justify product direction and positioning.","filename":"02-market-problem-and-value-proposition.md","documentType":"service-overview","outline":["Problem Statement","Market Context and Trends","Competitive Landscape","Differentiators and Core Value Proposition","Risks and Mitigations","Success Metrics Alignment"],"audience":"business stakeholders","keyQuestions":["What pains do target users face today?","Who are the competitors and how do we differentiate?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md"],"constraints":["Focus on user pains and value; avoid implementation details"]},{"reason":"Define authenticated roles, permissions, session behavior, and the business rules of authentication and authorization.","filename":"03-user-roles-and-authentication.md","documentType":"requirement","outline":["Authentication Requirements (Registration, Login, Logout, Email Verification, Password Reset, Session Management, Device Revocation)","Role Hierarchy and Permissions (member, verifiedMember, factChecker, moderator, admin)","Token Management (JWT) and Session Expiration Policies","Permission Matrix (Actions vs Roles)","Account Lifecycle (Creation, Verification, Suspension, Deletion, Appeals)","Auditability and Transparency Requirements"],"audience":"development team","keyQuestions":["What are the authenticated roles and what can each do or not do?","What business rules govern authentication, sessions, and token lifecycles?","How are account states handled across the lifecycle?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","07-content-moderation-and-safety-policies.md","09-security-privacy-and-compliance.md"],"constraints":["Must specify JWT-based token management requirements in business terms (access and refresh lifetimes, revocation expectations)","Must include a clear permission matrix","Use EARS for all applicable requirements","Avoid API or database specifications"]},{"reason":"Capture representative users and their end-to-end scenarios to ground requirements in real-world needs.","filename":"04-user-personas-and-scenarios.md","documentType":"user-story","outline":["Personas (Member, Verified Member, Fact Checker, Moderator, Admin)","Primary Scenarios (Happy Paths)","Secondary and Special Scenarios (Edge Cases)","Abuse and Misuse Scenarios","Acceptance Criteria (EARS)"],"audience":"product managers","keyQuestions":["Who are the primary personas and what are their motivations?","What are the main scenarios that define success?","What edge cases and abuse scenarios must be supported or mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","05-user-flows-and-processes.md","06-functional-requirements.md"],"constraints":["Use narrative language; include EARS acceptance criteria where applicable","Avoid UI design or technical details"]},{"reason":"Describe end-to-end business workflows so developers can implement processes consistently.","filename":"05-user-flows-and-processes.md","documentType":"user-flow","outline":["Posting and Editing Content Flow","Commenting and Replying Flow","Voting and Reactions Flow","Reporting Content and Triage Flow","Moderation Review and Enforcement Flow","Appeals and Reinstatement Flow","Onboarding and Verification Flow","Notification Delivery Flow"],"audience":"development team","keyQuestions":["What are the step-by-step business flows for core actions?","How do reporting, moderation, and appeals progress from start to finish?","What are the key decision points and outcomes?"],"detailLevel":"detailed specification","relatedDocuments":["04-user-personas-and-scenarios.md","06-functional-requirements.md","07-content-moderation-and-safety-policies.md"],"constraints":["Include at least one Mermaid flow diagram per complex flow using strict syntax rules","Describe business logic only; avoid technical implementation details"]},{"reason":"Define all functional capabilities, rules, and validations for the discussion board in unambiguous terms.","filename":"06-functional-requirements.md","documentType":"requirement","outline":["Content Model and Relationships (conceptual, non-technical)","Threading and Discussion Rules","Tagging, Topics, and Categories","Search and Discovery (filters, sorting)","Notifications and Subscriptions","Bookmarks and Follows","Localization and Timezone Handling (business perspective)","Accessibility and Inclusivity Expectations","Acceptance Criteria (EARS for all applicable requirements)"],"audience":"development team","keyQuestions":["What can users do and under what business rules?","What validations and constraints apply to actions?","How should content be organized and discovered?"],"detailLevel":"detailed specification","relatedDocuments":["05-user-flows-and-processes.md","07-content-moderation-and-safety-policies.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS format extensively","Specify measurable, testable business requirements","Avoid technical specifications (no APIs, schemas, or code)"]},{"reason":"Establish policy definitions and enforcement processes to protect community safety and discourse quality.","filename":"07-content-moderation-and-safety-policies.md","documentType":"requirement","outline":["Policy Principles and Scope","Prohibited and Restricted Content Categories","Civic Discourse Safeguards (election integrity, misinformation handling)","Report Intake and Prioritization","Review SLAs and Escalation Paths","Sanctions (warnings, mutes, suspensions) and Transparency","Evidence Handling and Audit Trails","Appeals and Restorative Processes","EARS-Formatted Enforcement Requirements"],"audience":"development team","keyQuestions":["What content is allowed, restricted, or prohibited?","How are reports prioritized and reviewed?","What sanctions and transparency obligations exist?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","05-user-flows-and-processes.md","09-security-privacy-and-compliance.md"],"constraints":["Define measurable SLAs and sanctions in business terms","Use EARS for enforceable requirements","Avoid technical details; focus on policy and process"]},{"reason":"Set measurable expectations for performance, availability, scalability, and operability from a user-experience perspective.","filename":"08-non-functional-requirements-and-slas.md","documentType":"requirement","outline":["Performance Targets (response time by scenario)","Availability and Reliability Objectives","Capacity and Scalability Goals","Rate Limiting and Fair-Use Policies","Observability Expectations (logging, metrics, alerting in business terms)","Backup and Disaster Recovery Objectives (RTO/RPO)","Internationalization and Timezone Considerations","EARS-Formatted Non-Functional Requirements"],"audience":"development team","keyQuestions":["What performance should users experience in common and peak scenarios?","What availability and recovery objectives are required?","How should fair use be enforced?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","09-security-privacy-and-compliance.md"],"constraints":["All targets must be specific and measurable","Use EARS where applicable","Avoid architecture or technology prescriptions"]},{"reason":"Document privacy, security, and legal obligations to ensure trust and compliance without prescribing implementation.","filename":"09-security-privacy-and-compliance.md","documentType":"requirement","outline":["Data Privacy Principles and Consent Management","User Rights (access, correction, deletion)","Security Expectations (access control, data protection in business terms)","Audit Logging and Accountability Requirements","Incident Response and Breach Notification","Regulatory Compliance (GDPR, CCPA, election-related policies where applicable)","Third-Party and Integration Risk Management","EARS-Formatted Compliance Requirements"],"audience":"development team","keyQuestions":["What privacy rights and obligations apply?","What security controls are required in business terms?","How are incidents handled and reported?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS where applicable","Do not specify technical mechanisms; describe obligations and outcomes"]},{"reason":"Align revenue strategy, ethical analytics, and measurement with platform goals to guide ongoing optimization.","filename":"10-business-model-and-analytics.md","documentType":"business-model","outline":["Why This Service Exists (recap)","Revenue Strategy Options (ads, sponsorships, subscriptions) and Guardrails","User Acquisition and Growth Strategy","Analytics KPIs and Reporting Cadence","Content Quality and Community Health Metrics","Moderation and Safety Metrics","Governance for Data Use and Ethics","Success Metrics and Review Process"],"audience":"business stakeholders","keyQuestions":["How will the service sustain itself financially?","What KPIs define growth, engagement, and quality?","What governance ensures ethical data use?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md","08-non-functional-requirements-and-slas.md"],"constraints":["Must define measurable KPIs and review cadence","Avoid technical analytics tooling specifications","Ensure alignment with privacy obligations"]}],"tokenUsage":{"total":22566,"input":{"total":16560,"cached":0},"output":{"total":6006,"reasoning":3520,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"created_at":"2025-08-15T02:34:53.778Z"},"tokenUsage":{"aggregate":{"total":25388,"input":{"total":18867,"cached":0},"output":{"total":6521,"reasoning":3904,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":22566,"input":{"total":16560,"cached":0},"output":{"total":6006,"reasoning":3520,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"To provide a navigable overview of all documents with clear links and reading order for stakeholders.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","Document List and Descriptions","Reading Order and Dependencies"],"audience":"general","keyQuestions":["What documents exist and in what order should they be read?","How are documents related?"],"detailLevel":"high-level overview","constraints":["Must list every document with descriptive link text","Must include developer autonomy note at the very end as a blockquote per guidelines"],"content":"# civicDebateBoard Documentation Index and Reading Guide\n\n## Document Purpose\nThis document serves as the authoritative table of contents for the civicDebateBoard documentation set. It provides a concise description, intended audience, and purpose for every document in the repository, along with a recommended reading order and a clear view of dependencies. It is designed to help stakeholders navigate efficiently and understand how each document contributes to the overall system definition.\n\n## Document List and Descriptions\n- [Table of Contents and Reading Guide](./00-toc.md) — Provides an overview of all documents, their purposes, recommended reading order, and cross-dependencies.\n- [Service Vision and Overview](./01-service-vision-and-overview.md) — Establishes vision, scope, and success criteria, including the Business Model section (Why the service exists, revenue strategy, growth plan, and success metrics). Audience: business stakeholders.\n- [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Clarifies target user pains, market context, competitive landscape, and differentiators. Audience: business stakeholders.\n- [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Defines authenticated roles (member, verifiedMember, factChecker, moderator, admin), role permissions, JWT-based session and token policies, and account lifecycle rules using EARS. Audience: development team.\n- [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Captures representative personas and end-to-end scenarios (happy paths, edge cases, abuse/misuse) with acceptance criteria in EARS. Audience: product managers.\n- [User Flows and Business Processes](./05-user-flows-and-processes.md) — Describes step-by-step workflows for posting, commenting, voting, reporting, moderation, appeals, onboarding/verification, and notifications, with Mermaid flow diagrams. Audience: development team.\n- [Functional Requirements Specification](./06-functional-requirements.md) — Defines all functional capabilities, rules, and validations for the discussion board, including content relationships, threading, tagging, search/discovery, notifications, bookmarks/follows, localization/timezone handling, and accessibility expectations. Uses EARS extensively with measurable acceptance criteria. Audience: development team.\n- [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Establishes policy principles, prohibited/restricted content, civic discourse safeguards, report intake and prioritization, review SLAs, sanctions, transparency, evidence handling, audit trails, and appeals using EARS. Audience: development team.\n- [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Sets measurable targets for performance, availability, reliability, capacity/scalability, rate limiting and fair use, observability expectations, backup/DR objectives (RTO/RPO), internationalization/timezone considerations, all using EARS where applicable. Audience: development team.\n- [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Documents privacy principles and consent, user rights, security expectations, audit and accountability, incident response, breach notification, regulatory compliance, and third-party risk, with EARS-formatted obligations. Audience: development team.\n- [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Aligns revenue strategy options (ads, sponsorships, subscriptions) and guardrails with ethical analytics, KPIs, reporting cadence, content quality and community health metrics, moderation/safety metrics, governance for data use, and success review processes. Audience: business stakeholders.\n\n## Reading Order and Dependencies\nThe documents are intended to be read in the following order to build context progressively and reduce rework:\n\n1. [Service Vision and Overview](./01-service-vision-and-overview.md) — Establishes the foundational vision, scope, and success metrics.\n2. [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Validates the problem-solution fit and differentiators.\n3. [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Grounds the requirements in real user needs and representative scenarios.\n4. [User Flows and Business Processes](./05-user-flows-and-processes.md) — Converts scenarios into end-to-end business workflows.\n5. [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Defines role models and account lifecycle rules that underpin authorization across flows.\n6. [Functional Requirements Specification](./06-functional-requirements.md) — Consolidates complete functional rules, validations, and acceptance criteria informed by flows and roles.\n7. [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Formalizes community safety policies and enforcement that inform functional and process constraints.\n8. [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Establishes performance, availability, scalability, and operability expectations drawing from functional scope and safety imperatives.\n9. [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Defines cross-cutting obligations that shape authentication, data handling, and operational practices.\n10. [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Aligns measurement and monetization with the defined product scope and operating constraints.\n\nThe following diagram illustrates high-level dependencies among documents:\n\n```mermaid\ngraph LR\n  A[\"01 Service Vision and Overview\"] --> B[\"02 Market Problem and Value Proposition\"]\n  A --> C[\"06 Functional Requirements\"]\n  B --> C\n  D[\"04 User Personas and Scenarios\"] --> E[\"05 User Flows and Processes\"]\n  C --> E\n  F[\"03 User Roles and Authentication\"] --> C\n  F --> G[\"07 Content Moderation and Safety Policies\"]\n  G --> E\n  C --> H[\"08 Non-Functional Requirements and SLAs\"]\n  F --> H\n  I[\"09 Security, Privacy, and Compliance\"] --> F\n  I --> H\n  C --> J[\"10 Business Model and Analytics\"]\n  A --> J\n```\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*"},"tokenUsage":{"total":19321,"input":{"total":15320,"cached":0},"output":{"total":4001,"reasoning":2368,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":1,"created_at":"2025-08-15T02:38:19.393Z"},"tokenUsage":{"aggregate":{"total":44709,"input":{"total":34187,"cached":0},"output":{"total":10522,"reasoning":6272,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":41887,"input":{"total":31880,"cached":0},"output":{"total":10007,"reasoning":5888,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Clarify the specific market gap, user pains, and differentiators to justify product direction and positioning.","filename":"02-market-problem-and-value-proposition.md","documentType":"service-overview","outline":["Problem Statement","Market Context and Trends","Competitive Landscape","Differentiators and Core Value Proposition","Risks and Mitigations","Success Metrics Alignment"],"audience":"business stakeholders","keyQuestions":["What pains do target users face today?","Who are the competitors and how do we differentiate?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md"],"constraints":["Focus on user pains and value; avoid implementation details"],"content":"# Market Problem and Value Proposition for civicDebateBoard\n\nThis document articulates the market problem, user pains, competitive landscape, differentiators, and measurable value proposition for civicDebateBoard. It provides business requirements context only; all technical design and implementation decisions remain at the discretion of the development team. For strategic framing, see the Service Vision and Overview. For detailed capabilities, see the Functional Requirements Specification.\n\n- Reference: Service Vision and Overview — [Service Vision and Overview](./01-service-vision-and-overview.md)\n- Reference: Functional Requirements Specification — [Functional Requirements Specification](./06-functional-requirements.md)\n\n## Problem Statement\nCivic discussions on mainstream social platforms and generic forums are plagued by low signal-to-noise ratios, misinformation cycles, hostile behavior, fragmented discourse, and shallow engagement mechanisms. Existing solutions prioritize virality and entertainment over deliberative quality, transparency, and accountability. As a result:\n\n- Everyday participants (members) encounter hostility, low trust, and limited tools to curate meaningful conversations around public-interest topics.\n- Knowledgeable or identity-verified contributors (verified members) lack protected affordances to share expertise without being drowned out by brigading, low-quality replies, or algorithmic bias toward engagement over substance.\n- Community safety roles (moderators) face overwhelming report volumes without structured evidence handling, transparent policy scaffolding, or consistent sanctions playbooks.\n- Specialized integrity roles (fact checkers) lack in-platform workflows to annotate claims with citations, highlight context, and propagate corrections without appearing adversarial.\n- Administrators need governance controls, policy configuration, and compliance oversight aligned with civic discourse (e.g., election periods) rather than generic community moderation.\n\nThe core market gap is a civic debate platform optimized for deliberation quality, transparency, and trust—balancing open participation with role-based accountability and evidence-backed conversation.\n\n## Market Context and Trends\nSeveral macro and micro trends intensify the need for a purpose-built civic debate platform:\n\n- Trust and Safety Maturation: Platforms are shifting from reactive moderation to proactive, policy-led safety frameworks with auditability. Regulators and civil society expect clear processes and transparency.\n- Election Integrity and Information Quality: Recurring election cycles amplify misinformation, coordinated manipulation, and polarized discourse. Stakeholders demand structured fact-checking and provenance of claims.\n- Role-based Communities: Professional networks and QA communities demonstrate the value of role differentiation (e.g., experts, moderators) for signal amplification and quality assurance.\n- User Fatigue with Engagement-first Feeds: Users increasingly seek substantively curated spaces where credibility and evidence outweigh raw engagement metrics.\n- Ethical Monetization: There is a growing preference for revenue models that do not incentivize outrage or virality, supporting healthier discourse and sustainable operations.\n- Compliance and Governance: Global privacy and platform accountability expectations (e.g., GDPR-like regimes, election-related guidelines) push for better audit trails and transparent enforcement records.\n\nThese trends suggest opportunity for a platform explicitly designed for civic debate with structured roles, evidence-based contributions, and transparent governance.\n\n## Competitive Landscape\nThe problem space overlaps with several categories. Each category provides partial solutions but fails to combine deliberation depth, trust mechanisms, and scalable safety operations.\n\n- Mainstream Social Networks: Offer massive reach and real-time conversation but optimize for engagement over depth; limited role differentiation; opaque moderation; fact-checking often externalized or post hoc.\n- Traditional Forums and Subforums: Enable topic organization but rely on volunteer moderation with inconsistent policies; minimal evidence workflows; limited transparency on enforcement and appeals.\n- Q&A / Knowledge Platforms: Emphasize accurate answers and reputation systems but are not optimized for multi-perspective civic debate, time-bounded events, or misinformation surge handling.\n- News Comments and Publisher Communities: Provide context-rich discussions but lack standardized moderation transparency and cross-article deliberation continuity; tools are publisher-specific and fragmented.\n- Specialized Fact-Checking Sites: Produce high-quality fact checks but are not interactive conversation platforms; limited integration into ongoing debates and user-level accountability features.\n\nConclusion: No dominant solution integrates role-based participation, structured evidence workflows, transparent moderation, and trust-anchored conversation mechanics for civic discourse.\n\n## Differentiators and Core Value Proposition\ncivicDebateBoard differentiates through a role-enabled, evidence-forward, and transparency-first approach purposely designed for civic conversations.\n\n- Role Differentiation as a First-Class Concept:\n  - Members: Participate with clear accountability, rate limits, and self-moderation tools supporting healthy dialogue.\n  - Verified Members: Identity- or expertise-verified users can label expert content, host structured AMAs, and have calibrated trust (e.g., reduced pre-moderation).\n  - Fact Checkers: Dedicated workflows to annotate claims with citations, add context, and propose corrections; visible badges and track records foster trust.\n  - Moderators: Policy-backed triage queues, clear sanctions catalog, and audit trails for consistent, explainable decisions and appeals.\n  - Admins: Governance configuration, policy and sanctions management, and compliance oversight aligned to civic discourse needs.\n\n- Evidence-Centric Conversation Mechanics:\n  - Claim-level annotations, source citations, and transparency notes reduce misinformation persistence and enable constructive correction.\n  - Topic and category structures oriented to public-interest themes improve discovery and sustained deliberation.\n\n- Transparency and Accountability by Design:\n  - Visible policy references on enforcement actions and public transparency logs for aggregated moderation outcomes build institutional trust.\n  - Clear appeal pathways with auditable histories improve perceived fairness.\n\n- Safety at Scale, Without Engagement Maximization:\n  - Emphasis on healthy discourse outcomes (quality signals, resolved debates, consensus markers) rather than pure engagement metrics.\n  - Configurable thresholds and rate-limiting to reduce brigading and harassment without silencing legitimate participation.\n\n- Business Value:\n  - Institutions, NGOs, local governments, and media partners can host credible civic dialogues with measurable integrity, supporting partnerships and ethical revenue options.\n\nCore Value Proposition: Enable high-trust, evidence-backed civic discussions that are transparent, role-accountable, and operationally sustainable—improving discourse quality and community legitimacy.\n\n## Risks and Mitigations\nThe civic debate space entails material risks. Mitigations emphasize process, governance, and role clarity.\n\n- Cold Start and Network Effects\n  - Risk: Difficulty seeding high-quality discussions without initial critical mass.\n  - Mitigations: Partner-led onboarding (civic groups, universities, local councils); structured AMAs with verified members; highlight fact-checker contributions to bootstrap trust.\n\n- Abuse, Harassment, and Coordinated Manipulation\n  - Risk: Targeted brigading during sensitive topics or election windows.\n  - Mitigations: Rate limits, graduated sanctions catalog, prioritized triage for high-risk topics, clear enforcement transparency, and evidence handling for escalations.\n\n- Misinformation and Defamation\n  - Risk: Reputational damage and legal exposure from persistent false claims.\n  - Mitigations: Claim-level fact-check annotations, corrections workflow, verified member accountability, and transparent moderation outcomes.\n\n- Perception of Bias\n  - Risk: Accusations that moderation or fact-checking favors certain viewpoints.\n  - Mitigations: Public policy documentation, consistent enforcement SLAs, appeal and review processes, and publishable aggregate enforcement metrics.\n\n- Compliance Exposure\n  - Risk: Privacy, election law, or platform accountability obligations not met.\n  - Mitigations: Governance reviews, consent and rights management, auditability and incident response procedures; regular policy updates aligned with civic timelines.\n\n- Monetization Misalignment\n  - Risk: Revenue incentives that encourage polarizing content or compromise trust.\n  - Mitigations: Ethics-aligned monetization (sponsorships by credible institutions, subscriptions for premium capabilities, grants); internal guardrails tying revenue to quality metrics.\n\n## Success Metrics Alignment\nSuccess is defined by outcomes that reflect healthy, trusted civic discourse. Metrics emphasize quality, safety, and integrity rather than raw engagement.\n\n- Quality of Discourse\n  - Percentage of posts/comments with cited sources for claims in designated civic topics.\n  - Ratio of resolved threads (e.g., consensus markers, acknowledged corrections) to total active debates.\n\n- Trust and Accountability\n  - Time-to-first fact-check annotation on high-velocity claims in priority topics.\n  - Appeal resolution time and satisfaction rate from reinstatement outcomes.\n  - Transparency logs publication cadence and completeness (e.g., proportion of enforcement actions with policy references).\n\n- Safety and Moderation Efficiency\n  - Report triage SLA attainment by severity tier.\n  - Rate of repeat violations post-warning or sanction (recidivism).\n  - Share of proactive vs. reactive moderation actions.\n\n- Community Health and Growth Quality\n  - Share of verified members participating monthly; expert AMA cadence.\n  - New member onboarding completion rate with policy acknowledgment.\n  - Ratio of constructive participation to removals in sensitive topics during civic events.\n\n- Partner and Institutional Adoption\n  - Number of hosted civic dialogues by NGOs, universities, or media partners per quarter.\n  - Partner retention and satisfaction scores tied to transparency and quality outcomes.\n\nAlignment Notes:\n- These metrics support strategic objectives described in the Service Vision and Overview and inform prioritization of capabilities outlined in the Functional Requirements Specification.\n\n---\n\nThis document describes market problems and business value only. It does not specify technical implementations. All architectural, API, and database design decisions remain under the full autonomy of the development team, which is responsible for selecting fit-for-purpose solutions consistent with the business requirements context above."},"tokenUsage":{"total":19045,"input":{"total":15320,"cached":0},"output":{"total":3725,"reasoning":1472,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":2,"created_at":"2025-08-15T02:38:29.559Z"},"tokenUsage":{"aggregate":{"total":63754,"input":{"total":49507,"cached":0},"output":{"total":14247,"reasoning":7744,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":60932,"input":{"total":47200,"cached":0},"output":{"total":13732,"reasoning":7360,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Establish the vision, scope, and business model to align all stakeholders before detailing requirements.","filename":"01-service-vision-and-overview.md","documentType":"service-overview","outline":["Executive Summary","Objectives and Success Criteria","Target Users and Use Cases","Service Scope and Boundaries","Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)","Assumptions and Constraints","Out of Scope"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who are the users and what are the core goals?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","02-market-problem-and-value-proposition.md","06-functional-requirements.md","10-business-model-and-analytics.md"],"constraints":["Must include Business Model section with Why/How/What","Use natural language only; avoid technical implementation details"],"content":"# Service Vision and Overview — civicDebateBoard\n\n## Executive Summary\ncivicDebateBoard is a community discussion platform designed to elevate high-quality civic discourse by combining open participation with verifiable expertise, structured fact-checking, and transparent moderation. The service enables members of the public to discuss policy questions, local and national issues, and public-interest topics with contributions from verified domain experts. It integrates role-based participation (member, verifiedMember, factChecker, moderator, admin) and policy-driven safeguards to reduce misinformation, harassment, and low-signal content while preserving free expression and inclusivity.\n\nThe platform addresses three persistent gaps in online civic discussion: (1) low signal-to-noise ratio that undermines productive debate, (2) limited mechanisms to incorporate expertise and evidence in real time, and (3) opaque or inconsistent moderation that erodes trust. By introducing expert verification, structured fact-check annotations, transparent enforcement flows, and measurable service-level expectations, civicDebateBoard aims to deliver a reliable venue for citizens, journalists, researchers, and policymakers to engage constructively.\n\nFor an expanded market context and differentiation narrative, see the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md). Functional details of capabilities and rules are captured in the [Functional Requirements Specification](./06-functional-requirements.md). Business sustainability and measurement strategy are elaborated in the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md). A navigable listing of all documents is available in the [Project Table of Contents](./00-toc.md).\n\n## Objectives and Success Criteria\nThe following objectives are business-outcome focused and expressed with measurable targets. Where applicable, requirements are written using EARS for clarity and testability.\n\n### Strategic Objectives\n- Establish a trusted venue for civic discourse that balances open participation with verifiable information and respectful debate.\n- Promote transparency and accountability in content moderation and fact-checking.\n- Enable sustainable growth via ethical monetization aligned with civic-impact goals.\n\n### Key Results and Targets (12–18 months)\n- Community Health and Quality\n  - Minimum 70% of active discussions include at least one sourced claim or fact-check annotation.\n  - Median moderation turnaround time under 30 minutes for priority-1 (safety) reports and under 4 hours for standard reports during active periods.\n  - Reported content retraction or correction rate above 60% when fact-checks indicate material inaccuracies.\n- Engagement and Reach\n  - Monthly Active Users (MAU) ≥ 100,000 with a 90-day retention rate ≥ 35% for new members.\n  - Verified expert participation in ≥ 20% of high-visibility discussions (top decile by engagement).\n  - Average time-to-first-meaningful-response under 10 minutes on tagged public-interest threads during peak hours.\n- Trust and Transparency\n  - ≥ 95% of enforcement actions accompanied by a machine-readable and human-readable rationale visible to impacted users.\n  - Appeals resolved with written outcomes and references to policy sections in ≥ 95% of cases.\n\n### EARS-Formatted Success Requirements\n- THE platform SHALL support the roles \"member\", \"verifiedMember\", \"factChecker\", \"moderator\", and \"admin\" as the basis for permissions and accountability.\n- WHEN a user reports a post or comment as priority-1 (safety risk), THE platform SHALL surface the item to the moderation queue within 1 minute and SHALL display a receipt to the reporter.\n- WHEN fact-check annotations are submitted with citations, THE platform SHALL attach them to the referenced claim and SHALL present the annotation status as \"proposed\", \"accepted\", or \"contested\".\n- IF content is sanctioned (warning, mute, or suspension), THEN THE platform SHALL notify the content owner with the policy basis, duration, and appeal options.\n- WHERE a discussion is labeled as public-interest or time-sensitive (e.g., election-related), THE platform SHALL elevate review priority and SHALL target a moderation response within 15 minutes during active periods.\n\n## Target Users and Use Cases\ncivicDebateBoard serves multiple user groups, each mapped to a role with distinct responsibilities and privileges in business terms:\n\n- Member (member)\n  - Authenticated participant able to create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules.\n  - Primary use cases: raising civic questions; contributing lived experience; voting and signaling interest; reporting misconduct.\n\n- Verified Member (verifiedMember)\n  - Identity- or expertise-verified participant with elevated trust; can create expert-tagged posts, host “Ask Me Anything” sessions, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while subject to all policies.\n  - Primary use cases: providing qualified analysis; clarifying complex topics; leading structured Q&A; amplifying evidence-backed discourse.\n\n- Fact Checker (factChecker)\n  - Trusted role able to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes. Cannot apply sanctions directly.\n  - Primary use cases: annotating claims; proposing corrections; linking to reputable sources; collaborating with moderators on misinformation.\n\n- Moderator (moderator)\n  - Triages reports, reviews content, applies policy decisions, edits/removes violating content, issues warnings and sanctions, handles appeals within scope, and maintains community health.\n  - Primary use cases: managing queues; enforcing policy; communicating decisions; documenting rationales and evidence trails.\n\n- Administrator (admin)\n  - Manages platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions.\n  - Primary use cases: governance; policy calibration; safety escalation; compliance oversight; strategic partnerships.\n\n### Representative Use Cases\n- Public-interest debate: A member initiates a thread on election policy; verifiedMembers contribute expert context; factCheckers annotate claims; moderators ensure civility and rule compliance.\n- Rapid misinformation response: A viral claim is reported; factCheckers propose annotations with sources; moderators escalate and, if necessary, apply temporary restrictions pending review.\n- Community education: VerifiedMembers host time-bound AMAs; members submit questions; moderation ensures respectful dialogue; post-event, annotations and summaries remain accessible for reference.\n- Policy transparency: A sanctioned user receives a clear rationale with references to the applicable policy section and appeal windows; outcomes are logged and discoverable to the affected user.\n\n## Service Scope and Boundaries\n\n### In Scope (Business Capabilities)\n- Role-based participation mechanisms aligning with the roles defined above.\n- Threaded discussions with posts, comments, reactions, voting, and topic organization (categories/tags).\n- Structured reporting and moderation flows with prioritization and documented rationales.\n- Fact-check lifecycle: submission, review, acceptance/rejection, and visibility on referenced claims.\n- Transparency features including enforcement notices, appeals, and auditability in business terms.\n- Notifications for role-relevant events (e.g., replies, mentions, decisions, fact-check updates).\n- Ethical growth and revenue features (sponsorships, subscriptions) with safety guardrails.\n\n### Boundaries and Operating Principles\n- Civic mission first: content quality and safety take precedence over raw engagement.\n- Evidence-centered: claims are encouraged to be supported by citations; expert contributions are labeled.\n- Transparent enforcement: rationale, duration, and appeal paths accompany sanctions.\n- Inclusivity and accessibility: users can participate regardless of background; language and accessibility needs are respected within community norms.\n\n### High-Level Interaction Flow\n\n```mermaid\ngraph LR\n  subgraph \"Public Participation\"\n    U[\"Members & Verified Members\"] --> P[\"Posts & Comments\"]\n    P --> R[\"Report Content Action\"]\n    P --> N[\"Notifications to Followers\"]\n    P --> T[\"Topic & Category Organization\"]\n  end\n  subgraph \"Quality & Integrity\"\n    V[\"Fact Checkers\"] --> F[\"Fact-Check Annotations\"]\n    F --> P\n    R --> M[\"Moderation Review Queue\"]\n    M --> E[\"Enforcement & Appeals\"]\n  end\n  subgraph \"Governance\"\n    A[\"Administrators\"] --> S[\"Policies, Roles, Settings\"]\n    S -.-> M\n    S -.-> T\n  end\n```\n\n## Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)\n\n### Why This Service Exists\n- Problem: Civic discussion spaces frequently devolve into low-signal debate, misinformation, and harassment, limiting productive engagement and discouraging expert participation.\n- Opportunity: A platform that blends open dialogue with verifiable expertise and structured fact-checking can materially improve discourse quality, trust, and policy literacy.\n- Differentiation: Role-based trust layers (verified experts and fact checkers), transparent enforcement with measurable SLAs, and annotation-first handling of claims distinguish civicDebateBoard from generic forums and social feeds.\n\n### Revenue Strategy\n- Primary: Ethical sponsorships on civic topics with strict conflict-of-interest guardrails and transparency labels.\n- Secondary: Subscription tiers for organizations (e.g., civic groups, newsrooms, universities) to host curated debates, AMAs, or research initiatives with enhanced moderation support.\n- Tertiary: Community memberships offering perks such as topic curation, early access to features, and recognition badges — without pay-to-speak or pay-to-amplify mechanics.\n- Guardrails: No targeted political ads; no pay-for-reach; disclosures for sponsored sessions; clear separation between editorial independence and sponsorship.\n\n### Growth Plan\n- User Acquisition: Partnerships with universities, think tanks, public libraries, NGOs, and local governments; outreach to journalist networks and community organizers; organic growth through high-quality public-interest threads.\n- Activation and Retention: Onboarding flows that encourage citation-backed contributions; scheduled expert sessions; recognition programs for constructive participation and verified expertise.\n- Network Effects: Topic following and notifications; recurring event series; publicly accessible knowledge artifacts (e.g., summarized AMAs, accepted fact-checks) to drive inbound interest.\n\n### Success Metrics and KPIs\n- Reach and Engagement: MAU/DAU, session frequency, average time-to-first-meaningful-response on public-interest threads.\n- Quality and Integrity: Percentage of posts with citations; fact-check turnaround times; proportion of accepted vs. contested annotations; rate of corrected or retracted claims after annotation.\n- Safety and Trust: Moderation SLA adherence, appeals resolution time, user-reported satisfaction with enforcement communications, reduction of repeat violations.\n- Sustainability: Sponsorship revenue distribution by topic (with disclosures), organizational subscription retention, community membership conversion and churn.\n\n## Assumptions and Constraints\n\n### Assumptions\n- User Identity and Roles: Users can be authenticated and associated with one of the defined roles with clear, auditable transitions (e.g., member → verifiedMember).\n- Policy-Driven Operations: Content rules, sanctions, and prioritization are governed by published policy documents that can be updated with appropriate governance.\n- Time Sensitivity: Certain threads (e.g., election or emergency-related) require elevated review priority and faster turnaround compared to standard discussions.\n- International Participation: Users may participate across time zones; business logic will align timestamps to user locale for clarity in communications and notices.\n\n### Constraints\n- Safety Over Virality: Business processes prioritize community safety and integrity ahead of traffic maximization.\n- Transparency Requirement: Enforcement communications include rationale and references to policy sections; appeals produce documented outcomes.\n- Ethical Monetization: Revenue activities cannot undermine discourse independence or safety policies.\n- Privacy and Compliance: Data rights and legal obligations are respected per applicable jurisdictions; security expectations are treated as business obligations.\n\n### EARS-Formatted Operating Constraints\n- THE service SHALL provide human-readable enforcement rationales with policy references for all sanctions.\n- WHERE sponsorship is present, THE service SHALL label sponsored sessions and SHALL disclose sponsor identity to participants.\n- IF a verifiedMember’s expert-tagged post is found materially inaccurate, THEN THE service SHALL require correction or annotation before further amplification.\n- WHILE a discussion is under active appeal, THE service SHALL preserve evidence and SHALL restrict irreversible enforcement until appeal resolution, except where safety risk requires immediate action.\n\n## Out of Scope\nTo maintain focus and ensure coherent delivery, the following items are out of scope for the current vision and planning cycle. These exclusions set expectations for stakeholders and will guide prioritization in downstream requirement documents.\n\n- Frontend UI/UX specifications, visual design systems, and screen layouts.\n- Technical implementation details such as APIs, database schemas, infrastructure choices, or deployment topologies.\n- Paid amplification mechanisms (e.g., pay-for-reach, targeted political ads) and any monetization that could bias civic discourse.\n- Real-time voice/video townhalls; the platform focuses on asynchronous and near-synchronous text-based discourse with notifications.\n- Third-party data brokerage or resale of user data.\n\n---\n\nThis document provides the service vision, scope, and business model in natural language for business stakeholders. Detailed functional capabilities and policies will be specified in the [Functional Requirements Specification](./06-functional-requirements.md) and the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md). Business sustainability and measurement details are further elaborated in the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md), while broader market context is discussed in the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md)."},"tokenUsage":{"total":19988,"input":{"total":15320,"cached":0},"output":{"total":4668,"reasoning":1472,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":3,"created_at":"2025-08-15T02:38:33.916Z"},"tokenUsage":{"aggregate":{"total":83742,"input":{"total":64827,"cached":0},"output":{"total":18915,"reasoning":9216,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":80920,"input":{"total":62520,"cached":0},"output":{"total":18400,"reasoning":8832,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Describe end-to-end business workflows so developers can implement processes consistently.","filename":"05-user-flows-and-processes.md","documentType":"user-flow","outline":["Posting and Editing Content Flow","Commenting and Replying Flow","Voting and Reactions Flow","Reporting Content and Triage Flow","Moderation Review and Enforcement Flow","Appeals and Reinstatement Flow","Onboarding and Verification Flow","Notification Delivery Flow"],"audience":"development team","keyQuestions":["What are the step-by-step business flows for core actions?","How do reporting, moderation, and appeals progress from start to finish?","What are the key decision points and outcomes?"],"detailLevel":"detailed specification","relatedDocuments":["04-user-personas-and-scenarios.md","06-functional-requirements.md","07-content-moderation-and-safety-policies.md"],"constraints":["Include at least one Mermaid flow diagram per complex flow using strict syntax rules","Describe business logic only; avoid technical implementation details"],"content":"# User Flows and Processes — civicDebateBoard\n\nThis document defines the complete business workflows for civicDebateBoard so backend developers can implement consistent behaviors across all core processes. It describes WHAT the system should do in business terms, not HOW to build it. All technical implementations (architecture, APIs, database design, or UI) are at the discretion of the development team.\n\nRelated context for deeper background can be found in the following documents:\n- See the narrative personas and examples in the [User Personas and Scenarios](./04-user-personas-and-scenarios.md).\n- For the full set of capability rules, refer to the [Functional Requirements Specification](./06-functional-requirements.md).\n- For policy definitions and enforcement guardrails, consult the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## Conventions and Roles Context\n- Roles used throughout: member, verifiedMember, factChecker, moderator, admin.\n- Content types referenced: post, comment, reply, reaction, vote, report, annotation (fact-check), sanction, appeal, notification.\n- Time references are evaluated in the user’s configured timezone; timestamps are stored and presented per business rules in the [Functional Requirements Specification](./06-functional-requirements.md).\n- EARS syntax is used for applicable requirements. EARS keywords (WHEN, WHILE, IF, THEN, WHERE, THE, SHALL) are kept in English.\n\n## Posting and Editing Content Flow\n\n### Business Description\nMembers publish civic discussion posts that may include titles, body text, tags, and topic associations. Certain content may require pre-moderation depending on trust signals (e.g., newly registered users) and policy flags. Authors can edit their own posts subject to time-bound and policy constraints. Verified members may tag posts as expert contributions when permitted.\n\n### Preconditions\n- A user must be authenticated as member or above to create posts.\n- The author’s account must be in good standing (not muted or suspended).\n- Rate limit budgets must not be exhausted.\n\n### Primary Flow (Posting)\n1. Author creates a draft with required fields.\n2. System validates input fields and checks rate limits.\n3. System evaluates whether the post qualifies for pre-moderation or can be immediately visible.\n4. If pre-moderation is required, the post enters a review queue; otherwise, it is published.\n5. On publish, the system schedules notifications to followers or subscribers as per preferences.\n\n### Editing Flow\n1. Author requests to edit own post.\n2. System validates edit window and policy constraints.\n3. System applies edit and records an immutable edit trail.\n4. If the edit materially changes policy-sensitive content, the post may be temporarily hidden or queued for re-review based on rules.\n\n### Key Decisions\n- Whether pre-moderation is required.\n- Whether edit is within allowable window or requires re-review.\n- Whether the user is sanctioned or rate-limited.\n\n### Mermaid Flow Diagram (Posting + Editing)\n```mermaid\ngraph LR\n  A[\"Start (Author Authenticated)\"] --> B[\"Create Draft(Post)\" ]\n  B --> C[\"Validate Input & Rate Limits\" ]\n  C --> D{\"Valid & Within Limits?\"}\n  D -->|\"No\"| E[\"Reject with Errors\" ]\n  D -->|\"Yes\"| F{\"Pre-Moderation Needed?\"}\n  F -->|\"Yes\"| G[\"Queue for Review\" ]\n  F -->|\"No\"| H[\"Publish Immediately\" ]\n  G --> I{\"Approved?\"}\n  I -->|\"Yes\"| H\n  I -->|\"No\"| J[\"Reject with Policy Reason\" ]\n  H --> K[\"Notify Subscribers/Followers\" ]\n  K --> L[\"End (Post Visible)\" ]\n\n  %% Editing sub-flow\n  M[\"Author Requests Edit\" ] --> N[\"Check Edit Window & Sanctions\" ]\n  N --> O{\"Allowed?\"}\n  O -->|\"No\"| P[\"Deny Edit with Reason\" ]\n  O -->|\"Yes\"| Q[\"Apply Edit & Record Trail\" ]\n  Q --> R{\"Triggers Re-Review?\"}\n  R -->|\"Yes\"| S[\"Temporarily Hide & Queue\" ]\n  R -->|\"No\"| T[\"Keep Visible\" ]\n  S --> U{\"Approved?\"}\n  U -->|\"Yes\"| T\n  U -->|\"No\"| V[\"Revert/Reject Edit\" ]\n```\n\n### EARS-Formatted Requirements\n- THE posting service SHALL require authentication as member or higher to create posts.\n- THE posting service SHALL validate required fields: title (non-empty, max length per policy), body (non-empty), and at least one tag/topic where required by policy.\n- WHERE the author is newly registered or under low-trust conditions, THE posting service SHALL route new posts to pre-moderation.\n- WHEN input validation fails, THE posting service SHALL return a structured error containing field-level reasons.\n- WHEN a post is published, THE notification service SHALL enqueue notifications to eligible subscribers within 1 minute.\n- WHILE the post is in review, THE content visibility service SHALL set visibility to non-public and visible to moderators and the author.\n- IF the review is rejected for policy reasons, THEN THE posting service SHALL notify the author with categorical reasons and next-step guidance.\n- WHERE the edit occurs within the allowed self-edit window (e.g., 24 hours) and no sanctions apply, THE posting service SHALL allow edits and record an edit trail accessible to moderators.\n- IF the edit materially changes sensitive content categories, THEN THE posting service SHALL temporarily hide the post and submit for re-review.\n- WHEN rate limits are exhausted, THE posting service SHALL deny the action with a reset time.\n- WHEN a verifiedMember marks a post as expert-tagged, THE posting service SHALL display an expert badge subject to verification policy.\n\n### Error Handling and Recovery\n- IF required fields are missing, THEN THE system SHALL provide explicit field names and constraints in the response message.\n- IF the user is muted or suspended, THEN THE system SHALL block posting and include sanction type and end time.\n- IF duplicate content is detected within a short window, THEN THE system SHALL reject with a duplicate warning.\n\n### Performance and Rate Limiting Expectations\n- WHEN a valid post is submitted without pre-moderation, THE system SHALL complete publication within 2 seconds under normal load.\n- WHEN posts enter pre-moderation, THE system SHALL place the item in the review queue within 1 second and confirm receipt to the author.\n- WHERE rate limits apply, THE system SHALL present remaining quota and next reset time in natural language.\n\n## Commenting and Replying Flow\n\n### Business Description\nUsers add comments to posts and replies to comments to facilitate threaded discussion. Comment visibility and edit rules mirror those of posts, but with shorter edit windows and stricter anti-spam controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Account not under comment-restrictive sanctions.\n- Target post or parent comment is visible and open for comments.\n\n### Mermaid Flow Diagram (Commenting)\n```mermaid\ngraph LR\n  A[\"Start (Authenticated)\" ] --> B[\"Select Target(Post/Comment)\" ]\n  B --> C[\"Validate Target Visibility & Open State\" ]\n  C --> D{\"Allowed to Comment?\"}\n  D -->|\"No\"| E[\"Deny with Reason\" ]\n  D -->|\"Yes\"| F[\"Create Draft(Comment)\" ]\n  F --> G[\"Validate Content & Rate Limits\" ]\n  G --> H{\"Valid?\"}\n  H -->|\"No\"| I[\"Reject with Errors\" ]\n  H -->|\"Yes\"| J{\"Pre-Moderation Needed?\"}\n  J -->|\"Yes\"| K[\"Queue for Review\" ]\n  J -->|\"No\"| L[\"Publish Comment\" ]\n  K --> M{\"Approved?\"}\n  M -->|\"Yes\"| L\n  M -->|\"No\"| N[\"Reject with Policy Reason\" ]\n  L --> O[\"Update Counts & Notify Participants\" ]\n```\n\n### EARS-Formatted Requirements\n- THE commenting service SHALL allow only authenticated users in good standing to submit comments.\n- THE commenting service SHALL validate that the target is visible and open for comments before accepting content.\n- WHERE anti-spam heuristics trigger, THE commenting service SHALL require pre-moderation for the comment.\n- WHEN a comment is published, THE system SHALL notify the post author and recent participants subject to notification preferences.\n- WHERE an edit occurs within a 30-minute window and no replies exist, THE commenting service SHALL allow self-edit with edit trail.\n- IF the parent content is removed, THEN THE commenting service SHALL mark the comment’s visibility per policy (e.g., hidden with placeholder).\n\n### Error Handling and Performance\n- WHEN validation fails, THE system SHALL return field-specific messages within 2 seconds.\n- WHEN a user exceeds comment rate limits, THE system SHALL block the action and provide reset time.\n\n## Voting and Reactions Flow\n\n### Business Description\nUsers express sentiment through votes (e.g., up/down) and reactions (e.g., agree, insightful). Each user may cast at most one vote per item and may update or retract it. Tallying is transparent and subject to anti-abuse controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Target content is visible and not locked.\n\n### Mermaid Flow Diagram (Voting)\n```mermaid\ngraph LR\n  A[\"Start (Authenticated)\" ] --> B[\"Select Target Content\" ]\n  B --> C[\"Check Visibility & Lock State\" ]\n  C --> D{\"Eligible?\"}\n  D -->|\"No\"| E[\"Deny (Not Eligible)\" ]\n  D -->|\"Yes\"| F[\"Check Existing Vote\" ]\n  F --> G{\"Has Existing Vote?\"}\n  G -->|\"No\"| H[\"Apply New Vote\" ]\n  G -->|\"Yes\"| I{\"Same Direction?\"}\n  I -->|\"Yes\"| J[\"Retract Vote\" ]\n  I -->|\"No\"| K[\"Update Vote Direction\" ]\n  H --> L[\"Update Tally\" ]\n  J --> L\n  K --> L\n  L --> M[\"Acknowledge & Notify (Optional)\" ]\n```\n\n### EARS-Formatted Requirements\n- THE voting service SHALL restrict each user to a single active vote per item at any time.\n- WHEN a user submits the same vote twice, THE voting service SHALL interpret it as a retraction and update the tally accordingly.\n- WHEN a user changes vote direction, THE voting service SHALL decrement the prior tally and increment the new tally atomically.\n- WHERE the target content is locked, THE voting service SHALL reject voting with a lock reason.\n- THE reactions service SHALL allow multiple reaction types per item but limit one per type per user.\n- IF a user is sanctioned from participatory actions, THEN THE voting and reactions services SHALL deny the attempt with sanction details.\n\n### Error Handling and Performance\n- WHEN a valid vote/reaction request succeeds, THE system SHALL acknowledge within 1 second under normal load.\n- IF the content reference is invalid, THEN THE system SHALL return a clear “not found or not visible” outcome without leaking private state.\n\n## Reporting Content and Triage Flow\n\n### Business Description\nUsers report content suspected of violating policy. Reports are categorized, prioritized, and routed to moderation queues. FactCheckers can attach annotations citing sources and propose corrections. Moderators triage reports according to SLAs.\n\n### Preconditions\n- Reporter is authenticated (member or above) and not sanctioned from reporting.\n- Target content exists and is visible to the reporter at the time of reporting.\n\n### Mermaid Flow Diagram (Reporting & Triage)\n```mermaid\ngraph LR\n  A[\"Start (Reporter Authenticated)\" ] --> B[\"Select Content & Category\" ]\n  B --> C[\"Validate Inputs & Duplicate Report Check\" ]\n  C --> D{\"Valid?\"}\n  D -->|\"No\"| E[\"Reject with Errors\" ]\n  D -->|\"Yes\"| F[\"Create Report Record\" ]\n  F --> G[\"Priority Scoring (Severity, Volume, Role)\" ]\n  G --> H[\"Route to Queue (Policy/Topic)\" ]\n  H --> I{\"Auto-Action Threshold Met?\"}\n  I -->|\"Yes\"| J[\"Apply Temporary Hide\" ]\n  I -->|\"No\"| K[\"Await Moderator Review\" ]\n  J --> K\n```\n\n### EARS-Formatted Requirements\n- THE reporting service SHALL require a category selection from the defined policy taxonomy for every report.\n- THE reporting service SHALL deduplicate substantially identical reports within a defined time window to prevent spam.\n- WHERE severity or report volume crosses thresholds, THE reporting service SHALL temporarily hide the content pending review.\n- WHEN a factChecker adds an annotation, THE system SHALL link the annotation to the reported content and make it available to moderators.\n- WHEN a report is submitted, THE system SHALL confirm receipt to the reporter within 2 seconds and provide a reference ID.\n\n### Error Handling and SLAs\n- THE reporting service SHALL prevent reports on content the reporter cannot see.\n- THE moderation triage process SHALL surface high-priority items to moderators within 1 minute of report submission.\n\n## Moderation Review and Enforcement Flow\n\n### Business Description\nModerators review reported or queued content, assess against policy, and choose outcomes: approve, edit with transparency note, remove, warn, mute, suspend, or escalate to admin. All actions create audit logs and user notifications with clear reasons.\n\n### Preconditions\n- Moderator or admin is authenticated with appropriate privileges.\n- Evidence (reports, prior history, annotations) is accessible.\n\n### Mermaid Flow Diagram (Moderation)\n```mermaid\ngraph LR\n  A[\"Start (Moderator Assigned)\" ] --> B[\"Open Case & Review Evidence\" ]\n  B --> C{\"Policy Violation?\"}\n  C -->|\"No\"| D[\"Approve/Restore Content\" ]\n  C -->|\"Yes\"| E{\"Severity Level\"}\n  E --> F[\"Edit with Transparency Note\" ]\n  E --> G[\"Remove Content\" ]\n  E --> H[\"Issue Warning\" ]\n  E --> I[\"Apply Mute/Suspension\" ]\n  E --> J[\"Escalate to Admin\" ]\n  D --> K[\"Notify Reporter & Author\" ]\n  F --> K\n  G --> K\n  H --> K\n  I --> K\n  J --> L[\"Admin Decision\" ] --> K\n  K --> M[\"Close Case & Log Audit\" ]\n```\n\n### EARS-Formatted Requirements\n- THE moderation service SHALL present consolidated evidence including reports, prior violations, and factChecker annotations.\n- WHEN no violation is found, THE moderation service SHALL approve or restore the content and notify involved parties.\n- WHERE a minor violation is identified, THE moderation service SHALL allow corrective edits with a transparency note.\n- WHERE policy prohibits the content, THE moderation service SHALL remove the content and preserve an evidence snapshot.\n- WHERE behavior warrants sanctions, THE moderation service SHALL apply warnings, mutes, or suspensions per configured policy tiers.\n- WHEN a case requires higher authority, THE moderation service SHALL support escalation to admin with case context.\n- THE moderation service SHALL create immutable audit logs for every action, including actor, timestamp, and rationale category.\n\n### Error Handling and SLAs\n- WHEN a moderation action is taken, THE system SHALL notify affected users within 1 minute with clear reason categories and appeal instructions.\n- WHERE automatic actions temporarily hid content, THE system SHALL reconcile visibility within 1 minute after final decision.\n\n## Appeals and Reinstatement Flow\n\n### Business Description\nUsers may appeal moderation actions within a defined window. Appeals are queued, reviewed by a different moderator or an admin depending on severity, and result in uphold, partial modification, or full reversal.\n\n### Preconditions\n- Appellant is authenticated and is the subject of the action or the content author.\n- Appeal is within allowed time window and includes a reason.\n\n### Mermaid Flow Diagram (Appeals)\n```mermaid\ngraph LR\n  A[\"Start (User Files Appeal)\" ] --> B[\"Validate Eligibility & Window\" ]\n  B --> C{\"Eligible?\"}\n  C -->|\"No\"| D[\"Reject Appeal with Reason\" ]\n  C -->|\"Yes\"| E[\"Create Appeal Case\" ]\n  E --> F[\"Assign Reviewer (Independence Rule)\" ]\n  F --> G[\"Review Evidence & Rationale\" ]\n  G --> H{\"Outcome\"}\n  H --> I[\"Uphold\" ]\n  H --> J[\"Modify (Partial)\" ]\n  H --> K[\"Reverse\" ]\n  I --> L[\"Notify Parties & Close\" ]\n  J --> L\n  K --> L\n```\n\n### EARS-Formatted Requirements\n- THE appeals service SHALL require appellants to provide a reason tied to predefined categories.\n- THE appeals service SHALL enforce an independence rule such that the original moderator does not decide the appeal.\n- WHEN an appeal is filed, THE system SHALL acknowledge receipt within 2 seconds and provide a tracking ID.\n- WHEN an appeal decision is recorded, THE system SHALL notify all relevant parties and update content visibility and sanctions accordingly.\n- WHERE reversal occurs, THE appeals service SHALL restore content and remove or annotate sanctions as appropriate.\n\n### Error Handling and SLAs\n- IF the appeal is out of window or lacks required information, THEN THE system SHALL reject with guidance on eligibility and timing.\n- THE appeals queue SHALL present new appeals to eligible reviewers within 5 minutes of submission.\n\n## Onboarding and Verification Flow\n\n### Business Description\nNew users register, verify email, and complete basic profile steps. Users may request elevated status as verifiedMember by submitting identity or expertise evidence. Admins or designated verifiers adjudicate requests.\n\n### Preconditions\n- For registration: unauthenticated visitor.\n- For verification: authenticated user in good standing.\n\n### Mermaid Flow Diagram (Onboarding & Verification)\n```mermaid\ngraph LR\n  A[\"Start Registration\" ] --> B[\"Provide Email & Password\" ]\n  B --> C[\"Create Account (Pending Verification)\" ]\n  C --> D[\"Send Verification Email\" ]\n  D --> E{\"Email Verified?\"}\n  E -->|\"No\"| F[\"Limit Access (Grace Period)\" ]\n  E -->|\"Yes\"| G[\"Activate Member Role\" ]\n  G --> H[\"Optional: Complete Profile\" ]\n  H --> I{\"Apply for Verification?\"}\n  I -->|\"No\"| J[\"End (Member)\" ]\n  I -->|\"Yes\"| K[\"Submit Evidence & Rationale\" ]\n  K --> L[\"Queue for Verifier Review\" ]\n  L --> M{\"Approved?\"}\n  M -->|\"Yes\"| N[\"Elevate to verifiedMember\" ]\n  M -->|\"No\"| O[\"Deny with Reason & Cooldown\" ]\n```\n\n### EARS-Formatted Requirements\n- THE onboarding service SHALL require email verification before granting full member privileges.\n- WHILE the email is unverified within the grace period, THE onboarding service SHALL restrict posting and interaction capabilities per policy.\n- WHEN verification succeeds, THE onboarding service SHALL activate the member role and record the verification timestamp.\n- WHEN a user applies for verifiedMember, THE verification service SHALL require evidence and a rationale.\n- THE verification service SHALL maintain an auditable decision with reviewer identity and decision reason.\n- IF a verification request is denied, THEN THE verification service SHALL impose a cooldown period before re-application.\n\n### Error Handling and Performance\n- WHEN verification links are followed, THE system SHALL process activation within 2 seconds and provide clear status.\n- IF the verification link is expired or already used, THEN THE system SHALL present a safe re-issue path.\n\n## Notification Delivery Flow\n\n### Business Description\nNotifications inform users about relevant events (e.g., new comments, moderation outcomes, appeal updates). Users set preferences for delivery types (instant or digest) and categories. The system batches and rate limits notifications to prevent overload.\n\n### Preconditions\n- Trigger event occurs from another process.\n- Recipient has not muted the category and is eligible under policy.\n\n### Mermaid Flow Diagram (Notifications)\n```mermaid\ngraph LR\n  A[\"Event Triggered\" ] --> B[\"Resolve Recipients & Preferences\" ]\n  B --> C[\"Apply Eligibility & Mute Rules\" ]\n  C --> D{\"Any Recipients?\"}\n  D -->|\"No\"| E[\"End (No Delivery)\" ]\n  D -->|\"Yes\"| F{\"Delivery Mode\"}\n  F --> G[\"Instant Queue\" ]\n  F --> H[\"Digest Queue\" ]\n  G --> I[\"Send Notification\" ]\n  H --> J[\"Aggregate & Schedule\" ]\n  I --> K[\"Acknowledge\" ]\n  J --> K\n```\n\n### EARS-Formatted Requirements\n- THE notification service SHALL respect per-user category preferences for instant or digest delivery modes.\n- WHERE recipients exceed batching thresholds, THE notification service SHALL aggregate events into a digest according to schedule rules.\n- WHEN a moderation or appeal decision occurs, THE notification service SHALL deliver outcome notifications within 1 minute.\n- IF a user has muted a category, THEN THE notification service SHALL suppress those notifications except for mandatory compliance notices.\n- THE notification service SHALL mark notifications as read/unread based on user interactions recorded by other flows.\n\n### Error Handling and Performance\n- WHEN an instant notification is enqueued, THE system SHALL attempt delivery within 1 minute under normal operating conditions.\n- IF a delivery attempt fails, THEN THE system SHALL retry based on a backoff schedule and record a delivery status for audit.\n\n## Cross-Role Considerations and Guardrails\n- WHERE a user’s account state changes (mute, suspension, reinstatement), THE system SHALL enforce the new state consistently across all flows without delay.\n- THE system SHALL ensure that factChecker annotations do not directly impose sanctions but are highly visible to moderators in related cases.\n- THE system SHALL ensure that admin can perform all moderator actions and manage role elevations and policy configurations.\n\n## Scope Reminder\nThis document contains business requirements only. It intentionally avoids technical implementation details such as APIs, database schemas, or system architecture. Developers have full autonomy to choose the appropriate technical solutions that satisfy these requirements.\n"},"tokenUsage":{"total":22264,"input":{"total":15320,"cached":0},"output":{"total":6944,"reasoning":1472,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":4,"created_at":"2025-08-15T02:39:30.883Z"},"tokenUsage":{"aggregate":{"total":106006,"input":{"total":80147,"cached":0},"output":{"total":25859,"reasoning":10688,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":103184,"input":{"total":77840,"cached":0},"output":{"total":25344,"reasoning":10304,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Capture representative users and their end-to-end scenarios to ground requirements in real-world needs.","filename":"04-user-personas-and-scenarios.md","documentType":"user-story","outline":["Personas (Member, Verified Member, Fact Checker, Moderator, Admin)","Primary Scenarios (Happy Paths)","Secondary and Special Scenarios (Edge Cases)","Abuse and Misuse Scenarios","Acceptance Criteria (EARS)"],"audience":"product managers","keyQuestions":["Who are the primary personas and what are their motivations?","What are the main scenarios that define success?","What edge cases and abuse scenarios must be supported or mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","05-user-flows-and-processes.md","06-functional-requirements.md"],"constraints":["Use narrative language; include EARS acceptance criteria where applicable","Avoid UI design or technical details"],"content":"# civicDebateBoard — User Personas and Scenarios (Requirement Analysis)\n\nThis document provides business requirements only for civicDebateBoard. All technical implementation decisions, including architecture, APIs, and data models, are at the discretion of the development team. The document describes WHAT the system should do from a user and business perspective.\n\n## Document Scope and Context\n- Purpose: Capture representative users and their end-to-end scenarios to ground requirements in real-world civic discourse needs and to inform implementation without prescribing technical mechanisms.\n- Alignment: Complements the strategic framing in the [Service Vision and Overview](./01-service-vision-and-overview.md), details narrative flows that will be elaborated procedurally in the [User Flows and Processes](./05-user-flows-and-processes.md), and anchors the detailed rules in the [Functional Requirements](./06-functional-requirements.md).\n- Service Prefix: civicDebateBoard\n- Roles in Scope: member, verifiedMember, factChecker, moderator, admin\n- Tone: Formal, policy- and outcome-oriented, avoiding UI specifications.\n\n## Personas\n\n### Member\n- Summary: Authenticated community participant who starts and joins discussions, votes, reacts, follows topics, bookmarks, reports content, and manages own account within community rules and rate limits.\n- Motivations:\n  - Participate in good-faith civic debate, ask questions, and learn.\n  - Find trustworthy information quickly.\n  - Receive timely updates about followed topics and threads.\n- Goals:\n  - Publish posts and comments that remain visible if compliant.\n  - Get useful responses and consensus signals (votes, reactions).\n  - Curate a personal feed by following topics and users.\n- Behaviors:\n  - Posts within rate limits; edits content shortly after posting; reports harmful content.\n  - Uses bookmarks to return to long threads; subscribes for notifications.\n- Constraints:\n  - Must verify email to publish or report; subject to rate limits, content rules, and possible sanctions.\n- Definition of Success:\n  - Content is published promptly; notifications arrive within expected time; reports receive visible outcomes; personal activity and preferences persist across sessions.\n\n### Verified Member\n- Summary: Identity- or expertise-verified participant with elevated trust and accountability; can publish expert-tagged content and host AMAs.\n- Motivations:\n  - Share domain expertise responsibly; reduce friction from pre-moderation; build public credibility.\n- Goals:\n  - Publish expert posts with fewer pre-moderation holds while maintaining accountability.\n  - Host and manage topic-focused sessions (e.g., AMA) with structured Q&A.\n- Behaviors:\n  - Provides sources; maintains higher standards of accuracy; engages respectfully.\n- Constraints:\n  - Bound by stricter accountability; some actions subject to audit but with relaxed rate limits compared to general members.\n- Definition of Success:\n  - Expert posts are discoverable and trusted; engagement is high; fewer false-positive moderation holds.\n\n### Fact Checker\n- Summary: Trusted role allowed to add fact-check annotations and cite sources; flags misleading claims for review and proposes corrections; cannot sanction.\n- Motivations:\n  - Improve information quality; surface evidence; build transparency.\n- Goals:\n  - Attach verifiable annotations; escalate critical misinformation quickly.\n- Behaviors:\n  - Adds structured notes with sources; proposes status labels (e.g., “unsupported”, “misleading”).\n- Constraints:\n  - No direct sanctions; requires moderator/admin confirmation for enforcement actions.\n- Definition of Success:\n  - Annotations appear contextually; authors and readers see clear evidence; reviews occur within SLA; misinformation visibility is appropriately reduced.\n\n### Moderator\n- Summary: Responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, and handling appeals.\n- Motivations:\n  - Maintain healthy discourse at scale; act fairly and consistently; meet review SLAs.\n- Goals:\n  - Efficiently process queues; apply transparent decisions; reduce repeat violations.\n- Behaviors:\n  - Triage by severity; consult policy references; communicate decisions and rationales.\n- Constraints:\n  - Must follow policy and escalation rules; avoids conflicts of interest; respects auditability.\n- Definition of Success:\n  - Queue latency within SLA; low rate of reversed decisions on appeal; clear, consistent messaging.\n\n### Admin\n- Summary: Manages platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, and compliance reviews; can perform all moderator actions.\n- Motivations:\n  - Ensure governance, safety, and compliance while supporting growth.\n- Goals:\n  - Configure policies and roles; approve sensitive data exports; audit platform health.\n- Behaviors:\n  - Assigns roles; updates sanctions and policies; reviews audits and compliance.\n- Constraints:\n  - Operates under legal and governance obligations; high accountability and audit requirements.\n- Definition of Success:\n  - Policies and roles reflect current needs; compliance reviews pass; community health metrics improve.\n\n## Primary Scenarios (Happy Paths)\n\n### 1) Member publishes a compliant discussion and engages\n- Narrative:\n  - A member drafts a substantive discussion within rate limits, selects relevant topics/tags in business terms, and publishes. The post appears instantly to the community if it does not require pre-moderation. The member follows the thread. Other members react and comment; the author receives timely notifications and responds. The thread remains visible and discoverable via topics and search.\n- Business Rules (implicit in flow):\n  - Email verification is required to publish; content must conform to policy; rate limits apply; edits allowed for a short window (e.g., 15 minutes) without moderator review; subsequent edits may require review if content meaning materially changes.\n- Success Indicators:\n  - Publication within seconds; notifications within one minute for direct replies; discoverability via the selected topics.\n\n### 2) Verified Member hosts an expert Q&A (AMA) session\n- Narrative:\n  - A verifiedMember schedules and posts an expert session. The session is tagged as “expert” and prioritized in discovery. Questions from members are collected; the verifiedMember answers and cites credible sources. The session concludes with a summary note and remains archived for reference.\n- Business Rules:\n  - Expert tag is restricted to verifiedMember and above; standard policy and rate limits apply; session tagging influences prominence but does not exempt policy.\n- Success Indicators:\n  - Session starts on time; questions route properly; post-session summary is visible; high engagement with minimal moderation intervention.\n\n### 3) Fact Checker annotates a claim with sources\n- Narrative:\n  - A factChecker identifies a claim in a popular post, attaches an annotation with citations, and proposes a status label (e.g., “unsupported”). Readers see a clear contextual note and link to sources. A moderator reviews and confirms the proposed label; the author is notified and may revise.\n- Business Rules:\n  - Annotations are non-destructive; factChecker cannot sanction; moderation review is required to change visibility or apply labels with enforcement.\n- Success Indicators:\n  - Annotation appears contextually within seconds; review completed within SLA; readers engage with sources.\n\n### 4) Member reports content; Moderator triages and enforces\n- Narrative:\n  - A member reports content for misinformation/harassment. The system prioritizes the report based on severity heuristics. A moderator reviews with relevant context and past case history, then applies a proportionate action (dismiss, edit, warning, temporary mute, suspension) and logs a clear rationale. Reporter and content author receive notifications summarizing the outcome.\n- Business Rules:\n  - Reporter identity remains confidential to the author; sanctions follow configured ladders; appeals are available within a defined window.\n- Success Indicators:\n  - High-severity cases are acknowledged within minutes; decisions communicated clearly; low reversal rate on appeal.\n\n### 5) Admin manages categories and role assignments\n- Narrative:\n  - An admin creates new categories for upcoming civic events, updates topic taxonomies, and assigns factChecker status to a qualified user. The changes take effect promptly and are logged for audit. Affected users are notified of role changes.\n- Business Rules:\n  - Role changes require justification; taxonomy changes propagate to discovery and subscriptions; audits capture who, what, when, and why.\n- Success Indicators:\n  - Zero disruption to existing content; new categories appear in discovery; role changes reflect instantly in permissions.\n\n### 6) Member follows topics and receives updates\n- Narrative:\n  - A member follows a set of civic topics. New posts in followed topics trigger notifications and a personalized activity feed. The member can unfollow anytime and updates take effect immediately.\n- Business Rules:\n  - Follow capacity and rate limits apply to prevent abuse; notification preferences are user-configurable.\n- Success Indicators:\n  - Timely and relevant notifications; accurate feed composition reflecting follows/unfollows.\n\n### Flow Illustration: Report Intake and Triage (Happy Path)\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"Member Report Content(Select reason)\"] --> B[\"Submit Report\"]\n  end\n  subgraph \"System Classification\"\n    C[\"Classify Severity\"] --> D{\"High Severity?\"}\n  end\n  subgraph \"Moderation\"\n    E[\"Queue Moderator\"] --> F[\"Review Context and History\"] --> G{\"Policy Violation?\"}\n    H[\"Apply Sanction(Warning/Mute/Suspension)\"] --> I[\"Notify Author and Reporter\"]\n    J[\"Dismiss Report\"] --> I\n  end\n  B --> C\n  D -->|\"Yes\"| E\n  D -->|\"No\"| E\n  E --> F\n  G -->|\"Yes\"| H\n  G -->|\"No\"| J\n```\n\n## Secondary and Special Scenarios (Edge Cases)\n\n### Editing window exceeded\n- Narrative: A member attempts to edit a post after the self-edit window has expired. The system offers a revision request path that may queue for moderator review when the change is material.\n- Expected Outcome: Edit is denied instantly with clear rationale; optional revision request enters review with status tracking.\n\n### Rate limit reached during surge\n- Narrative: A member hits posting or commenting rate limits during a high-traffic event. The system communicates the remaining cooldown and suggests draft saving.\n- Expected Outcome: No content loss; member understands wait time; rate limit resets as scheduled.\n\n### Email not verified but attempting to publish\n- Narrative: An authenticated user without verified email tries to publish or report.\n- Expected Outcome: Action blocked with clear instructions to verify; progress preserved until verification completes.\n\n### Suspended user content visibility\n- Narrative: A previously suspended user’s past content is accessed. The system applies visibility rules that may limit or label historical content without erasing lawful records.\n- Expected Outcome: Reader sees appropriate labels or limited visibility; audit records remain intact.\n\n### Fact-checker conflict of interest\n- Narrative: A factChecker attempts to annotate content authored by a declared close collaborator.\n- Expected Outcome: System requires disclosure and routes to another reviewer; annotation is held until independent review completes.\n\n### Moderator conflict-of-interest recusal\n- Narrative: A moderator is assigned a report involving a user they sanctioned recently.\n- Expected Outcome: Reassignment occurs automatically; audit notes the recusal reason and time.\n\n### Appeals window and reinstatement\n- Narrative: A sanctioned user submits an appeal within the configured window.\n- Expected Outcome: Appeal is acknowledged, reviewed by a distinct moderator within SLA, and the decision (uphold/modify/reverse) is communicated with rationale.\n\n### Multi-device session revocation\n- Narrative: A member revokes all device sessions from account settings after suspecting account sharing.\n- Expected Outcome: Active sessions terminate promptly; user is informed that re-authentication is required across devices.\n\n### Timezone and localization handling\n- Narrative: A user traveling across timezones views timestamps.\n- Expected Outcome: Timestamps reflect user preference and show original post time with offset clarity when needed.\n\n## Abuse and Misuse Scenarios\n\n### Coordinated brigading and vote manipulation\n- Behavior: New or low-reputation accounts attempt to mass-upvote or downvote to distort consensus.\n- Mitigations:\n  - Weight votes based on trust signals; limit rapid voting bursts; detect correlated activity.\n- Expected Outcomes:\n  - Manipulative impact is reduced; abnormal patterns are flagged for moderator review.\n\n### Misinformation campaigns in civic contexts\n- Behavior: Rapid spread of misleading claims during elections or emergencies.\n- Mitigations:\n  - Priority routing to factChecker and moderator queues; temporary interstitials with context; reduced algorithmic amplification pending review.\n- Expected Outcomes:\n  - Harm minimized through timely labels and context; legitimate discussion remains possible.\n\n### Harassment and doxxing\n- Behavior: Targeted harassment, threats, or sharing of personal information.\n- Mitigations:\n  - Swift removal of personal data; immediate protective actions (mutes/suspensions); enhanced reporting pathways for targets.\n- Expected Outcomes:\n  - Victims protected quickly; offenders sanctioned; audit trail preserved.\n\n### Spam and link farming\n- Behavior: Accounts posting low-quality promotional links at scale.\n- Mitigations:\n  - Strict rate limits; link reputation checks; escalating sanctions for repeat offenses.\n- Expected Outcomes:\n  - Reduced visibility of spam; legitimate links unaffected.\n\n### Sockpuppetry and duplicate accounts\n- Behavior: One actor uses multiple accounts to evade sanctions or create false consensus.\n- Mitigations:\n  - Trust and behavior analytics; stricter limits on new accounts; consolidated enforcement when linked by policy signals.\n- Expected Outcomes:\n  - Evading behaviors curtailed; sanctions applied across linked accounts per policy.\n\n### Malicious or bad-faith reporting\n- Behavior: Users repeatedly report compliant content to harass others or burden moderation.\n- Mitigations:\n  - Reporter reputation factoring; cooldowns for false reporting; sanctions for repeat abuse.\n- Expected Outcomes:\n  - Reduced false-positive load; preserved reporter functionality for good-faith users.\n\n### Sanction evasion attempts\n- Behavior: Changing content to avoid detection, deleting evidence, or using obfuscation.\n- Mitigations:\n  - Immutable audit logs; snapshotting before removals; re-checks after edits; pattern detection.\n- Expected Outcomes:\n  - Evasion attempts are ineffective; accountability maintained.\n\n## Acceptance Criteria (EARS)\n\nThe following acceptance criteria are expressed using EARS. All descriptions are in en-US with EARS keywords in English. They are business-testable and avoid prescribing technical mechanisms.\n\n### Core Participation and Posting\n- WHEN a verified email member publishes compliant content, THE civicDebateBoard SHALL make the content visible to the community within 3 seconds.\n- IF a member attempts to publish without verified email, THEN THE civicDebateBoard SHALL block the action and provide a clear verification path without content loss.\n- WHERE a post is newly created by its author, THE civicDebateBoard SHALL allow self-editing for up to 15 minutes from initial publication.\n- IF an edit is attempted after the self-edit window and the change is material, THEN THE civicDebateBoard SHALL route the edit for review and retain the original until a decision is made.\n- WHILE a post is under pre-moderation due to policy or trust signals, THE civicDebateBoard SHALL keep the post non-public and display pending status to the author.\n- WHEN a member follows a topic, THE civicDebateBoard SHALL include relevant new posts in the member’s personalized feed within 1 minute of publication.\n\n### Reactions, Voting, and Anti-manipulation\n- WHERE an account is newly created or low-trust, THE civicDebateBoard SHALL apply stricter voting and reaction rate limits than for established members.\n- WHEN a member casts a vote, THE civicDebateBoard SHALL reflect the vote effect in aggregates within 2 seconds.\n- IF correlated voting patterns exceed manipulation thresholds, THEN THE civicDebateBoard SHALL dampen aggregated impact and flag the activity for moderator review.\n- WHEN a member withdraws a vote within 10 minutes, THE civicDebateBoard SHALL reverse the aggregation accordingly.\n\n### Reporting and Moderation\n- WHEN a member submits a content report, THE civicDebateBoard SHALL acknowledge receipt instantly and assign a severity.\n- WHERE a report is high severity (e.g., doxxing, threats), THE civicDebateBoard SHALL notify a moderator queue within 2 minutes.\n- WHEN a moderator decides an outcome, THE civicDebateBoard SHALL notify the reporter and the author with the decision rationale within 1 minute of decision.\n- IF a report is dismissed, THEN THE civicDebateBoard SHALL record the dismissal rationale in the audit log and mark the report resolved.\n- WHEN a sanction is applied, THE civicDebateBoard SHALL enforce the sanction immediately across all user actions and persist its duration.\n\n### Fact-Checking and Annotations\n- WHEN a factChecker adds an annotation with sources, THE civicDebateBoard SHALL display the annotation contextually on the referenced claim within 3 seconds to all readers.\n- IF a factChecker proposes an enforcement-affecting label (e.g., reduced amplification), THEN THE civicDebateBoard SHALL require moderator confirmation before the label affects visibility.\n- WHERE a conflict of interest is declared, THE civicDebateBoard SHALL route the annotation to an independent reviewer and pause enforcement changes until review completes.\n\n### Appeals and Restorative Processes\n- WHEN an author appeals a sanction within the allowed window, THE civicDebateBoard SHALL confirm receipt immediately and assign the appeal to a reviewer distinct from the original decision-maker.\n- WHILE an appeal is pending, THE civicDebateBoard SHALL maintain the current enforcement unless policy specifies otherwise.\n- WHEN an appeal is upheld, THE civicDebateBoard SHALL restore content visibility and notify affected parties within 1 minute.\n- IF an appeal results in modified sanctions, THEN THE civicDebateBoard SHALL update enforcement and communicate changes with rationale.\n\n### Notifications and Subscriptions\n- WHEN a followed thread receives a direct reply to the member’s content, THE civicDebateBoard SHALL send a notification within 1 minute.\n- WHERE a member disables a notification category, THE civicDebateBoard SHALL cease notifications for that category within 1 minute.\n- IF a notification cannot be delivered, THEN THE civicDebateBoard SHALL record a delivery failure and retry according to policy without duplicating user-visible messages.\n\n### Account Lifecycle and Sessions\n- WHEN a member revokes all sessions, THE civicDebateBoard SHALL terminate active sessions within 1 minute and require re-authentication.\n- WHERE an account is suspended, THE civicDebateBoard SHALL restrict all posting, voting, and reporting actions for the suspension duration and label historical content per policy.\n- IF a suspended account attempts a restricted action, THEN THE civicDebateBoard SHALL deny the action and display the remaining suspension duration.\n\n### Accessibility, Inclusivity, and Localization\n- THE civicDebateBoard SHALL present timestamps according to the user’s timezone preference with clear offset indicators.\n- WHERE content includes sensitive topics, THE civicDebateBoard SHALL allow readers to access contextual safety and policy information within 2 clicks from the content.\n- THE civicDebateBoard SHALL ensure that all user-facing messages are concise, unambiguous, and free of technical jargon.\n\n### Auditability and Transparency\n- WHEN any moderation or fact-check event occurs, THE civicDebateBoard SHALL record who initiated it, the reason category, the decision, and the time, in an immutable audit trail.\n- IF a moderator is reassigned due to conflict of interest, THEN THE civicDebateBoard SHALL record the reassignment with rationale and timestamps.\n- WHERE a role change is performed by an admin, THE civicDebateBoard SHALL notify the affected user and list the effective permissions change.\n\n### Performance and Experience Expectations\n- THE civicDebateBoard SHALL render user-triggered state changes (publish, vote, follow, report) as complete within 3 seconds in typical conditions.\n- WHERE system load is elevated, THE civicDebateBoard SHALL continue to acknowledge user actions instantly and complete processing within published SLAs.\n\n## Traceability and References\n- Strategic context and business model: see the [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Detailed process diagrams and stepwise flows: see the [User Flows and Processes](./05-user-flows-and-processes.md).\n- Formalized capabilities, validations, and rules: see the [Functional Requirements](./06-functional-requirements.md).\n\nEnd of document."},"tokenUsage":{"total":22231,"input":{"total":15320,"cached":9472},"output":{"total":6911,"reasoning":2112,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":5,"created_at":"2025-08-15T02:39:31.227Z"},"tokenUsage":{"aggregate":{"total":128237,"input":{"total":95467,"cached":9472},"output":{"total":32770,"reasoning":12800,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":125415,"input":{"total":93160,"cached":9472},"output":{"total":32255,"reasoning":12416,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Document privacy, security, and legal obligations to ensure trust and compliance without prescribing implementation.","filename":"09-security-privacy-and-compliance.md","documentType":"requirement","outline":["Data Privacy Principles and Consent Management","User Rights (access, correction, deletion)","Security Expectations (access control, data protection in business terms)","Audit Logging and Accountability Requirements","Incident Response and Breach Notification","Regulatory Compliance (GDPR, CCPA, election-related policies where applicable)","Third-Party and Integration Risk Management","EARS-Formatted Compliance Requirements"],"audience":"development team","keyQuestions":["What privacy rights and obligations apply?","What security controls are required in business terms?","How are incidents handled and reported?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS where applicable","Do not specify technical mechanisms; describe obligations and outcomes"],"content":"# civicDebateBoard Security, Privacy, and Compliance Requirements\n\nThis document defines the business requirements for security, privacy, and compliance for the civicDebateBoard service. It specifies WHAT the system must do from a compliance and safety perspective in clear, testable terms, without prescribing HOW to implement it. All technical implementation decisions (architecture, APIs, database design, cryptographic choices, tooling) are at the discretion of the development team.\n\n## Introduction and Scope\ncivicDebateBoard facilitates civic discourse with roles [member, verifiedMember, factChecker, moderator, admin]. This document governs how user data is handled, how access is controlled, how activities are audited, and how incidents are managed to meet legal and ethical obligations across jurisdictions in which the service operates. Requirements herein are expressed in business terms and must be treated as mandatory acceptance criteria.\n\n- In-Scope: Data privacy obligations, consent management, user rights, business-level security expectations, audit logging, incident response, regulatory conformance, third-party risk.\n- Out-of-Scope: UI/UX specifications, API endpoints, database schemas, cryptographic algorithms, network or infrastructure choices.\n\nFor role definitions and session behaviors, see the User Roles and Authentication Requirements in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). For performance, availability, and disaster recovery expectations, see [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## Data Privacy Principles and Consent Management\ncivicDebateBoard adheres to the following privacy principles: purpose limitation, data minimization, transparency, integrity and confidentiality, storage limitation, and accountability. Consent is one lawful basis among others (e.g., contract, legitimate interest) and must be handled explicitly when required.\n\n### Data Categories and Classification (Business View)\n| Category | Examples | Sensitivity | Default Collection | Default Sharing |\n|---------|----------|-------------|--------------------|-----------------|\n| Account Data | email, display name, role, verification status | Personal | Required for account | Not shared externally |\n| Content Data | posts, comments, reactions, bookmarks | Varies (may include personal) | Optional per user action | Public if posted publicly |\n| Behavioral Data | follows, subscriptions, notification preferences, rate-limit counters | Personal | Limited to service operation | Not shared externally |\n| Security Data | login events, device sessions, password reset requests, sanctions | Personal | Required for security | Not shared externally |\n| Moderation Data | reports, review decisions, sanctions, appeals | Personal | Required for policy enforcement | Not shared externally |\n| Analytics Data | aggregated usage metrics | Aggregated/De-identified | Optional per consent where required | Shared only in aggregate |\n\n### Privacy Disclosures and Consent\n- Transparency: Users must receive clear disclosures about purposes of processing, categories of data collected, retention periods, and sharing practices at or before the point of collection.\n- Consent: Explicit consent must be obtained before processing categories that require consent by law (e.g., certain analytics, marketing communications, location-based personalization where applicable). Consent must be granular, freely given, informed, unambiguous, and revocable at any time without detriment.\n- Legitimate Interest: Where legitimate interest is used as a lawful basis, a documented balancing test must be maintained and users must be offered an easy opt-out when required.\n\n### EARS Requirements — Privacy and Consent\n- THE civicDebateBoard SHALL present purpose-specific privacy disclosures prior to any data collection that is not strictly necessary for core service operation.\n- THE civicDebateBoard SHALL record the timestamp, scope, and version of the disclosure accepted by the user for any consent-based processing.\n- WHEN a user withdraws consent for a processing purpose, THE civicDebateBoard SHALL cease that processing within 24 hours and ensure no new data is collected for that purpose thereafter.\n- WHEN consent is required for analytics beyond strictly necessary operations, THE civicDebateBoard SHALL default to opt-out and SHALL enable opt-in only after explicit user action.\n- IF a processing purpose changes materially, THEN THE civicDebateBoard SHALL obtain fresh consent before continuing consent-based processing under the new purpose.\n- WHERE legal bases other than consent are relied upon, THE civicDebateBoard SHALL expose a clear explanation of the applicable legal basis within the privacy notice.\n\n## User Rights (Access, Correction, Deletion)\nUser rights procedures must ensure timely, secure, and verifiable fulfillment of requests.\n\n### Identity Verification for Requests\n- Requests to access, correct, or delete data must be verified using reasonable methods proportionate to the sensitivity of the data and the risk of harm from unauthorized access. The verification method must not require excessive data.\n\n### DSAR Intake and Fulfillment Timelines\n- GDPR: Respond to access, correction, and deletion requests without undue delay and within 30 calendar days of receipt; a single extension up to 60 additional days is allowed when justified by complexity, with notification to the requester within the original 30 days.\n- CCPA/CPRA: Respond to access and deletion requests within 45 days; a 45-day extension is allowed when reasonably necessary with notice to the consumer.\n\n### Packaging of Responses\n- Access responses must include a human-readable summary and a machine-readable portable format commonly used in the industry, limited to the requestor’s personal data and clearly excluding other users’ data.\n\n### Deletion Scope and Exceptions\n- Deletion removes personal data that is not required for legal, security, or integrity obligations. Content removals may leave a publicly visible tombstone where necessary to preserve discussion coherence without revealing personal data.\n\n### Retention and Storage Limitation\n| Data Type | Default Retention | Extensions and Holds | Final Disposition |\n|----------|-------------------|----------------------|-------------------|\n| Account Data | Lifetime of account + 30 days after deletion | Extended for legal holds | Permanent deletion |\n| Content Data | Lifetime of content; user-initiated deletion immediate | Retained in backups per backup window | Removal from active service; anonymized references where necessary |\n| Security Logs | 12 months | Extended for investigations/legal holds | Secure deletion |\n| Moderation Records | 24 months | Extended through appeal window and legal holds | Secure deletion or anonymization |\n| Incident Records | 5 years | As required by regulation | Secure deletion |\n| Backups | Up to 30 days | No extension absent legal holds | Rolling overwrite |\n\n### EARS Requirements — User Rights\n- WHEN a user submits a verified access request, THE civicDebateBoard SHALL provide a complete copy of the user’s personal data within the applicable legal timeframe and SHALL log the fulfillment event for audit.\n- WHEN a user submits a verified correction request, THE civicDebateBoard SHALL update inaccurate personal data within 30 days and SHALL notify the user upon completion.\n- WHEN a user submits a verified deletion request, THE civicDebateBoard SHALL delete personal data not required for legal or security obligations within 30 days and SHALL document exceptions with reasons.\n- IF identity verification for a rights request fails, THEN THE civicDebateBoard SHALL reject the request and SHALL provide a reason and a path to re-verify without revealing sensitive information.\n- WHERE the law permits timeline extensions, THE civicDebateBoard SHALL notify the requester of the extension and the justification before the original deadline expires.\n- WHILE a legal hold is active, THE civicDebateBoard SHALL suspend deletion for data subject to the hold and SHALL resume deletion once the hold is lifted.\n\n## Security Expectations (Access Control, Data Protection in Business Terms)\nSecurity requirements are expressed as business obligations that protect users and the integrity of discourse while respecting role-based access.\n\n### Role-Based Access Expectations\n| Data/Action | member | verifiedMember | factChecker | moderator | admin |\n|------------|--------|----------------|------------|----------|-------|\n| View own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View other users’ Account Data | ❌ | ❌ | ❌ | Limited to enforcement need | Limited to administrative need |\n| Access Content Data (public) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Access flagged Moderation Data | ❌ | ❌ | Propose annotations only | ✅ | ✅ |\n| Issue sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Manage roles and platform policies | ❌ | ❌ | ❌ | ❌ | ✅ |\n\nNote: Detailed role semantics are defined in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This table expresses high-level business permissions only.\n\n### Protection of Data in Transit and at Rest (Business Level)\n- Communications and stored data containing personal information must be protected against unauthorized access. Protection mechanisms must align with industry standards and regulatory expectations without specifying exact technologies here.\n\n### Secrets and Key Material Handling (Business Level)\n- Secrets must be treated as confidential assets, access must be strictly limited to those with a business need, and rotation must occur on a regular cadence and upon suspected exposure.\n\n### Account and Session Protections (Business Level)\n- Authentication, session duration, revocation, and device management are governed by [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This document requires outcomes: resistant to brute-force attempts, rapid revocation on logout-all events, and safe handling of password resets and email verification.\n\n### EARS Requirements — Security Expectations\n- THE civicDebateBoard SHALL enforce least-privilege access aligned with user roles for all data categories listed in this document.\n- WHEN a user’s role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate any access inconsistent with the new role.\n- WHEN a user logs out of all devices, THE civicDebateBoard SHALL ensure that no previously issued session remains valid beyond 60 seconds after the action.\n- IF repeated failed authentication attempts indicate brute-force behavior, THEN THE civicDebateBoard SHALL temporarily block further attempts from the source and SHALL preserve relevant Security Data for investigation.\n- WHERE personal data is stored, THE civicDebateBoard SHALL ensure that unauthorized access is prevented using industry-standard protection mechanisms both in transit and at rest.\n- WHEN secrets exposure is suspected, THE civicDebateBoard SHALL rotate affected secrets within 24 hours and SHALL invalidate dependent credentials promptly.\n\n## Audit Logging and Accountability Requirements\nAuditability ensures traceability of significant actions while respecting privacy.\n\n### Scope of Auditable Events (Business View)\n- Authentication lifecycle events (registration, login, logout, password reset, email verification)\n- Role and permission changes\n- Content lifecycle events (create, edit, delete, restore)\n- Moderation lifecycle events (report intake, triage, decision, sanction, appeal, reinstatement)\n- Privacy events (consent grant/withdrawal, DSAR intake/fulfillment)\n- Security events (failed logins spikes, admin access, configuration changes)\n\n### Required Audit Record Elements (Semantic Fields)\n- Actor identity and role at time of action\n- Action type and target object category\n- Timestamp in a standardized, consistent time basis\n- Outcome (success/denied/error) and reason code if denied\n- High-level origin context (e.g., device type or general location as permitted by law)\n- Correlation identifier for multi-step processes\n\n### Access and Integrity of Audit Logs\n- Access to audit logs must be restricted to admin and authorized moderator functions used for investigations.\n- Logs must be tamper-evident and retained per schedule without exposing personal data beyond necessity.\n\n### EARS Requirements — Audit and Accountability\n- THE civicDebateBoard SHALL record audit entries for all events listed in the Scope of Auditable Events.\n- WHEN an auditable event is recorded, THE civicDebateBoard SHALL include actor identity, role, action type, target category, timestamp, outcome, and correlation identifier.\n- WHERE an action is denied due to insufficient permissions, THE civicDebateBoard SHALL record the denial reason without exposing sensitive data.\n- IF audit log access is requested by an unauthorized role, THEN THE civicDebateBoard SHALL deny access and SHALL record the attempt.\n- WHILE an investigation is active, THE civicDebateBoard SHALL protect relevant logs from alteration or deletion and SHALL lift protection once the investigation concludes.\n\n## Incident Response and Breach Notification\nIncident management ensures rapid detection, containment, and communication proportionate to severity.\n\n### Severity Levels and SLAs\n| Severity | Description | Initial Triage | Containment | User/Authority Notification |\n|---------|-------------|----------------|-------------|-----------------------------|\n| Sev 1 | Confirmed breach of personal data with high risk | Within 1 hour | Within 4 hours | Authorities within 72 hours where required; affected users without undue delay and within 7 days |\n| Sev 2 | Suspected breach or material service abuse | Within 4 hours | Within 24 hours | Notify affected users if risk is nontrivial; authority notification per law |\n| Sev 3 | Security weakness or limited exposure with low risk | Within 1 business day | Within 3 business days | No notification unless legally required |\n\n### Incident Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Detect Event\"] --> B{\"Severity Assessed\"}\n  B -->|\"Sev 1\"| C[\"Containment Actions\"]\n  B -->|\"Sev 2/3\"| C\n  C --> D[\"Forensics & Impact Determination\"]\n  D --> E{\"Personal Data Involved?\"}\n  E -->|\"Yes\"| F[\"Regulatory Notification Prep\"]\n  E -->|\"No\"| G[\"Remediation Plan\"]\n  F --> H[\"Notify Authorities\"]\n  F --> I[\"Notify Affected Users\"]\n  G --> J[\"Execute Remediation\"]\n  H --> K[\"Postmortem & Lessons\"]\n  I --> K\n  J --> K\n```\n\n### EARS Requirements — Incident Response\n- WHEN a potential incident is detected, THE civicDebateBoard SHALL initiate severity assessment within the timeframes specified in the Severity Levels and SLAs table.\n- WHEN an incident reaches Sev 1, THE civicDebateBoard SHALL complete initial containment within 4 hours and SHALL prepare regulatory notifications as required.\n- IF personal data is likely exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where applicable and SHALL notify affected users without undue delay using clear guidance on protective steps.\n- WHERE a legal hold is established as part of an incident, THE civicDebateBoard SHALL suspend routine deletions of affected data until the hold is lifted.\n- THE civicDebateBoard SHALL conduct a post-incident review within 10 business days of containment, including root cause, impact, and remediation actions.\n\n## Regulatory Compliance (GDPR, CCPA, Election-Related Policies)\nThe service must operate in compliance with applicable privacy laws and content-related obligations where it is offered.\n\n### Lawful Bases and Transparency\n- Identify and document lawful bases per processing purpose (e.g., contract for account operation; legitimate interest for safety; consent for marketing where applicable). Privacy notices must reflect these bases in clear language.\n\n### Cross-Border Data Transfers\n- Where personal data is transferred across borders, use valid transfer mechanisms recognized by the destination and origin jurisdictions and maintain records of such transfers and safeguards.\n\n### Minors and Age-Gating\n- The service is designed for civic discourse and may be restricted for minors based on jurisdictional requirements. Where participation by minors is permitted, verifiable parental consent must be in place if required by local law.\n\n### Election-Related Integrity and Transparency\n- For features involving political content classifications or labels, ensure transparency notices and access to corrective pathways (e.g., appeals, fact-check annotations) consistent with policy documents and applicable regulations.\n\n### EARS Requirements — Regulatory Compliance\n- THE civicDebateBoard SHALL maintain a privacy notice that lists processing purposes, lawful bases, categories of data, retention periods, and data sharing practices.\n- WHERE cross-border transfers occur, THE civicDebateBoard SHALL document the transfer mechanism and SHALL make a summary available upon request.\n- WHEN operating in jurisdictions requiring age-gating, THE civicDebateBoard SHALL restrict access by minors unless verifiable consent requirements are satisfied.\n- WHEN processing political or election-related content categories, THE civicDebateBoard SHALL present transparency labels and SHALL preserve a record of labeling and review actions.\n\n## Third-Party and Integration Risk Management\nThird parties include analytics providers, email delivery services, identity verification services, and content safety partners. The service remains accountable for data shared with subprocessors.\n\n### Third-Party Onboarding and Oversight\n- Due diligence must evaluate data protection posture, contractual commitments, breach history, and data locality. Data processing agreements must be in place when personal data is processed on behalf of civicDebateBoard.\n\n### Data Sharing Minimization and Controls\n- Share only the minimum personal data necessary for the stated purpose. Prohibit third parties from selling, reusing, or combining personal data for unrelated purposes.\n\n### Subprocessor Registry and Notifications\n- Maintain a public-facing list of subprocessors that handle personal data and provide advance notice of material changes where legally required.\n\n### EARS Requirements — Third-Party Risk\n- WHEN engaging a new third party that processes personal data, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document a due diligence assessment prior to activation.\n- WHERE a third party is no longer necessary, THE civicDebateBoard SHALL terminate data flows and SHALL ensure data return or deletion as contractually required within 30 days.\n- IF a third party reports a breach impacting civicDebateBoard data, THEN THE civicDebateBoard SHALL trigger the incident response process and SHALL assess notification obligations.\n- THE civicDebateBoard SHALL maintain and publish a current subprocessor list that includes categories of services and data types processed.\n\n## EARS-Formatted Compliance Requirements (Consolidated)\nThis section consolidates key testable requirements for verification. All descriptions use business language and keep EARS keywords in English.\n\n### Privacy and Consent\n- THE civicDebateBoard SHALL display purpose-specific privacy disclosures before any optional data collection.\n- WHEN consent is withdrawn, THE civicDebateBoard SHALL stop consent-based processing within 24 hours and SHALL record the withdrawal.\n- IF processing purposes change, THEN THE civicDebateBoard SHALL obtain renewed consent where consent is the legal basis.\n\n### User Rights\n- WHEN a verified access request is received, THE civicDebateBoard SHALL fulfill it within legal timelines and SHALL log the fulfillment.\n- WHEN a verified deletion request is received, THE civicDebateBoard SHALL delete eligible data within 30 days and SHALL document exceptions.\n- IF verification fails for a rights request, THEN THE civicDebateBoard SHALL deny the request with a non-sensitive reason.\n\n### Security and Access Control\n- THE civicDebateBoard SHALL enforce least-privilege access for all roles and data categories.\n- WHEN a role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate inconsistent sessions.\n- IF brute-force indicators are detected, THEN THE civicDebateBoard SHALL throttle attempts and SHALL retain evidence for 12 months.\n\n### Audit and Accountability\n- THE civicDebateBoard SHALL record audit events with actor, role, action type, target category, timestamp, outcome, and correlation identifier.\n- IF unauthorized access to audit logs is attempted, THEN THE civicDebateBoard SHALL deny it and SHALL record the attempt.\n\n### Incident Response\n- WHEN an incident is detected, THE civicDebateBoard SHALL assess severity within defined SLAs and SHALL contain confirmed Sev 1 incidents within 4 hours.\n- IF personal data is exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where required and SHALL notify affected users without undue delay.\n- THE civicDebateBoard SHALL complete a post-incident review within 10 business days of containment.\n\n### Regulatory and Third-Party\n- WHERE data crosses borders, THE civicDebateBoard SHALL document transfer mechanisms and SHALL provide summaries upon request.\n- WHEN onboarding a personal-data processor, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document due diligence.\n- IF a subprocessor incident impacts civicDebateBoard data, THEN THE civicDebateBoard SHALL activate incident response and SHALL evaluate notification duties.\n\n## Appendices\n\n### Appendix A — Glossary (Business Terms)\n- Personal Data: Information relating to an identified or identifiable individual.\n- Consent: Freely given, specific, informed, and unambiguous indication of wishes by which the data subject signifies agreement to processing.\n- DSAR: Data Subject Access Request; includes access, correction, deletion, portability where applicable.\n- Legal Hold: A process that suspends routine deletion due to litigation, investigations, or regulatory obligations.\n- Subprocessor: A third party engaged to process personal data on behalf of the service.\n\n### Appendix B — Data Categories (Detailed Examples)\n- Account Data: email, display name, avatar reference, role, verification flags.\n- Content Data: posts, comments, reactions, bookmarks, follows, topics.\n- Security Data: login attempts, session metadata, password reset events, device revocations.\n- Moderation Data: reports, review decisions, sanctions, appeals, reinstatement status.\n\n### Appendix C — Severity Matrix (Quick Reference)\n| Severity | Impact | Notification Expectation |\n|---------|--------|--------------------------|\n| Sev 1 | High risk to personal data | Authorities within 72 hours; users within 7 days |\n| Sev 2 | Medium risk or uncertain breach | Conditional per risk and law |\n| Sev 3 | Low risk or contained weakness | None unless required |\n\n---\nThis document provides business requirements only. All technical implementation decisions belong to the development team. Developers have full autonomy over architecture, APIs, and database design; this document describes WHAT the system must do, not HOW to build it."},"tokenUsage":{"total":23033,"input":{"total":15320,"cached":0},"output":{"total":7713,"reasoning":2560,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":6,"created_at":"2025-08-15T02:39:35.027Z"},"tokenUsage":{"aggregate":{"total":151270,"input":{"total":110787,"cached":9472},"output":{"total":40483,"reasoning":15360,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":148448,"input":{"total":108480,"cached":9472},"output":{"total":39968,"reasoning":14976,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Establish policy definitions and enforcement processes to protect community safety and discourse quality.","filename":"07-content-moderation-and-safety-policies.md","documentType":"requirement","outline":["Policy Principles and Scope","Prohibited and Restricted Content Categories","Civic Discourse Safeguards (election integrity, misinformation handling)","Report Intake and Prioritization","Review SLAs and Escalation Paths","Sanctions (warnings, mutes, suspensions) and Transparency","Evidence Handling and Audit Trails","Appeals and Restorative Processes","EARS-Formatted Enforcement Requirements"],"audience":"development team","keyQuestions":["What content is allowed, restricted, or prohibited?","How are reports prioritized and reviewed?","What sanctions and transparency obligations exist?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","05-user-flows-and-processes.md","09-security-privacy-and-compliance.md"],"constraints":["Define measurable SLAs and sanctions in business terms","Use EARS for enforceable requirements","Avoid technical details; focus on policy and process"],"content":"# Content Moderation and Safety Policies for civicDebateBoard\n\nThis document defines the business requirements for moderation and safety on civicDebateBoard. It specifies policies, processes, and enforcement standards in natural language for backend implementation. All requirements are written to be specific, measurable, and testable from a business perspective. Technical implementation choices are at the discretion of the development team.\n\n## Policy Principles and Scope\n\n### Guiding Principles\n- Safety First: Protect users from harm, harassment, exploitation, and illegal activity.\n- Civility and Civic Value: Promote constructive, well-sourced debate and discourage manipulation.\n- Fairness and Consistency: Apply policies uniformly with documented rationales.\n- Transparency and Accountability: Provide clear reasons for actions and maintain auditability.\n- Due Process: Offer notice, the ability to appeal, and restorative options where appropriate.\n- Proportionality: Match enforcement severity to violation severity and user history.\n- Context Sensitivity: Consider intent, context, and public-interest value in decisions.\n- Legal Compliance: Respect applicable laws and regulatory obligations across jurisdictions.\n\n### Scope of Application\n- Applies to all user-generated content (UGC), including posts, comments, profile fields, attachments, links, tags, and reactions.\n- Applies to all users and roles: member, verifiedMember, factChecker, moderator, admin.\n- Covers in-product messaging (including automated notices), report handling, content labeling, and sanction workflows.\n- Includes both proactive policy enforcement (e.g., automated pre-flagging) and reactive enforcement (e.g., user reports).\n\n## Prohibited and Restricted Content Categories\n\nThe following categories define allowed, restricted, and prohibited content. Restricted content may require labels, age-gating, contextualization, or limited distribution. Prohibited content requires removal and potential account sanctions.\n\n| Category | Definition (business-level) | Status | Notes and Handling |\n|---------|------------------------------|--------|--------------------|\n| Illegal Content | Content that violates applicable laws (e.g., CSAM, explicit criminal facilitation) | Prohibited | Immediate removal and escalation to admin; emergency escalation for child safety |\n| Child Exploitation | Any sexualization of minors, grooming, or endangerment | Prohibited | Immediate removal; mandatory emergency workflow activation |\n| Terrorism and Extremism | Praise, support, or operational content for designated extremist organizations | Prohibited | Removal; account sanctions; preserve evidence for audit |\n| Hate Speech | Direct attacks on protected classes (e.g., race, religion, gender identity) | Prohibited | Removal; apply strike; consider user intent only for sanction calibration |\n| Harassment & Threats | Targeted harassment, credible threats, doxxing | Prohibited | Removal; escalate for urgent threat assessment |\n| Graphic Violence | Gratuitous gore, celebration of violence | Prohibited | Removal; contextual news value may allow limited exceptions with labels |\n| Non-Consensual Intimate Imagery | Sharing sexual/explicit imagery without consent | Prohibited | Removal; immediate account suspension pending review |\n| Privacy Violations (Doxxing) | Publishing private identifying information without consent | Prohibited | Removal; evaluate imminent harm risk |\n| Self-Harm and Suicide Promotion | Encouraging self-harm or suicide | Prohibited | Removal; provide crisis resources; limited supportive discussion allowed |\n| Misinformation with Imminent Harm | False claims likely to cause real-world harm (health, safety, civic process integrity) | Restricted/Prohibited | Label, reduce distribution, or remove depending on harm assessment |\n| Election Integrity Violations | Coordinated voter suppression, false voting logistics | Prohibited | Removal; high-priority escalation during election windows |\n| Medical Misinformation | Provably false medical claims contradicting leading public health bodies | Restricted | Label and reduce distribution; removal if imminently harmful |\n| Spam and Scams | Mass unsolicited content, phishing, financial scams | Prohibited | Removal; apply automated cool-down and strikes |\n| Platform Manipulation | Coordinated inauthentic behavior, astroturfing, vote brigading | Prohibited | Removal; deamplify; investigate account networks |\n| Copyright and Plagiarism | Unauthorized reproduction of copyrighted material | Restricted/Prohibited | Takedown upon valid notice; repeat infringement may trigger suspension |\n| Adult Sexual Content | Explicit adult content | Restricted | Age-gate, label, and limit distribution; adhere to jurisdictional rules |\n| Sensitive Media | Disturbing content with public interest value (e.g., war reporting) | Restricted | Allow with strong labels and click-through warnings |\n| Profanity and Rude Behavior | Non-targeted profanity | Allowed/Restricted | Allowed unless targeted; repeated abuse leads to moderation actions |\n| Off-Topic/Low-Quality | Content not aligned with civicDebateBoard’s civic discourse goals | Restricted | Downrank or move; removal for repeated abuse |\n\nBusiness notes:\n- Context exceptions can be applied for news reporting, educational content, or public-interest documentation when accompanied by contextualization and labels.\n- Verified sources and citations may reduce enforcement severity but not override prohibitions.\n\n## Civic Discourse Safeguards (Election Integrity and Misinformation Handling)\n\n### Core Safeguards\n- Election Windows: Elevated protections start 90 days before and end 14 days after scheduled elections relevant to the user’s locale.\n- Claim Typology: Distinguish between verifiable factual claims and opinion/analysis. Apply fact-check annotations to factual claims.\n- Source Citation: Encourage references to credible sources for significant civic claims.\n- Distribution Controls: Reduce distribution of labeled misinformation and prevent it from trending or being recommended.\n- Entity Disclosure: Label accounts with declared affiliations to campaigns, governments, or NGOs when such disclosure is provided or verified.\n\n### Fact-Checking and Annotations\n- factChecker Role: May add claim-level annotations, ratings (e.g., true/misleading/unfounded), and source citations; cannot impose sanctions.\n- Moderator Review: Moderators may apply labels, reduce distribution, or remove content based on harm assessment and policy fit.\n- User Notification: Authors receive notices when annotations or labels are applied, including reasons and sources.\n\n## Report Intake and Prioritization\n\n### Intake Channels and Metadata\n- In-line Content Reports: Users can report from content context with category selection and optional notes.\n- Out-of-Content Reports: Users can report user profiles or messages via dedicated reporting entry.\n- System Flags: Automated signals (e.g., burst activity, new-account behavior) generate reports.\n- Trusted Partner Reports: Pre-vetted organizations may submit high-priority notices for certain categories (e.g., election integrity, child safety).\n\n### Prioritization Rubric\n- Severity Tiers:\n  - Critical (P0): Child safety, credible violent threats, voter suppression, non-consensual intimate imagery.\n  - High (P1): Hate speech, doxxing, terrorism support, imminent harm misinformation.\n  - Medium (P2): Harassment, platform manipulation, medical misinformation without imminent harm, copyright takedown notices.\n  - Low (P3): Spam, off-topic, profanity, low-quality content.\n- Reporter Trust Weighting: Reports from verifiedMember, factChecker, moderator, and trusted partners receive elevated priority.\n- Recency and Velocity: Recent posts with high engagement escalate within the same tier.\n- Duplicate Report Merging: Multiple reports for the same item are aggregated.\n\n### Triage Workflow (Business-Level)\n\n```mermaid\ngraph LR\n  subgraph \"Report Intake\"\n    A[\"User/System Submits Report\"] --> B[\"Capture Metadata(Category, Notes, Reporter Role)\"]\n    B --> C[\"Assign Severity Tier(P0-P3)\"]\n  end\n  subgraph \"Queueing\"\n    C --> D[\"Merge Duplicates\"]\n    D --> E[\"Apply Priority Weighting\"]\n  end\n  subgraph \"Review\"\n    E --> F{\"Harm Likely?\"}\n    F -->|\"Yes\"| G[\"Fast-Track to Moderator\"]\n    F -->|\"No\"| H[\"Standard Queue\"]\n  end\n  G --> I[\"Immediate Interim Action(Label/Hide)\"]\n  H --> I\n  I --> J[\"Assignment to Reviewer\"]\n```\n\n## Review SLAs and Escalation Paths\n\n### Service-Level Objectives (business expectations)\n- Working Hours Assumption: Reviews are processed continuously.\n- Elevated Periods: During election windows and declared crises, apply faster SLAs.\n\n| Severity | First Action Deadline (from report) | Final Decision Deadline | Escalation Trigger |\n|----------|-------------------------------------|-------------------------|--------------------|\n| P0 Critical | 15 minutes | 2 hours | Immediate escalation to senior moderator; admin if law risk |\n| P1 High | 1 hour | 12 hours | Escalate if backlog exceeds 1 hour or repeated violations |\n| P2 Medium | 6 hours | 48 hours | Escalate if item trends or duplicates exceed 10 |\n| P3 Low | 24 hours | 5 days | Escalate if duplicates exceed 25 or author has 3+ recent strikes |\n| Election Window P0 | 10 minutes | 1 hour | Auto-notify admin and factChecker group |\n\n### Escalation Paths (business logic)\n- Moderator to Senior Moderator: Triggered by severity thresholds, legal sensitivity, or repeated violations.\n- Senior Moderator to Admin: Triggered by legal obligations, public-interest exceptions, government requests, or platform-wide risk.\n- Emergency Referral: Child safety or credible threats to life follow emergency process with immediate action and post-facto review.\n\n## Sanctions and Transparency\n\n### Sanction Types and Durations\n\n| Sanction | Description | Default Duration | Applicability |\n|----------|-------------|------------------|---------------|\n| Content Removal | Remove violating content | Permanent | All categories where prohibited |\n| Warning | Formal notice for minor or first-time violations | N/A | P2-P3 violations |\n| Labeling | Add context labels or fact-check notes | Until resolved or updated | Misinformation, sensitive media |\n| Limited Participation | Reduce posting/commenting cadence (cool-down) | 24-72 hours | Harassment, spam, low-quality |\n| Temporary Mute | Block posting/commenting | 24 hours to 14 days | Repeated harassment, hate speech |\n| Shadow Deamplification | Reduce distribution without blocking access | 7-30 days | Manipulation, low-quality |\n| Temporary Suspension | Disable account access | 7-30 days | Severe or repeated violations |\n| Permanent Ban | Terminate account | Permanent | CSAM, extremism, chronic abuse |\n\nStrike Policy (business rules):\n- First serious violation (P1-P0): Temporary mute or suspension plus content removal.\n- Three-strike escalation: Three P1 violations within 90 days lead to 30-day suspension; any P0 triggers immediate permanent ban review.\n- Strike Decay: Strikes older than 180 days do not count toward automatic escalations.\n\n### Role-Based Authority\n- moderator: May remove content, issue warnings, apply labels, impose limited participation, apply temporary mutes and temporary suspensions up to 14 days, and escalate to admin.\n- admin: May perform all moderator actions plus impose suspensions up to permanent ban, configure sanction policies, and approve exceptions.\n- factChecker: May add annotations and propose labels; cannot apply sanctions.\n- verifiedMember and member: May report content and appeal sanctions on their own content.\n\n### Transparency and User Notice\n- Action Notices: Users receive a clear reason, policy category, evidence summary, and appeal option with deadlines.\n- Public Transparency Log: Anonymized aggregate statistics published periodically (counts by category, sanction type, resolution time) without exposing personal data.\n\n## Evidence Handling and Audit Trails\n\n- Evidence Capture: Preserve the exact content, timestamps, author identifiers, reporter role, and context pointers at the moment of report or enforcement.\n- Chain of Custody: Record each handling step with actor role, action type, timestamp, and rationale.\n- Retention: Keep evidence for at least 365 days from final resolution, or longer if required by law or active appeal.\n- Access Control: Restrict evidence access to moderators and admins; factCheckers may view content context when assessing claims but not sensitive personal data.\n- Redaction: Redact personal identifiers from shared case summaries outside the moderation team.\n\n## Appeals and Restorative Processes\n\n- Appeal Window: Users can appeal within 14 days of notice for most sanctions; 7 days for election-related actions.\n- Independent Review: Appeals are handled by a different moderator than the original reviewer; admins review permanent ban appeals.\n- Restorative Options: For non-severe cases, users may complete educational prompts or edit content to reinstate visibility.\n- Outcome Notifications: Provide clear decisions with updated rationales and references to policy categories.\n- Rate Limits: Limit to one appeal per decision unless new evidence emerges.\n\n### Appeals Workflow (Business-Level)\n\n```mermaid\ngraph LR\n  subgraph \"Appeal Submission\"\n    A[\"User Submits Appeal\"] --> B[\"Validate Eligibility(Window, Single Appeal)\"]\n  end\n  subgraph \"Review and Decision\"\n    B --> C[\"Assign Different Reviewer\"]\n    C --> D{\"Uphold or Overturn?\"}\n  end\n  D -->|\"Uphold\"| E[\"Notify User and Maintain Sanction\"]\n  D -->|\"Overturn\"| F[\"Reinstate Content/Access and Clear Strike\"]\n  E --> G[\"Log Outcome in Audit Trail\"]\n  F --> G\n```\n\n## EARS-Formatted Enforcement Requirements\n\n### General Policy Application\n- THE moderation system SHALL apply the most severe applicable policy category when multiple categories are triggered by the same content.\n- THE moderation system SHALL preserve a snapshot of content and metadata at the time of report and at the time of enforcement.\n- THE moderation system SHALL record actor role, action, timestamp, and rationale for every enforcement action.\n\n### Reporting and Intake\n- WHEN a user submits a report with a selected category, THE moderation system SHALL capture category, free-text notes up to 1,000 characters, reporter role, and timestamp.\n- WHEN duplicate reports target the same content, THE moderation system SHALL merge them into a single case while preserving reporter counts and roles.\n- WHERE the reporter is a trusted partner or factChecker, THE moderation system SHALL assign at least P1 priority unless the content already has P0 triggers.\n- WHILE content is under review for P0 or P1, THE moderation system SHALL prevent the content from appearing in recommendations and trending lists.\n\n### Prioritization and SLAs\n- WHEN a report is categorized as P0, THE moderation system SHALL present it to a moderator within 15 minutes and record the presentation timestamp.\n- WHEN a report is categorized as P1, THE moderation system SHALL present it to a moderator within 1 hour.\n- WHEN a report is categorized as P2, THE moderation system SHALL present it to a moderator within 6 hours.\n- WHEN a report is categorized as P3, THE moderation system SHALL present it to a moderator within 24 hours.\n- WHILE under an election window, THE moderation system SHALL apply the Election Window SLA table to P0 items.\n\n### Interim Actions and Labels\n- WHEN harm assessment is pending for P0 or P1, THE moderation system SHALL allow moderators to apply interim actions: temporary hide, label, or limit distribution, with rationale capture.\n- WHERE content is labeled as misinformation, THE moderation system SHALL show fact-check annotations and reduce distribution for the labeled item until updated or removed.\n\n### Sanctions and Strikes\n- WHEN content is removed for a Prohibited category, THE moderation system SHALL add one strike to the author’s account with category and date.\n- WHERE a user accrues three P1 strikes within 90 days, THE moderation system SHALL apply a 30-day suspension.\n- IF a P0 violation is confirmed, THEN THE moderation system SHALL disable the account pending admin review for permanent ban.\n- WHERE a strike becomes older than 180 days, THE moderation system SHALL exclude it from automatic escalation calculations.\n- WHEN a warning is issued, THE moderation system SHALL record it without adding a strike.\n\n### Role-Based Permissions\n- WHERE the actor role is moderator, THE moderation system SHALL permit content removal, warnings, labels, limited participation, mutes up to 14 days, and suspensions up to 14 days.\n- WHERE the actor role is admin, THE moderation system SHALL permit permanent bans and configuration of sanction durations and policies.\n- WHERE the actor role is factChecker, THE moderation system SHALL permit creating annotations and proposing labels but SHALL prohibit sanctions.\n\n### Transparency and Notices\n- WHEN an enforcement action is applied, THE moderation system SHALL notify the author with the policy category, a concise explanation up to 500 characters, evidence summary reference, and appeal deadline.\n- WHEN a label is applied to content, THE moderation system SHALL notify the author and provide sources used for labeling.\n- WHERE a public transparency report is generated, THE moderation system SHALL include counts by category, average time to first action, and appeal outcomes by month.\n\n### Evidence and Audit\n- WHEN evidence is captured, THE moderation system SHALL store the snapshot alongside case identifiers and prevent edits.\n- WHERE a case is accessed by a reviewer, THE moderation system SHALL log the access with role and purpose.\n- IF an appeal overturns a decision, THEN THE moderation system SHALL link the new decision to the original case and mark the original rationale as superseded.\n\n### Appeals and Restorative Processes\n- WHEN a user appeals within the allowed window, THE moderation system SHALL route the case to a different reviewer.\n- WHERE a decision is upheld, THE moderation system SHALL allow exactly one appeal per decision unless new evidence is attached.\n- WHERE a restorative option is offered, THE moderation system SHALL reinstate content visibility upon completion or compliant edits.\n\n### Civic Safeguards\n- WHEN election-related misinformation is detected, THE moderation system SHALL apply the election SLA and prioritize review over non-election P1 items.\n- WHERE an account self-identifies as part of a political campaign, THE moderation system SHALL display affiliation labels on posts and profile per disclosure data.\n- WHEN a factChecker publishes an annotation on a claim, THE moderation system SHALL notify moderators and reduce distribution for the annotated item until reviewed.\n\n## Appendices\n\n### Definitions (Business-Level)\n- Strike: Recorded violation event tied to policy category, used for escalation rules.\n- Label: Notice attached to content to provide context (e.g., fact-check, sensitive media).\n- Limited Participation: Temporary reduction in a user’s ability to post or comment.\n- Election Window: The period with elevated protections around elections.\n\n### Severity Rubric (Condensed)\n- P0: Imminent harm or illegal content; requires immediate action.\n- P1: Severe policy violations with significant harm risk.\n- P2: Clear violations without imminent harm.\n- P3: Minor or contextual issues; often educational response.\n\n### Related Documents\n- Refer to the [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) for role definitions and session behaviors.\n- Refer to the [User Flows and Processes Guide](./05-user-flows-and-processes.md) for end-to-end business workflows.\n- Refer to the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for privacy, security, and legal obligations.\n"},"tokenUsage":{"total":22233,"input":{"total":15320,"cached":0},"output":{"total":6913,"reasoning":2304,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":7,"created_at":"2025-08-15T02:39:35.373Z"},"tokenUsage":{"aggregate":{"total":173503,"input":{"total":126107,"cached":9472},"output":{"total":47396,"reasoning":17664,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":170681,"input":{"total":123800,"cached":9472},"output":{"total":46881,"reasoning":17280,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Align revenue strategy, ethical analytics, and measurement with platform goals to guide ongoing optimization.","filename":"10-business-model-and-analytics.md","documentType":"business-model","outline":["Why This Service Exists (recap)","Revenue Strategy Options (ads, sponsorships, subscriptions) and Guardrails","User Acquisition and Growth Strategy","Analytics KPIs and Reporting Cadence","Content Quality and Community Health Metrics","Moderation and Safety Metrics","Governance for Data Use and Ethics","Success Metrics and Review Process"],"audience":"business stakeholders","keyQuestions":["How will the service sustain itself financially?","What KPIs define growth, engagement, and quality?","What governance ensures ethical data use?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md","08-non-functional-requirements-and-slas.md"],"constraints":["Must define measurable KPIs and review cadence","Avoid technical analytics tooling specifications","Ensure alignment with privacy obligations"],"content":"# civicDebateBoard — Business Model and Analytics\n\nThis document defines business requirements only. All technical implementation decisions (architecture, APIs, data pipelines, analytics tooling, storage, and dashboards) are at the discretion of the development team. The document describes WHAT the system must achieve from a business perspective, not HOW to implement it.\n\n## 1) Why This Service Exists (recap)\n\ncivicDebateBoard exists to improve the quality, transparency, and civility of online civic discourse. The platform enables structured discussions, integrates fact-checking roles, and equips moderators with policy-aligned workflows so that communities can debate complex topics responsibly. The service differentiates through:\n- A role design that includes verifiedMember and factChecker, elevating credibility and corrections.\n- Embedded, measurable safety and transparency requirements that prioritize community health over raw engagement.\n- Governance for data use and ethical analytics that protects user privacy and democratic processes.\n\nAlignment with related documents:\n- Strategic vision and scope are summarized in the [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Capabilities and constraints for user actions are detailed in the [Functional Requirements](./06-functional-requirements.md).\n- Experience-focused performance and availability targets are defined in the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## 2) Revenue Strategy Options and Guardrails\n\nThe revenue model must sustain the platform without compromising civic integrity or user trust. Monetization approaches are complementary and can be combined, subject to strict guardrails.\n\n### 2.1 Advertising (Contextual, Non-Microtargeted)\n- Contextual display and sponsorship placements adjacent to topics, never within user-generated arguments to avoid misattribution.\n- No behavioral microtargeting based on sensitive attributes or political beliefs.\n- Frequency caps and clear disclosures for all paid placements.\n\nEARS Requirements — Advertising\n- THE civicDebateBoard SHALL label all paid placements with an unambiguous disclosure visible wherever the placement appears.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL apply a user-level daily impression cap of 3 impressions per unique campaign.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL prohibit targeting based on sensitive attributes including political affiliation, religion, health status, or inferred beliefs.\n- IF a paid placement conflicts with community safety policies (e.g., misinformation, hate speech, election manipulation), THEN THE civicDebateBoard SHALL reject the placement and provide reasoned feedback to the advertiser.\n- WHEN a user opts out of personalized ads, THE civicDebateBoard SHALL restrict ad selection to contextual signals only and record the consent state for compliance reporting.\n- WHILE a live political event period (e.g., election blackout windows) is active, THE civicDebateBoard SHALL disable new political ad activations and freeze existing political campaigns.\n\n### 2.2 Sponsorships (Topic, Series, or Event-Based)\n- Brand sponsorship of topic hubs, expert AMAs, or fact-checking series with guardrails to prevent content interference.\n- Sponsors can fund public-interest fact-checking efforts without editorial control.\n\nEARS Requirements — Sponsorships\n- THE civicDebateBoard SHALL disclose sponsor identity on all sponsored surfaces associated with the sponsor.\n- WHERE a content area is sponsored, THE civicDebateBoard SHALL prevent sponsor accounts from editing or removing user content or fact-check annotations.\n- IF a sponsor attempts to influence moderation or fact-check outcomes, THEN THE civicDebateBoard SHALL document the attempt and escalate to policy governance for review.\n- WHEN a sponsored AMA is scheduled, THE civicDebateBoard SHALL present the sponsorship disclosure on the AMA announcement and session surfaces for the duration of the campaign.\n\n### 2.3 Subscriptions (Member-Supported)\n- Optional subscription for power users and institutions for benefits such as reduced ads, advanced topic insights, and community support for fact-checking capacity.\n- No paywalling of core civic participation (reading, posting, voting) to preserve accessibility.\n\nEARS Requirements — Subscriptions\n- THE civicDebateBoard SHALL keep core participation features (reading, posting, voting, reporting) accessible without payment.\n- WHERE subscriptions are active, THE civicDebateBoard SHALL provide a clear list of benefits before purchase and on the account page thereafter.\n- IF a payment fails or a subscription lapses, THEN THE civicDebateBoard SHALL revert benefits within 24 hours and retain access to core participation features.\n- WHEN a user cancels a subscription, THE civicDebateBoard SHALL stop future billing immediately and retain benefits until the end of the current paid period.\n- WHERE institutional subscriptions are active, THE civicDebateBoard SHALL allow assignment and revocation of seats without affecting user data ownership or posting history.\n\n### 2.4 General Monetization Guardrails\n- No sale of personal data; revenue must not depend on data brokerage.\n- Monetization experiments must pass a policy and privacy review before launch.\n\nEARS Requirements — Monetization Guardrails\n- THE civicDebateBoard SHALL refrain from selling or licensing personal data to third parties for unrelated purposes.\n- WHEN launching a new monetization experiment, THE civicDebateBoard SHALL require prior approval by policy and privacy governance with documented objectives, metrics, and guardrails.\n- IF revenue objectives conflict with community safety or integrity metrics, THEN THE civicDebateBoard SHALL prioritize safety and integrity outcomes and pause conflicting experiments.\n\n## 3) User Acquisition and Growth Strategy\n\nGrowth will emphasize trust, transparency, and real utility over vanity metrics. Core tactics include:\n- Partnerships with civic organizations, universities, and local newsrooms for verifiedMember onboarding and sponsored educational threads.\n- Invite flows and topic follows that bring participants back to relevant discussions without spam.\n- Reputation-based prompts that recognize high-quality contributions rather than quantity.\n\nEARS Requirements — Growth\n- THE civicDebateBoard SHALL prohibit dark patterns (e.g., confusing consent, disguised ads, forced continuity) in any acquisition or retention flow.\n- WHEN a user invites a contact, THE civicDebateBoard SHALL send a single, clearly labeled invitation and SHALL not re-message the contact without explicit consent.\n- WHERE growth notifications are enabled, THE civicDebateBoard SHALL limit notification sends to a maximum of 2 per user per day and SHALL include a single-click opt-out per category.\n- IF a partner’s onboarding content violates safety policies, THEN THE civicDebateBoard SHALL remove the content and notify the partner with policy references.\n- WHEN a verifiedMember application is approved by policy criteria, THE civicDebateBoard SHALL elevate the account status and update applicable rate limits within 1 hour.\n\n## 4) Analytics KPIs and Reporting Cadence\n\nKPIs are defined to capture growth, engagement, quality, safety, and revenue without compromising user privacy. All metrics should be aggregations at appropriate levels with data minimization and consent-respecting collection.\n\nEARS Requirements — Analytics and Reporting\n- THE civicDebateBoard SHALL maintain a weekly operational report covering growth, engagement, quality, safety, and monetization KPIs with owner accountability.\n- WHEN a KPI crosses an alert threshold (as defined below), THE civicDebateBoard SHALL create an incident entry in the business review log within 24 hours and assign a responsible owner.\n- WHERE consent is required for analytics, THE civicDebateBoard SHALL exclude non-consenting users from analytics cohorts and annotate reports accordingly.\n- IF a metric requires sensitive data to compute, THEN THE civicDebateBoard SHALL either use a privacy-preserving aggregate or omit the metric and document the omission.\n\n### KPI Catalog and Targets\n\n| KPI | Definition | Target (Green) | Alert Threshold (Amber/Red) | Required Breakdowns | Primary Owner | Cadence |\n|-----|------------|----------------|------------------------------|---------------------|---------------|---------|\n| Monthly Active Users (MAU) | Count of unique authenticated users active at least once in a calendar month | ≥ 100,000 | Amber: < 80,000; Red: < 60,000 | Role, geography (region), acquisition source | Growth Lead | Monthly |\n| Daily Active Users (DAU) | Unique authenticated users active on a given day | DAU/MAU ≥ 40% | Amber: 30–39%; Red: < 30% | Role, topic category | Growth Lead | Daily |\n| New Registrations | New accounts created | ≥ 15,000/month | Amber: < 10,000; Red: < 7,000 | Source, geography | Growth Lead | Weekly |\n| Activation Rate | Share of new users who complete first post or comment within 7 days | ≥ 60% | Amber: 45–59%; Red: < 45% | Role, source | Product Lead | Weekly |\n| 7-Day Retention | Percent of new users active 7 days after registration | ≥ 35% | Amber: 25–34%; Red: < 25% | Role, source | Product Analytics | Weekly |\n| 30-Day Retention | Percent of new users active 30 days after registration | ≥ 20% | Amber: 15–19%; Red: < 15% | Role, source | Product Analytics | Monthly |\n| Posts per Active Member | Average posts per DAU | 0.20–0.35 | Amber: < 0.15; Red: < 0.10 | Role, topic | Community Ops | Weekly |\n| Comments per Post | Average comments per post within 7 days | ≥ 3.0 | Amber: 2.0–2.9; Red: < 2.0 | Topic, role of author | Community Ops | Weekly |\n| Net Helpfulness Score | Net “helpful” minus “unhelpful” reactions per post over 7 days | ≥ +1.0 | Amber: 0.0–0.9; Red: < 0 | Topic, role, verification status | Community Ops | Weekly |\n| Fact-Check Coverage | Share of flagged claims with at least one fact-check annotation within 24 hours | ≥ 90% | Amber: 80–89%; Red: < 80% | Topic, severity | Policy Lead | Weekly |\n| Correction Adoption Rate | Share of content with accepted corrections visible within 24 hours of verification | ≥ 85% | Amber: 70–84%; Red: < 70% | Topic, role | Policy Lead | Weekly |\n| Time to First Moderator View (Critical) | Minutes from critical report to first moderator view | ≤ 30 min | Amber: 31–60; Red: > 60 | Severity, time of day | Safety Lead | Daily |\n| Report Review SLA (Standard) | Hours to decision for standard reports | ≤ 24 h | Amber: 25–48; Red: > 48 | Category, moderator team | Safety Lead | Daily |\n| False Positive Rate (Moderation) | Share of sanctions overturned on appeal | ≤ 5% | Amber: 5.1–8%; Red: > 8% | Category, team | Safety QA | Monthly |\n| Re-offense Rate | Share of sanctioned users who re-offend within 60 days | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Category, sanction type | Safety QA | Monthly |\n| Subscription Conversion | Percent of eligible users who start a paid plan within 30 days | ≥ 2.5% | Amber: 1.5–2.4%; Red: < 1.5% | Role, geography | Monetization Lead | Monthly |\n| ARPPU | Average revenue per paying user per month | ≥ $8.00 | Amber: $6.00–7.99; Red: < $6.00 | Plan type, region | Finance | Monthly |\n| Ad Fill Rate | Served ad impressions / eligible ad opportunities | ≥ 85% | Amber: 70–84%; Red: < 70% | Context, region | Monetization Lead | Weekly |\n| Ad Frequency (per user/day) | Average ads per user per day where ads enabled | ≤ 2.0 | Amber: 2.1–3.0; Red: > 3.0 | Role, region | Monetization Lead | Weekly |\n| Opt-out Rate (Personalized Ads) | Percent of users opting out of personalized ads | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Region | Privacy Lead | Monthly |\n| Consent Coverage | Percent of active users with recorded analytics consent state | 100% | Amber: 98–99.9%; Red: < 98% | Region | Privacy Lead | Monthly |\n\nReporting Cadence\n- Weekly Ops Review: Growth, engagement, quality, safety, revenue highlights; action items with owners and due dates.\n- Monthly Business Review: Trend analysis, budget vs. actuals, experiment outcomes, compliance review notes.\n- Quarterly Strategy Review: Deep-dive on mission metrics, long-term risks, policy landscape, and roadmap adjustments.\n\n## 5) Content Quality and Community Health Metrics\n\nQuality and health take precedence over pure volume. Metrics emphasize constructive engagement and corrective transparency.\n\nEARS Requirements — Quality and Health\n- THE civicDebateBoard SHALL compute quality metrics using privacy-preserving aggregates and SHALL avoid tracking users across unrelated contexts.\n- WHEN a topic’s Net Helpfulness Score remains below 0 for seven consecutive days, THE civicDebateBoard SHALL trigger a community health review with proposed remediation actions.\n- WHERE factChecker coverage falls below the alert threshold, THE civicDebateBoard SHALL prioritize recruitment or scheduling for fact-checking resources in the affected topics.\n- IF a content area exhibits repeated misinformation patterns, THEN THE civicDebateBoard SHALL introduce friction measures (e.g., pre-post reminders, source citation prompts) consistent with policy.\n- WHEN verifiedMember posts include expert tags, THE civicDebateBoard SHALL present expert context labels to readers to improve interpretability.\n\nAdditional Health Metrics (Targets)\n- Civility Incident Rate: ≤ 1.5% of posts flagged for civility violations per week.\n- Repeat Correction Visibility: ≥ 95% of accepted corrections remain visible on the original content indefinitely.\n- Topic Diversity Index: ≥ 0.65 across top 20 topics by volume each quarter.\n\n## 6) Moderation and Safety Metrics\n\nSafety protects both discourse quality and user well-being. Targets must be explicit and testable.\n\nEARS Requirements — Moderation and Safety\n- THE civicDebateBoard SHALL prioritize critical severity reports to the front of the review queue and SHALL meet the Time to First Moderator View target.\n- WHEN a sanction is issued, THE civicDebateBoard SHALL present the policy citation and evidence links to the user at the time of enforcement.\n- WHERE sanctions include temporary restrictions, THE civicDebateBoard SHALL automatically restore privileges upon sanction expiry without further user action.\n- IF an appeal is submitted within the allowed window, THEN THE civicDebateBoard SHALL review and decide within 72 hours and SHALL notify the appellant of the outcome and rationale.\n- WHEN a moderator action is overturned, THE civicDebateBoard SHALL update the audit trail and recalculate related metrics within 24 hours.\n\nSafety SLA Targets\n- Critical Harms (doxxing, threats): First view ≤ 30 minutes; decision ≤ 2 hours.\n- Standard Reports: Decision ≤ 24 hours.\n- Appeals: Decision ≤ 72 hours; overturn rate ≤ 5%.\n\n## 7) Governance for Data Use and Ethics\n\nGovernance ensures analytics and monetization respect privacy, comply with policy, and preserve civic integrity. Governance applies to product, monetization, policy, and research uses of data.\n\nPrinciples\n- Data minimization and purpose limitation for all analytics and monetization uses.\n- Transparency in user-facing disclosures for ads, sponsorships, and data use.\n- No sale of personal data; no political microtargeting based on sensitive attributes.\n\nEARS Requirements — Governance\n- THE civicDebateBoard SHALL maintain a register of analytics metrics with documented purpose, lawful basis or consent requirement, and retention period.\n- WHEN a new metric or experiment is proposed that requires additional data collection, THE civicDebateBoard SHALL conduct a privacy impact assessment and obtain governance approval before launch.\n- WHERE user consent is withdrawn, THE civicDebateBoard SHALL exclude the user’s data from future analytics cohorts and SHALL remove the user from longitudinal tracking cohorts within 7 days where feasible under law.\n- IF an ethics or compliance breach is suspected, THEN THE civicDebateBoard SHALL initiate an incident review within 24 hours and SHALL notify relevant stakeholders per compliance requirements.\n- WHILE a government election moratorium period is active, THE civicDebateBoard SHALL disable political audience refinements and SHALL restrict political ad activations.\n\nGovernance Process Flow\n\n```mermaid\ngraph LR\n  A[\"Propose Metric/Experiment\"] --> B[\"Document Purpose & Data Needs\"]\n  B --> C[\"Privacy Impact Assessment\"]\n  C --> D{\"Approval?\"}\n  D -->|\"Yes\"| E[\"Launch with Guardrails\"]\n  D -->|\"No\"| F[\"Revise or Reject\"]\n  E --> G[\"Monitor KPIs & Thresholds\"]\n  G --> H{\"Any Breach or Threshold Crossed?\"}\n  H -->|\"Yes\"| I[\"Incident Review & Mitigation\"]\n  H -->|\"No\"| J[\"Continue & Schedule Review\"]\n```\n\nRoles and Responsibilities\n- Policy Governance: Owns approvals, moratorium calendars, and ethics reviews.\n- Privacy Lead: Owns consent frameworks, retention, and cohort exclusions.\n- Product Analytics: Owns KPI catalog integrity and reporting cadences.\n- Monetization Lead: Owns revenue experiments, guardrails, and compliance with sponsorship/ads rules.\n\n## 8) Success Metrics and Review Process\n\nSuccess is measured across mission impact, sustainable revenue, and community safety. Reviews drive continuous improvement with ethical guardrails.\n\nMission and Platform Success Metrics (Annual Targets)\n- Mission Integrity Index (composite of civility, correction adoption, and misinformation mitigation): ≥ 75/100.\n- Community Trust (periodic survey): ≥ 70/100 with ≤ 5-point variance across major regions.\n- Sustainable Revenue Mix: ≥ 40% subscriptions/sponsorships, ≤ 60% ads.\n- Safety Assurance: Meet or exceed all safety SLAs ≥ 95% of the time.\n\nEARS Requirements — Reviews and Decision-Making\n- THE civicDebateBoard SHALL conduct a Weekly Ops Review with published notes, KPI deltas, and assigned actions.\n- WHEN a KPI remains in Red for two consecutive review periods, THE civicDebateBoard SHALL initiate a corrective action plan with owner, deadline, and expected impact.\n- WHERE a revenue initiative degrades the Mission Integrity Index by ≥ 3 points in a month, THE civicDebateBoard SHALL pause the initiative and present a remediation plan before resuming.\n- IF quarterly targets are not met for two consecutive quarters, THEN THE civicDebateBoard SHALL run a strategy reset workshop including policy, safety, product, and finance leadership.\n- WHILE a corrective action plan is active, THE civicDebateBoard SHALL track plan-specific leading indicators weekly and SHALL escalate if no improvement is observed within 3 weeks.\n\nReview Artifacts and Cadence\n- Weekly Ops Review: Dashboard snapshot, exceptions, actions (owners, due dates).\n- Monthly Business Review: Trend narratives, budget outcomes, experiment registry updates, compliance annotations.\n- Quarterly Strategy Review: OKR scorecards, policy landscape analysis, risk and contingency updates.\n\n## Appendices\n\nA. Alignment with Privacy and Non-Functional Expectations\n- This document’s requirements align with the privacy and consent expectations described in the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md). Any analytics requiring consent must honor consent state and applicable regulations without exception.\n\nB. Business-Only Scope Statement\n- This document specifies business objectives, measurable KPIs, ethical guardrails, and review cadences. Technical implementation (including, but not limited to, data models, API design, analytics tools, storage, and dashboarding) is the responsibility of the development team and may be implemented using any compliant architecture that meets the business requirements above.\n\nC. Role Considerations for Metrics\n- member: Included in all growth and engagement KPIs; subject to standard rate limits.\n- verifiedMember: Segmented in quality metrics and expert-tag analyses; subject to adjusted rate limits consistent with policy.\n- factChecker: Tracked for fact-check coverage and correction adoption rates; cannot directly sanction.\n- moderator: Accountable for safety SLAs and appeal turnaround metrics.\n- admin: Accountable for governance approvals, monetization guardrails, and cross-functional reviews.\n"},"tokenUsage":{"total":21966,"input":{"total":15320,"cached":0},"output":{"total":6646,"reasoning":1792,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":8,"created_at":"2025-08-15T02:39:38.416Z"},"tokenUsage":{"aggregate":{"total":195469,"input":{"total":141427,"cached":9472},"output":{"total":54042,"reasoning":19456,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":192647,"input":{"total":139120,"cached":9472},"output":{"total":53527,"reasoning":19072,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Define all functional capabilities, rules, and validations for the discussion board in unambiguous terms.","filename":"06-functional-requirements.md","documentType":"requirement","outline":["Content Model and Relationships (conceptual, non-technical)","Threading and Discussion Rules","Tagging, Topics, and Categories","Search and Discovery (filters, sorting)","Notifications and Subscriptions","Bookmarks and Follows","Localization and Timezone Handling (business perspective)","Accessibility and Inclusivity Expectations","Acceptance Criteria (EARS for all applicable requirements)"],"audience":"development team","keyQuestions":["What can users do and under what business rules?","What validations and constraints apply to actions?","How should content be organized and discovered?"],"detailLevel":"detailed specification","relatedDocuments":["05-user-flows-and-processes.md","07-content-moderation-and-safety-policies.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS format extensively","Specify measurable, testable business requirements","Avoid technical specifications (no APIs, schemas, or code)"],"content":"# Functional Requirements for civicDebateBoard\n\nThis document defines the complete set of business-functional requirements for the civicDebateBoard service. It specifies WHAT the system must do from a business perspective and how it should behave for users, without prescribing technical implementation details, APIs, database schemas, or infrastructure. All enforceable requirements are expressed in EARS where applicable to ensure clarity and testability. Developers retain full autonomy over architecture, APIs, and data design.\n\n## 1) Introduction and Scope\n- Purpose: Provide unambiguous, testable business rules governing content creation, discussion flows, organization, discovery, subscriptions, and user interactions for a civic discourse platform.\n- In-Scope: Posts, threads, comments/replies, reactions/votes, fact-check annotations, tags/topics/categories, search and discovery, notifications and subscriptions, bookmarks and follows, localization/timezone, accessibility and inclusivity, cross-cutting business rules (edits/deletions, attachments, mentions, rate limiting).\n- Out of Scope: Technical mechanisms (APIs, DB schemas, auth token formats), UI layout, styling, frontend interactions beyond business behavior.\n- Primary Roles: member, verifiedMember, factChecker, moderator, admin.\n\n## 2) Content Model and Relationships (conceptual, non-technical)\nConceptual entities (business definitions):\n- Post: Top-level content item that starts a discussion thread. Contains title, body, optional attachments/links, and optional tags/topics/categories.\n- Comment: A response to a Post or another Comment. Supports single-threaded parent-child relationships (reply chains) with depth limits.\n- Thread: The collection of a Post and all its Comments in hierarchical order.\n- Reaction/Vote: A simple expression of support or sentiment on a Post or Comment. Voting is limited to one per user per item per reaction type.\n- Fact-Check Annotation: A structured annotation attached to a Post or Comment by a factChecker, containing claim excerpts, ratings, evidence citations, and notes.\n- Report: A user-initiated flag on content for possible policy violation or quality issue.\n- Topic: A thematic grouping users can follow to receive relevant updates.\n- Tag: A free-form or controlled keyword applied to content for categorization and discovery.\n- Category: A curated taxonomy level for organizing threads (e.g., local issues, national policy, elections).\n- Subscription: A user’s preference to receive notifications about content, authors, or topics.\n- Bookmark: A user’s personal saved reference to content.\n\nMermaid relationship overview (conceptual):\n```mermaid\ngraph LR\n  A[\"User\"] --> B[\"Post\"]\n  B --> C[\"Comment\"]\n  C --> C2[\"Comment(Reply)\"]\n  B --> D[\"Reaction/Vote\"]\n  C --> D2[\"Reaction/Vote\"]\n  B --> E[\"Fact-Check Annotation\"]\n  C --> E2[\"Fact-Check Annotation\"]\n  B --> F[\"Report\"]\n  C --> F2[\"Report\"]\n  B --> G[\"Tag\"]\n  B --> H[\"Topic\"]\n  B --> I[\"Category\"]\n  A --> J[\"Subscription\"]\n  A --> K[\"Bookmark\"]\n```\n\nEARS requirements (core concepts and lifecycle):\n- THE civicDebateBoard SHALL treat a \"Post\" as the root item of a thread with a title and body.\n- THE civicDebateBoard SHALL treat a \"Comment\" as a reply to a Post or another Comment with exactly one parent.\n- THE civicDebateBoard SHALL allow a user to create exactly one Reaction/Vote per content item per reaction type.\n- THE civicDebateBoard SHALL associate zero or more Tags and zero or more Topics to a Post.\n- THE civicDebateBoard SHALL associate exactly one Category to a Post where category policy requires a single category.\n- THE civicDebateBoard SHALL allow factChecker to attach Fact-Check Annotations to Posts and Comments.\n- THE civicDebateBoard SHALL allow any authenticated user to create a Report on Posts and Comments within rate limits.\n- THE civicDebateBoard SHALL allow any authenticated user to create Bookmarks on Posts and Comments.\n\n## 3) Threading and Discussion Rules\n### 3.1 Posting and Commenting Permissions\n- WHERE role is \"member\" or \"verifiedMember\", THE civicDebateBoard SHALL permit creating Posts and Comments subject to community rules and rate limits.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL permit creating Posts and Comments under the same rules as member and adding Fact-Check Annotations.\n- WHERE role is \"moderator\" or \"admin\", THE civicDebateBoard SHALL permit all posting and commenting actions plus moderation controls defined in the content policies.\n- IF user is unauthenticated, THEN THE civicDebateBoard SHALL deny creating Posts or Comments and return an appropriate error.\n\n### 3.2 Validation Rules for Posts\n- THE civicDebateBoard SHALL require Post titles with length 10–150 characters.\n- THE civicDebateBoard SHALL require Post bodies with length 20–50,000 characters.\n- WHERE Post includes attachments, THE civicDebateBoard SHALL allow up to 5 attachments per Post with cumulative size up to 25 MB.\n- WHERE Post includes external links, THE civicDebateBoard SHALL require each link to use http or https and include a resolvable hostname.\n- WHERE role is \"verifiedMember\" and the post is marked as expert-tagged, THE civicDebateBoard SHALL require a topic area selection and an expertise declaration note up to 500 characters.\n\n### 3.3 Validation Rules for Comments\n- THE civicDebateBoard SHALL require Comment bodies with length 1–20,000 characters.\n- THE civicDebateBoard SHALL allow up to 3 attachments per Comment with cumulative size up to 10 MB.\n- THE civicDebateBoard SHALL allow a maximum reply depth of 5 levels including the root Post.\n\n### 3.4 Edits, Deletions, and Locking\n- WHEN a user edits their own Post, THE civicDebateBoard SHALL allow edits for 24 hours from creation unless the Post has been locked or sanctioned.\n- WHEN a user edits their own Comment, THE civicDebateBoard SHALL allow edits for 60 minutes from creation unless the thread is locked or sanctioned.\n- WHEN content is edited, THE civicDebateBoard SHALL preserve prior versions for audit visibility to moderators and admins.\n- IF a thread is locked by a moderator, THEN THE civicDebateBoard SHALL prohibit new Comments and further edits by non-moderators.\n- IF a Post is deleted by its author within 24 hours and has no Comments, THEN THE civicDebateBoard SHALL remove it from public discovery and retain a soft-deleted record for 30 days for audit.\n- IF a Comment is deleted by its author within 60 minutes, THEN THE civicDebateBoard SHALL replace it with a tombstone indicating deletion by author.\n\n### 3.5 Reactions and Voting\n- THE civicDebateBoard SHALL support one upvote per user per content item and allow removal (unvote) at any time.\n- WHERE reaction types include \"upvote\" and \"respectful\" reactions, THE civicDebateBoard SHALL limit to one per user per item per type.\n- WHEN a user attempts a duplicate reaction on the same item and type, THE civicDebateBoard SHALL toggle the reaction off.\n- IF a user attempts to react to their own content, THEN THE civicDebateBoard SHALL deny the action.\n\n### 3.6 Mentions\n- THE civicDebateBoard SHALL allow mentioning other users by handle within Posts and Comments using a validated handle format.\n- IF a mentioned user has blocked the author, THEN THE civicDebateBoard SHALL prevent the mention and inform the author.\n\n### 3.7 Fact-Check Annotations\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL allow attaching an annotation that includes: claim excerpt (1–1,000 chars), rating (e.g., \"accurate\", \"needs context\", \"misleading\", \"false\"), at least one source citation (valid http/https URL), and an explanation (1–2,000 chars).\n- WHEN an annotation is published, THE civicDebateBoard SHALL display an annotation badge and summary linked to the detailed note.\n- IF an annotation is flagged for policy issues, THEN THE civicDebateBoard SHALL queue it for moderator review and temporarily withhold visibility until resolved.\n\n## 4) Tagging, Topics, and Categories\n### 4.1 Tags\n- THE civicDebateBoard SHALL allow 0–10 tags per Post, each 1–30 characters, alphanumeric plus hyphens.\n- WHERE tags are controlled, THE civicDebateBoard SHALL restrict selection to approved tags; WHERE tags are free-form, THE civicDebateBoard SHALL normalize case and trim whitespace.\n\n### 4.2 Topics\n- THE civicDebateBoard SHALL allow users to follow Topics to receive notifications and discovery prioritization.\n- THE civicDebateBoard SHALL allow Post authors to associate 0–5 Topics with each Post.\n\n### 4.3 Categories\n- THE civicDebateBoard SHALL require exactly one Category per Post chosen from the active taxonomy.\n- WHERE a Category is changed by a moderator for policy reasons, THE civicDebateBoard SHALL update the Post categorization and record a moderation note.\n\n## 5) Search and Discovery (filters, sorting)\n### 5.1 Search Inputs and Validation\n- THE civicDebateBoard SHALL accept keyword search queries 1–100 characters and ignore stopwords.\n- THE civicDebateBoard SHALL support filtering by Category, Topic, Tag, author, role (author type), time range, and content type (Post or Comment).\n- THE civicDebateBoard SHALL support exclusion filters for Tags and Topics.\n\n### 5.2 Sorting Rules\n- THE civicDebateBoard SHALL support sorting by newest, oldest, most upvoted (24h, 7d, 30d, all-time), most commented (24h, 7d, 30d, all-time), and relevance for keyword queries.\n- WHERE no sort is specified, THE civicDebateBoard SHALL default to newest for non-search results and relevance for search results.\n\n### 5.3 Pagination and Result Limits\n- THE civicDebateBoard SHALL return results in pages of 20 items by default with user-selectable options of 10, 20, 50 per page.\n- THE civicDebateBoard SHALL cap total retrievable pages at 100 per query to ensure fair use.\n\n### 5.4 Safety and Quality in Discovery\n- IF a Post is under active moderation hold, THEN THE civicDebateBoard SHALL exclude it from public discovery views until resolved.\n- WHERE fact-check annotations exist, THE civicDebateBoard SHALL surface an annotation indicator in listings and allow filtering by annotation rating.\n\n## 6) Notifications and Subscriptions\n### 6.1 Subscription Types\n- THE civicDebateBoard SHALL allow users to subscribe to: author updates, thread updates (Post-level), Topic updates, and Category digests.\n\n### 6.2 Triggering Events\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL notify subscribers within 1 minute.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify the mentioned user within 1 minute.\n- WHEN a factChecker publishes an annotation on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n- WHERE Category digests are enabled, THE civicDebateBoard SHALL send a daily summary including top items by votes and comments.\n\n### 6.3 Frequency and Throttling\n- THE civicDebateBoard SHALL bundle notifications for the same thread within a 10-minute window.\n- IF a user disables notifications for a specific thread, THEN THE civicDebateBoard SHALL cease further notifications for that thread until re-enabled.\n\n## 7) Bookmarks and Follows\n- THE civicDebateBoard SHALL allow users to bookmark any Post or Comment for later reference.\n- THE civicDebateBoard SHALL allow users to follow authors and Topics to personalize discovery and notifications.\n- IF a user unfollows an author or Topic, THEN THE civicDebateBoard SHALL immediately stop related notifications and de-prioritize content from those sources in personalized lists.\n\n## 8) Localization and Timezone Handling (business perspective)\n- THE civicDebateBoard SHALL store and display timestamps relative to the user’s preferred timezone while preserving the canonical time for audit and consistency.\n- WHERE users have not set a preferred timezone, THE civicDebateBoard SHALL default to the user’s device or profile locale setting.\n- WHERE scheduled publication features are enabled, THE civicDebateBoard SHALL interpret schedule times in the author’s selected timezone and indicate the canonical time in content metadata.\n- THE civicDebateBoard SHALL allow user-selectable language preferences for interface text and content filters while preserving original content language.\n\n## 9) Accessibility and Inclusivity Expectations\n- THE civicDebateBoard SHALL require alternative text descriptions for image attachments with length 5–500 characters.\n- THE civicDebateBoard SHALL support content warnings for sensitive topics allowing users to proceed or skip as per preferences.\n- WHERE audio or video attachments are allowed, THE civicDebateBoard SHALL require caption files or transcripts to be provided by the uploader.\n- THE civicDebateBoard SHALL support respectful discourse by disallowing harassment and hate content per policy and enabling report and moderation flows.\n\n## 10) Cross-cutting Business Rules\n### 10.1 Rate Limiting (business fairness)\n- WHERE role is \"member\", THE civicDebateBoard SHALL limit to 10 Posts per 24 hours and 100 Comments per 24 hours.\n- WHERE role is \"verifiedMember\", THE civicDebateBoard SHALL limit to 20 Posts per 24 hours and 200 Comments per 24 hours.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL limit annotations to 100 per 24 hours and otherwise follow verifiedMember limits.\n- THE civicDebateBoard SHALL limit reactions to 500 per 24 hours per user and reports to 50 per 24 hours per user.\n- IF rate limits are exceeded, THEN THE civicDebateBoard SHALL deny the action with a message indicating the limit and reset time.\n\n### 10.2 Attachments and Links\n- THE civicDebateBoard SHALL allow attachment types: images and documents as per policy; executable formats are disallowed.\n- IF an attachment or link is detected as malicious or violates policy, THEN THE civicDebateBoard SHALL block it and record a safety event.\n\n### 10.3 Mentions and Blocks\n- THE civicDebateBoard SHALL allow users to block others which prevents mentions and direct notification triggers.\n- IF a blocked user attempts to interact (mention, follow) with the blocker’s content, THEN THE civicDebateBoard SHALL deny and avoid notifying the blocker.\n\n### 10.4 Ownership and Accountability\n- THE civicDebateBoard SHALL attribute all content to a single author account and record any role attributes at time of posting for accountability.\n- WHERE a user changes role (e.g., becomes verifiedMember), THE civicDebateBoard SHALL not retroactively alter existing content role labels.\n\n## 11) Role-Based Capabilities Summary (business perspective)\nBusiness matrix for core content actions:\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|--------|--------|----------------|------------|-----------|-------|\n| Create Post | ✅ | ✅ (can mark expert) | ✅ | ✅ | ✅ |\n| Create Comment | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Post (24h) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Comment (60m) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| React/Vote | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Fact-Check Annotation | ❌ | ❌ | ✅ | ✅ (review/approve) | ✅ |\n| Lock/Unlock Thread | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Change Category | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Remove Violating Content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue Sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n\nNotes:\n- Moderators and admins inherit all content capabilities and add enforcement controls as defined in policy documents.\n\n## 12) Acceptance Criteria (EARS for all applicable requirements)\nThis section consolidates key EARS requirements for verification and testing. It complements, and does not replace, the rules enumerated above.\n\n### 12.1 Posting and Commenting\n- WHEN a user submits a Post with title length between 10 and 150 and body length between 20 and 50,000, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Post title is shorter than 10 or longer than 150 characters, THEN THE civicDebateBoard SHALL reject the Post with a validation message specifying the title length constraint.\n- IF a Post body is shorter than 20 or longer than 50,000 characters, THEN THE civicDebateBoard SHALL reject the Post with a validation message specifying the body length constraint.\n- WHEN a user submits a Comment with body length 1–20,000 at a depth not exceeding 5, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Comment would exceed the maximum depth of 5, THEN THE civicDebateBoard SHALL reject it with a message indicating depth limits.\n\n### 12.2 Edits and Deletions\n- WHEN an author edits their Post within 24 hours and the thread is not locked, THE civicDebateBoard SHALL save the new version and maintain an immutable version history accessible to moderators.\n- IF a user attempts to edit a Post after 24 hours, THEN THE civicDebateBoard SHALL deny the edit and inform the user of the elapsed edit window.\n- WHEN an author deletes a Post within 24 hours that has no Comments, THE civicDebateBoard SHALL remove it from discovery and retain a soft-deleted record for 30 days.\n- WHEN an author deletes a Comment within 60 minutes, THE civicDebateBoard SHALL replace it with a tombstone label \"Deleted by author\".\n\n### 12.3 Reactions and Voting\n- WHEN a user upvotes a Post or Comment they did not author and has not previously upvoted, THE civicDebateBoard SHALL record the upvote and increase the visible count immediately.\n- WHEN a user upvotes again on the same item, THE civicDebateBoard SHALL remove their previous upvote (toggle behavior).\n- IF a user attempts to upvote their own content, THEN THE civicDebateBoard SHALL deny the action with an explanatory message.\n\n### 12.4 Fact-Check Annotations\n- WHEN a factChecker submits an annotation with required fields (claim excerpt, rating, at least one valid URL source, explanation), THE civicDebateBoard SHALL publish the annotation and display a badge on the content within 1 minute.\n- IF an annotation misses required fields or includes an invalid URL, THEN THE civicDebateBoard SHALL reject it with field-specific messages.\n\n### 12.5 Tags, Topics, Categories\n- WHEN a Post includes 0–10 valid tags, THE civicDebateBoard SHALL accept and store the tags; IF any tag violates length or character rules, THEN THE civicDebateBoard SHALL reject the Post with tag-specific messages.\n- WHEN a Post is submitted with a Category from the active taxonomy, THE civicDebateBoard SHALL accept it; IF the Category is missing or invalid, THEN THE civicDebateBoard SHALL reject the submission.\n\n### 12.6 Search and Discovery\n- WHEN a user searches with a 1–100 character keyword, THE civicDebateBoard SHALL return results sorted by relevance unless another sort is chosen, with page size default 20.\n- WHERE filters for Category, Topic, Tag, author, role, time range, or content type are applied, THE civicDebateBoard SHALL restrict results accordingly.\n- IF a content item is under moderation hold, THEN THE civicDebateBoard SHALL exclude it from public discovery results.\n\n### 12.7 Notifications and Subscriptions\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL deliver a notification to subscribers within 1 minute, bundling events within 10-minute windows.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify the mentioned user within 1 minute unless they have blocked the author.\n- WHEN a fact-check is published on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n\n### 12.8 Bookmarks and Follows\n- WHEN a user bookmarks a Post or Comment, THE civicDebateBoard SHALL record the bookmark and make it retrievable in the user’s saved list.\n- WHEN a user follows an author or Topic, THE civicDebateBoard SHALL include related content in personalized discovery and generate notifications per user settings.\n- IF a user unfollows, THEN THE civicDebateBoard SHALL cease related notifications immediately.\n\n### 12.9 Localization and Timezones\n- WHEN a user sets a preferred timezone, THE civicDebateBoard SHALL display all timestamps in that timezone while retaining canonical timestamps for audit.\n- WHEN a Post is scheduled for publication at a specified local time, THE civicDebateBoard SHALL publish according to the author’s chosen timezone and display both local and canonical times in metadata.\n\n### 12.10 Accessibility and Inclusivity\n- WHEN an image attachment is uploaded, THE civicDebateBoard SHALL require an alt-text of 5–500 characters.\n- WHERE a content warning is set by the author or moderator, THE civicDebateBoard SHALL gate the content behind a warning banner until the user opts to proceed.\n- WHEN an audio/video attachment is uploaded, THE civicDebateBoard SHALL require captions or transcripts before making it publicly discoverable.\n\n### 12.11 Rate Limits and Abuse Prevention\n- WHEN a user reaches a rate limit for Posts, Comments, reactions, or reports, THE civicDebateBoard SHALL return a clear error including remaining cooldown time.\n- IF repeated violation attempts occur after rate-limit errors, THEN THE civicDebateBoard SHALL extend the cooldown period and log a potential abuse event for moderation review.\n\n## 13) References to Related Documents\n- For end-to-end workflows, see the [User Flows and Processes](./05-user-flows-and-processes.md).\n- For content safety, sanctions, and enforcement specifics, see the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n- For performance, availability, and operability targets, see the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\nEnd of document."},"tokenUsage":{"total":22380,"input":{"total":15320,"cached":9856},"output":{"total":7060,"reasoning":1728,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":9,"created_at":"2025-08-15T02:39:38.893Z"},"tokenUsage":{"aggregate":{"total":217849,"input":{"total":156747,"cached":19328},"output":{"total":61102,"reasoning":21184,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":215027,"input":{"total":154440,"cached":19328},"output":{"total":60587,"reasoning":20800,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Set measurable expectations for performance, availability, scalability, and operability from a user-experience perspective.","filename":"08-non-functional-requirements-and-slas.md","documentType":"requirement","outline":["Performance Targets (response time by scenario)","Availability and Reliability Objectives","Capacity and Scalability Goals","Rate Limiting and Fair-Use Policies","Observability Expectations (logging, metrics, alerting in business terms)","Backup and Disaster Recovery Objectives (RTO/RPO)","Internationalization and Timezone Considerations","EARS-Formatted Non-Functional Requirements"],"audience":"development team","keyQuestions":["What performance should users experience in common and peak scenarios?","What availability and recovery objectives are required?","How should fair use be enforced?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","09-security-privacy-and-compliance.md"],"constraints":["All targets must be specific and measurable","Use EARS where applicable","Avoid architecture or technology prescriptions"],"content":"# Non-Functional Requirements and SLAs — civicDebateBoard\n\nThis document defines business expectations for performance, availability, scalability, operability, and continuity of the civicDebateBoard service. It describes WHAT the system must achieve from a user-experience perspective and operational outcomes. All technical implementation decisions (architecture, APIs, databases, tooling) are at the discretion of the development team.\n\n## Performance Targets (response time by scenario)\n\nPerformance targets are expressed at percentile levels measured at the service boundary from the user’s request to the system’s response, excluding end-user network variability but including all server-side processing. Targets apply during normal operations; separate peak and surge targets are defined for predictable events (e.g., elections, major civic news cycles).\n\n### Core Read Scenarios\n- Thread view (initial load of a discussion with first page of comments)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Subsequent page loads in same thread: p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Topic/Category feed listing (first page)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Pagination/“next” fetches: p95 ≤ 0.7 s; p99 ≤ 1.4 s\n- Notifications list fetch (latest 50 items)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- User profile read (public view)\n  - p95 ≤ 0.7 s; p99 ≤ 1.2 s\n\n### Write and Interaction Scenarios\n- Create post (including server-side validations and topic/tag processing)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n- Edit post within allowed policy window\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Create comment or reply\n  - p95 ≤ 0.9 s; p99 ≤ 1.8 s\n- Add reaction (like/support) or cast vote\n  - p95 ≤ 0.5 s; p99 ≤ 1.0 s\n  - Cross-device reflection of the action (eventual consistency): visible to the same user’s other sessions within 2.0 s (p95) and 5.0 s (p99)\n- Report content (submit report with category and notes)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Fact-check annotation submission (by factChecker)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n\n### Search and Discovery\n- Simple search (keyword over titles/content, default filters)\n  - p95 ≤ 1.5 s; p99 ≤ 3.0 s\n- Advanced search (multiple filters such as date range, tags, author)\n  - p95 ≤ 2.5 s; p99 ≤ 5.0 s\n- Autocomplete suggestions (typeahead)\n  - p95 ≤ 0.3 s; p99 ≤ 0.6 s\n\n### Authentication and Account Management (business perspective)\n- Login with valid credentials\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n- Email verification link consumption\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Password reset flow (token validation and new password set)\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n\n### Background and Asynchronous Outcomes (user-observable)\n- Notification delivery for direct mentions and replies\n  - p95 ≤ 10 s; p99 ≤ 30 s from event occurrence\n- Moderation decision visibility after decision recorded\n  - p95 ≤ 10 s; p99 ≤ 60 s to all relevant views\n- Indexing latency for search after new content\n  - p95 ≤ 30 s; p99 ≤ 120 s\n\n### Concurrency and Throughput Assumptions (business-facing)\n- Baseline steady state: 10,000 concurrent authenticated users, 2,000 read requests/s, 500 write requests/s\n- Peak predictable events (e.g., election nights): up to 50,000 concurrent users, 10,000 read requests/s, 2,000 write requests/s\n- Short surge (≤ 10 minutes) due to breaking news: up to 2× peak for reads and 1.5× peak for writes\n- Performance targets SHALL hold under baseline; during peak/surge windows, p95 and p99 targets may degrade by at most +30% latency while maintaining availability objectives\n\n## Availability and Reliability Objectives\n\nAvailability targets define user-facing uptime for core capabilities. Objectives are measured monthly unless specified.\n\n### Service-Level Objectives (SLOs)\n- Core read operations (view thread, list feeds): SLO 99.95% monthly availability\n- Core write operations (create/edit posts/comments, vote/reaction): SLO 99.90% monthly availability\n- Authentication and session operations: SLO 99.90% monthly availability\n- Search services: SLO 99.90% monthly availability\n\n### Error Budgets (aligned to SLOs)\n- 99.95% monthly leaves 21.6 minutes unavailability budget\n- 99.90% monthly leaves 43.8 minutes unavailability budget\n- Error budget consumption triggers progressive change freeze: at 50% consumption, restrict non-critical changes; at 100% consumption, freeze non-emergency changes until budget resets\n\n### Maintenance Windows\n- Planned maintenance may occur up to 60 minutes per month, scheduled at low-traffic times and announced at least 72 hours in advance, with local-time communication for impacted regions.\n- Degraded-mode maintenance (read-only) is preferred over full downtime.\n\n### Graceful Degradation Expectations\n- During service impairment, the system prioritizes read availability over non-critical write operations and background tasks to preserve civic discourse continuity.\n- Non-critical features (e.g., heavy analytics exports) may be temporarily disabled to protect core SLOs.\n\n## Capacity and Scalability Goals\n\n- Capacity planning horizon: 12 months rolling with quarterly review.\n- Headroom policy: maintain ≥ 30% spare capacity over the 95th percentile observed demand; ≥ 50% spare during scheduled high-impact civic events.\n- Elasticity: scale-out actions shall commence within 2 minutes of sustained (≥ 5 minutes) demand beyond headroom; scale-in after 30 minutes of sub-70% utilization to avoid thrashing.\n- Data growth assumptions: 1–2 million new posts/month, 10–20 million new comments/month, linear growth in reactions and votes.\n- Multi-tenant fairness: ensure per-topic or per-region spikes do not starve other topics/regions.\n\n## Rate Limiting and Fair-Use Policies\n\nRate limits exist to protect platform health, fairness, and discourse integrity. Limits are enforced per authenticated user and, where applicable, per-IP to mitigate abuse. Role-specific limits reflect trust and responsibility. Administrative and moderation functions required to maintain safety are exempt from general content-creation caps but remain subject to overall platform protection measures.\n\n### Action-Based Daily Quotas by Role\n\n| Action (per 24h rolling window) | member | verifiedMember | factChecker | moderator | admin |\n|---------------------------------|--------|----------------|-------------|-----------|-------|\n| Create posts                    | 30     | 60             | 60          | 120       | 240   |\n| Comments/replies                | 300    | 600            | 600         | 1,200     | 2,400 |\n| Reactions (likes/support)       | 3,000  | 5,000          | 5,000       | 10,000    | 20,000|\n| Votes (polls/ballots)           | 1,000  | 2,000          | 2,000       | 5,000     | 10,000|\n| Reports submitted               | 100    | 200            | 300         | 5,000     | 5,000 |\n| Fact-check annotations          | —      | —              | 100         | 300       | 300   |\n| Data exports (on-demand)        | 2      | 2              | 4           | 10        | 20    |\n\nNotes:\n- “—” means action not available to that role.\n- High-volume administrative operations that affect many items may require additional confirmations and audit entries per policy in the moderation and compliance documents.\n\n### Per-User and Per-IP Request Shaping\n- Sustained per-user request rate: 60 requests/minute with burst up to 3× for 10 seconds; cooldown applies if exceeded.\n- Per-IP guideline: 120 requests/minute with burst up to 3× for 10 seconds; stricter thresholds may apply for shared networks exhibiting abusive patterns.\n- Search-specific limit: 20 queries/minute (member), 40 (verifiedMember), 60 (factChecker), 120 (moderator/admin). Hourly caps 100/200/300/600 respectively.\n\n### Abuse Response and Recovery\n- Progressive throttling: soft warnings, temporary slowdowns, then hard blocks within the 24h window; resets occur after the rolling window elapses.\n- Human verification steps may be required when automated abuse signals exceed thresholds.\n- Accuracy-weighted reporting: frequent inaccurate reporters may see reduced report quotas until accuracy improves per moderation policies.\n\n## Observability Expectations (business terms)\n\nObservability ensures the team can detect, triage, and resolve issues quickly, protecting user experience and SLAs. Expectations are expressed as outcomes and signal categories, not tooling.\n\n### Business Event Logging\n- Authentication events: registration, login success/failure, logout, email verification, password reset, device/session revocation.\n- Content lifecycle: post/comment creation, edits, deletions, restores, visibility changes (e.g., moderation actions), tagging/topic updates.\n- User safety: reports, triage outcomes, sanctions applied, appeals and outcomes.\n- Configuration and policy changes: role assignments, feature toggles, category/tag configuration, sanctions configuration.\n- Data access requiring elevated permissions: exports and policy audits.\n\nLogs must include sufficient context to trace who acted, what changed, and when, in a privacy-compliant manner consistent with security and compliance requirements.\n\n### Metrics and Health Indicators\n- Latency distributions: p50/p95/p99 for key endpoints and flows defined in Performance Targets.\n- Availability: success rate per capability, excluding client/network errors beyond the service boundary.\n- Saturation: indicators of constrained capacity (e.g., queue depth, worker utilization) expressed as high-level health signals.\n- Workload: request rates, concurrency, job backlogs.\n- Business KPIs for operability: report backlog age, moderation decision latency, notification delivery latency.\n\n### Alerting and Operational Response\n- Alerting thresholds map to SLOs and user impact:\n  - Critical: immediate paging when projected to breach SLO within 30 minutes or when user-visible errors exceed 2% for 5 minutes.\n  - High: paging when p99 latency exceeds target by 50% for 10 minutes during baseline.\n  - Moderate: ticketing for chronic degradations not immediately user-visible.\n- On-call availability: 24/7 coverage with acknowledgement within 5 minutes (critical) and 15 minutes (high); mitigation or rollback initiated within 15 minutes (critical) and 30 minutes (high).\n- Post-incident review: completed within 5 business days with action items tracked to completion.\n\n#### Incident Alerting and Escalation Flow\n```mermaid\nsequenceDiagram\n  participant U as \"User Experience\"\n  participant M as \"Metrics/Alerts\"\n  participant OC as \"On-Call Engineer\"\n  participant IM as \"Incident Manager\"\n  participant ST as \"Service Team\"\n  U->>M: \"User-visible degradation detected\"\n  M-->>OC: \"Page (critical/high)\"\n  OC->>U: \"Mitigation actions (traffic shaping, feature gating)\"\n  OC->>IM: \"Declare incident and severity\"\n  IM->>ST: \"Coordinate response and updates\"\n  ST->>U: \"Restore service and confirm SLO compliance\"\n```\n\n## Backup and Disaster Recovery Objectives (RTO/RPO)\n\n- Backup coverage: all user-generated content, policy configurations, and audit records required for legal and operational accountability.\n- Backup frequency: at least every 15 minutes for critical transactional data; daily immutable snapshots for full datasets.\n- Retention: minimum 30 days online; 180 days in archive for compliance-relevant records, subject to privacy obligations.\n- Recovery Point Objective (RPO): ≤ 15 minutes for critical data; ≤ 60 minutes for non-critical indexes and caches.\n- Recovery Time Objective (RTO): ≤ 60 minutes for single-region outages affecting core operations; ≤ 4 hours for full regional failover.\n- Restore testing: quarterly restore drills for critical datasets with evidence of success and measured RTO/RPO compliance.\n\n#### Disaster Recovery Decision Flow\n```mermaid\ngraph LR\n  A[\"Degradation or Outage Detected\"] --> B{\"Within Error Budget?\"}\n  B -->|\"Yes\"| C[\"Mitigate and Monitor\"]\n  B -->|\"No\"| D[\"Initiate Failover Runbook\"]\n  C --> E{\"Resolved < 30 min?\"}\n  E -->|\"Yes\"| F[\"Close Incident\"]\n  E -->|\"No\"| D\n  D --> G[\"Restore Data to RPO Targets\"]\n  G --> H[\"Validate Core Capabilities\"]\n  H --> I{\"Meets RTO?\"}\n  I -->|\"Yes\"| F\n  I -->|\"No\"| J[\"Escalate and Communicate Extended ETA\"]\n```\n\n## Internationalization and Timezone Considerations\n\n- All user-visible timestamps are displayed in the user’s configured timezone and locale formats, with an option to view in UTC.\n- Relative time phrasing is acceptable when unambiguous and accompanied by absolute time upon request.\n- Daylight saving and regional calendar differences are respected when presenting date ranges and limits.\n- Rolling windows for rate limits are anchored to UTC for fairness and predictability, while user interfaces communicate remaining quotas in the user’s timezone.\n- Notifications and scheduled communications are delivered respecting the recipient’s local time windows when applicable (e.g., avoid sending at night based on preferences).\n\n## EARS-Formatted Non-Functional Requirements\n\n### Performance (Event-driven and Ubiquitous)\n- THE civicDebateBoard SHALL deliver thread view responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL deliver topic feed responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process post creation within 1.2 s at p95 and 2.5 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process comment creation within 0.9 s at p95 and 1.8 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process reactions and votes within 0.5 s at p95 and 1.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL make user actions visible across the user’s sessions within 2.0 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver simple search results within 1.5 s at p95 and 3.0 s at p99; advanced search within 2.5 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver login responses within 2.0 s at p95 and 4.0 s at p99.\n- THE civicDebateBoard SHALL deliver notifications within 10 s at p95 and 30 s at p99 from the triggering event.\n- WHERE peak or surge conditions occur, THE civicDebateBoard SHALL keep all latency targets within +30% of baseline p95/p99 values.\n\n### Availability and Reliability\n- THE civicDebateBoard SHALL maintain 99.95% monthly availability for core read operations.\n- THE civicDebateBoard SHALL maintain 99.90% monthly availability for core write operations, authentication, and search.\n- THE civicDebateBoard SHALL enforce error budgets aligned to SLOs and apply change freezes upon 100% budget consumption.\n- WHEN planned maintenance is required, THE civicDebateBoard SHALL announce at least 72 hours in advance and prefer read-only modes over downtime.\n- IF service impairment occurs, THEN THE civicDebateBoard SHALL degrade non-critical features to preserve read availability.\n\n### Capacity and Scalability\n- THE civicDebateBoard SHALL sustain baseline concurrency of 10,000 authenticated users, 2,000 read requests/s, and 500 write requests/s.\n- WHERE predictable civic events occur, THE civicDebateBoard SHALL sustain 50,000 concurrent users, 10,000 read requests/s, and 2,000 write requests/s.\n- WHILE demand exceeds headroom for ≥ 5 minutes, THE civicDebateBoard SHALL initiate scale-out so that user-facing performance targets continue to hold.\n- THE civicDebateBoard SHALL maintain ≥ 30% spare capacity over 95th percentile load and ≥ 50% during scheduled high-impact events.\n\n### Rate Limiting and Fair Use\n- THE civicDebateBoard SHALL enforce daily action quotas per role as specified in the Rate Limiting and Fair-Use Policies table.\n- THE civicDebateBoard SHALL enforce sustained per-user request rate of 60 requests/min with 3× burst for 10 seconds and apply cooldowns after exceedance.\n- THE civicDebateBoard SHALL enforce per-IP guidelines of 120 requests/min with 3× burst, with stricter controls for abusive patterns.\n- IF a user exceeds fair-use thresholds, THEN THE civicDebateBoard SHALL apply progressive throttling culminating in temporary blocks within the same 24h rolling window.\n- WHERE a user’s report accuracy score declines materially, THE civicDebateBoard SHALL proportionally reduce report quotas until accuracy improves.\n\n### Observability and Operations\n- THE civicDebateBoard SHALL record business events for authentication, content lifecycle, user safety, configuration changes, and elevated data access with sufficient context for accountability.\n- THE civicDebateBoard SHALL publish latency distributions (p50/p95/p99), availability rates, saturation, workload, and operability KPIs at a cadence suitable for real-time alerting and weekly reviews.\n- WHEN indicators project an SLO breach within 30 minutes, THE civicDebateBoard SHALL trigger critical alerts to on-call.\n- THE civicDebateBoard SHALL ensure on-call acknowledgement within 5 minutes for critical alerts and 15 minutes for high alerts.\n- THE civicDebateBoard SHALL initiate mitigation or rollback within 15 minutes for critical incidents and 30 minutes for high incidents.\n- THE civicDebateBoard SHALL complete post-incident reviews within 5 business days with tracked actions.\n\n### Backup and Disaster Recovery\n- THE civicDebateBoard SHALL create backups of critical transactional data at least every 15 minutes and daily immutable full snapshots.\n- THE civicDebateBoard SHALL meet RPO ≤ 15 minutes for critical data and ≤ 60 minutes for non-critical indexes and caches.\n- THE civicDebateBoard SHALL meet RTO ≤ 60 minutes for single-region core outages and ≤ 4 hours for full regional failover.\n- THE civicDebateBoard SHALL conduct quarterly restore drills and document evidence of success.\n\n### Internationalization and Timezone\n- THE civicDebateBoard SHALL display timestamps in the user’s configured timezone and locale, with an option to view in UTC.\n- THE civicDebateBoard SHALL anchor rolling-rate-limit windows to UTC while communicating remaining quotas in the user’s local time.\n- THE civicDebateBoard SHALL respect daylight saving rules and regional calendar differences when presenting ranges and limits.\n- WHERE user preferences specify quiet hours, THE civicDebateBoard SHALL align notification delivery windows accordingly.\n\n## References\n- See the [Functional Requirements Document](./06-functional-requirements.md) for business capabilities and rules related to content, discussions, and workflows.\n- See the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for obligations that intersect with observability, audit logging, data retention, and user rights.\n"},"tokenUsage":{"total":21972,"input":{"total":15320,"cached":0},"output":{"total":6652,"reasoning":1856,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":10,"created_at":"2025-08-15T02:39:48.566Z"},"tokenUsage":{"aggregate":{"total":239821,"input":{"total":172067,"cached":19328},"output":{"total":67754,"reasoning":23040,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":236999,"input":{"total":169760,"cached":19328},"output":{"total":67239,"reasoning":22656,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Define authenticated roles, permissions, session behavior, and the business rules of authentication and authorization.","filename":"03-user-roles-and-authentication.md","documentType":"requirement","outline":["Authentication Requirements (Registration, Login, Logout, Email Verification, Password Reset, Session Management, Device Revocation)","Role Hierarchy and Permissions (member, verifiedMember, factChecker, moderator, admin)","Token Management (JWT) and Session Expiration Policies","Permission Matrix (Actions vs Roles)","Account Lifecycle (Creation, Verification, Suspension, Deletion, Appeals)","Auditability and Transparency Requirements"],"audience":"development team","keyQuestions":["What are the authenticated roles and what can each do or not do?","What business rules govern authentication, sessions, and token lifecycles?","How are account states handled across the lifecycle?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","07-content-moderation-and-safety-policies.md","09-security-privacy-and-compliance.md"],"constraints":["Must specify JWT-based token management requirements in business terms (access and refresh lifetimes, revocation expectations)","Must include a clear permission matrix","Use EARS for all applicable requirements","Avoid API or database specifications"],"content":"# User Roles and Authentication Requirements for civicDebateBoard\n\nThis document defines business requirements for authentication, authorization, user roles and permissions, token/session behavior, account lifecycle, and auditability for the civicDebateBoard service. It provides business requirements only; all technical implementation decisions (architecture, APIs, database design, cryptography choices, storage mechanisms) belong to the development team. This document describes WHAT the system must do in business terms, not HOW to build it.\n\nConsistent terminology in this document:\n- “the system” means the civicDebateBoard service.\n- “user” means a human end-user operating an account.\n- “session” means a login state tied to a device and a token pair.\n\nFor broader functional capabilities, refer to the [Functional Requirements Specification](./06-functional-requirements.md), the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md), and the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n\n## 1) Definitions and Role Overview\n\n- member: Authenticated community participant who can create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules.\n- verifiedMember: Identity- or expertise-verified participant with elevated trust level; may create expert-tagged posts, host AMAs, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while remaining subject to all policies.\n- factChecker: Trusted role allowed to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes; cannot apply sanctions directly.\n- moderator: Role responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, handling appeals within scope, and maintaining community health.\n- admin: Top-level role managing platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions plus administrative operations.\n\nEARS global principle:\n- THE civicDebateBoard service SHALL protect accounts, content integrity, and community safety through role-based access control, tokenized sessions, and auditable decision-making.\n\n## 2) Authentication Requirements\n\n### 2.1 Registration\n- WHEN a visitor provides required registration attributes (email and password), THE system SHALL create a pending account and send a verification message.\n- THE system SHALL require email uniqueness per account.\n- THE system SHALL enforce password policy at creation (see 2.5 Password Policy).\n- IF the email is already in use, THEN THE system SHALL reject registration with a clear, non-disclosing message.\n- WHERE legal age or jurisdictional constraints apply, THE system SHALL require age attestation and reject accounts that fail attestation.\n- THE system SHALL limit registration attempts to a maximum of 5 per IP within 1 hour and 2 per email within 24 hours.\n- IF registration throttling thresholds are exceeded, THEN THE system SHALL delay or block further attempts for the applicable cool-down period (minimum 1 hour).\n\n### 2.2 Email Verification\n- WHEN a registration completes, THE system SHALL send a verification link with a validity of 24 hours.\n- WHEN a user requests re-send, THE system SHALL allow up to 3 re-sends within 24 hours.\n- IF the verification link is expired or invalid, THEN THE system SHALL deny verification and provide a re-send path.\n- WHILE the account is unverified, THE system SHALL restrict posting and interaction capabilities to read-only and profile completion functions.\n- WHEN email verification succeeds, THE system SHALL mark the account as verified and lift unverified restrictions.\n\n### 2.3 Login\n- WHEN a user submits email and password, THE system SHALL validate credentials and respond within 2 seconds under normal load.\n- IF the credentials are invalid, THEN THE system SHALL reject login and increment a failed-attempt counter.\n- IF there are 10 failed login attempts for the same account within 15 minutes, THEN THE system SHALL lock login attempts for that account for 15 minutes and notify the user via the primary email.\n- WHERE optional multi-factor verification is required by policy or risk, THE system SHALL challenge with a secondary factor before establishing a session.\n- WHEN login succeeds, THE system SHALL establish a session associated with a specific device context and issue tokens per Section 4.\n\n### 2.4 Logout\n- WHEN a user invokes logout on a device, THE system SHALL immediately invalidate the corresponding session for that device.\n- WHEN a user invokes “logout from all devices”, THE system SHALL invalidate all sessions and tokens for that user within 60 seconds.\n\n### 2.5 Password Policy and Reset\n- THE system SHALL enforce password complexity at creation and change: minimum 10 characters; must include at least 3 of the following: uppercase letters, lowercase letters, digits, symbols; shall not contain the email local-part; shall not be one of the last 5 used passwords.\n- WHEN a user requests password reset, THE system SHALL send a reset link valid for 60 minutes.\n- IF a reset token is expired, revoked, or invalid, THEN THE system SHALL deny the reset and allow issuing a new token subject to rate limits (max 3 per 24 hours per account).\n- WHEN a password is successfully reset, THE system SHALL revoke all existing sessions and require re-login on all devices.\n\n### 2.6 Session Management\n- THE system SHALL associate each session with a user, a device context, and a token pair with independent lifetimes (see Section 4).\n- THE system SHALL allow up to 10 concurrent active sessions per user by default.\n- WHERE an organization or policy sets a lower limit, THE system SHALL enforce the configured maximum sessions per user.\n- WHEN a session exceeds its refresh lifetime, THE system SHALL require full login to re-establish a session.\n- WHILE a session is valid, THE system SHALL honor access tokens for authorization checks within their lifetime.\n\n### 2.7 Device Management and Revocation\n- THE system SHALL maintain a list of active sessions and device contexts visible to the account owner (device name, last activity time, approximate location, and creation time) without exposing sensitive identifiers.\n- WHEN the account owner revokes a device session, THE system SHALL invalidate that session’s tokens within 60 seconds and block further refresh for that session.\n- WHEN suspicious activity is detected (e.g., impossible travel, many failed refresh attempts), THE system SHALL flag the session for review and may require re-authentication on next action.\n\n## 3) Role Hierarchy and Permissions\n\nRole scope and escalation model:\n- THE system SHALL implement a hierarchical permission model where admin encompasses moderator permissions; moderator does not encompass admin; factChecker, verifiedMember, and member are orthogonal in scope except where explicitly extended.\n- WHERE a user holds multiple roles, THE system SHALL grant the union of permissions and enforce the strictest accountability and transparency rules that apply to any held role.\n\nRole capabilities (business-level):\n- member\n  - Create, edit, and delete own posts and comments within edit windows and policy.\n  - React, vote, follow topics, bookmark items, and report content.\n  - Manage own account and sessions within limits.\n- verifiedMember\n  - All member capabilities.\n  - Create expert-tagged posts; host AMAs; enjoy reduced pre-moderation and rate limits as defined by policy.\n  - Elevated accountability: content may require more detailed disclosures where applicable.\n- factChecker\n  - Add fact-check annotations tied to specific claims; attach sources and confidence levels.\n  - Flag misleading claims for review; propose corrections; generate transparency notes.\n  - No sanction powers; cannot edit or delete others’ content.\n- moderator\n  - Review reports and queues; apply policy decisions; edit/remove violating content.\n  - Issue warnings, mutes, suspensions within scope; handle appeals at first level.\n  - Access limited audit views necessary for case handling.\n- admin\n  - All moderator capabilities.\n  - Manage platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews.\n\nEARS role control examples:\n- WHEN a member attempts to apply a sanction, THE system SHALL deny the action and display insufficient permission.\n- WHEN a factChecker submits a fact-check note, THE system SHALL record it with attribution and route for visibility according to policy.\n- WHEN a moderator removes content, THE system SHALL record the reason, policy reference, and notify the content owner.\n- WHEN an admin changes a user’s role, THE system SHALL record the actor, old role(s), new role(s), timestamp, and justification.\n\n## 4) Token Management (JWT) and Session Expiration Policies\n\nBusiness requirements for tokenized sessions:\n- THE system SHALL use JWT for access and refresh tokens.\n- THE access token lifetime SHALL be 15 minutes.\n- THE refresh token lifetime SHALL be 14 days, with sliding renewal on successful refresh (rotation) up to a maximum of 30 days from last credentialed login.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and invalidate the previous refresh token.\n- IF a previously used refresh token is presented again (reuse), THEN THE system SHALL revoke the corresponding session and require full re-authentication.\n- WHEN a user logs out, THE system SHALL invalidate the associated refresh token(s) and disallow further refresh for that session.\n- THE JWT payload SHALL include at minimum: userId, role, permissions array suitable for authorization checks, issued-at time, expiry time, and a session identifier.\n- WHERE additional security context is configured (e.g., device identifier, risk score), THE system SHALL include business-relevant claims without exposing sensitive personal data.\n- THE system SHALL support immediate revocation within 60 seconds for logout-all and device revocation actions.\n\n## 5) Permission Matrix (Actions vs Roles)\n\nThe following matrix defines baseline permissions. Business rules and rate limits from related documents still apply. A check mark means “allowed by default,” a cross means “not allowed”; some actions are “Conditional” as noted.\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|---|---|---|---|---|---|\n| Register account | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Login / Logout | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View public content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Create post | ✅ (rate-limited) | ✅ (reduced limits) | ✅ (within policy) | ✅ | ✅ |\n| Create expert-tagged post | ❌ | ✅ | ❌ | ❌ | ✅ (for official posts) |\n| Edit own post (within window) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Delete own post (within window/policy) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Comment on posts | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Vote/React | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Follow topics / Bookmark | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Report content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Add fact-check annotation | ❌ | ❌ | ✅ | ✅ (with tag) | ✅ |\n| Flag misleading claims for review | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Propose corrections | ❌ | ❌ | ✅ | ✅ | ✅ |\n| Edit/remove others’ content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue warnings | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue mutes/suspensions | ❌ | ❌ | ❌ | ✅ (within scope) | ✅ |\n| Handle appeals (first level) | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Overturn moderator decision | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage roles and verifications | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage policies/categories/tags | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Approve data exports | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Access audit logs (case-limited) | ❌ | ❌ | ❌ | ✅ (need-to-know) | ✅ (full) |\n| Host AMAs | ❌ | ✅ | ❌ | ✅ (official) | ✅ |\n\nClarifications:\n- “within window” means within the edit/delete grace windows defined in the [Functional Requirements Specification](./06-functional-requirements.md).\n- “within scope” means within the sanction ranges and SLAs defined in the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## 6) Authorization Rules and Validation (Business Terms)\n\nGeneral authorization checks:\n- WHEN an action requires a specific role, THE system SHALL validate that the role is present in the current session’s permissions.\n- WHEN content ownership is required (e.g., edit own post), THE system SHALL validate the actor is the content owner and the action is within permitted time windows.\n- WHERE actions are rate-limited, THE system SHALL enforce limits per user and per device to prevent abuse.\n\nError-handling:\n- IF authorization fails, THEN THE system SHALL deny the action with an explanation appropriate to the user’s role and context without revealing sensitive internal details.\n- IF ownership validation fails, THEN THE system SHALL deny the action and indicate that only the owner may perform it within the permitted window.\n\n## 7) Account Lifecycle\n\nStates (business-level):\n- Registered(Unverified)\n- Email Verified\n- Active\n- Verified Member (overlay role state)\n- Muted (temporary, limited interactions)\n- Suspended (temporary, login allowed only to view notices and appeal)\n- Banned (permanent or long-term; login allowed only for appeals if policy allows)\n- Deleted (pending grace period) / Hard Deleted\n- Appeal Pending (overlay state)\n\nTransitions and rules:\n- WHEN registration completes, THE system SHALL place the account in Registered(Unverified).\n- WHEN email is verified within 24 hours, THE system SHALL transition to Email Verified.\n- WHEN profile minimums are met (if required), THE system SHALL mark the account Active.\n- WHERE identity or expertise verification is approved by admins, THE system SHALL grant verifiedMember.\n- WHEN a mute sanction is applied, THE system SHALL restrict posting and commenting for the mute duration while allowing read access.\n- WHEN a suspension is applied, THE system SHALL restrict all posting and commenting; login is allowed for reviewing notices and filing appeals.\n- WHEN a ban is applied, THE system SHALL disable access except appeal functions as policy dictates.\n- WHEN a user requests deletion, THE system SHALL place the account in Deleted (pending) state with a 30-day grace period for reversal.\n- IF the deletion grace period elapses without reversal, THEN THE system SHALL hard delete the account and irreversibly remove personal data subject to legal and audit obligations.\n- WHEN an appeal is filed, THE system SHALL mark the case Appeal Pending and pause escalation timelines until a decision is issued.\n- WHEN an appeal is granted, THE system SHALL restore the prior permissible state and record the justification.\n- WHEN an appeal is denied, THE system SHALL maintain the sanction state and record the justification.\n\nNotifications:\n- THE system SHALL notify users of state changes (verification, sanctions, appeals decisions, deletion) using their preferred notification channels per the [Functional Requirements Specification](./06-functional-requirements.md).\n\n## 8) Auditability and Transparency Requirements\n\n- THE system SHALL produce an immutable audit trail for security- and policy-relevant events: registrations, logins, logouts, token refreshes and revocations, password changes/resets, role assignments, sanctions, and appeals decisions.\n- THE system SHALL capture for each audited event: actor (user or system), target (user/content), action, timestamp, outcome (success/failure), and justification where applicable.\n- WHERE personal data minimization is required, THE system SHALL record only the minimum necessary identifiers.\n- WHEN moderators or admins take actions affecting user content or state, THE system SHALL require entering a policy reference and rationale.\n- THE system SHALL provide role-appropriate audit access: moderators see case-relevant records; admins can run compliance reviews.\n- IF evidence (e.g., screenshots, links) is attached to a moderation action, THEN THE system SHALL preserve references consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n\n## 9) Non-Functional Expectations for Authentication\n\n- THE system SHALL respond to successful login within 2 seconds under normal load (p95) and 4 seconds under peak load (p95).\n- THE system SHALL deliver verification and reset emails within 2 minutes under normal conditions; retries SHALL occur for transient failures for up to 30 minutes.\n- THE system SHALL support immediate logout-all and device revocation propagation within 60 seconds p95.\n- THE system SHALL enforce rate limits for registration, login, and reset flows as defined in Sections 2.1, 2.3, and 2.5.\n- WHERE service degradation occurs, THE system SHALL provide clear user-facing messages and safe fallback behaviors without exposing internal details.\n\n## 10) Detailed EARS Acceptance Criteria by Flow\n\n### 10.1 Registration and Verification\n- WHEN a user completes the sign-up form with a unique email and compliant password, THE system SHALL create an unverified account and send a verification email within 2 minutes.\n- IF the email is already registered, THEN THE system SHALL prevent account creation and present a non-enumerating message.\n- IF the verification link is invalid or expired, THEN THE system SHALL refuse verification and allow requesting a new link subject to rate limits.\n- WHEN verification is successful, THE system SHALL elevate the account to verified state and unlock standard interactions.\n\n### 10.2 Login, Logout, and Lockout\n- WHEN valid credentials are submitted, THE system SHALL issue tokens and create a session in less than 2 seconds.\n- IF invalid credentials are submitted, THEN THE system SHALL increment a failure counter and return an error without indicating which field is incorrect.\n- IF the account reaches 10 failed attempts in 15 minutes, THEN THE system SHALL impose a 15-minute lockout and notify the user’s email.\n- WHEN logout is requested, THE system SHALL invalidate the associated session’s refresh token within 60 seconds.\n- WHEN logout-all is requested, THE system SHALL invalidate all sessions for that user within 60 seconds.\n\n### 10.3 Password Reset and Change\n- WHEN a reset is requested, THE system SHALL send a reset link valid for 60 minutes and rate-limit to 3 per day per account.\n- WHEN a password is reset successfully, THE system SHALL revoke all sessions and require fresh login everywhere.\n- IF the new password fails complexity or reuse checks, THEN THE system SHALL reject the change with specific, actionable messages.\n\n### 10.4 Token Refresh and Reuse Detection\n- WHEN an access token expires, THE system SHALL allow refresh using a valid refresh token within its lifetime.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and issue a new access token.\n- IF a refresh token is detected as reused, THEN THE system SHALL revoke the session and require full login.\n\n### 10.5 Authorization by Role\n- WHEN an action requires moderator privileges, THE system SHALL permit the action only if the session includes moderator or admin roles.\n- WHEN a fact-check annotation is submitted, THE system SHALL record the annotation and attribute it to the factChecker role user.\n- IF a user without verifiedMember status attempts to create an expert-tagged post, THEN THE system SHALL deny the action and indicate the verification requirement.\n\n## 11) Diagrams\n\n### 11.1 Authentication and Token Refresh Flow\n```mermaid\ngraph LR\n  subgraph \"User Device\"\n    A[\"Submit Login(Email,Password)\"] --> B[\"Wait For Response\"]\n    H[\"Use Access Token For Requests\"] --> I{\"Access Token Expired?\"}\n    I -->|\"Yes\"| J[\"Send Refresh Token\"]\n    I -->|\"No\"| H\n  end\n  subgraph \"civicDebateBoard Service\"\n    C[\"Validate Credentials\"] --> D{\"Account State OK?\"}\n    D -->|\"Yes\"| E[\"Issue Access & Refresh Tokens\"]\n    D -->|\"No\"| F[\"Deny With Reason\"]\n    K[\"Validate Refresh Token\"] --> L{\"Refresh Valid?\"}\n    L -->|\"Yes\"| M[\"Rotate Refresh & Issue New Access\"]\n    L -->|\"No\"| F\n  end\n  A --> C\n  E --> B\n  B --> H\n  J --> K\n  M --> H\n```\n\n### 11.2 Account Lifecycle Overview\n```mermaid\ngraph LR\n  A[\"Registered(Unverified)\"] -->|\"Verify Email(<24h)\"| B[\"Email Verified\"]\n  B -->|\"Profile Minimums Met\"| C[\"Active\"]\n  C -->|\"Admin Grants Verification\"| D[\"Verified Member\"]\n  C -->|\"Issue Mute(<=7d)\"| E[\"Muted\"]\n  C -->|\"Issue Suspension(<=30d)\"| F[\"Suspended\"]\n  C -->|\"Ban\"| G[\"Banned\"]\n  E -->|\"Mute Ends\"| C\n  F -->|\"Suspension Ends\"| C\n  G -->|\"Appeal Filed\"| H[\"Appeal Pending\"]\n  H -->|\"Appeal Upheld\"| C\n  H -->|\"Appeal Denied\"| G\n  C -->|\"User Requests Deletion\"| I[\"Deleted(Pending)\"]\n  I -->|\"Grace Ends(30d)\"| J[\"Hard Deleted\"]\n  I -->|\"User Cancels Deletion\"| C\n```\n\n## 12) Data and Privacy Alignment (Business Terms)\n\n- THE system SHALL minimize personal data exposure in session and audit records consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n- WHERE legal hold or regulatory retention applies, THE system SHALL retain essential audit records without restoring interactive access for deleted or banned accounts.\n\n## 13) Success Criteria\n\n- Complete and correct enforcement of role-based permissions per matrix.\n- Reliable session handling with timely revocation and token rotation.\n- Clear, testable EARS requirements for all major flows (registration, login, logout, reset, refresh, authorization, lifecycle, auditability).\n- Alignment with safety policies and compliance documents without prescribing implementation.\n\nEnd of document."},"tokenUsage":{"total":23354,"input":{"total":15320,"cached":0},"output":{"total":8034,"reasoning":2688,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":11,"created_at":"2025-08-15T02:40:42.290Z"},"tokenUsage":{"aggregate":{"total":263175,"input":{"total":187387,"cached":19328},"output":{"total":75788,"reasoning":25728,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":260353,"input":{"total":185080,"cached":19328},"output":{"total":75273,"reasoning":25344,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"To provide a navigable overview of all documents with clear links and reading order for stakeholders.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","Document List and Descriptions","Reading Order and Dependencies"],"audience":"general","keyQuestions":["What documents exist and in what order should they be read?","How are documents related?"],"detailLevel":"high-level overview","constraints":["Must list every document with descriptive link text","Must include developer autonomy note at the very end as a blockquote per guidelines"],"content":"# civicDebateBoard Documentation Index and Reading Guide\n\n## Document Purpose\nThis document serves as the authoritative table of contents for the civicDebateBoard documentation set. It provides a concise description, intended audience, and purpose for every document in the repository, along with a recommended reading order and a clear view of dependencies. It is designed to help stakeholders navigate efficiently and understand how each document contributes to the overall system definition.\n\n## Document List and Descriptions\n- [Table of Contents and Reading Guide](./00-toc.md) — Provides an overview of all documents, their purposes, recommended reading order, and cross-dependencies.\n- [Service Vision and Overview](./01-service-vision-and-overview.md) — Establishes vision, scope, and success criteria, including the Business Model section (Why the service exists, revenue strategy, growth plan, and success metrics). Audience: business stakeholders.\n- [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Clarifies target user pains, market context, competitive landscape, and differentiators. Audience: business stakeholders.\n- [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Defines authenticated roles (member, verifiedMember, factChecker, moderator, admin), role permissions, JWT-based session and token policies, and account lifecycle rules using EARS. Audience: development team.\n- [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Captures representative personas and end-to-end scenarios (happy paths, edge cases, abuse/misuse) with acceptance criteria in EARS. Audience: product managers.\n- [User Flows and Business Processes](./05-user-flows-and-processes.md) — Describes step-by-step workflows for posting, commenting, voting, reporting, moderation, appeals, onboarding/verification, and notifications, with Mermaid flow diagrams. Audience: development team.\n- [Functional Requirements Specification](./06-functional-requirements.md) — Defines all functional capabilities, rules, and validations for the discussion board, including content relationships, threading, tagging, search/discovery, notifications, bookmarks/follows, localization/timezone handling, and accessibility expectations. Uses EARS extensively with measurable acceptance criteria. Audience: development team.\n- [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Establishes policy principles, prohibited/restricted content, civic discourse safeguards, report intake and prioritization, review SLAs, sanctions, transparency, evidence handling, audit trails, and appeals using EARS. Audience: development team.\n- [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Sets measurable targets for performance, availability, reliability, capacity/scalability, rate limiting and fair use, observability expectations, backup/DR objectives (RTO/RPO), internationalization/timezone considerations, all using EARS where applicable. Audience: development team.\n- [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Documents privacy principles and consent, user rights, security expectations, audit and accountability, incident response, breach notification, regulatory compliance, and third-party risk, with EARS-formatted obligations. Audience: development team.\n- [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Aligns revenue strategy options (ads, sponsorships, subscriptions) and guardrails with ethical analytics, KPIs, reporting cadence, content quality and community health metrics, moderation/safety metrics, governance for data use, and success review processes. Audience: business stakeholders.\n\n## Reading Order and Dependencies\nThe documents are intended to be read in the following order to build context progressively and reduce rework:\n\n1. [Service Vision and Overview](./01-service-vision-and-overview.md) — Establishes the foundational vision, scope, and success metrics.\n2. [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Validates the problem-solution fit and differentiators.\n3. [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Grounds the requirements in real user needs and representative scenarios.\n4. [User Flows and Business Processes](./05-user-flows-and-processes.md) — Converts scenarios into end-to-end business workflows.\n5. [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Defines role models and account lifecycle rules that underpin authorization across flows.\n6. [Functional Requirements Specification](./06-functional-requirements.md) — Consolidates complete functional rules, validations, and acceptance criteria informed by flows and roles.\n7. [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Formalizes community safety policies and enforcement that inform functional and process constraints.\n8. [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Establishes performance, availability, scalability, and operability expectations drawing from functional scope and safety imperatives.\n9. [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Defines cross-cutting obligations that shape authentication, data handling, and operational practices.\n10. [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Aligns measurement and monetization with the defined product scope and operating constraints.\n\nThe following diagram illustrates high-level dependencies among documents:\n\n```mermaid\ngraph LR\n  A[\"01 Service Vision and Overview\"] --> B[\"02 Market Problem and Value Proposition\"]\n  A --> C[\"06 Functional Requirements\"]\n  B --> C\n  D[\"04 User Personas and Scenarios\"] --> E[\"05 User Flows and Processes\"]\n  C --> E\n  F[\"03 User Roles and Authentication\"] --> C\n  F --> G[\"07 Content Moderation and Safety Policies\"]\n  G --> E\n  C --> H[\"08 Non-Functional Requirements and SLAs\"]\n  F --> H\n  I[\"09 Security, Privacy, and Compliance\"] --> F\n  I --> H\n  C --> J[\"10 Business Model and Analytics\"]\n  A --> J\n```\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*"},"plan":"Filename: 00-toc.md; Type: service-overview; Audience: general; Reason: Provide a navigable overview with clear links and reading order. Outline: 1) Document Purpose; 2) Document List and Descriptions; 3) Reading Order and Dependencies. Key questions: What documents exist and in what order to read them? How are documents related? Constraints: list every document with descriptive link text; include developer autonomy note at very end as a blockquote. Related documents: 01 through 10 as per project list. Service prefix: civicDebateBoard. Roles present across project: member, verifiedMember, factChecker, moderator, admin.","review":"Enhance to meet: 1) Minimum length for standard doc (≥2,000 chars). 2) All sections from outline fully written (Document Purpose; Document List and Descriptions; Reading Order and Dependencies). 3) Link rules: descriptive link text, relative paths only, link only to existing files. 4) Mermaid validation: ALL labels in double quotes; no spaces between brackets/braces and quotes; correct arrow syntax using --> and labeled edges as -->|\"Label\"|; no nested quotes; LR orientation preferred. 5) Content specificity: clear purpose, audience, and relationships; no vague statements; avoid technical implementation details. 6) EARS usage not required for ToC but avoid ambiguity. 7) Prohibit API/database specs. 8) Business focus and consistent use of service prefix civicDebateBoard. 9) Include the developer autonomy note exactly as specified at the very end as a single blockquote and nowhere else. 10) Maintain en-US professional tone. 11) No questions to reader. 12) Ensure consistency with provided document list and roles. 13) Do not add documents that do not exist.","content":"# civicDebateBoard Documentation Index and Reading Guide\n\n## Document Purpose\nAuthoritative table of contents for the civicDebateBoard documentation set with concise descriptions, intended audiences, and purposes for every file. Provides a recommended reading order and dependency view so stakeholders can navigate efficiently and understand how each document contributes to the overall system definition.\n\n## Document List and Descriptions\n- [Table of Contents and Reading Guide](./00-toc.md) — Overview of all documents, their purposes, recommended reading order, and cross-dependencies.\n- [Service Vision and Overview](./01-service-vision-and-overview.md) — Vision, scope, objectives, success criteria, and the Business Model (Why the service exists, revenue strategy, growth plan, and success metrics). Audience: business stakeholders.\n- [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Target user pains, market context, competitive landscape, differentiators, risks, and mitigations. Audience: business stakeholders.\n- [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Authenticated roles (member, verifiedMember, factChecker, moderator, admin), role permissions, JWT-based session and token policies, permission matrix, and account lifecycle rules using EARS. Audience: development team.\n- [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Representative personas and end-to-end scenarios (happy paths, edge cases, abuse/misuse) with acceptance criteria in EARS. Audience: product managers.\n- [User Flows and Business Processes](./05-user-flows-and-processes.md) — Step-by-step workflows for posting, commenting, voting, reporting, moderation, appeals, onboarding/verification, and notifications, with Mermaid flow diagrams. Audience: development team.\n- [Functional Requirements Specification](./06-functional-requirements.md) — Functional capabilities, rules, and validations for the discussion board: content relationships, threading, tagging, search/discovery, notifications, bookmarks/follows, localization/timezone handling, and accessibility expectations. Uses EARS extensively with measurable acceptance criteria. Audience: development team.\n- [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Policy principles, prohibited/restricted content, civic discourse safeguards, report intake and prioritization, review SLAs, sanctions, transparency, evidence handling, audit trails, and appeals using EARS. Audience: development team.\n- [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Performance, availability, reliability, capacity/scalability, rate limiting and fair use, observability expectations, backup/DR objectives (RTO/RPO), and internationalization/timezone considerations, using EARS where applicable. Audience: development team.\n- [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Privacy principles and consent, user rights, security expectations, audit and accountability, incident response, breach notification, regulatory compliance, and third-party risk, with EARS-formatted obligations. Audience: development team.\n- [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Revenue strategy options (ads, sponsorships, subscriptions) with ethical guardrails, analytics KPIs and cadence, content quality and community health metrics, moderation/safety metrics, governance for data use, and success review processes. Audience: business stakeholders.\n\n## Reading Order and Dependencies\n\nRecommended sequence builds context progressively and reduces rework:\n\n1. [Service Vision and Overview](./01-service-vision-and-overview.md) — Foundation: vision, scope, and success metrics set direction.\n2. [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Validates problem-solution fit and differentiators.\n3. [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Grounds requirements in real user needs and representative scenarios.\n4. [User Flows and Business Processes](./05-user-flows-and-processes.md) — Converts scenarios into end-to-end business workflows.\n5. [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Defines role models and account lifecycle rules underpinning authorization across flows.\n6. [Functional Requirements Specification](./06-functional-requirements.md) — Consolidates complete functional rules, validations, and acceptance criteria informed by flows and roles.\n7. [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Formalizes community safety policies and enforcement that constrain and inform functional behaviors.\n8. [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Establishes performance, availability, scalability, and operability expectations informed by scope and safety.\n9. [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Defines cross-cutting obligations shaping authentication, data handling, and operational practices.\n10. [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Aligns measurement and monetization with the defined product scope and operating constraints.\n\nHigh-level dependencies among documents:\n\n```mermaid\ngraph LR\n  A[\"01 Service Vision and Overview\"] --> B[\"02 Market Problem and Value Proposition\"]\n  A --> C[\"06 Functional Requirements\"]\n  B --> C\n  D[\"04 User Personas and Scenarios\"] --> E[\"05 User Flows and Processes\"]\n  C --> E\n  F[\"03 User Roles and Authentication\"] --> C\n  F --> G[\"07 Content Moderation and Safety Policies\"]\n  G --> E\n  C --> H[\"08 Non-Functional Requirements and SLAs\"]\n  F --> H\n  I[\"09 Security, Privacy, and Compliance\"] --> F\n  I --> H\n  C --> J[\"10 Business Model and Analytics\"]\n  A --> J\n```\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*","tokenUsage":{"total":68951,"input":{"total":65772,"cached":0},"output":{"total":3179,"reasoning":1472,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":1,"step":0,"created_at":"2025-08-15T02:41:59.944Z"},"tokenUsage":{"aggregate":{"total":332126,"input":{"total":253159,"cached":19328},"output":{"total":78967,"reasoning":27200,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":329304,"input":{"total":250852,"cached":19328},"output":{"total":78452,"reasoning":26816,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Establish the vision, scope, and business model to align all stakeholders before detailing requirements.","filename":"01-service-vision-and-overview.md","documentType":"service-overview","outline":["Executive Summary","Objectives and Success Criteria","Target Users and Use Cases","Service Scope and Boundaries","Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)","Assumptions and Constraints","Out of Scope"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who are the users and what are the core goals?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","02-market-problem-and-value-proposition.md","06-functional-requirements.md","10-business-model-and-analytics.md"],"constraints":["Must include Business Model section with Why/How/What","Use natural language only; avoid technical implementation details"],"content":"# Service Vision and Overview — civicDebateBoard\n\n## Executive Summary\ncivicDebateBoard is a community discussion platform designed to elevate high-quality civic discourse by combining open participation with verifiable expertise, structured fact-checking, and transparent moderation. The service enables members of the public to discuss policy questions, local and national issues, and public-interest topics with contributions from verified domain experts. It integrates role-based participation (member, verifiedMember, factChecker, moderator, admin) and policy-driven safeguards to reduce misinformation, harassment, and low-signal content while preserving free expression and inclusivity.\n\nThe platform addresses three persistent gaps in online civic discussion: (1) low signal-to-noise ratio that undermines productive debate, (2) limited mechanisms to incorporate expertise and evidence in real time, and (3) opaque or inconsistent moderation that erodes trust. By introducing expert verification, structured fact-check annotations, transparent enforcement flows, and measurable service-level expectations, civicDebateBoard aims to deliver a reliable venue for citizens, journalists, researchers, and policymakers to engage constructively.\n\nFor an expanded market context and differentiation narrative, see the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md). Functional details of capabilities and rules are captured in the [Functional Requirements Specification](./06-functional-requirements.md). Business sustainability and measurement strategy are elaborated in the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md). A navigable listing of all documents is available in the [Project Table of Contents](./00-toc.md).\n\n## Objectives and Success Criteria\nThe following objectives are business-outcome focused and expressed with measurable targets. Where applicable, requirements are written using EARS for clarity and testability.\n\n### Strategic Objectives\n- Establish a trusted venue for civic discourse that balances open participation with verifiable information and respectful debate.\n- Promote transparency and accountability in content moderation and fact-checking.\n- Enable sustainable growth via ethical monetization aligned with civic-impact goals.\n\n### Key Results and Targets (12–18 months)\n- Community Health and Quality\n  - Minimum 70% of active discussions include at least one sourced claim or fact-check annotation.\n  - Median moderation turnaround time under 30 minutes for priority-1 (safety) reports and under 4 hours for standard reports during active periods.\n  - Reported content retraction or correction rate above 60% when fact-checks indicate material inaccuracies.\n- Engagement and Reach\n  - Monthly Active Users (MAU) ≥ 100,000 with a 90-day retention rate ≥ 35% for new members.\n  - Verified expert participation in ≥ 20% of high-visibility discussions (top decile by engagement).\n  - Average time-to-first-meaningful-response under 10 minutes on tagged public-interest threads during peak hours.\n- Trust and Transparency\n  - ≥ 95% of enforcement actions accompanied by a machine-readable and human-readable rationale visible to impacted users.\n  - Appeals resolved with written outcomes and references to policy sections in ≥ 95% of cases.\n\n### EARS-Formatted Success Requirements\n- THE platform SHALL support the roles \"member\", \"verifiedMember\", \"factChecker\", \"moderator\", and \"admin\" as the basis for permissions and accountability.\n- WHEN a user reports a post or comment as priority-1 (safety risk), THE platform SHALL surface the item to the moderation queue within 1 minute and SHALL display a receipt to the reporter.\n- WHEN fact-check annotations are submitted with citations, THE platform SHALL attach them to the referenced claim and SHALL present the annotation status as \"proposed\", \"accepted\", or \"contested\".\n- IF content is sanctioned (warning, mute, or suspension), THEN THE platform SHALL notify the content owner with the policy basis, duration, and appeal options.\n- WHERE a discussion is labeled as public-interest or time-sensitive (e.g., election-related), THE platform SHALL elevate review priority and SHALL target a moderation response within 15 minutes during active periods.\n\n## Target Users and Use Cases\ncivicDebateBoard serves multiple user groups, each mapped to a role with distinct responsibilities and privileges in business terms:\n\n- Member (member)\n  - Authenticated participant able to create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules.\n  - Primary use cases: raising civic questions; contributing lived experience; voting and signaling interest; reporting misconduct.\n\n- Verified Member (verifiedMember)\n  - Identity- or expertise-verified participant with elevated trust; can create expert-tagged posts, host “Ask Me Anything” sessions, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while subject to all policies.\n  - Primary use cases: providing qualified analysis; clarifying complex topics; leading structured Q&A; amplifying evidence-backed discourse.\n\n- Fact Checker (factChecker)\n  - Trusted role able to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes. Cannot apply sanctions directly.\n  - Primary use cases: annotating claims; proposing corrections; linking to reputable sources; collaborating with moderators on misinformation.\n\n- Moderator (moderator)\n  - Triages reports, reviews content, applies policy decisions, edits/removes violating content, issues warnings and sanctions, handles appeals within scope, and maintains community health.\n  - Primary use cases: managing queues; enforcing policy; communicating decisions; documenting rationales and evidence trails.\n\n- Administrator (admin)\n  - Manages platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions.\n  - Primary use cases: governance; policy calibration; safety escalation; compliance oversight; strategic partnerships.\n\n### Representative Use Cases\n- Public-interest debate: A member initiates a thread on election policy; verifiedMembers contribute expert context; factCheckers annotate claims; moderators ensure civility and rule compliance.\n- Rapid misinformation response: A viral claim is reported; factCheckers propose annotations with sources; moderators escalate and, if necessary, apply temporary restrictions pending review.\n- Community education: VerifiedMembers host time-bound AMAs; members submit questions; moderation ensures respectful dialogue; post-event, annotations and summaries remain accessible for reference.\n- Policy transparency: A sanctioned user receives a clear rationale with references to the applicable policy section and appeal windows; outcomes are logged and discoverable to the affected user.\n\n## Service Scope and Boundaries\n\n### In Scope (Business Capabilities)\n- Role-based participation mechanisms aligning with the roles defined above.\n- Threaded discussions with posts, comments, reactions, voting, and topic organization (categories/tags).\n- Structured reporting and moderation flows with prioritization and documented rationales.\n- Fact-check lifecycle: submission, review, acceptance/rejection, and visibility on referenced claims.\n- Transparency features including enforcement notices, appeals, and auditability in business terms.\n- Notifications for role-relevant events (e.g., replies, mentions, decisions, fact-check updates).\n- Ethical growth and revenue features (sponsorships, subscriptions) with safety guardrails.\n\n### Boundaries and Operating Principles\n- Civic mission first: content quality and safety take precedence over raw engagement.\n- Evidence-centered: claims are encouraged to be supported by citations; expert contributions are labeled.\n- Transparent enforcement: rationale, duration, and appeal paths accompany sanctions.\n- Inclusivity and accessibility: users can participate regardless of background; language and accessibility needs are respected within community norms.\n\n### High-Level Interaction Flow\n\n```mermaid\ngraph LR\n  subgraph \"Public Participation\"\n    U[\"Members & Verified Members\"] --> P[\"Posts & Comments\"]\n    P --> R[\"Report Content Action\"]\n    P --> N[\"Notifications to Followers\"]\n    P --> T[\"Topic & Category Organization\"]\n  end\n  subgraph \"Quality & Integrity\"\n    V[\"Fact Checkers\"] --> F[\"Fact-Check Annotations\"]\n    F --> P\n    R --> M[\"Moderation Review Queue\"]\n    M --> E[\"Enforcement & Appeals\"]\n  end\n  subgraph \"Governance\"\n    A[\"Administrators\"] --> S[\"Policies, Roles, Settings\"]\n    S -.-> M\n    S -.-> T\n  end\n```\n\n## Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)\n\n### Why This Service Exists\n- Problem: Civic discussion spaces frequently devolve into low-signal debate, misinformation, and harassment, limiting productive engagement and discouraging expert participation.\n- Opportunity: A platform that blends open dialogue with verifiable expertise and structured fact-checking can materially improve discourse quality, trust, and policy literacy.\n- Differentiation: Role-based trust layers (verified experts and fact checkers), transparent enforcement with measurable SLAs, and annotation-first handling of claims distinguish civicDebateBoard from generic forums and social feeds.\n\n### Revenue Strategy\n- Primary: Ethical sponsorships on civic topics with strict conflict-of-interest guardrails and transparency labels.\n- Secondary: Subscription tiers for organizations (e.g., civic groups, newsrooms, universities) to host curated debates, AMAs, or research initiatives with enhanced moderation support.\n- Tertiary: Community memberships offering perks such as topic curation, early access to features, and recognition badges — without pay-to-speak or pay-to-amplify mechanics.\n- Guardrails: No targeted political ads; no pay-for-reach; disclosures for sponsored sessions; clear separation between editorial independence and sponsorship.\n\n### Growth Plan\n- User Acquisition: Partnerships with universities, think tanks, public libraries, NGOs, and local governments; outreach to journalist networks and community organizers; organic growth through high-quality public-interest threads.\n- Activation and Retention: Onboarding flows that encourage citation-backed contributions; scheduled expert sessions; recognition programs for constructive participation and verified expertise.\n- Network Effects: Topic following and notifications; recurring event series; publicly accessible knowledge artifacts (e.g., summarized AMAs, accepted fact-checks) to drive inbound interest.\n\n### Success Metrics and KPIs\n- Reach and Engagement: MAU/DAU, session frequency, average time-to-first-meaningful-response on public-interest threads.\n- Quality and Integrity: Percentage of posts with citations; fact-check turnaround times; proportion of accepted vs. contested annotations; rate of corrected or retracted claims after annotation.\n- Safety and Trust: Moderation SLA adherence, appeals resolution time, user-reported satisfaction with enforcement communications, reduction of repeat violations.\n- Sustainability: Sponsorship revenue distribution by topic (with disclosures), organizational subscription retention, community membership conversion and churn.\n\n## Assumptions and Constraints\n\n### Assumptions\n- User Identity and Roles: Users can be authenticated and associated with one of the defined roles with clear, auditable transitions (e.g., member → verifiedMember).\n- Policy-Driven Operations: Content rules, sanctions, and prioritization are governed by published policy documents that can be updated with appropriate governance.\n- Time Sensitivity: Certain threads (e.g., election or emergency-related) require elevated review priority and faster turnaround compared to standard discussions.\n- International Participation: Users may participate across time zones; business logic will align timestamps to user locale for clarity in communications and notices.\n\n### Constraints\n- Safety Over Virality: Business processes prioritize community safety and integrity ahead of traffic maximization.\n- Transparency Requirement: Enforcement communications include rationale and references to policy sections; appeals produce documented outcomes.\n- Ethical Monetization: Revenue activities cannot undermine discourse independence or safety policies.\n- Privacy and Compliance: Data rights and legal obligations are respected per applicable jurisdictions; security expectations are treated as business obligations.\n\n### EARS-Formatted Operating Constraints\n- THE service SHALL provide human-readable enforcement rationales with policy references for all sanctions.\n- WHERE sponsorship is present, THE service SHALL label sponsored sessions and SHALL disclose sponsor identity to participants.\n- IF a verifiedMember’s expert-tagged post is found materially inaccurate, THEN THE service SHALL require correction or annotation before further amplification.\n- WHILE a discussion is under active appeal, THE service SHALL preserve evidence and SHALL restrict irreversible enforcement until appeal resolution, except where safety risk requires immediate action.\n\n## Out of Scope\nTo maintain focus and ensure coherent delivery, the following items are out of scope for the current vision and planning cycle. These exclusions set expectations for stakeholders and will guide prioritization in downstream requirement documents.\n\n- Frontend UI/UX specifications, visual design systems, and screen layouts.\n- Technical implementation details such as APIs, database schemas, infrastructure choices, or deployment topologies.\n- Paid amplification mechanisms (e.g., pay-for-reach, targeted political ads) and any monetization that could bias civic discourse.\n- Real-time voice/video townhalls; the platform focuses on asynchronous and near-synchronous text-based discourse with notifications.\n- Third-party data brokerage or resale of user data.\n\n---\n\nThis document provides the service vision, scope, and business model in natural language for business stakeholders. Detailed functional capabilities and policies will be specified in the [Functional Requirements Specification](./06-functional-requirements.md) and the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md). Business sustainability and measurement details are further elaborated in the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md), while broader market context is discussed in the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md)."},"plan":"Document type: service-overview for civicDebateBoard\nOutline to satisfy:\n1) Executive Summary\n2) Objectives and Success Criteria\n3) Target Users and Use Cases\n4) Service Scope and Boundaries\n5) Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics) — also include WHAT (business operations/value)\n6) Assumptions and Constraints\n7) Out of Scope\nAudience: business stakeholders. Key questions to answer: Why the service exists and the problem solved; who the users are and core goals; how success is measured. Related docs to reference with descriptive links: 00-toc.md, 02-market-problem-and-value-proposition.md, 06-functional-requirements.md, 10-business-model-and-analytics.md. Constraints: Use natural language only; avoid technical implementation details.\n","review":"Enhance to production-ready business documentation that is clear, complete, and implementation-ready for backend teams while avoiding technical implementation details. Apply these rules:\n- Length: minimum 2,000+ characters for service overview; expand sections fully.\n- EARS: Convert all applicable requirements to EARS with precise, testable statements (use English keywords WHEN/WHILE/IF/THEN/WHERE/THE/SHALL; keep descriptions in en-US).\n- Mermaid: All labels in double quotes; no spaces between brackets/braces and quotes; correct arrows (--> for solid, -.-> dotted, ==> thick); no nested quotes; subgraph titles in double quotes.\n- Content specificity: No vague terms like \"quickly\". Use measurable targets (e.g., minutes, percentages, counts). Focus on business processes, user scenarios, roles/permissions, validations, error handling, and performance expectations in business terms.\n- Business model: Include WHY (problem/opportunity), HOW (revenue strategy), WHAT (business operations/value), growth plan, and success metrics.\n- Prohibited: No APIs, database schemas, or technical architecture. No UI/UX specs. No developer notes except in 00-toc.md. Avoid meta-commentary; write as the final document.\n- Links: Use descriptive link text in en-US with relative paths.\n- Consistency: Maintain service prefix civicDebateBoard and roles [member, verifiedMember, factChecker, moderator, admin].\n- Error handling and transparency: Include user-facing outcomes and transparency rules.\n- Performance expectations: Express response/turnaround expectations in user-experience terms.\n- Maintain natural language; do not prescribe technologies.\n","content":"# Service Vision and Overview — civicDebateBoard\n\n## Executive Summary\ncivicDebateBoard is a mission-driven discussion platform purpose-built for high-quality civic discourse. It combines open participation with verifiable expertise, structured fact-checking, and transparent, policy-led moderation. Members of the public can raise civic questions and debate policy topics; identity- or expertise-verified contributors add qualified analysis; fact checkers annotate claims with sources; moderators enforce policy with documented rationales; and administrators govern platform-wide policies and safeguards.\n\nThe platform addresses three persistent gaps in online civic discussion: (1) low signal-to-noise that impedes constructive debate, (2) weak pathways for in-thread evidence and expertise, and (3) opaque or inconsistent moderation that undermines trust. By introducing role-based trust layers, claim-level fact-check annotations, explicit enforcement rationales, and measurable service-level expectations, civicDebateBoard aims to become a trusted venue for citizens, journalists, researchers, and policymakers to engage responsibly and learn from each other.\n\nContext and complementary materials are available in the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md), the [Functional Requirements Specification](./06-functional-requirements.md), and the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md). A navigable index is provided in the [Documentation Index and Reading Guide](./00-toc.md).\n\n## Objectives and Success Criteria\nStrategic objectives translate into measurable outcomes. Requirements below are expressed with EARS syntax where applicable for clarity and testability.\n\n### Strategic Objectives\n- Establish a trusted environment for evidence-centered civic debate that welcomes diverse participation while elevating verifiable information.\n- Provide clear, consistent, and transparent moderation and fact-check processes, including rationales and appeal mechanisms.\n- Achieve sustainable operations through ethical monetization aligned with civic mission and safety guardrails.\n\n### Key Results and Targets (12–18 months)\n- Community Health and Quality\n  - At least 70% of active discussions contain a sourced claim or a fact-check annotation within 24 hours of first reply.\n  - Median moderation first-action times: ≤ 30 minutes for P1 (safety) during active hours; ≤ 4 hours for standard P2/P3.\n  - Correction adoption rate ≥ 60% for content found materially inaccurate by accepted fact checks.\n- Engagement and Reach\n  - Monthly Active Users (MAU) ≥ 100,000; 90-day retention for new members ≥ 35%.\n  - Verified expert participation in ≥ 20% of high-visibility threads (top decile by engagement).\n  - Average time-to-first-meaningful-response on public-interest threads ≤ 10 minutes during peak hours.\n- Trust and Transparency\n  - ≥ 95% of enforcement actions provide machine-readable and human-readable rationales visible to impacted users.\n  - ≥ 95% of appeals include written outcomes with policy references and are delivered within published SLAs.\n\n### EARS-Formatted Success Requirements\n- THE platform SHALL support roles \"member\", \"verifiedMember\", \"factChecker\", \"moderator\", and \"admin\" as the basis for participation and accountability.\n- WHEN a user submits a P1 (safety) report, THE platform SHALL place the item in the moderation queue within 1 minute and SHALL present a receipt with a reference ID to the reporter.\n- WHEN a fact-check annotation with at least one citation is submitted by a factChecker, THE platform SHALL attach it to the referenced claim and SHALL present the annotation status as \"proposed\", \"accepted\", or \"contested\" to readers.\n- IF content is sanctioned with a warning, mute, or suspension, THEN THE platform SHALL notify the content owner with the policy basis, duration, and appeal options within 1 minute of action.\n- WHERE a thread is labeled as public-interest or time-sensitive (e.g., election-related), THE platform SHALL elevate review priority and SHALL target first-action within 15 minutes during active periods.\n- THE platform SHALL present timestamps, quotas, and durations in the user’s locale and timezone for clarity of notices and sanctions.\n\n## Target Users and Use Cases\nRoles define how users participate and are held accountable in business terms.\n\n- Member (member)\n  - Authenticated participant who can create and manage own posts and comments; react and vote; follow topics; bookmark; report content; and manage account settings under rate limits and policies.\n  - Primary outcomes: raise civic questions; contribute experiences; signal interest via voting; report misconduct with reasoned categories.\n\n- Verified Member (verifiedMember)\n  - Identity- or expertise-verified participant with elevated trust and accountability; can create expert-tagged posts and host structured Q&A sessions.\n  - Primary outcomes: provide qualified analysis; clarify complex topics; cite credible sources; lead high-signal events such as AMAs.\n\n- Fact Checker (factChecker)\n  - Trusted role focused on integrity; can add claim-level annotations with sources, propose corrective labels, and collaborate with moderators; cannot sanction directly.\n  - Primary outcomes: annotate claims; surface evidence; propose corrections; increase information quality.\n\n- Moderator (moderator)\n  - Responsible for triaging reports, reviewing content, applying policy decisions, issuing warnings and sanctions, handling appeals at first level, and maintaining audit trails.\n  - Primary outcomes: enforce policy consistently; meet review SLAs; communicate decisions with policy references.\n\n- Administrator (admin)\n  - Governs policies, categories, tags, role assignments, sanctions configuration, and compliance reviews; performs all moderator actions plus administrative operations.\n  - Primary outcomes: maintain governance; calibrate policies; ensure compliance; approve sensitive operations (e.g., data exports) in line with policy.\n\n### Representative Use Cases\n- Public-interest debate: A member starts a thread on election policy; verifiedMembers provide expert context; factCheckers annotate claims; moderators enforce civility and rules with transparent outcomes.\n- Fast misinformation response: A viral claim is reported; factCheckers propose annotations; moderators apply interim labels and review within accelerated SLAs.\n- Expert Q&A (AMA): A verifiedMember hosts a scheduled session; members submit questions; evidence-backed answers are curated; summaries remain accessible for public reference.\n- Policy transparency in enforcement: A sanctioned user receives a rationale with policy references and appeal windows; rationales are visible to the impacted user and auditable by authorized roles.\n\n## Service Scope and Boundaries\n\n### In Scope (Business Capabilities)\n- Role-based participation aligned to the roles above with calibrated privileges and accountability.\n- Threaded discussions (posts, comments, replies) with reactions and voting; organization by tags, topics, and categories.\n- Reporting and moderation workflows with prioritization, interim actions, rationales, and appeal mechanisms.\n- Fact-check lifecycle: submission, review, acceptance/rejection, and visible annotations on referenced claims.\n- Transparency and audit: policy references with sanctions, appeals outcomes, and role-appropriate audit views.\n- Notifications for replies, mentions, moderation decisions, and fact-check updates, respecting user preferences.\n- Ethical growth and monetization features (e.g., sponsorships, subscriptions) governed by guardrails that protect civic integrity.\n\n### Boundaries and Operating Principles\n- Civic mission first: quality and safety precede raw engagement or virality.\n- Evidence-centered dialogue: claims encouraged to reference credible sources; expert contributions are labeled.\n- Transparent enforcement: actions include rationale, duration, and appeal paths; outcomes follow documented SLAs.\n- Inclusivity and accessibility: participation is encouraged across backgrounds, languages, and abilities, within community norms and policies.\n\n### High-Level Interaction Flow\n```mermaid\ngraph LR\n  subgraph \"Public Participation\"\n    U[\"Members & Verified Members\"] --> P[\"Posts & Comments\"]\n    P --> R[\"Report Content Action\"]\n    P --> N[\"Notifications to Followers\"]\n    P --> T[\"Topic & Category Organization\"]\n  end\n  subgraph \"Quality & Integrity\"\n    V[\"Fact Checkers\"] --> F[\"Fact-Check Annotations\"]\n    F --> P\n    R --> M[\"Moderation Review Queue\"]\n    M --> E[\"Enforcement & Appeals\"]\n  end\n  subgraph \"Governance\"\n    A[\"Administrators\"] --> S[\"Policies, Roles, Settings\"]\n    S -.-> M\n    S -.-> T\n  end\n```\n\n## Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)\n\n### Why This Service Exists\n- Problem: Civic discussion spaces often degrade into low-signal debate, misinformation, and harassment, discouraging participation and expert input.\n- Opportunity: Combining open dialogue with verifiable expertise and structured fact-checking can materially improve discourse quality and civic literacy.\n- Differentiation: Role-based trust layers (verified experts and fact checkers), transparent enforcement with measurable SLAs, and annotation-first handling of claims distinguish civicDebateBoard from generic forums and social feeds.\n\n### Revenue Strategy (How)\n- Primary: Ethical sponsorships of civic topics with strict conflict-of-interest guardrails and clear disclosure labels.\n- Secondary: Organizational subscriptions for curated debates, AMAs, and research initiatives with enhanced moderation support.\n- Tertiary: Community memberships providing perks (topic curation, early access, recognition badges) without pay-to-speak or pay-to-amplify mechanics.\n- Guardrails: No targeted political ads; no pay-for-reach; mandatory sponsorship disclosures; strong separation between editorial independence and sponsorship.\n\n### What This Service Delivers (Business Operations)\n- Evidence-centered civic debate with role accountability and annotated claims.\n- Structured policy and enforcement workflows that provide consistent, explainable outcomes with auditable rationales.\n- Transparent public-interest programming (e.g., expert Q&A series) that remains accessible as a knowledge resource.\n- Ethical monetization that supports the mission without compromising discourse integrity or safety.\n\n### Growth Plan\n- Acquisition: Partnerships with universities, think tanks, public libraries, NGOs, journalist networks, and local governments; organic growth from high-quality public-interest threads and expert programming.\n- Activation and Retention: Onboarding that encourages citation-backed contributions; scheduled expert sessions; recognition programs for constructive participation and verified expertise.\n- Network Effects: Topic following and notifications; recurring event series; durable knowledge artifacts (accepted fact checks, AMA summaries) that drive inbound interest.\n\n### Success Metrics and KPIs\n- Reach and Engagement: MAU/DAU, session frequency, and time-to-first-meaningful-response on public-interest threads.\n- Quality and Integrity: Share of posts with citations; fact-check turnaround; accepted vs. contested annotations; rate of corrected or retracted claims.\n- Safety and Trust: SLA adherence in moderation and appeals; user satisfaction with enforcement communications; reduction in repeat violations.\n- Sustainability: Sponsorship revenue by topic (with disclosures), institutional subscription retention, membership conversion and churn.\n\n## Assumptions and Constraints\n\n### Assumptions\n- Roles and Identity: Users authenticate and can be associated with one or more of the defined roles with auditable transitions (e.g., member → verifiedMember).\n- Policy Governance: Content rules, sanctions, priorities, and appeals are governed by documented policies that can be updated with oversight.\n- Time Sensitivity: Certain threads (e.g., election or emergency-related) require elevated review priority and faster turnaround than standard discussions.\n- International Participation: Users participate across time zones; timestamps and notices align to user locale for clarity.\n\n### Constraints\n- Safety Over Virality: Business processes privilege community safety and integrity over growth tactics that increase harm risk.\n- Transparency Obligation: Enforcement communications must include rationales with policy references; appeals must produce documented outcomes.\n- Ethical Monetization: Revenue activities cannot bias discourse or undermine safety and independence.\n- Privacy and Compliance: Data rights and legal obligations are honored per applicable jurisdictions; security expectations are treated as business obligations.\n\n### EARS-Formatted Operating Constraints\n- THE service SHALL include policy references and human-readable rationales with all sanctions visible to the impacted user.\n- WHERE sponsorship is present, THE service SHALL label sponsored sessions and SHALL disclose sponsor identity to participants in all related surfaces.\n- IF an expert-tagged post by a verifiedMember is found materially inaccurate, THEN THE service SHALL require correction or visible annotation prior to further amplification.\n- WHILE a discussion is under active appeal, THE service SHALL preserve evidence and SHALL restrict irreversible enforcement until appeal resolution except where safety risk requires immediate action.\n- THE service SHALL reserve high-priority triage for public-interest and time-sensitive topics during defined civic windows (e.g., election periods) with accelerated response targets.\n- WHEN notifications are generated for policy decisions or annotations, THE service SHALL deliver them within the published timeframe and SHALL honor user preferences except where notices are mandatory.\n\n## Out of Scope\nTo keep the vision coherent and delivery focused, the following are out of scope in the current planning horizon:\n- Frontend UI/UX specifications, visual design systems, and screen layouts.\n- Technical implementation details such as APIs, database schemas, infrastructure choices, or deployment topologies.\n- Paid amplification mechanisms (pay-for-reach, targeted political ads) or monetization that could bias civic discourse.\n- Real-time voice or video townhalls; the focus is asynchronous and near-synchronous text with notifications.\n- Third-party data brokerage or resale of user data.\n\n---\n\nAll content in this overview expresses business requirements and expectations only; technical implementation decisions (including architecture, APIs, and data models) remain at the discretion of the development team. For deeper market context, consult the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md). For detailed capability rules and validations, consult the [Functional Requirements Specification](./06-functional-requirements.md). For sustainability and measurement details, consult the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md).","tokenUsage":{"total":72649,"input":{"total":67294,"cached":0},"output":{"total":5355,"reasoning":1856,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":2,"step":0,"created_at":"2025-08-15T02:42:32.571Z"},"tokenUsage":{"aggregate":{"total":404775,"input":{"total":320453,"cached":19328},"output":{"total":84322,"reasoning":29056,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":401953,"input":{"total":318146,"cached":19328},"output":{"total":83807,"reasoning":28672,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Establish policy definitions and enforcement processes to protect community safety and discourse quality.","filename":"07-content-moderation-and-safety-policies.md","documentType":"requirement","outline":["Policy Principles and Scope","Prohibited and Restricted Content Categories","Civic Discourse Safeguards (election integrity, misinformation handling)","Report Intake and Prioritization","Review SLAs and Escalation Paths","Sanctions (warnings, mutes, suspensions) and Transparency","Evidence Handling and Audit Trails","Appeals and Restorative Processes","EARS-Formatted Enforcement Requirements"],"audience":"development team","keyQuestions":["What content is allowed, restricted, or prohibited?","How are reports prioritized and reviewed?","What sanctions and transparency obligations exist?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","05-user-flows-and-processes.md","09-security-privacy-and-compliance.md"],"constraints":["Define measurable SLAs and sanctions in business terms","Use EARS for enforceable requirements","Avoid technical details; focus on policy and process"],"content":"# Content Moderation and Safety Policies for civicDebateBoard\n\nThis document defines the business requirements for moderation and safety on civicDebateBoard. It specifies policies, processes, and enforcement standards in natural language for backend implementation. All requirements are written to be specific, measurable, and testable from a business perspective. Technical implementation choices are at the discretion of the development team.\n\n## Policy Principles and Scope\n\n### Guiding Principles\n- Safety First: Protect users from harm, harassment, exploitation, and illegal activity.\n- Civility and Civic Value: Promote constructive, well-sourced debate and discourage manipulation.\n- Fairness and Consistency: Apply policies uniformly with documented rationales.\n- Transparency and Accountability: Provide clear reasons for actions and maintain auditability.\n- Due Process: Offer notice, the ability to appeal, and restorative options where appropriate.\n- Proportionality: Match enforcement severity to violation severity and user history.\n- Context Sensitivity: Consider intent, context, and public-interest value in decisions.\n- Legal Compliance: Respect applicable laws and regulatory obligations across jurisdictions.\n\n### Scope of Application\n- Applies to all user-generated content (UGC), including posts, comments, profile fields, attachments, links, tags, and reactions.\n- Applies to all users and roles: member, verifiedMember, factChecker, moderator, admin.\n- Covers in-product messaging (including automated notices), report handling, content labeling, and sanction workflows.\n- Includes both proactive policy enforcement (e.g., automated pre-flagging) and reactive enforcement (e.g., user reports).\n\n## Prohibited and Restricted Content Categories\n\nThe following categories define allowed, restricted, and prohibited content. Restricted content may require labels, age-gating, contextualization, or limited distribution. Prohibited content requires removal and potential account sanctions.\n\n| Category | Definition (business-level) | Status | Notes and Handling |\n|---------|------------------------------|--------|--------------------|\n| Illegal Content | Content that violates applicable laws (e.g., CSAM, explicit criminal facilitation) | Prohibited | Immediate removal and escalation to admin; emergency escalation for child safety |\n| Child Exploitation | Any sexualization of minors, grooming, or endangerment | Prohibited | Immediate removal; mandatory emergency workflow activation |\n| Terrorism and Extremism | Praise, support, or operational content for designated extremist organizations | Prohibited | Removal; account sanctions; preserve evidence for audit |\n| Hate Speech | Direct attacks on protected classes (e.g., race, religion, gender identity) | Prohibited | Removal; apply strike; consider user intent only for sanction calibration |\n| Harassment & Threats | Targeted harassment, credible threats, doxxing | Prohibited | Removal; escalate for urgent threat assessment |\n| Graphic Violence | Gratuitous gore, celebration of violence | Prohibited | Removal; contextual news value may allow limited exceptions with labels |\n| Non-Consensual Intimate Imagery | Sharing sexual/explicit imagery without consent | Prohibited | Removal; immediate account suspension pending review |\n| Privacy Violations (Doxxing) | Publishing private identifying information without consent | Prohibited | Removal; evaluate imminent harm risk |\n| Self-Harm and Suicide Promotion | Encouraging self-harm or suicide | Prohibited | Removal; provide crisis resources; limited supportive discussion allowed |\n| Misinformation with Imminent Harm | False claims likely to cause real-world harm (health, safety, civic process integrity) | Restricted/Prohibited | Label, reduce distribution, or remove depending on harm assessment |\n| Election Integrity Violations | Coordinated voter suppression, false voting logistics | Prohibited | Removal; high-priority escalation during election windows |\n| Medical Misinformation | Provably false medical claims contradicting leading public health bodies | Restricted | Label and reduce distribution; removal if imminently harmful |\n| Spam and Scams | Mass unsolicited content, phishing, financial scams | Prohibited | Removal; apply automated cool-down and strikes |\n| Platform Manipulation | Coordinated inauthentic behavior, astroturfing, vote brigading | Prohibited | Removal; deamplify; investigate account networks |\n| Copyright and Plagiarism | Unauthorized reproduction of copyrighted material | Restricted/Prohibited | Takedown upon valid notice; repeat infringement may trigger suspension |\n| Adult Sexual Content | Explicit adult content | Restricted | Age-gate, label, and limit distribution; adhere to jurisdictional rules |\n| Sensitive Media | Disturbing content with public interest value (e.g., war reporting) | Restricted | Allow with strong labels and click-through warnings |\n| Profanity and Rude Behavior | Non-targeted profanity | Allowed/Restricted | Allowed unless targeted; repeated abuse leads to moderation actions |\n| Off-Topic/Low-Quality | Content not aligned with civicDebateBoard’s civic discourse goals | Restricted | Downrank or move; removal for repeated abuse |\n\nBusiness notes:\n- Context exceptions can be applied for news reporting, educational content, or public-interest documentation when accompanied by contextualization and labels.\n- Verified sources and citations may reduce enforcement severity but not override prohibitions.\n\n## Civic Discourse Safeguards (Election Integrity and Misinformation Handling)\n\n### Core Safeguards\n- Election Windows: Elevated protections start 90 days before and end 14 days after scheduled elections relevant to the user’s locale.\n- Claim Typology: Distinguish between verifiable factual claims and opinion/analysis. Apply fact-check annotations to factual claims.\n- Source Citation: Encourage references to credible sources for significant civic claims.\n- Distribution Controls: Reduce distribution of labeled misinformation and prevent it from trending or being recommended.\n- Entity Disclosure: Label accounts with declared affiliations to campaigns, governments, or NGOs when such disclosure is provided or verified.\n\n### Fact-Checking and Annotations\n- factChecker Role: May add claim-level annotations, ratings (e.g., true/misleading/unfounded), and source citations; cannot impose sanctions.\n- Moderator Review: Moderators may apply labels, reduce distribution, or remove content based on harm assessment and policy fit.\n- User Notification: Authors receive notices when annotations or labels are applied, including reasons and sources.\n\n## Report Intake and Prioritization\n\n### Intake Channels and Metadata\n- In-line Content Reports: Users can report from content context with category selection and optional notes.\n- Out-of-Content Reports: Users can report user profiles or messages via dedicated reporting entry.\n- System Flags: Automated signals (e.g., burst activity, new-account behavior) generate reports.\n- Trusted Partner Reports: Pre-vetted organizations may submit high-priority notices for certain categories (e.g., election integrity, child safety).\n\n### Prioritization Rubric\n- Severity Tiers:\n  - Critical (P0): Child safety, credible violent threats, voter suppression, non-consensual intimate imagery.\n  - High (P1): Hate speech, doxxing, terrorism support, imminent harm misinformation.\n  - Medium (P2): Harassment, platform manipulation, medical misinformation without imminent harm, copyright takedown notices.\n  - Low (P3): Spam, off-topic, profanity, low-quality content.\n- Reporter Trust Weighting: Reports from verifiedMember, factChecker, moderator, and trusted partners receive elevated priority.\n- Recency and Velocity: Recent posts with high engagement escalate within the same tier.\n- Duplicate Report Merging: Multiple reports for the same item are aggregated.\n\n### Triage Workflow (Business-Level)\n\n```mermaid\ngraph LR\n  subgraph \"Report Intake\"\n    A[\"User/System Submits Report\"] --> B[\"Capture Metadata(Category, Notes, Reporter Role)\"]\n    B --> C[\"Assign Severity Tier(P0-P3)\"]\n  end\n  subgraph \"Queueing\"\n    C --> D[\"Merge Duplicates\"]\n    D --> E[\"Apply Priority Weighting\"]\n  end\n  subgraph \"Review\"\n    E --> F{\"Harm Likely?\"}\n    F -->|\"Yes\"| G[\"Fast-Track to Moderator\"]\n    F -->|\"No\"| H[\"Standard Queue\"]\n  end\n  G --> I[\"Immediate Interim Action(Label/Hide)\"]\n  H --> I\n  I --> J[\"Assignment to Reviewer\"]\n```\n\n## Review SLAs and Escalation Paths\n\n### Service-Level Objectives (business expectations)\n- Working Hours Assumption: Reviews are processed continuously.\n- Elevated Periods: During election windows and declared crises, apply faster SLAs.\n\n| Severity | First Action Deadline (from report) | Final Decision Deadline | Escalation Trigger |\n|----------|-------------------------------------|-------------------------|--------------------|\n| P0 Critical | 15 minutes | 2 hours | Immediate escalation to senior moderator; admin if law risk |\n| P1 High | 1 hour | 12 hours | Escalate if backlog exceeds 1 hour or repeated violations |\n| P2 Medium | 6 hours | 48 hours | Escalate if item trends or duplicates exceed 10 |\n| P3 Low | 24 hours | 5 days | Escalate if duplicates exceed 25 or author has 3+ recent strikes |\n| Election Window P0 | 10 minutes | 1 hour | Auto-notify admin and factChecker group |\n\n### Escalation Paths (business logic)\n- Moderator to Senior Moderator: Triggered by severity thresholds, legal sensitivity, or repeated violations.\n- Senior Moderator to Admin: Triggered by legal obligations, public-interest exceptions, government requests, or platform-wide risk.\n- Emergency Referral: Child safety or credible threats to life follow emergency process with immediate action and post-facto review.\n\n## Sanctions and Transparency\n\n### Sanction Types and Durations\n\n| Sanction | Description | Default Duration | Applicability |\n|----------|-------------|------------------|---------------|\n| Content Removal | Remove violating content | Permanent | All categories where prohibited |\n| Warning | Formal notice for minor or first-time violations | N/A | P2-P3 violations |\n| Labeling | Add context labels or fact-check notes | Until resolved or updated | Misinformation, sensitive media |\n| Limited Participation | Reduce posting/commenting cadence (cool-down) | 24-72 hours | Harassment, spam, low-quality |\n| Temporary Mute | Block posting/commenting | 24 hours to 14 days | Repeated harassment, hate speech |\n| Shadow Deamplification | Reduce distribution without blocking access | 7-30 days | Manipulation, low-quality |\n| Temporary Suspension | Disable account access | 7-30 days | Severe or repeated violations |\n| Permanent Ban | Terminate account | Permanent | CSAM, extremism, chronic abuse |\n\nStrike Policy (business rules):\n- First serious violation (P1-P0): Temporary mute or suspension plus content removal.\n- Three-strike escalation: Three P1 violations within 90 days lead to 30-day suspension; any P0 triggers immediate permanent ban review.\n- Strike Decay: Strikes older than 180 days do not count toward automatic escalations.\n\n### Role-Based Authority\n- moderator: May remove content, issue warnings, apply labels, impose limited participation, apply temporary mutes and temporary suspensions up to 14 days, and escalate to admin.\n- admin: May perform all moderator actions plus impose suspensions up to permanent ban, configure sanction policies, and approve exceptions.\n- factChecker: May add annotations and propose labels; cannot apply sanctions.\n- verifiedMember and member: May report content and appeal sanctions on their own content.\n\n### Transparency and User Notice\n- Action Notices: Users receive a clear reason, policy category, evidence summary, and appeal option with deadlines.\n- Public Transparency Log: Anonymized aggregate statistics published periodically (counts by category, sanction type, resolution time) without exposing personal data.\n\n## Evidence Handling and Audit Trails\n\n- Evidence Capture: Preserve the exact content, timestamps, author identifiers, reporter role, and context pointers at the moment of report or enforcement.\n- Chain of Custody: Record each handling step with actor role, action type, timestamp, and rationale.\n- Retention: Keep evidence for at least 365 days from final resolution, or longer if required by law or active appeal.\n- Access Control: Restrict evidence access to moderators and admins; factCheckers may view content context when assessing claims but not sensitive personal data.\n- Redaction: Redact personal identifiers from shared case summaries outside the moderation team.\n\n## Appeals and Restorative Processes\n\n- Appeal Window: Users can appeal within 14 days of notice for most sanctions; 7 days for election-related actions.\n- Independent Review: Appeals are handled by a different moderator than the original reviewer; admins review permanent ban appeals.\n- Restorative Options: For non-severe cases, users may complete educational prompts or edit content to reinstate visibility.\n- Outcome Notifications: Provide clear decisions with updated rationales and references to policy categories.\n- Rate Limits: Limit to one appeal per decision unless new evidence emerges.\n\n### Appeals Workflow (Business-Level)\n\n```mermaid\ngraph LR\n  subgraph \"Appeal Submission\"\n    A[\"User Submits Appeal\"] --> B[\"Validate Eligibility(Window, Single Appeal)\"]\n  end\n  subgraph \"Review and Decision\"\n    B --> C[\"Assign Different Reviewer\"]\n    C --> D{\"Uphold or Overturn?\"}\n  end\n  D -->|\"Uphold\"| E[\"Notify User and Maintain Sanction\"]\n  D -->|\"Overturn\"| F[\"Reinstate Content/Access and Clear Strike\"]\n  E --> G[\"Log Outcome in Audit Trail\"]\n  F --> G\n```\n\n## EARS-Formatted Enforcement Requirements\n\n### General Policy Application\n- THE moderation system SHALL apply the most severe applicable policy category when multiple categories are triggered by the same content.\n- THE moderation system SHALL preserve a snapshot of content and metadata at the time of report and at the time of enforcement.\n- THE moderation system SHALL record actor role, action, timestamp, and rationale for every enforcement action.\n\n### Reporting and Intake\n- WHEN a user submits a report with a selected category, THE moderation system SHALL capture category, free-text notes up to 1,000 characters, reporter role, and timestamp.\n- WHEN duplicate reports target the same content, THE moderation system SHALL merge them into a single case while preserving reporter counts and roles.\n- WHERE the reporter is a trusted partner or factChecker, THE moderation system SHALL assign at least P1 priority unless the content already has P0 triggers.\n- WHILE content is under review for P0 or P1, THE moderation system SHALL prevent the content from appearing in recommendations and trending lists.\n\n### Prioritization and SLAs\n- WHEN a report is categorized as P0, THE moderation system SHALL present it to a moderator within 15 minutes and record the presentation timestamp.\n- WHEN a report is categorized as P1, THE moderation system SHALL present it to a moderator within 1 hour.\n- WHEN a report is categorized as P2, THE moderation system SHALL present it to a moderator within 6 hours.\n- WHEN a report is categorized as P3, THE moderation system SHALL present it to a moderator within 24 hours.\n- WHILE under an election window, THE moderation system SHALL apply the Election Window SLA table to P0 items.\n\n### Interim Actions and Labels\n- WHEN harm assessment is pending for P0 or P1, THE moderation system SHALL allow moderators to apply interim actions: temporary hide, label, or limit distribution, with rationale capture.\n- WHERE content is labeled as misinformation, THE moderation system SHALL show fact-check annotations and reduce distribution for the labeled item until updated or removed.\n\n### Sanctions and Strikes\n- WHEN content is removed for a Prohibited category, THE moderation system SHALL add one strike to the author’s account with category and date.\n- WHERE a user accrues three P1 strikes within 90 days, THE moderation system SHALL apply a 30-day suspension.\n- IF a P0 violation is confirmed, THEN THE moderation system SHALL disable the account pending admin review for permanent ban.\n- WHERE a strike becomes older than 180 days, THE moderation system SHALL exclude it from automatic escalation calculations.\n- WHEN a warning is issued, THE moderation system SHALL record it without adding a strike.\n\n### Role-Based Permissions\n- WHERE the actor role is moderator, THE moderation system SHALL permit content removal, warnings, labels, limited participation, mutes up to 14 days, and suspensions up to 14 days.\n- WHERE the actor role is admin, THE moderation system SHALL permit permanent bans and configuration of sanction durations and policies.\n- WHERE the actor role is factChecker, THE moderation system SHALL permit creating annotations and proposing labels but SHALL prohibit sanctions.\n\n### Transparency and Notices\n- WHEN an enforcement action is applied, THE moderation system SHALL notify the author with the policy category, a concise explanation up to 500 characters, evidence summary reference, and appeal deadline.\n- WHEN a label is applied to content, THE moderation system SHALL notify the author and provide sources used for labeling.\n- WHERE a public transparency report is generated, THE moderation system SHALL include counts by category, average time to first action, and appeal outcomes by month.\n\n### Evidence and Audit\n- WHEN evidence is captured, THE moderation system SHALL store the snapshot alongside case identifiers and prevent edits.\n- WHERE a case is accessed by a reviewer, THE moderation system SHALL log the access with role and purpose.\n- IF an appeal overturns a decision, THEN THE moderation system SHALL link the new decision to the original case and mark the original rationale as superseded.\n\n### Appeals and Restorative Processes\n- WHEN a user appeals within the allowed window, THE moderation system SHALL route the case to a different reviewer.\n- WHERE a decision is upheld, THE moderation system SHALL allow exactly one appeal per decision unless new evidence is attached.\n- WHERE a restorative option is offered, THE moderation system SHALL reinstate content visibility upon completion or compliant edits.\n\n### Civic Safeguards\n- WHEN election-related misinformation is detected, THE moderation system SHALL apply the election SLA and prioritize review over non-election P1 items.\n- WHERE an account self-identifies as part of a political campaign, THE moderation system SHALL display affiliation labels on posts and profile per disclosure data.\n- WHEN a factChecker publishes an annotation on a claim, THE moderation system SHALL notify moderators and reduce distribution for the annotated item until reviewed.\n\n## Appendices\n\n### Definitions (Business-Level)\n- Strike: Recorded violation event tied to policy category, used for escalation rules.\n- Label: Notice attached to content to provide context (e.g., fact-check, sensitive media).\n- Limited Participation: Temporary reduction in a user’s ability to post or comment.\n- Election Window: The period with elevated protections around elections.\n\n### Severity Rubric (Condensed)\n- P0: Imminent harm or illegal content; requires immediate action.\n- P1: Severe policy violations with significant harm risk.\n- P2: Clear violations without imminent harm.\n- P3: Minor or contextual issues; often educational response.\n\n### Related Documents\n- Refer to the [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) for role definitions and session behaviors.\n- Refer to the [User Flows and Processes Guide](./05-user-flows-and-processes.md) for end-to-end business workflows.\n- Refer to the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for privacy, security, and legal obligations.\n"},"plan":"Use the provided outline as the backbone: 1) Policy Principles and Scope; 2) Prohibited and Restricted Content Categories; 3) Civic Discourse Safeguards; 4) Report Intake and Prioritization; 5) Review SLAs and Escalation Paths; 6) Sanctions and Transparency; 7) Evidence Handling and Audit Trails; 8) Appeals and Restorative Processes; 9) EARS-Formatted Enforcement Requirements. Expand with sub-sections: Moderator Conduct and Recusal; False-Report and Reporter Abuse Handling; Special Procedures (Child Safety, Credible Threats); Sanction Ladder by Violation; Policy Versioning and Change Management; User-Facing Error and Recovery Scenarios. Include additional Mermaid diagrams where helpful.","review":"Enhance to a production-ready, implementation-focused business requirements document. Enforce: minimum 5,000+ characters; complete coverage of all outline sections; EARS format for all enforceable requirements; specific, measurable SLAs and sanction rules; robust error-handling and user recovery steps; comprehensive role-based permissions; no APIs/DB schemas; correct Mermaid syntax with double-quoted labels, no bracket/quote spaces, correct arrows. Ensure links use descriptive titles. Remove meta-language like “This document…”. Add missing workflows (false-report handling, conflict-of-interest recusal, policy change governance, emergency categories), tables (sanction ladders by category), and extra EARS requirements for transparency logs, restorative actions, and reporter abuse. Keep language en-US; focus on business logic only.","content":"# Content Moderation and Safety Policies for civicDebateBoard\n\n## Policy Principles and Scope\n\n### Guiding Principles\n- Safety First: Protect users from harm, harassment, exploitation, and illegal activity.\n- Civility and Civic Value: Promote constructive, well-sourced debate and discourage manipulation.\n- Fairness and Consistency: Apply policies uniformly with documented rationales.\n- Transparency and Accountability: Provide clear reasons for actions and maintain auditability.\n- Due Process: Offer notice, the ability to appeal, and restorative options where appropriate.\n- Proportionality: Match enforcement severity to violation severity and user history.\n- Context Sensitivity: Consider intent, context, public-interest value, educational or newsworthiness exceptions.\n- Legal Compliance: Respect applicable laws and regulatory obligations across jurisdictions.\n\n### Scope of Application\n- Applies to all user-generated content (UGC): posts, comments, profile fields, attachments, links, tags, reactions, and account metadata disclosures.\n- Applies to all roles: member, verifiedMember, factChecker, moderator, admin.\n- Covers policy enforcement, user reporting, labeling and annotations, sanctions, transparency notices, appeals, audit trails, and emergency escalations.\n- Includes both proactive enforcement (e.g., automated pre-flagging) and reactive enforcement (e.g., user and partner reports).\n\n### Moderator Conduct and Recusal\n- Conflict of Interest: Moderators must recuse themselves from cases where impartiality may be compromised (e.g., personal relationships, prior disputes, organizational affiliations).\n- Professional Conduct: Decisions must reference policy categories, document rationales, and avoid personal or ideological commentary.\n- Independence of Appeals: Appeals must be reviewed by a different moderator or an admin for permanent bans.\n\n## Prohibited and Restricted Content Categories\n\nRestricted content requires labels, contextualization, age-gating, or limited distribution. Prohibited content requires removal and potential account sanctions. Context exceptions may apply for news reporting, educational materials, or public-interest documentation where clearly labeled and accompanied by context.\n\n| Category | Definition (business-level) | Status | Notes and Handling |\n|---------|------------------------------|--------|--------------------|\n| Illegal Content | Content that violates applicable laws (e.g., CSAM, explicit criminal facilitation) | Prohibited | Immediate removal and admin escalation; emergency escalation for child safety |\n| Child Exploitation | Any sexualization of minors, grooming, endangerment | Prohibited | Immediate removal; immediate emergency workflow activation and evidence preservation |\n| Terrorism and Extremism | Praise/support of designated extremist orgs or operational content | Prohibited | Removal; account sanctions; preserve evidence; consider law-enforcement referral |\n| Hate Speech | Direct attacks on protected classes (race, religion, gender identity, etc.) | Prohibited | Removal; strikes and sanctions calibrated by severity and context |\n| Harassment & Threats | Targeted harassment, credible threats, stalking, doxxing | Prohibited | Removal; urgent threat assessment and escalations |\n| Graphic Violence | Gratuitous gore or celebration of violence | Prohibited | Removal; limited exceptions for news or human-rights documentation with labels |\n| Non-Consensual Intimate Imagery | Sexual/explicit imagery shared without consent | Prohibited | Removal; immediate account suspension pending review |\n| Privacy Violations (Doxxing) | Publishing private identifying information without consent | Prohibited | Removal; evaluate imminent harm; rapid action |\n| Self-Harm and Suicide Promotion | Encouraging self-harm or suicide | Prohibited | Removal; provide crisis resources; supportive discussion allowed with guardrails |\n| Misinformation with Imminent Harm | False claims likely to cause real-world harm (health, safety, civic process) | Restricted/Prohibited | Label/reduce distribution or remove depending on harm/risk assessment |\n| Election Integrity Violations | Coordinated voter suppression, false voting logistics | Prohibited | Removal; high-priority escalation during election windows |\n| Medical Misinformation | Provably false medical claims contradicting leading public health bodies | Restricted | Label and reduce distribution; removal if imminently harmful |\n| Spam and Scams | Mass unsolicited content, phishing, financial scams | Prohibited | Removal; apply automated cool-down and strikes |\n| Platform Manipulation | Coordinated inauthentic behavior, astroturfing, vote brigading | Prohibited | Removal; deamplify; investigate related accounts |\n| Impersonation and Deceptive Identity | Misrepresenting identity or affiliation, deepfake impersonations | Restricted/Prohibited | Label or remove; require disclosure; sanction repeat abuse |\n| Copyright and Plagiarism | Unauthorized reproduction of copyrighted material | Restricted/Prohibited | Remove upon valid notice; repeat infringement may trigger suspension |\n| Adult Sexual Content | Explicit adult content | Restricted | Age-gate, label, and limit distribution; follow jurisdictional rules |\n| Sensitive Media | Disturbing but newsworthy content (e.g., war reporting) | Restricted | Allow with strong labels and click-through warnings |\n| Profanity and Rude Behavior | Non-targeted profanity | Allowed/Restricted | Allowed unless targeted; repeated abuse may trigger actions |\n| Off-Topic/Low-Quality | Content misaligned with civicDebateBoard’s civic discourse goals | Restricted | Downrank or move; removal after repeated abuse |\n| Synthetic/Manipulated Media | Materially deceptive edits without disclosure | Restricted/Prohibited | Require disclosure labels; remove where it causes imminent harm |\n\n### Category-Specific Handling Examples (Business)\n- Non-consensual intimate imagery: Fast-track to P0 with immediate content removal and temporary account disable pending review.\n- Election-related false logistics (e.g., wrong voting date): P0 during election windows; remove and apply strikes; add corrective banner when appropriate.\n- Newsworthy graphic content (e.g., war crimes documentation): Allow with strong interstitial labels and age-gating; limit distribution.\n\n## Civic Discourse Safeguards (Election Integrity and Misinformation Handling)\n\n### Core Safeguards\n- Election Windows: Elevated protections start 90 days before and end 14 days after scheduled elections relevant to the user’s locale.\n- Claim Typology: Distinguish factual claims from opinion/analysis; apply annotations only on factual claims.\n- Source Citation: Encourage references to credible sources for significant civic claims and expert-tagged posts.\n- Distribution Controls: Reduce distribution of labeled misinformation, prevent trending and recommendations, and consider comment limits for high-risk items.\n- Entity Disclosure: Label accounts that disclose affiliations to campaigns, governments, or NGOs; require disclosure for official spokespeople.\n\n### Fact-Checking and Annotations\n- factChecker Role: Add claim-level annotations, ratings (true/misleading/unfounded/needs context), and citations; cannot sanction directly.\n- Moderator Review: Apply labels, reduce distribution, or remove content based on harm assessment and policy fit; require citation alignment.\n- Author and Reader Notice: Notify authors upon annotation/labeling; show concise summaries with links to sources for readers.\n\n## Report Intake and Prioritization\n\n### Intake Channels and Metadata\n- In-line Content Reports: Reporting from content context with category selection and optional notes.\n- Out-of-Content Reports: Reports on profiles/messages via dedicated reporting entry.\n- System Flags: Automated signals (burst activity, new-account patterns) that generate reports.\n- Trusted Partner Reports: Pre-vetted organizations submitting high-priority notices for categories such as election integrity and child safety.\n\n### False-Report and Reporter Abuse Handling\n- Bad-Faith Reporting: Repeated inaccurate or harassing reports are a form of abuse.\n- Reporter Reputation: Reporter accuracy is tracked to weight prioritization; chronic abusers may face limits.\n\n### Prioritization Rubric\n- Severity Tiers:\n  - Critical (P0): Child safety, credible violent threats, voter suppression, non-consensual intimate imagery.\n  - High (P1): Hate speech, doxxing, terrorism support, imminent-harm misinformation.\n  - Medium (P2): Harassment, platform manipulation, medical misinformation without imminent harm, copyright notices.\n  - Low (P3): Spam, off-topic, profanity, low-quality content.\n- Reporter Trust Weighting: Reports by verifiedMember, factChecker, moderator, and trusted partners receive elevated priority.\n- Recency/Velocity: Recent posts with high engagement escalate within tier.\n- Duplicate Report Merging: Multiple reports for the same item are aggregated; unique reporter count influences priority.\n\n### Triage Workflow (Business-Level)\n```mermaid\ngraph LR\n  subgraph \"Report Intake\"\n    A[\"User/System Submits Report\"] --> B[\"Capture Metadata(Category, Notes, Reporter Role)\"]\n    B --> C[\"Assign Severity Tier(P0-P3)\"]\n  end\n  subgraph \"Queueing\"\n    C --> D[\"Merge Duplicates\"]\n    D --> E[\"Apply Priority Weighting\"]\n  end\n  subgraph \"Review\"\n    E --> F{\"Harm Likely?\"}\n    F -->|\"Yes\"| G[\"Fast-Track to Moderator\"]\n    F -->|\"No\"| H[\"Standard Queue\"]\n  end\n  G --> I[\"Immediate Interim Action(Label/Hide)\"]\n  H --> I\n  I --> J[\"Assignment to Reviewer\"]\n```\n\n## Review SLAs and Escalation Paths\n\n### Service-Level Objectives (business expectations)\n- Continuous review operations with enhanced responsiveness during civic or emergency periods.\n\n| Severity | First Action Deadline (from report) | Final Decision Deadline | Escalation Trigger |\n|----------|-------------------------------------|-------------------------|--------------------|\n| P0 Critical | 15 minutes | 2 hours | Immediate escalation to senior moderator; admin if legal risk or ongoing harm |\n| P1 High | 1 hour | 12 hours | Escalate if backlog > 1 hour or repeat violations |\n| P2 Medium | 6 hours | 48 hours | Escalate if trending or duplicates exceed 10 |\n| P3 Low | 24 hours | 5 days | Escalate if duplicates exceed 25 or author has 3+ recent strikes |\n| Election Window P0 | 10 minutes | 1 hour | Auto-notify admin and factChecker group |\n\n### Escalation Paths (business logic)\n- Moderator → Senior Moderator: Triggered by severity thresholds, legal sensitivity, repeated violations, or conflict of interest.\n- Senior Moderator → Admin: Triggered by legal obligations, public-interest exceptions, government requests, or platform-wide risk.\n- Emergency Referral: Child safety or credible threats to life follow emergency process with immediate action and post-facto review.\n- Legal Requests: Potential law-enforcement requests are logged and handled by admins consistent with compliance requirements.\n\n## Sanctions and Transparency\n\n### Sanction Types and Durations\n\n| Sanction | Description | Default Duration | Applicability |\n|----------|-------------|------------------|---------------|\n| Content Removal | Remove violating content | Permanent | All prohibited categories |\n| Warning | Formal notice for minor or first-time violations | N/A | P2–P3 violations |\n| Labeling | Add context labels or fact-check notes | Until resolved/updated | Misinformation, sensitive media |\n| Limited Participation | Reduce posting/comment cadence (cool-down) | 24–72 hours | Harassment, spam, low-quality |\n| Temporary Mute | Block posting/commenting | 24 hours to 14 days | Repeated harassment, hate speech |\n| Shadow Deamplification | Reduce distribution without blocking access | 7–30 days | Manipulation, low-quality |\n| Temporary Suspension | Disable account access | 7–30 days | Severe or repeated violations |\n| Permanent Ban | Terminate account | Permanent | CSAM, extremism, chronic abuse |\n\n### Sanction Ladder by Category (Default Calibration)\n\n| Category Group | First Confirmed Violation | Second Within 90 Days | Third Within 90 Days |\n|----------------|---------------------------|-----------------------|----------------------|\n| P3 Minor (spam, low-quality, profanity) | Warning or limited participation(24h) | Limited participation(72h) | Temporary mute(24–72h) |\n| P2 Moderate (harassment non-targeted, copyright on notice) | Content removal + warning | Temporary mute(24–72h) | Temporary suspension(7d) |\n| P1 Severe (hate speech, doxxing, extremism support non-operational) | Content removal + temporary suspension(7–14d) | Suspension(14–30d) + strike | Suspension(30d) + ban review |\n| P0 Critical (child safety, non-consensual intimate imagery, credible threats, voter suppression) | Immediate disable + ban review | Permanent ban | Permanent ban |\n\nStrike Policy\n- Three-strike escalation: Three P1 violations within 90 days lead to 30-day suspension; any confirmed P0 triggers immediate permanent ban review.\n- Strike Decay: Strikes older than 180 days are excluded from automatic escalations.\n\n### Role-Based Authority\n- moderator: Remove content, issue warnings, apply labels, impose limited participation, apply temporary mutes/suspensions up to 14 days, and escalate to admin.\n- admin: All moderator actions plus suspensions up to permanent ban, policy configuration, and exception approvals.\n- factChecker: Add annotations and propose labels; cannot apply sanctions.\n- verifiedMember and member: Report content and appeal sanctions on their own content.\n\n### Transparency and User Notice\n- Action Notices: Clear reason, policy category, evidence summary, and appeal option with deadlines.\n- Public Transparency Log: Anonymized aggregate statistics published periodically (counts by category, sanction type, resolution time) without exposing personal data.\n- Remediation Guidance: Provide corrective steps where appropriate (e.g., edit with context, cite sources).\n\n## Evidence Handling and Audit Trails\n\n- Evidence Capture: Preserve exact content, timestamps, author identifiers, reporter role, and context pointers at report and enforcement times.\n- Chain of Custody: Record each handling step with actor role, action type, timestamp, and rationale.\n- Retention: Keep evidence for at least 365 days from final resolution, or longer if required by law or active appeal.\n- Access Control: Restrict evidence access to moderators and admins; factCheckers may view content context for annotations but not sensitive personal data.\n- Redaction: Redact personal identifiers from case summaries shared beyond the moderation team.\n\n## Appeals and Restorative Processes\n\n- Appeal Window: 14 days for most sanctions; 7 days for election-related actions.\n- Independent Review: By a reviewer different from the original decision-maker; admins review permanent-ban appeals.\n- Restorative Options: Educational prompts, edits, or contextualization to reinstate visibility when policy allows.\n- Outcome Notifications: Clear decisions with updated rationales and references to policy categories.\n- Rate Limits: One appeal per decision unless new evidence emerges.\n\n### Appeals Workflow (Business-Level)\n```mermaid\ngraph LR\n  subgraph \"Appeal Submission\"\n    A[\"User Submits Appeal\"] --> B[\"Validate Eligibility(Window, Single Appeal)\"]\n  end\n  subgraph \"Review and Decision\"\n    B --> C[\"Assign Different Reviewer\"]\n    C --> D{\"Uphold or Overturn?\"}\n  end\n  D -->|\"Uphold\"| E[\"Notify User and Maintain Sanction\"]\n  D -->|\"Overturn\"| F[\"Reinstate Content/Access and Clear Strike\"]\n  E --> G[\"Log Outcome in Audit Trail\"]\n  F --> G\n```\n\n## EARS-Formatted Enforcement Requirements\n\n### General Policy Application\n- THE moderation system SHALL apply the most severe applicable policy category when multiple categories are triggered by the same content.\n- THE moderation system SHALL preserve a snapshot of content and metadata at the time of report and at the time of enforcement.\n- THE moderation system SHALL record actor role, action, timestamp, and rationale for every enforcement action.\n\n### Reporting and Intake\n- WHEN a user submits a report with a selected category, THE moderation system SHALL capture category, free-text notes up to 1,000 characters, reporter role, and timestamp.\n- WHEN duplicate reports target the same content, THE moderation system SHALL merge them into a single case while preserving reporter counts and roles.\n- WHERE the reporter is a trusted partner or factChecker, THE moderation system SHALL assign at least P1 priority unless the content already has P0 triggers.\n- WHILE content is under review for P0 or P1, THE moderation system SHALL prevent the content from appearing in recommendations and trending lists.\n- WHERE a reporter’s recent accuracy rate falls below 20% over 30 days, THE moderation system SHALL downgrade the reporter’s prioritization weight and may apply reporting cooldowns.\n- IF a reporter submits harassing or fraudulent reports repeatedly (≥ 5 invalid reports within 7 days), THEN THE moderation system SHALL impose a reporting cooldown of at least 72 hours and SHALL record a strike against reporter abuse.\n\n### Prioritization and SLAs\n- WHEN a report is categorized as P0, THE moderation system SHALL present it to a moderator within 15 minutes and record the presentation timestamp.\n- WHEN a report is categorized as P1, THE moderation system SHALL present it to a moderator within 1 hour.\n- WHEN a report is categorized as P2, THE moderation system SHALL present it to a moderator within 6 hours.\n- WHEN a report is categorized as P3, THE moderation system SHALL present it to a moderator within 24 hours.\n- WHILE under an election window, THE moderation system SHALL apply the Election Window SLA table to P0 items.\n\n### Interim Actions and Labels\n- WHEN harm assessment is pending for P0 or P1, THE moderation system SHALL allow moderators to apply interim actions: temporary hide, label, or limit distribution, with rationale capture.\n- WHERE content is labeled as misinformation, THE moderation system SHALL show fact-check annotations and reduce distribution for the labeled item until updated or removed.\n- WHERE synthetic/manipulated media lacks disclosure, THE moderation system SHALL apply a disclosure label and limit distribution pending author correction or moderator decision.\n\n### Sanctions and Strikes\n- WHEN content is removed for a Prohibited category, THE moderation system SHALL add one strike to the author’s account with category and date.\n- WHERE a user accrues three P1 strikes within 90 days, THE moderation system SHALL apply a 30-day suspension.\n- IF a P0 violation is confirmed, THEN THE moderation system SHALL disable the account pending admin review for permanent ban.\n- WHERE a strike becomes older than 180 days, THE moderation system SHALL exclude it from automatic escalation calculations.\n- WHEN a warning is issued, THE moderation system SHALL record it without adding a strike.\n- WHERE violation category maps to the sanction ladder, THE moderation system SHALL apply the default sanction unless an admin-approved exception is recorded with rationale.\n\n### Role-Based Permissions and Recusal\n- WHERE the actor role is moderator, THE moderation system SHALL permit content removal, warnings, labels, limited participation, mutes up to 14 days, and suspensions up to 14 days.\n- WHERE the actor role is admin, THE moderation system SHALL permit permanent bans and configuration of sanction durations and policies.\n- WHERE the actor role is factChecker, THE moderation system SHALL permit creating annotations and proposing labels but SHALL prohibit sanctions.\n- WHEN a moderator is assigned a case that presents a conflict of interest, THE moderation system SHALL allow and record recusal and SHALL reassign the case automatically.\n\n### Transparency and Notices\n- WHEN an enforcement action is applied, THE moderation system SHALL notify the author with the policy category, a concise explanation up to 500 characters, evidence summary reference, and appeal deadline.\n- WHEN a label is applied to content, THE moderation system SHALL notify the author and provide sources used for labeling.\n- WHERE a public transparency report is generated, THE moderation system SHALL include counts by category, average time to first action, and appeal outcomes by month.\n- WHERE a decision is reversed on appeal, THE moderation system SHALL remove associated strikes and update the transparency metrics within 24 hours.\n\n### Evidence and Audit\n- WHEN evidence is captured, THE moderation system SHALL store the snapshot alongside case identifiers and prevent edits.\n- WHERE a case is accessed by a reviewer, THE moderation system SHALL log the access with role and purpose.\n- IF an appeal overturns a decision, THEN THE moderation system SHALL link the new decision to the original case and mark the original rationale as superseded.\n- WHERE a legal hold is established, THE moderation system SHALL suspend routine deletion of relevant evidence until the hold is lifted.\n\n### Appeals and Restorative Processes\n- WHEN a user appeals within the allowed window, THE moderation system SHALL route the case to a different reviewer.\n- WHERE a decision is upheld, THE moderation system SHALL allow exactly one appeal per decision unless new evidence is attached.\n- WHERE a restorative option is offered, THE moderation system SHALL reinstate content visibility upon completion or compliant edits.\n- WHEN a permanent ban appeal is granted, THE moderation system SHALL downgrade sanctions to suspension and SHALL define a probation period of 30–90 days with enhanced monitoring.\n\n### Civic Safeguards\n- WHEN election-related misinformation is detected, THE moderation system SHALL apply the election SLA and prioritize review over non-election P1 items.\n- WHERE an account self-identifies as part of a political campaign, THE moderation system SHALL display affiliation labels on posts and profile per disclosure data.\n- WHEN a factChecker publishes an annotation on a claim, THE moderation system SHALL notify moderators and reduce distribution for the annotated item until reviewed.\n- WHERE a coordinated manipulation cluster is detected during election windows, THE moderation system SHALL deamplify implicated content, freeze related accounts for review, and notify admins.\n\n## Special Procedures (Business-Level)\n\n### Child Safety and Credible Threats\n- Immediate Action: P0 fast-track; temporary disable of content and implicated accounts pending review; evidence capture prioritized.\n- Lawful Referral: Admin evaluates and coordinates any legally required referrals.\n\n### Moderator Conflict-of-Interest Handling\n- Automatic prompts for recusal on signals like prior direct interactions or declared affiliations; reassignment recorded in audit.\n\n## User-Facing Error and Recovery Scenarios (Business)\n- Misfiled Report: Reporter selects wrong category. Outcome: Case remains valid; category can be corrected by reviewer; reporter receives outcome summary regardless.\n- Sanctioned While Posting: User starts writing before sanction and attempts to publish during sanction. Outcome: Publish denied with remaining sanction duration; draft preserved.\n- Label Dispute: Author disagrees with misinformation label. Outcome: Appeal path available; upon successful appeal, label removed and strike cleared.\n\n## Policy Versioning and Change Management\n- Versioned Policies: Each enforcement references a policy version identifier.\n- Change Notices: Material policy changes communicated to users; moderators briefed prior to enforcement; transparency report notes effective dates.\n\n## Related Documents\n- Refer to the [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) for role definitions and session behaviors.\n- Refer to the [User Flows and Processes Guide](./05-user-flows-and-processes.md) for end-to-end business workflows.\n- Refer to the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for privacy, security, and legal obligations.\n","tokenUsage":{"total":76466,"input":{"total":68621,"cached":0},"output":{"total":7845,"reasoning":2496,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":3,"step":0,"created_at":"2025-08-15T02:43:13.029Z"},"tokenUsage":{"aggregate":{"total":481241,"input":{"total":389074,"cached":19328},"output":{"total":92167,"reasoning":31552,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":478419,"input":{"total":386767,"cached":19328},"output":{"total":91652,"reasoning":31168,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Clarify the specific market gap, user pains, and differentiators to justify product direction and positioning.","filename":"02-market-problem-and-value-proposition.md","documentType":"service-overview","outline":["Problem Statement","Market Context and Trends","Competitive Landscape","Differentiators and Core Value Proposition","Risks and Mitigations","Success Metrics Alignment"],"audience":"business stakeholders","keyQuestions":["What pains do target users face today?","Who are the competitors and how do we differentiate?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md"],"constraints":["Focus on user pains and value; avoid implementation details"],"content":"# Market Problem and Value Proposition for civicDebateBoard\n\nThis document articulates the market problem, user pains, competitive landscape, differentiators, and measurable value proposition for civicDebateBoard. It provides business requirements context only; all technical design and implementation decisions remain at the discretion of the development team. For strategic framing, see the Service Vision and Overview. For detailed capabilities, see the Functional Requirements Specification.\n\n- Reference: Service Vision and Overview — [Service Vision and Overview](./01-service-vision-and-overview.md)\n- Reference: Functional Requirements Specification — [Functional Requirements Specification](./06-functional-requirements.md)\n\n## Problem Statement\nCivic discussions on mainstream social platforms and generic forums are plagued by low signal-to-noise ratios, misinformation cycles, hostile behavior, fragmented discourse, and shallow engagement mechanisms. Existing solutions prioritize virality and entertainment over deliberative quality, transparency, and accountability. As a result:\n\n- Everyday participants (members) encounter hostility, low trust, and limited tools to curate meaningful conversations around public-interest topics.\n- Knowledgeable or identity-verified contributors (verified members) lack protected affordances to share expertise without being drowned out by brigading, low-quality replies, or algorithmic bias toward engagement over substance.\n- Community safety roles (moderators) face overwhelming report volumes without structured evidence handling, transparent policy scaffolding, or consistent sanctions playbooks.\n- Specialized integrity roles (fact checkers) lack in-platform workflows to annotate claims with citations, highlight context, and propagate corrections without appearing adversarial.\n- Administrators need governance controls, policy configuration, and compliance oversight aligned with civic discourse (e.g., election periods) rather than generic community moderation.\n\nThe core market gap is a civic debate platform optimized for deliberation quality, transparency, and trust—balancing open participation with role-based accountability and evidence-backed conversation.\n\n## Market Context and Trends\nSeveral macro and micro trends intensify the need for a purpose-built civic debate platform:\n\n- Trust and Safety Maturation: Platforms are shifting from reactive moderation to proactive, policy-led safety frameworks with auditability. Regulators and civil society expect clear processes and transparency.\n- Election Integrity and Information Quality: Recurring election cycles amplify misinformation, coordinated manipulation, and polarized discourse. Stakeholders demand structured fact-checking and provenance of claims.\n- Role-based Communities: Professional networks and QA communities demonstrate the value of role differentiation (e.g., experts, moderators) for signal amplification and quality assurance.\n- User Fatigue with Engagement-first Feeds: Users increasingly seek substantively curated spaces where credibility and evidence outweigh raw engagement metrics.\n- Ethical Monetization: There is a growing preference for revenue models that do not incentivize outrage or virality, supporting healthier discourse and sustainable operations.\n- Compliance and Governance: Global privacy and platform accountability expectations (e.g., GDPR-like regimes, election-related guidelines) push for better audit trails and transparent enforcement records.\n\nThese trends suggest opportunity for a platform explicitly designed for civic debate with structured roles, evidence-based contributions, and transparent governance.\n\n## Competitive Landscape\nThe problem space overlaps with several categories. Each category provides partial solutions but fails to combine deliberation depth, trust mechanisms, and scalable safety operations.\n\n- Mainstream Social Networks: Offer massive reach and real-time conversation but optimize for engagement over depth; limited role differentiation; opaque moderation; fact-checking often externalized or post hoc.\n- Traditional Forums and Subforums: Enable topic organization but rely on volunteer moderation with inconsistent policies; minimal evidence workflows; limited transparency on enforcement and appeals.\n- Q&A / Knowledge Platforms: Emphasize accurate answers and reputation systems but are not optimized for multi-perspective civic debate, time-bounded events, or misinformation surge handling.\n- News Comments and Publisher Communities: Provide context-rich discussions but lack standardized moderation transparency and cross-article deliberation continuity; tools are publisher-specific and fragmented.\n- Specialized Fact-Checking Sites: Produce high-quality fact checks but are not interactive conversation platforms; limited integration into ongoing debates and user-level accountability features.\n\nConclusion: No dominant solution integrates role-based participation, structured evidence workflows, transparent moderation, and trust-anchored conversation mechanics for civic discourse.\n\n## Differentiators and Core Value Proposition\ncivicDebateBoard differentiates through a role-enabled, evidence-forward, and transparency-first approach purposely designed for civic conversations.\n\n- Role Differentiation as a First-Class Concept:\n  - Members: Participate with clear accountability, rate limits, and self-moderation tools supporting healthy dialogue.\n  - Verified Members: Identity- or expertise-verified users can label expert content, host structured AMAs, and have calibrated trust (e.g., reduced pre-moderation).\n  - Fact Checkers: Dedicated workflows to annotate claims with citations, add context, and propose corrections; visible badges and track records foster trust.\n  - Moderators: Policy-backed triage queues, clear sanctions catalog, and audit trails for consistent, explainable decisions and appeals.\n  - Admins: Governance configuration, policy and sanctions management, and compliance oversight aligned to civic discourse needs.\n\n- Evidence-Centric Conversation Mechanics:\n  - Claim-level annotations, source citations, and transparency notes reduce misinformation persistence and enable constructive correction.\n  - Topic and category structures oriented to public-interest themes improve discovery and sustained deliberation.\n\n- Transparency and Accountability by Design:\n  - Visible policy references on enforcement actions and public transparency logs for aggregated moderation outcomes build institutional trust.\n  - Clear appeal pathways with auditable histories improve perceived fairness.\n\n- Safety at Scale, Without Engagement Maximization:\n  - Emphasis on healthy discourse outcomes (quality signals, resolved debates, consensus markers) rather than pure engagement metrics.\n  - Configurable thresholds and rate-limiting to reduce brigading and harassment without silencing legitimate participation.\n\n- Business Value:\n  - Institutions, NGOs, local governments, and media partners can host credible civic dialogues with measurable integrity, supporting partnerships and ethical revenue options.\n\nCore Value Proposition: Enable high-trust, evidence-backed civic discussions that are transparent, role-accountable, and operationally sustainable—improving discourse quality and community legitimacy.\n\n## Risks and Mitigations\nThe civic debate space entails material risks. Mitigations emphasize process, governance, and role clarity.\n\n- Cold Start and Network Effects\n  - Risk: Difficulty seeding high-quality discussions without initial critical mass.\n  - Mitigations: Partner-led onboarding (civic groups, universities, local councils); structured AMAs with verified members; highlight fact-checker contributions to bootstrap trust.\n\n- Abuse, Harassment, and Coordinated Manipulation\n  - Risk: Targeted brigading during sensitive topics or election windows.\n  - Mitigations: Rate limits, graduated sanctions catalog, prioritized triage for high-risk topics, clear enforcement transparency, and evidence handling for escalations.\n\n- Misinformation and Defamation\n  - Risk: Reputational damage and legal exposure from persistent false claims.\n  - Mitigations: Claim-level fact-check annotations, corrections workflow, verified member accountability, and transparent moderation outcomes.\n\n- Perception of Bias\n  - Risk: Accusations that moderation or fact-checking favors certain viewpoints.\n  - Mitigations: Public policy documentation, consistent enforcement SLAs, appeal and review processes, and publishable aggregate enforcement metrics.\n\n- Compliance Exposure\n  - Risk: Privacy, election law, or platform accountability obligations not met.\n  - Mitigations: Governance reviews, consent and rights management, auditability and incident response procedures; regular policy updates aligned with civic timelines.\n\n- Monetization Misalignment\n  - Risk: Revenue incentives that encourage polarizing content or compromise trust.\n  - Mitigations: Ethics-aligned monetization (sponsorships by credible institutions, subscriptions for premium capabilities, grants); internal guardrails tying revenue to quality metrics.\n\n## Success Metrics Alignment\nSuccess is defined by outcomes that reflect healthy, trusted civic discourse. Metrics emphasize quality, safety, and integrity rather than raw engagement.\n\n- Quality of Discourse\n  - Percentage of posts/comments with cited sources for claims in designated civic topics.\n  - Ratio of resolved threads (e.g., consensus markers, acknowledged corrections) to total active debates.\n\n- Trust and Accountability\n  - Time-to-first fact-check annotation on high-velocity claims in priority topics.\n  - Appeal resolution time and satisfaction rate from reinstatement outcomes.\n  - Transparency logs publication cadence and completeness (e.g., proportion of enforcement actions with policy references).\n\n- Safety and Moderation Efficiency\n  - Report triage SLA attainment by severity tier.\n  - Rate of repeat violations post-warning or sanction (recidivism).\n  - Share of proactive vs. reactive moderation actions.\n\n- Community Health and Growth Quality\n  - Share of verified members participating monthly; expert AMA cadence.\n  - New member onboarding completion rate with policy acknowledgment.\n  - Ratio of constructive participation to removals in sensitive topics during civic events.\n\n- Partner and Institutional Adoption\n  - Number of hosted civic dialogues by NGOs, universities, or media partners per quarter.\n  - Partner retention and satisfaction scores tied to transparency and quality outcomes.\n\nAlignment Notes:\n- These metrics support strategic objectives described in the Service Vision and Overview and inform prioritization of capabilities outlined in the Functional Requirements Specification.\n\n---\n\nThis document describes market problems and business value only. It does not specify technical implementations. All architectural, API, and database design decisions remain under the full autonomy of the development team, which is responsible for selecting fit-for-purpose solutions consistent with the business requirements context above."},"plan":"Plan and structure to align with metadata:\n- Title: H1 using service prefix “civicDebateBoard”.\n- Sections per outline:\n  1) Problem Statement: articulate pains by role, root causes, quantification of impact.\n  2) Market Context and Trends: macro/micro trends driving need; regulatory and ethical pressures.\n  3) Competitive Landscape: categories, strengths, gaps; table comparing alternatives; concise positioning.\n  4) Differentiators and Core Value Proposition: role-based design, evidence workflows, transparency, safety without engagement maximization; messaging pillars; optional Mermaid mapping pains to differentiators (validated syntax).\n  5) Risks and Mitigations: enumerate risks with concrete mitigations; add EARS guardrails for governance and operations.\n  6) Success Metrics Alignment: measurable metrics across quality, trust, safety, growth, and partnerships; add EARS-formatted success commitments; reference related documents by descriptive links.\n- Tone: formal and professional for business stakeholders in en-US.\n- Constraints: focus on value and pains; avoid implementation details; ensure links and EARS compliance where applicable.\n","review":"Enhancement criteria to apply:\n- Length: minimum 2,000 characters; include complete coverage for all outline sections with actionable, specific content for business stakeholders.\n- Content specificity: focus on user pains, market context, competitors, differentiation, risks, and measurable value; avoid any technical implementation details (no APIs, schemas, or architecture).\n- EARS compliance: convert applicable commitments to EARS format (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL) for success metrics and policy guardrails, ensuring requirements are measurable and testable.\n- Mermaid validation: if diagrams are present, wrap ALL labels in double quotes, use graph LR, remove spaces between brackets/braces and quotes, avoid nested quotes, and use correct arrow syntax (--> and -- >|\"Label\"|). No broken syntax allowed.\n- Links: use descriptive link text in en-US; reference only existing files with relative paths.\n- Roles and business framing: reflect the defined roles (member, verifiedMember, factChecker, moderator, admin) in pains and differentiation.\n- Prohibitions: do not include database schemas, API specifications, or frontend UI; avoid meta-commentary about the document itself; no questions to the reader.\n- Developer autonomy: state that content defines business context/requirements only and that technical implementations remain at developers’ discretion, without using a developer note blockquote.\n","content":"# Market Problem and Value Proposition — civicDebateBoard\n\n## Problem Statement\nCivic discourse online is undermined by low signal-to-noise ratios, persistent misinformation, harassment, and fragmented conversations that fail to converge on clarity. Mainstream social feeds optimize for virality and novelty, not deliberative quality. Generic forums depend on inconsistent volunteer moderation without evidence workflows. Stakeholders lack shared accountability mechanisms that elevate expertise and protect participants.\n\nRole-based pains observed across civic communities:\n\n- Members (general participants)\n  - Encounter hostility, brigading, and low-trust environments that deter participation and reduce willingness to share nuanced perspectives.\n  - Lack reliable tools to follow civic topics, bookmark complex threads, and surface credible sources amid noise.\n  - Experience inconsistent enforcement, leading to perceptions of unfairness and disengagement.\n\n- Verified Members (identity- or expertise-verified participants)\n  - Struggle to make qualified contributions visible without being drowned out by engagement-biased ranking or low-quality replies.\n  - Face higher scrutiny with limited affordances to demonstrate expertise (e.g., expert tags with context and accountability).\n\n- Fact Checkers (trusted integrity role)\n  - Lack in-platform tools to attach claim-level annotations with citations and transparent ratings (e.g., true, needs context, misleading, false).\n  - Experience friction collaborating with moderators; proposed corrections are slow to propagate or hard to discover.\n\n- Moderators (community safety role)\n  - Overwhelmed by report volumes without standardized evidence intake, triage SLAs, or audit trails for consistent decisions and appeals.\n  - Encounter accusations of bias without transparent policy scaffolding or publishable enforcement metrics.\n\n- Admins (governance role)\n  - Need configurable policies, categories, and sanctions with clear oversight for compliance and election-related protections.\n  - Require partner-ready governance artifacts and transparency logs to maintain institutional trust.\n\nUnderlying structural causes:\n- Engagement-first incentives that amplify outrage and novelty rather than verifiable substance.\n- Insufficient role differentiation that fails to elevate credible expertise or structure integrity work.\n- Missing claim-level evidence mechanisms making corrections adversarial and hard to track.\n- Opaque moderation without consistent rationales, timelines, or appeal visibility.\n\ncivicDebateBoard addresses these pains by centering deliberation quality, role-based accountability, and transparent governance so that open participation can coexist with trust, safety, and evidence.\n\n## Market Context and Trends\nPersistent and accelerating trends intensify demand for a purpose-built civic debate platform:\n\n- Trust & Safety Maturation: Movement from reactive takedowns to policy-led enforcement with auditable rationale, SLAs, and appeal processes demanded by regulators and civil society.\n- Election Integrity Focus: Recurring election cycles elevate risks of misinformation, voter suppression narratives, and coordinated manipulation; stakeholders require rapid, auditable responses.\n- Role-Based Communities: Professional networks and QA platforms demonstrate the value of role differentiation (experts, moderators, reviewers) to improve signal quality and accountability.\n- Evidence-Seeking Behavior: Audiences increasingly look for citations and context, favoring spaces that reward substantiated claims over performative engagement.\n- Ethical Monetization: Preference for models that do not rely on polarization or sensitive microtargeting; institutions seek credible venues for public-interest dialogues.\n- Compliance & Platform Accountability: Privacy and platform rules (e.g., GDPR-like regimes and election-related guidelines) drive expectations for auditability, transparency logs, and rights-respecting processes.\n\nOpportunity emerges where open participation meets evidence-backed, role-accountable debate with measurable transparency.\n\n## Competitive Landscape\nAdjacent categories offer partial solutions but do not integrate deliberation depth, trust mechanisms, and scalable safety operations in one cohesive service.\n\n| Category | Strengths | Gaps vs civicDebateBoard | Implication |\n|---------|-----------|--------------------------|-------------|\n| Mainstream Social Networks | Reach, real-time updates | Engagement-first ranking, weak role differentiation, opaque moderation, externalized fact-checks | Poor fit for sustained, evidence-led debate |\n| Traditional Forums/Subforums | Topic organization, community ownership | Inconsistent moderation, minimal evidence workflows, fragmented appeals | Quality variance; low auditability |\n| Q&A/Knowledge Platforms | Reputation systems, focus on accuracy | Not optimized for multi-perspective civic debate or time-bounded events; limited misinformation surge handling | Insufficient for dynamic civic contexts |\n| News Comments & Publisher Communities | Article context | Fragmented across sites, minimal transparency for enforcement, weak cross-thread continuity | Limited network effects for civic discourse |\n| Specialized Fact-Checking Sites | High-quality fact checks | Not interactive platforms; limited integration into ongoing debates; no role-based community | Lacks participatory debate mechanics |\n\nPositioning summary:\n- Competes on deliberation quality, role accountability, and integrated evidence workflows, not on raw audience size or entertainment value.\n- Designed for public-interest partners (NGOs, universities, media, local governments) seeking credible civic dialogues with transparent governance.\n\n## Differentiators and Core Value Proposition\ncivicDebateBoard differentiates through a role-enabled, evidence-forward, transparency-first model tailored to civic conversations.\n\n- Role Differentiation as a First-Class Concept\n  - Members: Clear accountability with rate limits and self-moderation tools to support healthy dialogue.\n  - Verified Members: Expert-tagged content, structured AMAs, calibrated trust signals, and heightened accountability standards.\n  - Fact Checkers: Claim-level annotations with citations, ratings, and transparency notes; collaborative pathways to moderators.\n  - Moderators: Policy-backed triage queues, evidence handling, sanctions catalog, and audit trails for explainable decisions.\n  - Admins: Governance configuration, policy/sanction management, role assignments, and compliance oversight suitable for civic contexts.\n\n- Evidence-Centric Conversation Mechanics\n  - Claim-level annotation lifecycle (proposal, review, accepted/contested), citation surfacing, and contextual transparency to reduce misinformation persistence.\n  - Topic/category structures aligned to public-interest themes for sustained discovery and coherent debate continuity.\n\n- Transparency and Accountability by Design\n  - Visible policy references accompanying enforcement outcomes, auditable appeals, and publishable transparency logs for aggregated moderation metrics.\n  - Clear conflict-of-interest handling for reviewers and fact checkers to reinforce perceived fairness.\n\n- Safety Without Engagement Maximization\n  - Healthy discourse outcomes prioritized over raw engagement: resolved debates, consensus markers, correction adoption.\n  - Configurable rate limits and thresholds designed to reduce harassment and brigading while preserving legitimate participation.\n\n- Institutional Value\n  - Safe, auditable venue for civic partners to host debates, AMAs, and educational series with measurable integrity signals and trust-building transparency.\n\nValue proposition statement:\n- Enable high-trust, evidence-backed civic discussions that are transparent, role-accountable, and operationally sustainable—improving discourse quality and community legitimacy for members, institutions, and the broader public.\n\nMermaid mapping of pains to differentiators:\n\n```mermaid\ngraph LR\n  subgraph \"User Pains\"\n    P1[\"Low Signal-to-Noise\"]\n    P2[\"Misinformation Persistence\"]\n    P3[\"Hostility & Brigading\"]\n    P4[\"Opaque Moderation\"]\n    P5[\"Expert Voices Drowned Out\"]\n  end\n  subgraph \"civicDebateBoard Differentiators\"\n    D1[\"Role Differentiation\"]\n    D2[\"Claim-Level Annotations\"]\n    D3[\"Transparent Enforcement\"]\n    D4[\"Safety & Rate Limits\"]\n    D5[\"Expert Affordances(AMAs,Tags)\"]\n  end\n  P1 --> D1\n  P1 --> D5\n  P2 --> D2\n  P2 --> D3\n  P3 --> D4\n  P4 --> D3\n  P5 --> D1\n  P5 --> D5\n```\n\n## Risks and Mitigations\nThe civic debate domain includes operational, reputational, legal, and growth risks. Mitigations emphasize governance, standard operating procedures, and role clarity.\n\n- Cold Start and Network Effects\n  - Risk: Difficulty seeding quality discussions without initial critical mass.\n  - Mitigations: Partner-led topic launches (universities, NGOs, councils), scheduled expert AMAs, early emphasis on fact-check visibility and topic curation.\n\n- Abuse, Harassment, and Coordinated Manipulation\n  - Risk: Targeted brigading during sensitive events leading to participant attrition.\n  - Mitigations: Configurable rate limits, graduated sanctions, severity-based triage, conflict-of-interest rules, and transparent enforcement communication.\n\n- Misinformation and Defamation\n  - Risk: Legal and reputational exposure from persistent false claims.\n  - Mitigations: Claim-level annotations, corrections workflow, visibility labels, and verifiable sources coupled with auditable review outcomes.\n\n- Perception of Bias\n  - Risk: Allegations that moderation or fact-checking favors particular viewpoints.\n  - Mitigations: Public policy documentation, consistent SLAs, independence in appeals, conflict-of-interest disclosures, and aggregate transparency reporting.\n\n- Compliance Exposure\n  - Risk: Failure to meet privacy, election-related, or platform accountability obligations.\n  - Mitigations: Governance reviews, consent/rights management, auditability, incident response readiness, and policy updates aligned to civic timelines.\n\n- Monetization Misalignment\n  - Risk: Revenue mechanisms incentivizing polarizing content or undermining trust.\n  - Mitigations: Ethics-aligned sponsorships/subscriptions, bans on sensitive microtargeting, and guardrails tying revenue to quality outcomes.\n\n- Resource Constraints for Moderation and Fact-Checking\n  - Risk: Queues outpace reviewer capacity during peak civic events.\n  - Mitigations: Priority-tier routing, partner escalations for P0/P1 civic topics, scheduled volunteer fact-checker rotations, and temporary amplification dampening until review.\n\n- Community Capture by Factions\n  - Risk: Dominant groups discourage diverse participation and suppress minority voices.\n  - Mitigations: Topic diversity goals, proactive outreach to underrepresented experts, fair-use rate limits, and anti-manipulation rules.\n\nEARS-formatted governance guardrails:\n- THE governance model SHALL require conflict-of-interest disclosures for moderators and factCheckers on assigned cases.\n- WHEN a civic event enters a designated election window, THE enforcement process SHALL apply elevated SLAs and SHALL prioritize election-integrity categories over standard items.\n- IF monetization experiments degrade civic quality metrics beyond thresholds, THEN THE business operations SHALL pause or terminate the experiment and document remediation steps.\n- WHERE partner-hosted dialogues occur, THE community operations team SHALL display sponsorship labels and SHALL preserve editorial independence.\n- WHILE appeal review is pending, THE enforcement process SHALL preserve evidence and SHALL avoid irreversible actions unless safety requires immediate measures.\n\n## Success Metrics Alignment\nSuccess is defined by outcomes that reflect high-quality, trusted civic discourse and durable institutional credibility. Metrics emphasize quality, trust, safety, and mission-aligned growth rather than raw engagement volume.\n\nQuality of Discourse\n- Percentage of posts/comments in designated civic topics that include at least one cited source for material claims.\n- Ratio of resolved threads (consensus markers, accepted corrections) to total active debates.\n\nTrust and Accountability\n- Time to first fact-check annotation on high-velocity claims in priority topics.\n- Appeals resolution time and satisfaction rate measured by post-decision survey where applicable.\n- Transparency log cadence and completeness (share of enforcement actions with visible policy references).\n\nSafety and Moderation Efficiency\n- Triage SLA attainment by severity tier (critical, high, medium, low).\n- Recidivism rate after warnings or sanctions.\n- Share of proactive vs reactive enforcement actions.\n\nCommunity Health and Growth Quality\n- Monthly participation rate of verified members and expert AMA cadence.\n- New member onboarding completion rate with policy acknowledgment.\n- Ratio of constructive participation to removals within sensitive topics during civic events.\n\nPartner and Institutional Adoption\n- Number of hosted civic dialogues by NGOs, universities, or media partners per quarter.\n- Partner retention and satisfaction scores linked to transparency and quality outcomes.\n\nEARS-formatted success commitments (business-level, testable):\n- THE civicDebateBoard SHALL achieve ≥ 90% triage SLA attainment for critical severity reports during designated election windows.\n- THE civicDebateBoard SHALL reach ≥ 80% coverage of flagged high-velocity claims with at least one fact-check annotation within 24 hours.\n- THE civicDebateBoard SHALL keep the recidivism rate for sanctioned users ≤ 10% within 60 days of sanction.\n- THE civicDebateBoard SHALL publish aggregated transparency metrics at least monthly, including counts by category and average time to first action.\n- WHEN an appeal is submitted within the allowed window, THE civicDebateBoard SHALL deliver a decision within 72 hours and SHALL notify the appellant with rationale.\n- WHERE a partner-hosted AMA is sponsored, THE civicDebateBoard SHALL label the session clearly and SHALL retain the label for the archived record.\n\nAlignment and traceability:\n- Strategic framing and business model context are established in the [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Capability-level rules that operationalize these outcomes are specified in the [Functional Requirements Specification](./06-functional-requirements.md).\n\nBusiness requirements only. All technical implementation decisions (architecture, APIs, database design, and related mechanisms) remain at the full discretion of the development team.\n","tokenUsage":{"total":73193,"input":{"total":66432,"cached":0},"output":{"total":6761,"reasoning":3328,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":4,"step":0,"created_at":"2025-08-15T02:43:15.765Z"},"tokenUsage":{"aggregate":{"total":554434,"input":{"total":455506,"cached":19328},"output":{"total":98928,"reasoning":34880,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":551612,"input":{"total":453199,"cached":19328},"output":{"total":98413,"reasoning":34496,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Document privacy, security, and legal obligations to ensure trust and compliance without prescribing implementation.","filename":"09-security-privacy-and-compliance.md","documentType":"requirement","outline":["Data Privacy Principles and Consent Management","User Rights (access, correction, deletion)","Security Expectations (access control, data protection in business terms)","Audit Logging and Accountability Requirements","Incident Response and Breach Notification","Regulatory Compliance (GDPR, CCPA, election-related policies where applicable)","Third-Party and Integration Risk Management","EARS-Formatted Compliance Requirements"],"audience":"development team","keyQuestions":["What privacy rights and obligations apply?","What security controls are required in business terms?","How are incidents handled and reported?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS where applicable","Do not specify technical mechanisms; describe obligations and outcomes"],"content":"# civicDebateBoard Security, Privacy, and Compliance Requirements\n\nThis document defines the business requirements for security, privacy, and compliance for the civicDebateBoard service. It specifies WHAT the system must do from a compliance and safety perspective in clear, testable terms, without prescribing HOW to implement it. All technical implementation decisions (architecture, APIs, database design, cryptographic choices, tooling) are at the discretion of the development team.\n\n## Introduction and Scope\ncivicDebateBoard facilitates civic discourse with roles [member, verifiedMember, factChecker, moderator, admin]. This document governs how user data is handled, how access is controlled, how activities are audited, and how incidents are managed to meet legal and ethical obligations across jurisdictions in which the service operates. Requirements herein are expressed in business terms and must be treated as mandatory acceptance criteria.\n\n- In-Scope: Data privacy obligations, consent management, user rights, business-level security expectations, audit logging, incident response, regulatory conformance, third-party risk.\n- Out-of-Scope: UI/UX specifications, API endpoints, database schemas, cryptographic algorithms, network or infrastructure choices.\n\nFor role definitions and session behaviors, see the User Roles and Authentication Requirements in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). For performance, availability, and disaster recovery expectations, see [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## Data Privacy Principles and Consent Management\ncivicDebateBoard adheres to the following privacy principles: purpose limitation, data minimization, transparency, integrity and confidentiality, storage limitation, and accountability. Consent is one lawful basis among others (e.g., contract, legitimate interest) and must be handled explicitly when required.\n\n### Data Categories and Classification (Business View)\n| Category | Examples | Sensitivity | Default Collection | Default Sharing |\n|---------|----------|-------------|--------------------|-----------------|\n| Account Data | email, display name, role, verification status | Personal | Required for account | Not shared externally |\n| Content Data | posts, comments, reactions, bookmarks | Varies (may include personal) | Optional per user action | Public if posted publicly |\n| Behavioral Data | follows, subscriptions, notification preferences, rate-limit counters | Personal | Limited to service operation | Not shared externally |\n| Security Data | login events, device sessions, password reset requests, sanctions | Personal | Required for security | Not shared externally |\n| Moderation Data | reports, review decisions, sanctions, appeals | Personal | Required for policy enforcement | Not shared externally |\n| Analytics Data | aggregated usage metrics | Aggregated/De-identified | Optional per consent where required | Shared only in aggregate |\n\n### Privacy Disclosures and Consent\n- Transparency: Users must receive clear disclosures about purposes of processing, categories of data collected, retention periods, and sharing practices at or before the point of collection.\n- Consent: Explicit consent must be obtained before processing categories that require consent by law (e.g., certain analytics, marketing communications, location-based personalization where applicable). Consent must be granular, freely given, informed, unambiguous, and revocable at any time without detriment.\n- Legitimate Interest: Where legitimate interest is used as a lawful basis, a documented balancing test must be maintained and users must be offered an easy opt-out when required.\n\n### EARS Requirements — Privacy and Consent\n- THE civicDebateBoard SHALL present purpose-specific privacy disclosures prior to any data collection that is not strictly necessary for core service operation.\n- THE civicDebateBoard SHALL record the timestamp, scope, and version of the disclosure accepted by the user for any consent-based processing.\n- WHEN a user withdraws consent for a processing purpose, THE civicDebateBoard SHALL cease that processing within 24 hours and ensure no new data is collected for that purpose thereafter.\n- WHEN consent is required for analytics beyond strictly necessary operations, THE civicDebateBoard SHALL default to opt-out and SHALL enable opt-in only after explicit user action.\n- IF a processing purpose changes materially, THEN THE civicDebateBoard SHALL obtain fresh consent before continuing consent-based processing under the new purpose.\n- WHERE legal bases other than consent are relied upon, THE civicDebateBoard SHALL expose a clear explanation of the applicable legal basis within the privacy notice.\n\n## User Rights (Access, Correction, Deletion)\nUser rights procedures must ensure timely, secure, and verifiable fulfillment of requests.\n\n### Identity Verification for Requests\n- Requests to access, correct, or delete data must be verified using reasonable methods proportionate to the sensitivity of the data and the risk of harm from unauthorized access. The verification method must not require excessive data.\n\n### DSAR Intake and Fulfillment Timelines\n- GDPR: Respond to access, correction, and deletion requests without undue delay and within 30 calendar days of receipt; a single extension up to 60 additional days is allowed when justified by complexity, with notification to the requester within the original 30 days.\n- CCPA/CPRA: Respond to access and deletion requests within 45 days; a 45-day extension is allowed when reasonably necessary with notice to the consumer.\n\n### Packaging of Responses\n- Access responses must include a human-readable summary and a machine-readable portable format commonly used in the industry, limited to the requestor’s personal data and clearly excluding other users’ data.\n\n### Deletion Scope and Exceptions\n- Deletion removes personal data that is not required for legal, security, or integrity obligations. Content removals may leave a publicly visible tombstone where necessary to preserve discussion coherence without revealing personal data.\n\n### Retention and Storage Limitation\n| Data Type | Default Retention | Extensions and Holds | Final Disposition |\n|----------|-------------------|----------------------|-------------------|\n| Account Data | Lifetime of account + 30 days after deletion | Extended for legal holds | Permanent deletion |\n| Content Data | Lifetime of content; user-initiated deletion immediate | Retained in backups per backup window | Removal from active service; anonymized references where necessary |\n| Security Logs | 12 months | Extended for investigations/legal holds | Secure deletion |\n| Moderation Records | 24 months | Extended through appeal window and legal holds | Secure deletion or anonymization |\n| Incident Records | 5 years | As required by regulation | Secure deletion |\n| Backups | Up to 30 days | No extension absent legal holds | Rolling overwrite |\n\n### EARS Requirements — User Rights\n- WHEN a user submits a verified access request, THE civicDebateBoard SHALL provide a complete copy of the user’s personal data within the applicable legal timeframe and SHALL log the fulfillment event for audit.\n- WHEN a user submits a verified correction request, THE civicDebateBoard SHALL update inaccurate personal data within 30 days and SHALL notify the user upon completion.\n- WHEN a user submits a verified deletion request, THE civicDebateBoard SHALL delete personal data not required for legal or security obligations within 30 days and SHALL document exceptions with reasons.\n- IF identity verification for a rights request fails, THEN THE civicDebateBoard SHALL reject the request and SHALL provide a reason and a path to re-verify without revealing sensitive information.\n- WHERE the law permits timeline extensions, THE civicDebateBoard SHALL notify the requester of the extension and the justification before the original deadline expires.\n- WHILE a legal hold is active, THE civicDebateBoard SHALL suspend deletion for data subject to the hold and SHALL resume deletion once the hold is lifted.\n\n## Security Expectations (Access Control, Data Protection in Business Terms)\nSecurity requirements are expressed as business obligations that protect users and the integrity of discourse while respecting role-based access.\n\n### Role-Based Access Expectations\n| Data/Action | member | verifiedMember | factChecker | moderator | admin |\n|------------|--------|----------------|------------|----------|-------|\n| View own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View other users’ Account Data | ❌ | ❌ | ❌ | Limited to enforcement need | Limited to administrative need |\n| Access Content Data (public) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Access flagged Moderation Data | ❌ | ❌ | Propose annotations only | ✅ | ✅ |\n| Issue sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Manage roles and platform policies | ❌ | ❌ | ❌ | ❌ | ✅ |\n\nNote: Detailed role semantics are defined in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This table expresses high-level business permissions only.\n\n### Protection of Data in Transit and at Rest (Business Level)\n- Communications and stored data containing personal information must be protected against unauthorized access. Protection mechanisms must align with industry standards and regulatory expectations without specifying exact technologies here.\n\n### Secrets and Key Material Handling (Business Level)\n- Secrets must be treated as confidential assets, access must be strictly limited to those with a business need, and rotation must occur on a regular cadence and upon suspected exposure.\n\n### Account and Session Protections (Business Level)\n- Authentication, session duration, revocation, and device management are governed by [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This document requires outcomes: resistant to brute-force attempts, rapid revocation on logout-all events, and safe handling of password resets and email verification.\n\n### EARS Requirements — Security Expectations\n- THE civicDebateBoard SHALL enforce least-privilege access aligned with user roles for all data categories listed in this document.\n- WHEN a user’s role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate any access inconsistent with the new role.\n- WHEN a user logs out of all devices, THE civicDebateBoard SHALL ensure that no previously issued session remains valid beyond 60 seconds after the action.\n- IF repeated failed authentication attempts indicate brute-force behavior, THEN THE civicDebateBoard SHALL temporarily block further attempts from the source and SHALL preserve relevant Security Data for investigation.\n- WHERE personal data is stored, THE civicDebateBoard SHALL ensure that unauthorized access is prevented using industry-standard protection mechanisms both in transit and at rest.\n- WHEN secrets exposure is suspected, THE civicDebateBoard SHALL rotate affected secrets within 24 hours and SHALL invalidate dependent credentials promptly.\n\n## Audit Logging and Accountability Requirements\nAuditability ensures traceability of significant actions while respecting privacy.\n\n### Scope of Auditable Events (Business View)\n- Authentication lifecycle events (registration, login, logout, password reset, email verification)\n- Role and permission changes\n- Content lifecycle events (create, edit, delete, restore)\n- Moderation lifecycle events (report intake, triage, decision, sanction, appeal, reinstatement)\n- Privacy events (consent grant/withdrawal, DSAR intake/fulfillment)\n- Security events (failed logins spikes, admin access, configuration changes)\n\n### Required Audit Record Elements (Semantic Fields)\n- Actor identity and role at time of action\n- Action type and target object category\n- Timestamp in a standardized, consistent time basis\n- Outcome (success/denied/error) and reason code if denied\n- High-level origin context (e.g., device type or general location as permitted by law)\n- Correlation identifier for multi-step processes\n\n### Access and Integrity of Audit Logs\n- Access to audit logs must be restricted to admin and authorized moderator functions used for investigations.\n- Logs must be tamper-evident and retained per schedule without exposing personal data beyond necessity.\n\n### EARS Requirements — Audit and Accountability\n- THE civicDebateBoard SHALL record audit entries for all events listed in the Scope of Auditable Events.\n- WHEN an auditable event is recorded, THE civicDebateBoard SHALL include actor identity, role, action type, target category, timestamp, outcome, and correlation identifier.\n- WHERE an action is denied due to insufficient permissions, THE civicDebateBoard SHALL record the denial reason without exposing sensitive data.\n- IF audit log access is requested by an unauthorized role, THEN THE civicDebateBoard SHALL deny access and SHALL record the attempt.\n- WHILE an investigation is active, THE civicDebateBoard SHALL protect relevant logs from alteration or deletion and SHALL lift protection once the investigation concludes.\n\n## Incident Response and Breach Notification\nIncident management ensures rapid detection, containment, and communication proportionate to severity.\n\n### Severity Levels and SLAs\n| Severity | Description | Initial Triage | Containment | User/Authority Notification |\n|---------|-------------|----------------|-------------|-----------------------------|\n| Sev 1 | Confirmed breach of personal data with high risk | Within 1 hour | Within 4 hours | Authorities within 72 hours where required; affected users without undue delay and within 7 days |\n| Sev 2 | Suspected breach or material service abuse | Within 4 hours | Within 24 hours | Notify affected users if risk is nontrivial; authority notification per law |\n| Sev 3 | Security weakness or limited exposure with low risk | Within 1 business day | Within 3 business days | No notification unless legally required |\n\n### Incident Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Detect Event\"] --> B{\"Severity Assessed\"}\n  B -->|\"Sev 1\"| C[\"Containment Actions\"]\n  B -->|\"Sev 2/3\"| C\n  C --> D[\"Forensics & Impact Determination\"]\n  D --> E{\"Personal Data Involved?\"}\n  E -->|\"Yes\"| F[\"Regulatory Notification Prep\"]\n  E -->|\"No\"| G[\"Remediation Plan\"]\n  F --> H[\"Notify Authorities\"]\n  F --> I[\"Notify Affected Users\"]\n  G --> J[\"Execute Remediation\"]\n  H --> K[\"Postmortem & Lessons\"]\n  I --> K\n  J --> K\n```\n\n### EARS Requirements — Incident Response\n- WHEN a potential incident is detected, THE civicDebateBoard SHALL initiate severity assessment within the timeframes specified in the Severity Levels and SLAs table.\n- WHEN an incident reaches Sev 1, THE civicDebateBoard SHALL complete initial containment within 4 hours and SHALL prepare regulatory notifications as required.\n- IF personal data is likely exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where applicable and SHALL notify affected users without undue delay using clear guidance on protective steps.\n- WHERE a legal hold is established as part of an incident, THE civicDebateBoard SHALL suspend routine deletions of affected data until the hold is lifted.\n- THE civicDebateBoard SHALL conduct a post-incident review within 10 business days of containment, including root cause, impact, and remediation actions.\n\n## Regulatory Compliance (GDPR, CCPA, Election-Related Policies)\nThe service must operate in compliance with applicable privacy laws and content-related obligations where it is offered.\n\n### Lawful Bases and Transparency\n- Identify and document lawful bases per processing purpose (e.g., contract for account operation; legitimate interest for safety; consent for marketing where applicable). Privacy notices must reflect these bases in clear language.\n\n### Cross-Border Data Transfers\n- Where personal data is transferred across borders, use valid transfer mechanisms recognized by the destination and origin jurisdictions and maintain records of such transfers and safeguards.\n\n### Minors and Age-Gating\n- The service is designed for civic discourse and may be restricted for minors based on jurisdictional requirements. Where participation by minors is permitted, verifiable parental consent must be in place if required by local law.\n\n### Election-Related Integrity and Transparency\n- For features involving political content classifications or labels, ensure transparency notices and access to corrective pathways (e.g., appeals, fact-check annotations) consistent with policy documents and applicable regulations.\n\n### EARS Requirements — Regulatory Compliance\n- THE civicDebateBoard SHALL maintain a privacy notice that lists processing purposes, lawful bases, categories of data, retention periods, and data sharing practices.\n- WHERE cross-border transfers occur, THE civicDebateBoard SHALL document the transfer mechanism and SHALL make a summary available upon request.\n- WHEN operating in jurisdictions requiring age-gating, THE civicDebateBoard SHALL restrict access by minors unless verifiable consent requirements are satisfied.\n- WHEN processing political or election-related content categories, THE civicDebateBoard SHALL present transparency labels and SHALL preserve a record of labeling and review actions.\n\n## Third-Party and Integration Risk Management\nThird parties include analytics providers, email delivery services, identity verification services, and content safety partners. The service remains accountable for data shared with subprocessors.\n\n### Third-Party Onboarding and Oversight\n- Due diligence must evaluate data protection posture, contractual commitments, breach history, and data locality. Data processing agreements must be in place when personal data is processed on behalf of civicDebateBoard.\n\n### Data Sharing Minimization and Controls\n- Share only the minimum personal data necessary for the stated purpose. Prohibit third parties from selling, reusing, or combining personal data for unrelated purposes.\n\n### Subprocessor Registry and Notifications\n- Maintain a public-facing list of subprocessors that handle personal data and provide advance notice of material changes where legally required.\n\n### EARS Requirements — Third-Party Risk\n- WHEN engaging a new third party that processes personal data, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document a due diligence assessment prior to activation.\n- WHERE a third party is no longer necessary, THE civicDebateBoard SHALL terminate data flows and SHALL ensure data return or deletion as contractually required within 30 days.\n- IF a third party reports a breach impacting civicDebateBoard data, THEN THE civicDebateBoard SHALL trigger the incident response process and SHALL assess notification obligations.\n- THE civicDebateBoard SHALL maintain and publish a current subprocessor list that includes categories of services and data types processed.\n\n## EARS-Formatted Compliance Requirements (Consolidated)\nThis section consolidates key testable requirements for verification. All descriptions use business language and keep EARS keywords in English.\n\n### Privacy and Consent\n- THE civicDebateBoard SHALL display purpose-specific privacy disclosures before any optional data collection.\n- WHEN consent is withdrawn, THE civicDebateBoard SHALL stop consent-based processing within 24 hours and SHALL record the withdrawal.\n- IF processing purposes change, THEN THE civicDebateBoard SHALL obtain renewed consent where consent is the legal basis.\n\n### User Rights\n- WHEN a verified access request is received, THE civicDebateBoard SHALL fulfill it within legal timelines and SHALL log the fulfillment.\n- WHEN a verified deletion request is received, THE civicDebateBoard SHALL delete eligible data within 30 days and SHALL document exceptions.\n- IF verification fails for a rights request, THEN THE civicDebateBoard SHALL deny the request with a non-sensitive reason.\n\n### Security and Access Control\n- THE civicDebateBoard SHALL enforce least-privilege access for all roles and data categories.\n- WHEN a role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate inconsistent sessions.\n- IF brute-force indicators are detected, THEN THE civicDebateBoard SHALL throttle attempts and SHALL retain evidence for 12 months.\n\n### Audit and Accountability\n- THE civicDebateBoard SHALL record audit events with actor, role, action type, target category, timestamp, outcome, and correlation identifier.\n- IF unauthorized access to audit logs is attempted, THEN THE civicDebateBoard SHALL deny it and SHALL record the attempt.\n\n### Incident Response\n- WHEN an incident is detected, THE civicDebateBoard SHALL assess severity within defined SLAs and SHALL contain confirmed Sev 1 incidents within 4 hours.\n- IF personal data is exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where required and SHALL notify affected users without undue delay.\n- THE civicDebateBoard SHALL complete a post-incident review within 10 business days of containment.\n\n### Regulatory and Third-Party\n- WHERE data crosses borders, THE civicDebateBoard SHALL document transfer mechanisms and SHALL provide summaries upon request.\n- WHEN onboarding a personal-data processor, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document due diligence.\n- IF a subprocessor incident impacts civicDebateBoard data, THEN THE civicDebateBoard SHALL activate incident response and SHALL evaluate notification duties.\n\n## Appendices\n\n### Appendix A — Glossary (Business Terms)\n- Personal Data: Information relating to an identified or identifiable individual.\n- Consent: Freely given, specific, informed, and unambiguous indication of wishes by which the data subject signifies agreement to processing.\n- DSAR: Data Subject Access Request; includes access, correction, deletion, portability where applicable.\n- Legal Hold: A process that suspends routine deletion due to litigation, investigations, or regulatory obligations.\n- Subprocessor: A third party engaged to process personal data on behalf of the service.\n\n### Appendix B — Data Categories (Detailed Examples)\n- Account Data: email, display name, avatar reference, role, verification flags.\n- Content Data: posts, comments, reactions, bookmarks, follows, topics.\n- Security Data: login attempts, session metadata, password reset events, device revocations.\n- Moderation Data: reports, review decisions, sanctions, appeals, reinstatement status.\n\n### Appendix C — Severity Matrix (Quick Reference)\n| Severity | Impact | Notification Expectation |\n|---------|--------|--------------------------|\n| Sev 1 | High risk to personal data | Authorities within 72 hours; users within 7 days |\n| Sev 2 | Medium risk or uncertain breach | Conditional per risk and law |\n| Sev 3 | Low risk or contained weakness | None unless required |\n\n---\nThis document provides business requirements only. All technical implementation decisions belong to the development team. Developers have full autonomy over architecture, APIs, and database design; this document describes WHAT the system must do, not HOW to build it."},"plan":"Produce a requirements document titled “civicDebateBoard Security, Privacy, and Compliance Requirements” structured as: 1) Introduction and Scope referencing roles and related documents; 2) Data Privacy Principles and Consent Management (data categories, disclosures, consent lifecycle, cookies/GPC); 3) User Rights (access, correction, deletion, portability, restriction, opt-out, non-discrimination) with timelines and verification; 4) Security Expectations (role-based access, data protection, secrets handling, account/session protections, training, vulnerability disclosure/testing) in business terms; 5) Audit Logging and Accountability (scope, fields, access, retention, tamper-evidence); 6) Incident Response and Breach Notification (severity, SLAs, notification content, legal holds) with LR Mermaid flow; 7) Regulatory Compliance (GDPR/CCPA/CPRA, minors/COPPA-like, election-related transparency, cross-border transfers, DPIA/RoPA, records of processing); 8) Third-Party and Integration Risk (onboarding, DPA, subprocessor registry, change notices, reassessment cadence); 9) Governance and Privacy-by-Design (checkpoints, training, access reviews, retention schedule, de-identification); 10) EARS-Formatted Consolidated Requirements by domain; 11) Appendices (glossary, matrices, severity table). Ensure all requirements are precise and testable, and all Mermaid diagrams follow strict syntax.","review":"Enhance for complete, implementation-ready business requirements using EARS. Enforce: 1) Minimum length 5,000+ characters; 2) Every applicable requirement in EARS (WHEN/WHILE/IF/THEN/WHERE, THE, SHALL with precise, measurable outcomes); 3) No APIs, schemas, or technical implementation details; 4) Mermaid diagrams must use double quotes for all labels, no spaces between brackets/braces and quotes, no nested quotes, proper arrows (-->), LR orientation preferred; 5) Add missing business processes: DPIA/RoPA governance, data classification and handling rules, consent lifecycle, cookie/identifier preferences and GPC (Do Not Sell/Share), portability and restriction rights, non-discrimination (CCPA), de-identification and re-identification prohibitions, privacy-by-design checkpoints, training and access reviews, vulnerability disclosure and security testing expectations, vendor/subprocessor lifecycle and change notifications, cross-border transfer governance, minors/COPPA-like parental consent, election-related transparency, records retention governance, data breach notification content elements, sanctions for policy breaches; 6) Add comprehensive error and edge cases in business terms; 7) Add additional Mermaid flows for DSAR lifecycle and consent management (strict syntax rules); 8) Strengthen link text to related documents using descriptive titles; 9) Include concluding autonomy statement (business requirements only) without developer notes; 10) Ensure role coverage for member, verifiedMember, factChecker, moderator, admin across privacy/security obligations; 11) Avoid meta-commentary; write as the document itself.","content":"# civicDebateBoard Security, Privacy, and Compliance Requirements\n\nThis document defines the business requirements for security, privacy, and compliance for the civicDebateBoard service. It specifies WHAT the system must do from a compliance and safety perspective in clear, testable terms, without prescribing HOW to implement it. All technical implementation decisions (architecture, APIs, database design, cryptographic choices, tooling) are at the discretion of the development team.\n\n## Introduction and Scope\ncivicDebateBoard facilitates civic discourse with roles [member, verifiedMember, factChecker, moderator, admin]. This document governs how user data is handled, how access is controlled, how activities are audited, and how incidents are managed to meet legal and ethical obligations across jurisdictions in which the service operates. Requirements herein are expressed in business terms and must be treated as mandatory acceptance criteria.\n\n- In-Scope: Data privacy obligations, consent management, user rights, business-level security expectations, audit logging, incident response, regulatory conformance, third-party risk.\n- Out-of-Scope: UI/UX specifications, API endpoints, database schemas, cryptographic algorithms, network or infrastructure choices.\n\nFor role definitions and session behaviors, see the User Roles and Authentication Requirements in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). For performance, availability, and disaster recovery expectations, see [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## Data Privacy Principles and Consent Management\ncivicDebateBoard adheres to the following privacy principles: purpose limitation, data minimization, transparency, integrity and confidentiality, storage limitation, and accountability. Consent is one lawful basis among others (e.g., contract, legitimate interest) and must be handled explicitly when required.\n\n### Data Categories and Classification (Business View)\n| Category | Examples | Sensitivity | Default Collection | Default Sharing |\n|---------|----------|-------------|--------------------|-----------------|\n| Account Data | email, display name, role, verification status | Personal | Required for account | Not shared externally |\n| Content Data | posts, comments, reactions, bookmarks | Varies (may include personal) | Optional per user action | Public if posted publicly |\n| Behavioral Data | follows, subscriptions, notification preferences, rate-limit counters | Personal | Limited to service operation | Not shared externally |\n| Security Data | login events, device sessions, password reset requests, sanctions | Personal | Required for security | Not shared externally |\n| Moderation Data | reports, review decisions, sanctions, appeals | Personal | Required for policy enforcement | Not shared externally |\n| Analytics Data | aggregated usage metrics | Aggregated/De-identified | Optional per consent where required | Shared only in aggregate |\n\n### Privacy Disclosures and Consent\n- Transparency: Users must receive clear disclosures about purposes of processing, categories of data collected, retention periods, and sharing practices at or before the point of collection.\n- Consent: Explicit consent must be obtained before processing categories that require consent by law (e.g., certain analytics, marketing communications, location-based personalization where applicable). Consent must be granular, freely given, informed, unambiguous, and revocable at any time without detriment.\n- Legitimate Interest: Where legitimate interest is used as a lawful basis, a documented balancing test must be maintained and users must be offered an easy opt-out when required.\n\n### Cookie/Identifier Preferences and \"Do Not Sell/Share\"\n- Cookie and identifier preferences must be honored, including Global Privacy Control (GPC) or similar browser-level signals where applicable.\n- Marketing communications and cross-context behavioral advertising must be opt-in where required and opt-out at minimum elsewhere; non-discrimination rules apply.\n\n### EARS Requirements — Privacy and Consent\n- THE civicDebateBoard SHALL present purpose-specific privacy disclosures prior to any data collection that is not strictly necessary for core service operation.\n- THE civicDebateBoard SHALL record the timestamp, scope, and version of the disclosure accepted by the user for any consent-based processing.\n- WHEN a user withdraws consent for a processing purpose, THE civicDebateBoard SHALL cease that processing within 24 hours and ensure no new data is collected for that purpose thereafter.\n- WHEN consent is required for analytics beyond strictly necessary operations, THE civicDebateBoard SHALL default to opt-out and SHALL enable opt-in only after explicit user action.\n- IF a processing purpose changes materially, THEN THE civicDebateBoard SHALL obtain fresh consent before continuing consent-based processing under the new purpose.\n- WHERE legal bases other than consent are relied upon, THE civicDebateBoard SHALL expose a clear explanation of the applicable legal basis within the privacy notice.\n- WHERE a GPC or equivalent signal is received, THE civicDebateBoard SHALL treat it as a valid opt-out of sale/share for applicable jurisdictions and SHALL persist that preference.\n\n### Consent Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Collect Purpose-Specific Disclosure\"] --> B[\"Capture Consent State(Opt-in/Opt-out)\"]\n  B --> C{\"Consent Required?\"}\n  C -->|\"Yes\"| D[\"Enforce Purpose Access Controls\"]\n  C -->|\"No\"| E[\"Proceed Under Other Legal Basis\"]\n  D --> F{\"Withdrawal Requested?\"}\n  F -->|\"Yes\"| G[\"Stop Processing(<24h) & Log Withdrawal\"]\n  F -->|\"No\"| H[\"Continue Processing\"]\n  E --> H\n```\n\n## User Rights (Access, Correction, Deletion)\nUser rights procedures must ensure timely, secure, and verifiable fulfillment of requests.\n\n### Identity Verification for Requests\n- Requests to access, correct, or delete data must be verified using reasonable methods proportionate to the sensitivity of the data and the risk of harm from unauthorized access. The verification method must not require excessive data.\n\n### DSAR Intake and Fulfillment Timelines\n- GDPR: Respond to access, correction, and deletion requests without undue delay and within 30 calendar days of receipt; a single extension up to 60 additional days is allowed when justified by complexity, with notification to the requester within the original 30 days.\n- CCPA/CPRA: Respond to access and deletion requests within 45 days; a 45-day extension is allowed when reasonably necessary with notice to the consumer.\n\n### Packaging of Responses\n- Access responses must include a human-readable summary and a machine-readable portable format commonly used in the industry, limited to the requestor’s personal data and clearly excluding other users’ data.\n\n### Deletion Scope and Exceptions\n- Deletion removes personal data that is not required for legal, security, or integrity obligations. Content removals may leave a publicly visible tombstone where necessary to preserve discussion coherence without revealing personal data.\n\n### Portability, Restriction, and Opt-Outs\n- Portability: Provide a structured, commonly used, machine-readable export of personal data the user provided and, where applicable, data observed through their use of the service.\n- Restriction: Temporarily limit processing where legally required while preserving data integrity for the restriction period.\n- Opt-Outs: Honor user opt-outs of sale/share, targeted advertising, and profiling where required by law without degrading core functionality.\n\n### Non-Discrimination\n- Users exercising rights shall not be charged different prices or receive a different level or quality of goods or services unless permitted by law and disclosed.\n\n### Retention and Storage Limitation\n| Data Type | Default Retention | Extensions and Holds | Final Disposition |\n|----------|-------------------|----------------------|-------------------|\n| Account Data | Lifetime of account + 30 days after deletion | Extended for legal holds | Permanent deletion |\n| Content Data | Lifetime of content; user-initiated deletion immediate | Retained in backups per backup window | Removal from active service; anonymized references where necessary |\n| Security Logs | 12 months | Extended for investigations/legal holds | Secure deletion |\n| Moderation Records | 24 months | Extended through appeal window and legal holds | Secure deletion or anonymization |\n| Incident Records | 5 years | As required by regulation | Secure deletion |\n| Backups | Up to 30 days | No extension absent legal holds | Rolling overwrite |\n\n### EARS Requirements — User Rights\n- WHEN a user submits a verified access request, THE civicDebateBoard SHALL provide a complete copy of the user’s personal data within the applicable legal timeframe and SHALL log the fulfillment event for audit.\n- WHEN a user submits a verified correction request, THE civicDebateBoard SHALL update inaccurate personal data within 30 days and SHALL notify the user upon completion.\n- WHEN a user submits a verified deletion request, THE civicDebateBoard SHALL delete personal data not required for legal or security obligations within 30 days and SHALL document exceptions with reasons.\n- IF identity verification for a rights request fails, THEN THE civicDebateBoard SHALL reject the request and SHALL provide a reason and a path to re-verify without revealing sensitive information.\n- WHERE the law permits timeline extensions, THE civicDebateBoard SHALL notify the requester of the extension and the justification before the original deadline expires.\n- WHILE a legal hold is active, THE civicDebateBoard SHALL suspend deletion for data subject to the hold and SHALL resume deletion once the hold is lifted.\n- WHEN a portability request is verified, THE civicDebateBoard SHALL provide a structured, commonly used, machine-readable export within legal timelines.\n- WHEN a restriction request is verified, THE civicDebateBoard SHALL mark affected data as restricted and SHALL prevent processing except for storage and legal obligations for the restriction duration.\n- WHEN a user opts out of targeted advertising or sale/share, THE civicDebateBoard SHALL cease such processing within 15 days and SHALL confirm the opt-out state to the user.\n\n### DSAR Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Receive DSAR(Request Type)\"] --> B[\"Verify Identity(Reasonable Method)\"]\n  B --> C{\"Verified?\"}\n  C -->|\"No\"| D[\"Deny & Provide Re-verify Path\"]\n  C -->|\"Yes\"| E[\"Locate Data & Assess Scope\"]\n  E --> F{\"Extension Needed?\"}\n  F -->|\"Yes\"| G[\"Notify Extension & Justification\"]\n  F -->|\"No\"| H[\"Prepare Response(Package Type)\"]\n  G --> H\n  H --> I[\"Deliver Response & Log Audit\"]\n```\n\n## Security Expectations (Access Control, Data Protection in Business Terms)\nSecurity requirements are expressed as business obligations that protect users and the integrity of discourse while respecting role-based access.\n\n### Role-Based Access Expectations\n| Data/Action | member | verifiedMember | factChecker | moderator | admin |\n|------------|--------|----------------|------------|----------|-------|\n| View own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View other users’ Account Data | ❌ | ❌ | ❌ | Limited to enforcement need | Limited to administrative need |\n| Access Content Data (public) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Access flagged Moderation Data | ❌ | ❌ | Propose annotations only | ✅ | ✅ |\n| Issue sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Manage roles and platform policies | ❌ | ❌ | ❌ | ❌ | ✅ |\n\nNote: Detailed role semantics are defined in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This table expresses high-level business permissions only.\n\n### Protection of Data in Transit and at Rest (Business Level)\n- Communications and stored data containing personal information must be protected against unauthorized access. Protection mechanisms must align with industry standards and regulatory expectations without specifying exact technologies here.\n\n### Secrets and Key Material Handling (Business Level)\n- Secrets must be treated as confidential assets, access must be strictly limited to those with a business need, and rotation must occur on a regular cadence and upon suspected exposure.\n\n### Account and Session Protections (Business Level)\n- Authentication, session duration, revocation, and device management are governed by [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This document requires outcomes: resistant to brute-force attempts, rapid revocation on logout-all events, and safe handling of password resets and email verification.\n\n### Workforce Training and Access Reviews\n- Personnel with access to personal data must complete annual privacy and security training with role-appropriate modules.\n- Access to systems containing personal data must be reviewed at least quarterly and upon role changes.\n\n### Vulnerability Disclosure and Security Testing (Business Level)\n- A public channel for responsible vulnerability disclosure must exist with commitments to timely triage and remediation.\n- Periodic security testing (e.g., third-party assessments) must be conducted on a risk-based cadence without prescribing tools.\n\n### EARS Requirements — Security Expectations\n- THE civicDebateBoard SHALL enforce least-privilege access aligned with user roles for all data categories listed in this document.\n- WHEN a user’s role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate any access inconsistent with the new role.\n- WHEN a user logs out of all devices, THE civicDebateBoard SHALL ensure that no previously issued session remains valid beyond 60 seconds after the action.\n- IF repeated failed authentication attempts indicate brute-force behavior, THEN THE civicDebateBoard SHALL temporarily block further attempts from the source and SHALL preserve relevant Security Data for investigation.\n- WHERE personal data is stored, THE civicDebateBoard SHALL ensure that unauthorized access is prevented using industry-standard protection mechanisms both in transit and at rest.\n- WHEN secrets exposure is suspected, THE civicDebateBoard SHALL rotate affected secrets within 24 hours and SHALL invalidate dependent credentials promptly.\n- THE civicDebateBoard SHALL require annual privacy and security training for personnel with access to personal data and SHALL record completion.\n- THE civicDebateBoard SHALL conduct quarterly access reviews for privileged roles and SHALL remove access that is no longer required.\n- WHEN a vulnerability report is received through the responsible disclosure channel, THE civicDebateBoard SHALL acknowledge receipt within 7 days and SHALL provide status updates until resolution.\n\n## Audit Logging and Accountability Requirements\nAuditability ensures traceability of significant actions while respecting privacy.\n\n### Scope of Auditable Events (Business View)\n- Authentication lifecycle events (registration, login, logout, password reset, email verification)\n- Role and permission changes\n- Content lifecycle events (create, edit, delete, restore)\n- Moderation lifecycle events (report intake, triage, decision, sanction, appeal, reinstatement)\n- Privacy events (consent grant/withdrawal, DSAR intake/fulfillment)\n- Security events (failed logins spikes, admin access, configuration changes)\n\n### Required Audit Record Elements (Semantic Fields)\n- Actor identity and role at time of action\n- Action type and target object category\n- Timestamp in a standardized, consistent time basis\n- Outcome (success/denied/error) and reason code if denied\n- High-level origin context (e.g., device type or general location as permitted by law)\n- Correlation identifier for multi-step processes\n\n### Access and Integrity of Audit Logs\n- Access to audit logs must be restricted to admin and authorized moderator functions used for investigations.\n- Logs must be tamper-evident and retained per schedule without exposing personal data beyond necessity.\n\n### EARS Requirements — Audit and Accountability\n- THE civicDebateBoard SHALL record audit entries for all events listed in the Scope of Auditable Events.\n- WHEN an auditable event is recorded, THE civicDebateBoard SHALL include actor identity, role, action type, target category, timestamp, outcome, and correlation identifier.\n- WHERE an action is denied due to insufficient permissions, THE civicDebateBoard SHALL record the denial reason without exposing sensitive data.\n- IF audit log access is requested by an unauthorized role, THEN THE civicDebateBoard SHALL deny access and SHALL record the attempt.\n- WHILE an investigation is active, THE civicDebateBoard SHALL protect relevant logs from alteration or deletion and SHALL lift protection once the investigation concludes.\n\n## Incident Response and Breach Notification\nIncident management ensures rapid detection, containment, and communication proportionate to severity.\n\n### Severity Levels and SLAs\n| Severity | Description | Initial Triage | Containment | User/Authority Notification |\n|---------|-------------|----------------|-------------|-----------------------------|\n| Sev 1 | Confirmed breach of personal data with high risk | Within 1 hour | Within 4 hours | Authorities within 72 hours where required; affected users without undue delay and within 7 days |\n| Sev 2 | Suspected breach or material service abuse | Within 4 hours | Within 24 hours | Notify affected users if risk is nontrivial; authority notification per law |\n| Sev 3 | Security weakness or limited exposure with low risk | Within 1 business day | Within 3 business days | No notification unless legally required |\n\n### Incident Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Detect Event\"] --> B{\"Severity Assessed\"}\n  B -->|\"Sev 1\"| C[\"Containment Actions\"]\n  B -->|\"Sev 2/3\"| C\n  C --> D[\"Forensics & Impact Determination\"]\n  D --> E{\"Personal Data Involved?\"}\n  E -->|\"Yes\"| F[\"Regulatory Notification Prep\"]\n  E -->|\"No\"| G[\"Remediation Plan\"]\n  F --> H[\"Notify Authorities\"]\n  F --> I[\"Notify Affected Users\"]\n  G --> J[\"Execute Remediation\"]\n  H --> K[\"Postmortem & Lessons\"]\n  I --> K\n  J --> K\n```\n\n### Breach Notification Content (Business Expectations)\n- Nature of the incident, categories and approximate number of data subjects and records involved (where known), likely consequences, measures taken or proposed to address the breach, and guidance for affected users to mitigate harm.\n\n### EARS Requirements — Incident Response\n- WHEN a potential incident is detected, THE civicDebateBoard SHALL initiate severity assessment within the timeframes specified in the Severity Levels and SLAs table.\n- WHEN an incident reaches Sev 1, THE civicDebateBoard SHALL complete initial containment within 4 hours and SHALL prepare regulatory notifications as required.\n- IF personal data is likely exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where applicable and SHALL notify affected users without undue delay using clear guidance on protective steps.\n- WHERE a legal hold is established as part of an incident, THE civicDebateBoard SHALL suspend routine deletions of affected data until the hold is lifted.\n- THE civicDebateBoard SHALL conduct a post-incident review within 10 business days of containment, including root cause, impact, and remediation actions.\n\n## Regulatory Compliance (GDPR, CCPA, Election-Related Policies)\nThe service must operate in compliance with applicable privacy laws and content-related obligations where it is offered.\n\n### Lawful Bases and Transparency\n- Identify and document lawful bases per processing purpose (e.g., contract for account operation; legitimate interest for safety; consent for marketing where applicable). Privacy notices must reflect these bases in clear language.\n\n### Cross-Border Data Transfers\n- Where personal data is transferred across borders, use valid transfer mechanisms recognized by the destination and origin jurisdictions and maintain records of such transfers and safeguards.\n\n### DPIA and Records of Processing\n- Conduct Data Protection Impact Assessments (DPIAs) for high-risk processing and maintain Records of Processing Activities (RoPA) at a level sufficient for regulatory inspection.\n\n### Minors and Age-Gating\n- The service is designed for civic discourse and may be restricted for minors based on jurisdictional requirements. Where participation by minors is permitted, verifiable parental consent must be in place if required by local law.\n\n### Election-Related Integrity and Transparency\n- For features involving political content classifications or labels, ensure transparency notices and access to corrective pathways (e.g., appeals, fact-check annotations) consistent with policy documents and applicable regulations.\n\n### EARS Requirements — Regulatory Compliance\n- THE civicDebateBoard SHALL maintain a privacy notice that lists processing purposes, lawful bases, categories of data, retention periods, and data sharing practices.\n- WHERE cross-border transfers occur, THE civicDebateBoard SHALL document the transfer mechanism and SHALL make a summary available upon request.\n- WHEN operating in jurisdictions requiring age-gating, THE civicDebateBoard SHALL restrict access by minors unless verifiable consent requirements are satisfied.\n- WHEN processing political or election-related content categories, THE civicDebateBoard SHALL present transparency labels and SHALL preserve a record of labeling and review actions.\n- WHERE processing presents high risk to individuals, THE civicDebateBoard SHALL conduct a DPIA before launch and SHALL document mitigations and residual risk.\n- THE civicDebateBoard SHALL maintain Records of Processing Activities sufficient to describe purposes, categories, recipients, transfers, and retention for each processing activity.\n\n## Third-Party and Integration Risk Management\nThird parties include analytics providers, email delivery services, identity verification services, and content safety partners. The service remains accountable for data shared with subprocessors.\n\n### Third-Party Onboarding and Oversight\n- Due diligence must evaluate data protection posture, contractual commitments, breach history, and data locality. Data processing agreements must be in place when personal data is processed on behalf of civicDebateBoard.\n\n### Data Sharing Minimization and Controls\n- Share only the minimum personal data necessary for the stated purpose. Prohibit third parties from selling, reusing, or combining personal data for unrelated purposes.\n\n### Subprocessor Registry and Notifications\n- Maintain a public-facing list of subprocessors that handle personal data and provide advance notice of material changes where legally required.\n\n### Reassessment Cadence and Termination\n- Reassess critical subprocessors at least annually and upon material change; ensure secure data return or deletion upon termination.\n\n### EARS Requirements — Third-Party Risk\n- WHEN engaging a new third party that processes personal data, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document a due diligence assessment prior to activation.\n- WHERE a third party is no longer necessary, THE civicDebateBoard SHALL terminate data flows and SHALL ensure data return or deletion as contractually required within 30 days.\n- IF a third party reports a breach impacting civicDebateBoard data, THEN THE civicDebateBoard SHALL trigger the incident response process and SHALL assess notification obligations.\n- THE civicDebateBoard SHALL maintain and publish a current subprocessor list that includes categories of services and data types processed.\n- THE civicDebateBoard SHALL reassess critical subprocessors at least annually and SHALL record reassessment outcomes and follow-ups.\n\n## Governance and Privacy-by-Design\nGovernance embeds privacy and security into the lifecycle of features and operations.\n\n### Privacy-by-Design Checkpoints\n- Kickoff: Define purposes, lawful bases, data minimization strategies, and retention for new features.\n- Pre-Launch: Complete DPIA where required, finalize disclosures and consent flows, confirm role-based access, validate audit events.\n- Post-Launch: Monitor KPIs and incidents, review data retention alignment, and adjust controls as needed.\n\n### Training and Awareness\n- Annual training for all staff; enhanced training for moderators, admins, and engineers who handle personal data.\n\n### Access Governance\n- Joiner-Mover-Leaver process to ensure timely provisioning and deprovisioning of access based on role changes.\n\n### De-Identification and Re-Identification Prohibition\n- De-identified data must be managed to prevent re-identification, and any attempt to re-identify de-identified data is prohibited.\n\n### EARS Requirements — Governance\n- THE civicDebateBoard SHALL require privacy-by-design reviews at kickoff, pre-launch, and post-launch for features involving personal data.\n- WHEN a high-risk feature is proposed, THE civicDebateBoard SHALL mandate a DPIA and SHALL approve mitigations before launch.\n- THE civicDebateBoard SHALL require annual privacy training for all staff and enhanced training for roles with elevated data access.\n- WHEN an employee changes roles or leaves, THE civicDebateBoard SHALL adjust or revoke access within 24 hours and SHALL log the change.\n- THE civicDebateBoard SHALL prohibit re-identification of de-identified data and SHALL treat any detected attempt as a policy violation subject to sanction.\n\n## EARS-Formatted Compliance Requirements (Consolidated)\nThis section consolidates key testable requirements for verification. All descriptions use business language and keep EARS keywords in English.\n\n### Privacy and Consent\n- THE civicDebateBoard SHALL display purpose-specific privacy disclosures before any optional data collection.\n- WHEN consent is withdrawn, THE civicDebateBoard SHALL stop consent-based processing within 24 hours and SHALL record the withdrawal.\n- IF processing purposes change, THEN THE civicDebateBoard SHALL obtain renewed consent where consent is the legal basis.\n- WHERE a GPC signal is received, THE civicDebateBoard SHALL honor it as an opt-out of sale/share in applicable jurisdictions.\n\n### User Rights\n- WHEN a verified access request is received, THE civicDebateBoard SHALL fulfill it within legal timelines and SHALL log the fulfillment.\n- WHEN a verified deletion request is received, THE civicDebateBoard SHALL delete eligible data within 30 days and SHALL document exceptions.\n- IF verification fails for a rights request, THEN THE civicDebateBoard SHALL deny the request with a non-sensitive reason.\n- WHEN a portability request is verified, THE civicDebateBoard SHALL provide a structured export within legal timelines.\n- WHEN a restriction request is verified, THE civicDebateBoard SHALL prevent processing for the restriction duration except storage and legal obligations.\n- WHEN a user opts out of targeted advertising or sale/share, THE civicDebateBoard SHALL cease such processing within 15 days.\n\n### Security and Access Control\n- THE civicDebateBoard SHALL enforce least-privilege access for all roles and data categories.\n- WHEN a role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate inconsistent sessions.\n- IF brute-force indicators are detected, THEN THE civicDebateBoard SHALL throttle attempts and SHALL retain evidence for 12 months.\n- THE civicDebateBoard SHALL require annual training for personnel with access to personal data and SHALL record completion.\n- THE civicDebateBoard SHALL conduct quarterly privileged-access reviews and SHALL remove unnecessary access.\n\n### Audit and Accountability\n- THE civicDebateBoard SHALL record audit events with actor, role, action type, target category, timestamp, outcome, and correlation identifier.\n- IF unauthorized access to audit logs is attempted, THEN THE civicDebateBoard SHALL deny it and SHALL record the attempt.\n- WHILE an investigation is active, THE civicDebateBoard SHALL protect relevant logs from alteration or deletion.\n\n### Incident Response\n- WHEN an incident is detected, THE civicDebateBoard SHALL assess severity within defined SLAs and SHALL contain confirmed Sev 1 incidents within 4 hours.\n- IF personal data is exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where required and SHALL notify affected users without undue delay.\n- THE civicDebateBoard SHALL complete a post-incident review within 10 business days of containment.\n\n### Regulatory and Third-Party\n- WHERE data crosses borders, THE civicDebateBoard SHALL document transfer mechanisms and SHALL provide summaries upon request.\n- WHEN onboarding a personal-data processor, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document due diligence.\n- IF a subprocessor incident impacts civicDebateBoard data, THEN THE civicDebateBoard SHALL activate incident response and SHALL evaluate notification duties.\n- THE civicDebateBoard SHALL reassess critical subprocessors at least annually and SHALL record outcomes.\n- WHERE processing is high-risk, THE civicDebateBoard SHALL conduct a DPIA before launch and SHALL document mitigations.\n\n## Appendices\n\n### Appendix A — Glossary (Business Terms)\n- Personal Data: Information relating to an identified or identifiable individual.\n- Consent: Freely given, specific, informed, and unambiguous indication of wishes by which the data subject signifies agreement to processing.\n- DSAR: Data Subject Access Request; includes access, correction, deletion, portability where applicable.\n- Legal Hold: A process that suspends routine deletion due to litigation, investigations, or regulatory obligations.\n- Subprocessor: A third party engaged to process personal data on behalf of the service.\n- GPC: Global Privacy Control; a browser-level signal indicating user opt-out of sale/share of personal data where applicable.\n- DPIA: Data Protection Impact Assessment; process to evaluate high-risk processing.\n- RoPA: Records of Processing Activities; a register of processing purposes, categories, and other required details.\n\n### Appendix B — Data Categories (Detailed Examples)\n- Account Data: email, display name, avatar reference, role, verification flags.\n- Content Data: posts, comments, reactions, bookmarks, follows, topics.\n- Security Data: login attempts, session metadata, password reset events, device revocations.\n- Moderation Data: reports, review decisions, sanctions, appeals, reinstatement status.\n- Analytics Data: aggregated usage metrics and de-identified trend summaries subject to consent where required.\n\n### Appendix C — Severity Matrix (Quick Reference)\n| Severity | Impact | Notification Expectation |\n|---------|--------|--------------------------|\n| Sev 1 | High risk to personal data | Authorities within 72 hours; users within 7 days |\n| Sev 2 | Medium risk or uncertain breach | Conditional per risk and law |\n| Sev 3 | Low risk or contained weakness | None unless required |\n\n---\nThis document provides business requirements only. All technical implementation decisions belong to the development team. Developers have full autonomy over architecture, APIs, and database design; this document describes WHAT the system must do, not HOW to build it.","tokenUsage":{"total":77436,"input":{"total":69098,"cached":0},"output":{"total":8338,"reasoning":1280,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":5,"step":0,"created_at":"2025-08-15T02:43:24.383Z"},"tokenUsage":{"aggregate":{"total":631870,"input":{"total":524604,"cached":19328},"output":{"total":107266,"reasoning":36160,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":629048,"input":{"total":522297,"cached":19328},"output":{"total":106751,"reasoning":35776,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Capture representative users and their end-to-end scenarios to ground requirements in real-world needs.","filename":"04-user-personas-and-scenarios.md","documentType":"user-story","outline":["Personas (Member, Verified Member, Fact Checker, Moderator, Admin)","Primary Scenarios (Happy Paths)","Secondary and Special Scenarios (Edge Cases)","Abuse and Misuse Scenarios","Acceptance Criteria (EARS)"],"audience":"product managers","keyQuestions":["Who are the primary personas and what are their motivations?","What are the main scenarios that define success?","What edge cases and abuse scenarios must be supported or mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","05-user-flows-and-processes.md","06-functional-requirements.md"],"constraints":["Use narrative language; include EARS acceptance criteria where applicable","Avoid UI design or technical details"],"content":"# civicDebateBoard — User Personas and Scenarios (Requirement Analysis)\n\nThis document provides business requirements only for civicDebateBoard. All technical implementation decisions, including architecture, APIs, and data models, are at the discretion of the development team. The document describes WHAT the system should do from a user and business perspective.\n\n## Document Scope and Context\n- Purpose: Capture representative users and their end-to-end scenarios to ground requirements in real-world civic discourse needs and to inform implementation without prescribing technical mechanisms.\n- Alignment: Complements the strategic framing in the [Service Vision and Overview](./01-service-vision-and-overview.md), details narrative flows that will be elaborated procedurally in the [User Flows and Processes](./05-user-flows-and-processes.md), and anchors the detailed rules in the [Functional Requirements](./06-functional-requirements.md).\n- Service Prefix: civicDebateBoard\n- Roles in Scope: member, verifiedMember, factChecker, moderator, admin\n- Tone: Formal, policy- and outcome-oriented, avoiding UI specifications.\n\n## Personas\n\n### Member\n- Summary: Authenticated community participant who starts and joins discussions, votes, reacts, follows topics, bookmarks, reports content, and manages own account within community rules and rate limits.\n- Motivations:\n  - Participate in good-faith civic debate, ask questions, and learn.\n  - Find trustworthy information quickly.\n  - Receive timely updates about followed topics and threads.\n- Goals:\n  - Publish posts and comments that remain visible if compliant.\n  - Get useful responses and consensus signals (votes, reactions).\n  - Curate a personal feed by following topics and users.\n- Behaviors:\n  - Posts within rate limits; edits content shortly after posting; reports harmful content.\n  - Uses bookmarks to return to long threads; subscribes for notifications.\n- Constraints:\n  - Must verify email to publish or report; subject to rate limits, content rules, and possible sanctions.\n- Definition of Success:\n  - Content is published promptly; notifications arrive within expected time; reports receive visible outcomes; personal activity and preferences persist across sessions.\n\n### Verified Member\n- Summary: Identity- or expertise-verified participant with elevated trust and accountability; can publish expert-tagged content and host AMAs.\n- Motivations:\n  - Share domain expertise responsibly; reduce friction from pre-moderation; build public credibility.\n- Goals:\n  - Publish expert posts with fewer pre-moderation holds while maintaining accountability.\n  - Host and manage topic-focused sessions (e.g., AMA) with structured Q&A.\n- Behaviors:\n  - Provides sources; maintains higher standards of accuracy; engages respectfully.\n- Constraints:\n  - Bound by stricter accountability; some actions subject to audit but with relaxed rate limits compared to general members.\n- Definition of Success:\n  - Expert posts are discoverable and trusted; engagement is high; fewer false-positive moderation holds.\n\n### Fact Checker\n- Summary: Trusted role allowed to add fact-check annotations and cite sources; flags misleading claims for review and proposes corrections; cannot sanction.\n- Motivations:\n  - Improve information quality; surface evidence; build transparency.\n- Goals:\n  - Attach verifiable annotations; escalate critical misinformation quickly.\n- Behaviors:\n  - Adds structured notes with sources; proposes status labels (e.g., “unsupported”, “misleading”).\n- Constraints:\n  - No direct sanctions; requires moderator/admin confirmation for enforcement actions.\n- Definition of Success:\n  - Annotations appear contextually; authors and readers see clear evidence; reviews occur within SLA; misinformation visibility is appropriately reduced.\n\n### Moderator\n- Summary: Responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, and handling appeals.\n- Motivations:\n  - Maintain healthy discourse at scale; act fairly and consistently; meet review SLAs.\n- Goals:\n  - Efficiently process queues; apply transparent decisions; reduce repeat violations.\n- Behaviors:\n  - Triage by severity; consult policy references; communicate decisions and rationales.\n- Constraints:\n  - Must follow policy and escalation rules; avoids conflicts of interest; respects auditability.\n- Definition of Success:\n  - Queue latency within SLA; low rate of reversed decisions on appeal; clear, consistent messaging.\n\n### Admin\n- Summary: Manages platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, and compliance reviews; can perform all moderator actions.\n- Motivations:\n  - Ensure governance, safety, and compliance while supporting growth.\n- Goals:\n  - Configure policies and roles; approve sensitive data exports; audit platform health.\n- Behaviors:\n  - Assigns roles; updates sanctions and policies; reviews audits and compliance.\n- Constraints:\n  - Operates under legal and governance obligations; high accountability and audit requirements.\n- Definition of Success:\n  - Policies and roles reflect current needs; compliance reviews pass; community health metrics improve.\n\n## Primary Scenarios (Happy Paths)\n\n### 1) Member publishes a compliant discussion and engages\n- Narrative:\n  - A member drafts a substantive discussion within rate limits, selects relevant topics/tags in business terms, and publishes. The post appears instantly to the community if it does not require pre-moderation. The member follows the thread. Other members react and comment; the author receives timely notifications and responds. The thread remains visible and discoverable via topics and search.\n- Business Rules (implicit in flow):\n  - Email verification is required to publish; content must conform to policy; rate limits apply; edits allowed for a short window (e.g., 15 minutes) without moderator review; subsequent edits may require review if content meaning materially changes.\n- Success Indicators:\n  - Publication within seconds; notifications within one minute for direct replies; discoverability via the selected topics.\n\n### 2) Verified Member hosts an expert Q&A (AMA) session\n- Narrative:\n  - A verifiedMember schedules and posts an expert session. The session is tagged as “expert” and prioritized in discovery. Questions from members are collected; the verifiedMember answers and cites credible sources. The session concludes with a summary note and remains archived for reference.\n- Business Rules:\n  - Expert tag is restricted to verifiedMember and above; standard policy and rate limits apply; session tagging influences prominence but does not exempt policy.\n- Success Indicators:\n  - Session starts on time; questions route properly; post-session summary is visible; high engagement with minimal moderation intervention.\n\n### 3) Fact Checker annotates a claim with sources\n- Narrative:\n  - A factChecker identifies a claim in a popular post, attaches an annotation with citations, and proposes a status label (e.g., “unsupported”). Readers see a clear contextual note and link to sources. A moderator reviews and confirms the proposed label; the author is notified and may revise.\n- Business Rules:\n  - Annotations are non-destructive; factChecker cannot sanction; moderation review is required to change visibility or apply labels with enforcement.\n- Success Indicators:\n  - Annotation appears contextually within seconds; review completed within SLA; readers engage with sources.\n\n### 4) Member reports content; Moderator triages and enforces\n- Narrative:\n  - A member reports content for misinformation/harassment. The system prioritizes the report based on severity heuristics. A moderator reviews with relevant context and past case history, then applies a proportionate action (dismiss, edit, warning, temporary mute, suspension) and logs a clear rationale. Reporter and content author receive notifications summarizing the outcome.\n- Business Rules:\n  - Reporter identity remains confidential to the author; sanctions follow configured ladders; appeals are available within a defined window.\n- Success Indicators:\n  - High-severity cases are acknowledged within minutes; decisions communicated clearly; low reversal rate on appeal.\n\n### 5) Admin manages categories and role assignments\n- Narrative:\n  - An admin creates new categories for upcoming civic events, updates topic taxonomies, and assigns factChecker status to a qualified user. The changes take effect promptly and are logged for audit. Affected users are notified of role changes.\n- Business Rules:\n  - Role changes require justification; taxonomy changes propagate to discovery and subscriptions; audits capture who, what, when, and why.\n- Success Indicators:\n  - Zero disruption to existing content; new categories appear in discovery; role changes reflect instantly in permissions.\n\n### 6) Member follows topics and receives updates\n- Narrative:\n  - A member follows a set of civic topics. New posts in followed topics trigger notifications and a personalized activity feed. The member can unfollow anytime and updates take effect immediately.\n- Business Rules:\n  - Follow capacity and rate limits apply to prevent abuse; notification preferences are user-configurable.\n- Success Indicators:\n  - Timely and relevant notifications; accurate feed composition reflecting follows/unfollows.\n\n### Flow Illustration: Report Intake and Triage (Happy Path)\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"Member Report Content(Select reason)\"] --> B[\"Submit Report\"]\n  end\n  subgraph \"System Classification\"\n    C[\"Classify Severity\"] --> D{\"High Severity?\"}\n  end\n  subgraph \"Moderation\"\n    E[\"Queue Moderator\"] --> F[\"Review Context and History\"] --> G{\"Policy Violation?\"}\n    H[\"Apply Sanction(Warning/Mute/Suspension)\"] --> I[\"Notify Author and Reporter\"]\n    J[\"Dismiss Report\"] --> I\n  end\n  B --> C\n  D -->|\"Yes\"| E\n  D -->|\"No\"| E\n  E --> F\n  G -->|\"Yes\"| H\n  G -->|\"No\"| J\n```\n\n## Secondary and Special Scenarios (Edge Cases)\n\n### Editing window exceeded\n- Narrative: A member attempts to edit a post after the self-edit window has expired. The system offers a revision request path that may queue for moderator review when the change is material.\n- Expected Outcome: Edit is denied instantly with clear rationale; optional revision request enters review with status tracking.\n\n### Rate limit reached during surge\n- Narrative: A member hits posting or commenting rate limits during a high-traffic event. The system communicates the remaining cooldown and suggests draft saving.\n- Expected Outcome: No content loss; member understands wait time; rate limit resets as scheduled.\n\n### Email not verified but attempting to publish\n- Narrative: An authenticated user without verified email tries to publish or report.\n- Expected Outcome: Action blocked with clear instructions to verify; progress preserved until verification completes.\n\n### Suspended user content visibility\n- Narrative: A previously suspended user’s past content is accessed. The system applies visibility rules that may limit or label historical content without erasing lawful records.\n- Expected Outcome: Reader sees appropriate labels or limited visibility; audit records remain intact.\n\n### Fact-checker conflict of interest\n- Narrative: A factChecker attempts to annotate content authored by a declared close collaborator.\n- Expected Outcome: System requires disclosure and routes to another reviewer; annotation is held until independent review completes.\n\n### Moderator conflict-of-interest recusal\n- Narrative: A moderator is assigned a report involving a user they sanctioned recently.\n- Expected Outcome: Reassignment occurs automatically; audit notes the recusal reason and time.\n\n### Appeals window and reinstatement\n- Narrative: A sanctioned user submits an appeal within the configured window.\n- Expected Outcome: Appeal is acknowledged, reviewed by a distinct moderator within SLA, and the decision (uphold/modify/reverse) is communicated with rationale.\n\n### Multi-device session revocation\n- Narrative: A member revokes all device sessions from account settings after suspecting account sharing.\n- Expected Outcome: Active sessions terminate promptly; user is informed that re-authentication is required across devices.\n\n### Timezone and localization handling\n- Narrative: A user traveling across timezones views timestamps.\n- Expected Outcome: Timestamps reflect user preference and show original post time with offset clarity when needed.\n\n## Abuse and Misuse Scenarios\n\n### Coordinated brigading and vote manipulation\n- Behavior: New or low-reputation accounts attempt to mass-upvote or downvote to distort consensus.\n- Mitigations:\n  - Weight votes based on trust signals; limit rapid voting bursts; detect correlated activity.\n- Expected Outcomes:\n  - Manipulative impact is reduced; abnormal patterns are flagged for moderator review.\n\n### Misinformation campaigns in civic contexts\n- Behavior: Rapid spread of misleading claims during elections or emergencies.\n- Mitigations:\n  - Priority routing to factChecker and moderator queues; temporary interstitials with context; reduced algorithmic amplification pending review.\n- Expected Outcomes:\n  - Harm minimized through timely labels and context; legitimate discussion remains possible.\n\n### Harassment and doxxing\n- Behavior: Targeted harassment, threats, or sharing of personal information.\n- Mitigations:\n  - Swift removal of personal data; immediate protective actions (mutes/suspensions); enhanced reporting pathways for targets.\n- Expected Outcomes:\n  - Victims protected quickly; offenders sanctioned; audit trail preserved.\n\n### Spam and link farming\n- Behavior: Accounts posting low-quality promotional links at scale.\n- Mitigations:\n  - Strict rate limits; link reputation checks; escalating sanctions for repeat offenses.\n- Expected Outcomes:\n  - Reduced visibility of spam; legitimate links unaffected.\n\n### Sockpuppetry and duplicate accounts\n- Behavior: One actor uses multiple accounts to evade sanctions or create false consensus.\n- Mitigations:\n  - Trust and behavior analytics; stricter limits on new accounts; consolidated enforcement when linked by policy signals.\n- Expected Outcomes:\n  - Evading behaviors curtailed; sanctions applied across linked accounts per policy.\n\n### Malicious or bad-faith reporting\n- Behavior: Users repeatedly report compliant content to harass others or burden moderation.\n- Mitigations:\n  - Reporter reputation factoring; cooldowns for false reporting; sanctions for repeat abuse.\n- Expected Outcomes:\n  - Reduced false-positive load; preserved reporter functionality for good-faith users.\n\n### Sanction evasion attempts\n- Behavior: Changing content to avoid detection, deleting evidence, or using obfuscation.\n- Mitigations:\n  - Immutable audit logs; snapshotting before removals; re-checks after edits; pattern detection.\n- Expected Outcomes:\n  - Evasion attempts are ineffective; accountability maintained.\n\n## Acceptance Criteria (EARS)\n\nThe following acceptance criteria are expressed using EARS. All descriptions are in en-US with EARS keywords in English. They are business-testable and avoid prescribing technical mechanisms.\n\n### Core Participation and Posting\n- WHEN a verified email member publishes compliant content, THE civicDebateBoard SHALL make the content visible to the community within 3 seconds.\n- IF a member attempts to publish without verified email, THEN THE civicDebateBoard SHALL block the action and provide a clear verification path without content loss.\n- WHERE a post is newly created by its author, THE civicDebateBoard SHALL allow self-editing for up to 15 minutes from initial publication.\n- IF an edit is attempted after the self-edit window and the change is material, THEN THE civicDebateBoard SHALL route the edit for review and retain the original until a decision is made.\n- WHILE a post is under pre-moderation due to policy or trust signals, THE civicDebateBoard SHALL keep the post non-public and display pending status to the author.\n- WHEN a member follows a topic, THE civicDebateBoard SHALL include relevant new posts in the member’s personalized feed within 1 minute of publication.\n\n### Reactions, Voting, and Anti-manipulation\n- WHERE an account is newly created or low-trust, THE civicDebateBoard SHALL apply stricter voting and reaction rate limits than for established members.\n- WHEN a member casts a vote, THE civicDebateBoard SHALL reflect the vote effect in aggregates within 2 seconds.\n- IF correlated voting patterns exceed manipulation thresholds, THEN THE civicDebateBoard SHALL dampen aggregated impact and flag the activity for moderator review.\n- WHEN a member withdraws a vote within 10 minutes, THE civicDebateBoard SHALL reverse the aggregation accordingly.\n\n### Reporting and Moderation\n- WHEN a member submits a content report, THE civicDebateBoard SHALL acknowledge receipt instantly and assign a severity.\n- WHERE a report is high severity (e.g., doxxing, threats), THE civicDebateBoard SHALL notify a moderator queue within 2 minutes.\n- WHEN a moderator decides an outcome, THE civicDebateBoard SHALL notify the reporter and the author with the decision rationale within 1 minute of decision.\n- IF a report is dismissed, THEN THE civicDebateBoard SHALL record the dismissal rationale in the audit log and mark the report resolved.\n- WHEN a sanction is applied, THE civicDebateBoard SHALL enforce the sanction immediately across all user actions and persist its duration.\n\n### Fact-Checking and Annotations\n- WHEN a factChecker adds an annotation with sources, THE civicDebateBoard SHALL display the annotation contextually on the referenced claim within 3 seconds to all readers.\n- IF a factChecker proposes an enforcement-affecting label (e.g., reduced amplification), THEN THE civicDebateBoard SHALL require moderator confirmation before the label affects visibility.\n- WHERE a conflict of interest is declared, THE civicDebateBoard SHALL route the annotation to an independent reviewer and pause enforcement changes until review completes.\n\n### Appeals and Restorative Processes\n- WHEN an author appeals a sanction within the allowed window, THE civicDebateBoard SHALL confirm receipt immediately and assign the appeal to a reviewer distinct from the original decision-maker.\n- WHILE an appeal is pending, THE civicDebateBoard SHALL maintain the current enforcement unless policy specifies otherwise.\n- WHEN an appeal is upheld, THE civicDebateBoard SHALL restore content visibility and notify affected parties within 1 minute.\n- IF an appeal results in modified sanctions, THEN THE civicDebateBoard SHALL update enforcement and communicate changes with rationale.\n\n### Notifications and Subscriptions\n- WHEN a followed thread receives a direct reply to the member’s content, THE civicDebateBoard SHALL send a notification within 1 minute.\n- WHERE a member disables a notification category, THE civicDebateBoard SHALL cease notifications for that category within 1 minute.\n- IF a notification cannot be delivered, THEN THE civicDebateBoard SHALL record a delivery failure and retry according to policy without duplicating user-visible messages.\n\n### Account Lifecycle and Sessions\n- WHEN a member revokes all sessions, THE civicDebateBoard SHALL terminate active sessions within 1 minute and require re-authentication.\n- WHERE an account is suspended, THE civicDebateBoard SHALL restrict all posting, voting, and reporting actions for the suspension duration and label historical content per policy.\n- IF a suspended account attempts a restricted action, THEN THE civicDebateBoard SHALL deny the action and display the remaining suspension duration.\n\n### Accessibility, Inclusivity, and Localization\n- THE civicDebateBoard SHALL present timestamps according to the user’s timezone preference with clear offset indicators.\n- WHERE content includes sensitive topics, THE civicDebateBoard SHALL allow readers to access contextual safety and policy information within 2 clicks from the content.\n- THE civicDebateBoard SHALL ensure that all user-facing messages are concise, unambiguous, and free of technical jargon.\n\n### Auditability and Transparency\n- WHEN any moderation or fact-check event occurs, THE civicDebateBoard SHALL record who initiated it, the reason category, the decision, and the time, in an immutable audit trail.\n- IF a moderator is reassigned due to conflict of interest, THEN THE civicDebateBoard SHALL record the reassignment with rationale and timestamps.\n- WHERE a role change is performed by an admin, THE civicDebateBoard SHALL notify the affected user and list the effective permissions change.\n\n### Performance and Experience Expectations\n- THE civicDebateBoard SHALL render user-triggered state changes (publish, vote, follow, report) as complete within 3 seconds in typical conditions.\n- WHERE system load is elevated, THE civicDebateBoard SHALL continue to acknowledge user actions instantly and complete processing within published SLAs.\n\n## Traceability and References\n- Strategic context and business model: see the [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Detailed process diagrams and stepwise flows: see the [User Flows and Processes](./05-user-flows-and-processes.md).\n- Formalized capabilities, validations, and rules: see the [Functional Requirements](./06-functional-requirements.md).\n\nEnd of document."},"plan":"Document type: user-story. Audience: product managers. Structure and intent:\n1) Title and business-only scope declaration for developer autonomy.\n2) Document scope and context: purpose, alignment to related docs, roles in scope, tone.\n3) Personas: Member, Verified Member, Fact Checker, Moderator, Admin — each with summary, motivations, goals, behaviors, constraints, success definition, pain points, anti-goals, information needs.\n4) Primary Scenarios (Happy Paths): Member publishes and engages; Verified AMA; Fact-check annotation lifecycle; Member reporting to moderation; Admin manages categories/roles; Member follows topics and gets updates; Author accepts correction; Digest notifications; Conflict-of-interest recusal; Election window activation.\n5) Mermaid flow diagrams for complex flows (e.g., Report triage, Fact-check lifecycle) with strict syntax.\n6) Secondary and Special Scenarios (Edge Cases): editing window exceeded; rate limits; unverified email; suspended user visibility; conflicts of interest; appeals; multi-device revocation; timezone handling; additional nuanced cases (stale links, duplicate reports, long threads, cross-posting, archived topics).\n7) Abuse and Misuse Scenarios: brigading/vote manipulation; misinformation campaigns; harassment/doxxing; spam/link farming; sockpuppetry; malicious reporting; sanction evasion; deepfake media; mass-report brigading; astroturfing by coordinated orgs.\n8) Acceptance Criteria (EARS): grouped by functional area — participation/posting; AMA sessions; reactions/voting/anti-manipulation; reporting/moderation; fact-check and annotations; appeals/restorative; notifications/subscriptions (instant and digest); account lifecycle/sessions; accessibility/localization; transparency/auditability; election safeguards; admin governance updates. Each requirement measurable with timing or condition.\n9) Traceability and references to related documents using descriptive links.\n10) Close without questions or meta commentary.","review":"Enhance for completeness, specificity, and EARS compliance. Apply these rules:\n- Length: minimum 2,000+ characters; expand narratives, edge cases, and acceptance criteria.\n- EARS: Convert all applicable requirements to EARS (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL). Make them measurable with clear pass/fail criteria.\n- Mermaid: Use double quotes for all labels; no spaces between brackets/braces and quotes; arrows must be -->, -.->, or ==>; edge labels must be quoted; no nested quotes.\n- Content scope: Business requirements only. Strictly avoid APIs, database schemas, or technical architecture.\n- Roles: Cover member, verifiedMember, factChecker, moderator, admin. Define motivations, goals, constraints, success indicators.\n- Workflows: Include end-to-end narratives for happy paths, edge cases, and abuse/misuse. Add decision points, outcomes, and SLAs in business terms.\n- Error handling: Specify user-visible outcomes, recovery, and time bounds.\n- Performance expectations: State user-facing response/latency windows in seconds/minutes where relevant.\n- Links: Use descriptive link text with relative paths that map to actual files.\n- Language: en-US, formal business tone.\n- Prohibitions: No questions to reader; no developer notes except where allowed (not applicable here). No UI/visual design specs.\n- Consistency: Use service prefix civicDebateBoard consistently.\n- Validation: Ensure acceptance criteria cover personas and scenarios comprehensively, including moderation, fact-check, appeals, notifications, roles, and sanctions.\n- Transparency and auditability: Include business expectations for rationale capture and audit trails.\n- Localization/timezone: Address user-facing time handling in business terms.","content":"# civicDebateBoard — User Personas and Scenarios (Requirement Analysis)\n\nBusiness requirements only for civicDebateBoard. All technical implementation decisions (architecture, APIs, data models, and infrastructure) belong to the development team. Content defines WHAT outcomes and behaviors are required in business terms.\n\n## Document Scope and Context\n- Purpose: Represent real users, their motivations, and end-to-end scenarios that drive unambiguous business requirements for civic discourse.\n- Alignment: Complements strategic framing in the [Service Vision and Overview](./01-service-vision-and-overview.md); feeds procedural detail in the [User Flows and Processes](./05-user-flows-and-processes.md); anchors validation rules in the [Functional Requirements](./06-functional-requirements.md).\n- Service Prefix: civicDebateBoard\n- Roles in Scope: member, verifiedMember, factChecker, moderator, admin\n- Tone: Formal, outcome-oriented, policy-aware; excludes UI and technical specifications.\n\n## Personas\n\n### Member\n- Summary: Authenticated participant who starts and joins discussions, reacts and votes, follows topics, bookmarks content, reports issues, and manages account settings under rate limits and policy.\n- Motivations:\n  - Participate in good-faith civic debate to learn and contribute constructively.\n  - Find trustworthy, timely information and see quality signals.\n  - Receive relevant updates about followed topics, authors, and threads.\n- Goals:\n  - Publish compliant posts and comments that remain visible.\n  - Get meaningful responses and see consensus signals (votes, helpful reactions).\n  - Curate a personalized feed via follows and bookmarks.\n- Behaviors:\n  - Creates drafts, edits shortly after posting, and reports harmful or off-policy content.\n  - Subscribes to notifications; manages preferences; returns to long threads via bookmarks.\n- Constraints:\n  - Must verify email to publish or report; subject to role-based rate limits and sanctions when applicable.\n- Pain Points and Anti-Goals:\n  - Pain: Low-signal replies and brigading drown out substance; uncertainty about moderation outcomes.\n  - Anti-Goals: Does not want to manage complex settings; does not want to lose drafts or be rate-limited without clear timing.\n- Information Needs:\n  - Clear status of posts/comments (published, pending, held); transparent moderation decisions; visible cooldown timers.\n- Definition of Success:\n  - Content publish completes within seconds; replies trigger timely notifications; reports produce visible outcomes; preferences persist and apply consistently.\n\n### Verified Member\n- Summary: Identity- or expertise-verified participant with elevated trust and accountability; can publish expert-tagged content and host structured Q&A sessions.\n- Motivations:\n  - Share qualified expertise with accountability; reduce friction from pre-moderation; build public credibility.\n- Goals:\n  - Publish expert posts discoverable as authoritative; host AMAs with structured Q&A; cite credible sources.\n- Behaviors:\n  - Provides sources with claims; maintains higher accuracy standards; engages respectfully across threads.\n- Constraints:\n  - Elevated accountability; some actions subject to audit; relaxed rate limits relative to members but full policy compliance.\n- Pain Points and Anti-Goals:\n  - Pain: Expertise drowned by low-signal responses; unnecessary pre-moderation holds during urgent civic events.\n  - Anti-Goals: Avoids forced editorial control by sponsors or admins.\n- Information Needs:\n  - Expert-tag visibility; AMA scheduling status; annotation or label status on their content.\n- Definition of Success:\n  - Expert posts and AMAs achieve high-quality engagement with minimal false-positive holds; annotations and corrections are visible and discoverable.\n\n### Fact Checker\n- Summary: Trusted role adding fact-check annotations with citations, flagging misleading claims for review, proposing corrections, and creating transparency notes; cannot sanction.\n- Motivations:\n  - Improve information quality, context, and verifiability; reduce misinformation persistence.\n- Goals:\n  - Attach annotations with sources; elevate critical misleading claims quickly to moderation.\n- Behaviors:\n  - Adds structured notes including claim excerpts, rating, sources, and explanation; proposes labels that can affect distribution once confirmed by moderation.\n- Constraints:\n  - No direct sanctions; requires moderator/admin confirmation for enforcement-affecting labels; recusal on conflicts.\n- Pain Points and Anti-Goals:\n  - Pain: Limited visibility or delayed review of annotations on fast-moving threads; unclear status of proposed labels.\n  - Anti-Goals: Being perceived as partisan; losing transparency into annotation outcomes.\n- Information Needs:\n  - Annotation visibility state; review status; acceptance/rejection reasons; conflict-of-interest routing confirmations.\n- Definition of Success:\n  - Annotations surface contextually; proposals reviewed within SLAs; authors and readers see clear evidence and status.\n\n### Moderator\n- Summary: Triage reports, review content, apply policy decisions, edit/remove violations, issue warnings and sanctions, handle appeals within scope, and maintain community health.\n- Motivations:\n  - Fair, consistent, transparent enforcement; meet review SLAs; reduce repeat violations.\n- Goals:\n  - Process queues efficiently; apply proportionate actions with rationale; escalate correctly; minimize overturned decisions.\n- Behaviors:\n  - Triage by severity; consult policy references; notify affected parties with concise reasons; maintain audit trails.\n- Constraints:\n  - Must follow escalation rules; avoid conflicts of interest; respect auditability and evidence handling.\n- Pain Points and Anti-Goals:\n  - Pain: Report floods and mass-report brigading; incomplete evidence; unclear precedence.\n  - Anti-Goals: Silent enforcement without rationale; inconsistent decisions across reviewers.\n- Information Needs:\n  - Consolidated case evidence; prior history; annotation context; SLA timers; conflict-of-interest alerts.\n- Definition of Success:\n  - Queue latency within SLA; low appeal reversal rate; clear communications with policy references.\n\n### Admin\n- Summary: Manages platform policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions.\n- Motivations:\n  - Ensure governance, safety, compliance, and sustainable growth.\n- Goals:\n  - Configure policies and taxonomies; manage roles; approve sensitive exports; oversee compliance and audits.\n- Behaviors:\n  - Assigns roles; updates sanctions and policies; reviews audits; activates elevated-protection windows (election/crisis).\n- Constraints:\n  - Operates under legal and governance obligations; high accountability in audit logs; separation from editorial influence.\n- Pain Points and Anti-Goals:\n  - Pain: Policy drift across teams; emergency protections not activating quickly enough; perception of bias.\n  - Anti-Goals: Monetization that compromises discourse integrity; opaque policy changes.\n- Information Needs:\n  - Change impact summaries; compliance status; transparency reports; live SLA adherence.\n- Definition of Success:\n  - Policies and roles reflect current needs; community health metrics improve; compliance reviews pass with minimal exceptions.\n\n## Primary Scenarios (Happy Paths)\n\n### 1) Member publishes and engages\n- Narrative: A member drafts a substantive discussion within rate limits, selects relevant topics and tags, and publishes. If no pre-moderation is required, the post appears instantly. The member follows the thread, receives notifications for replies, and responds. The thread remains discoverable via topics and search.\n- Business Rules: Email verification is required to publish; content must conform to policy; rate limits apply; edits allowed in a short window (e.g., 15 minutes) without review; material changes after the window may require review.\n- Success Indicators: Publication ≤ 3 seconds; notifications ≤ 1 minute for direct replies; discoverability by selected topics.\n\n### 2) Verified Member hosts an expert Q&A (AMA)\n- Narrative: A verifiedMember schedules and posts an expert session tagged as \"expert\". Questions from members are collected; the host answers and cites sources. A summary note closes the session; the thread remains archived.\n- Business Rules: Expert tagging restricted to verifiedMember and above; standard policies and rate limits apply; tagging may increase prominence but never exempts policy.\n- Success Indicators: On-time start; proper question routing; visible summary; high-quality engagement with minimal intervention.\n\n### 3) Fact Checker annotates a claim\n- Narrative: A factChecker identifies a claim in a popular post, attaches an annotation with citations, and proposes a label such as \"unsupported\". Readers see the contextual note and sources. A moderator reviews and confirms the label; the author is notified and may revise.\n- Business Rules: Annotations are non-destructive; proposed enforcement-affecting labels require moderator confirmation.\n- Success Indicators: Annotation visible in ≤ 3 seconds; review completed within SLA; readers engage with sources.\n\n### 4) Member reports content; Moderator triages and enforces\n- Narrative: A member reports content for misinformation or harassment. The system assigns severity and routes to queues. A moderator reviews context and history, applies a proportionate action (dismiss, edit with note, warning, temporary mute, suspension), and logs rationale. Reporter and author are notified.\n- Business Rules: Reporter identity remains confidential to the author; sanctions follow configured ladders; appeals are available within a defined window.\n- Success Indicators: High-severity acknowledgement in minutes; decisions communicated clearly; low reversal rate on appeal.\n\n### 5) Admin manages categories and roles\n- Narrative: An admin creates categories for civic events, updates taxonomies, and assigns factChecker status to a qualified user. Changes take effect quickly and are audited. Affected users are notified.\n- Business Rules: Role changes require justification; taxonomy changes propagate to discovery and subscriptions; audits capture who, what, when, and why.\n- Success Indicators: No disruption to existing content; new categories visible; role changes reflect instantly in permissions.\n\n### 6) Member follows topics and receives updates\n- Narrative: A member follows civic topics. New posts in those topics trigger notifications and update a personalized feed. The member can unfollow at any time with immediate effect.\n- Business Rules: Follow capacity and rate limits apply; notification preferences are user-configurable.\n- Success Indicators: Timely, relevant notifications; accurate feed reflecting follow/unfollow.\n\n### 7) Author adopts a fact-check correction\n- Narrative: An author receives a notification that a claim in their post has an accepted annotation rated \"misleading\". The author revises the content with sources and submits. The revision is accepted; the label is updated to \"corrected\" and the post remains visible with a transparency note.\n- Business Rules: Correction path available to authors; material edits may require review; transparency note persists.\n- Success Indicators: Correction acknowledged within minutes; label updated; readers can see correction context.\n\n### 8) Digest notifications for busy topics\n- Narrative: A member opts into daily digests for a category. The system aggregates updates and sends a digest. The member can switch back to instant notifications.\n- Business Rules: Respect category preferences and quiet hours; deduplicate events; configurable cadence.\n- Success Indicators: Digest contains relevant items; opt-in/out takes effect within 1 minute.\n\n### 9) Moderator conflict-of-interest recusal\n- Narrative: A case assignment engine detects a potential conflict (recent sanctioning of the same author by the same moderator). The case is reassigned; the system records recusal.\n- Business Rules: Independence rule enforced for assignments and appeals.\n- Success Indicators: Reassignment within minutes; audit contains recusal reason and timestamp.\n\n### 10) Election window activation\n- Narrative: Admin activates an elevated-protection window for an upcoming election. Reports in relevant categories are prioritized with faster SLAs; political-content labels are enabled; transparency logs note the activation window.\n- Business Rules: Election windows elevate certain categories; labels and prioritization apply during activation period.\n- Success Indicators: Priority routing verified; SLA compliance improved on election-related items; visibility of labels.\n\n## Flow Illustrations\n\n### Report Intake and Triage (Happy Path)\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"Member Report Content(Select reason)\"] --> B[\"Submit Report\"]\n  end\n  subgraph \"System Classification\"\n    C[\"Classify Severity\"] --> D{\"High Severity?\"}\n  end\n  subgraph \"Moderation\"\n    E[\"Queue Moderator\"] --> F[\"Review Context and History\"] --> G{\"Policy Violation?\"}\n    H[\"Apply Sanction(Warning/Mute/Suspension)\"] --> I[\"Notify Author and Reporter\"]\n    J[\"Dismiss Report\"] --> I\n  end\n  B --> C\n  D -->|\"Yes\"| E\n  D -->|\"No\"| E\n  E --> F\n  G -->|\"Yes\"| H\n  G -->|\"No\"| J\n```\n\n### Fact-Check Annotation Lifecycle\n```mermaid\ngraph LR\n  subgraph \"Annotation\"\n    A[\"Select Claim Excerpt\"] --> B[\"Add Sources(Valid URLs)\"] --> C[\"Propose Rating(True/Needs Context/Misleading/False)\"]\n  end\n  subgraph \"Visibility & Review\"\n    D[\"Display Annotation Contextually\"] --> E{\"Enforcement-Affecting Label?\"}\n    E -->|\"Yes\"| F[\"Require Moderator Confirmation\"]\n    E -->|\"No\"| G[\"Visible Without Enforcement Change\"]\n  end\n  subgraph \"Outcomes\"\n    H[\"Accepted\"]\n    I[\"Contested\"]\n    J[\"Rejected\"]\n  end\n  C --> D\n  F --> H\n  G --> H\n  F -.-> I\n  D -.-> I\n  I --> K[\"Notify Author & FactChecker\"]\n  H --> K\n  J --> K\n```\n\n## Secondary and Special Scenarios (Edge Cases)\n\n### Editing window exceeded\n- Narrative: A member attempts to edit after the self-edit window. A revision request path is offered; material changes queue for review.\n- Expected Outcome: Immediate denial with rationale; optional revision request tracked; visibility preserved until decision.\n\n### Rate limit reached during surge\n- Narrative: A member hits post or comment limits during high-traffic events.\n- Expected Outcome: Clear cooldown timing; draft preserved; automatic re-attempt guidance where applicable.\n\n### Email not verified but attempting to publish\n- Narrative: An authenticated but unverified user tries to publish or report.\n- Expected Outcome: Action blocked with instructions to verify; draft and selections preserved for completion post-verification.\n\n### Suspended user content visibility\n- Narrative: Past content of a suspended user is accessed.\n- Expected Outcome: Labels or limited visibility applied per policy; audit trail intact.\n\n### Fact-checker conflict of interest\n- Narrative: A factChecker attempts to annotate a close collaborator’s content.\n- Expected Outcome: Disclosure required; annotation held; routed to independent reviewer.\n\n### Moderator conflict-of-interest recusal\n- Narrative: A moderator is assigned a report involving a recently sanctioned author.\n- Expected Outcome: Automatic reassignment; recusal captured in audit.\n\n### Appeals window and reinstatement\n- Narrative: A sanctioned user appeals within the allowed window.\n- Expected Outcome: Acknowledgement with tracking ID; independent review within SLA; clear outcome notification with rationale.\n\n### Multi-device session revocation\n- Narrative: A member revokes all device sessions due to suspected account sharing.\n- Expected Outcome: Active sessions terminate within a minute; re-authentication required across devices.\n\n### Timezone and localization handling\n- Narrative: A traveling user views timestamps across timezones.\n- Expected Outcome: Timestamps reflect preference with clear offsets; original post time remains interpretable.\n\n### Duplicate reports and stale links\n- Narrative: Multiple users report the same content; a link in the content is stale.\n- Expected Outcome: Reports merged; stale link warning provided to author; prioritization considers deduplication.\n\n### Long thread management\n- Narrative: A thread exceeds typical length and depth.\n- Expected Outcome: Participants can navigate with summaries and structured context in business terms; moderation tools highlight hotspots.\n\n### Cross-posting and archived topics\n- Narrative: Content cross-posted between related categories; topic later archived.\n- Expected Outcome: Cross-post references remain consistent; archived topics retain read access; posting disabled in archived topics.\n\n## Abuse and Misuse Scenarios\n\n### Coordinated brigading and vote manipulation\n- Behavior: New or low-trust accounts mass-upvote or downvote to distort consensus.\n- Mitigations: Weighted voting by trust signals; burst-limiting; correlation detection; moderator review flags.\n- Expected Outcomes: Reduced manipulative impact; investigation trails available.\n\n### Misinformation campaigns in civic contexts\n- Behavior: Misleading claims surge during elections or emergencies.\n- Mitigations: Priority routing to factChecker and moderator; interstitial context; reduced amplification pending review.\n- Expected Outcomes: Timely labels and context; preserved legitimate debate.\n\n### Harassment and doxxing\n- Behavior: Targeted harassment, threats, or non-consensual personal data sharing.\n- Mitigations: Immediate removal of personal data; protective actions (mutes/suspensions); targeted reporting paths.\n- Expected Outcomes: Rapid protection; proportionate sanctions; comprehensive audit.\n\n### Spam and link farming\n- Behavior: Low-quality promotional links at scale; link shorteners with tracking.\n- Mitigations: Strict rate limits; link reputation checks; auto-collapsing repetitive posts; escalating sanctions.\n- Expected Outcomes: Reduced spam visibility; legitimate links unaffected.\n\n### Sockpuppetry and duplicate accounts\n- Behavior: Multiple accounts used to evade sanctions or fake consensus.\n- Mitigations: Behavioral analytics; stricter new-account limits; consolidated enforcement across linked accounts per policy.\n- Expected Outcomes: Evasion curtailed; sanctions applied across linked accounts.\n\n### Malicious or bad-faith reporting\n- Behavior: Repeatedly reporting compliant content to burden moderation.\n- Mitigations: Reporter reputation factoring; cooldowns for false reporting; sanctions for abuse.\n- Expected Outcomes: Lower false-positive load; preserved reporter functionality for good-faith users.\n\n### Sanction evasion attempts\n- Behavior: Editing to obscure violations; deleting evidence; obfuscation.\n- Mitigations: Immutable audit snapshots; pre-removal capture; post-edit re-checks; pattern detection.\n- Expected Outcomes: Evasion ineffective; accountability preserved.\n\n### Deepfake or synthetic media\n- Behavior: AI-generated media used to mislead.\n- Mitigations: Labeling workflows; request for provenance; fact-check affinity routing; temporary deamplification pending review.\n- Expected Outcomes: Harm reduced; clear labels; source transparency.\n\n### Mass-report brigading\n- Behavior: Coordinated campaigns to mass-report targeted users to silence them.\n- Mitigations: Deduplication, reputation weighting, and anomaly detection; independence rules for reviewers.\n- Expected Outcomes: Minimized abuse; protected speech for compliant content; auditability of report patterns.\n\n### Astroturfing by coordinated organizations\n- Behavior: Coordinated accounts simulate grassroots support.\n- Mitigations: Trust scoring, disclosure requirements, and distribution controls when applicable.\n- Expected Outcomes: Reduced misleading amplification; transparency labels when disclosures apply.\n\n## Acceptance Criteria (EARS)\n\nAll requirements use EARS with descriptions in en-US and keywords in English.\n\n### Core Participation and Posting\n- WHEN a verified email member publishes compliant content, THE civicDebateBoard SHALL make the content visible to the community within 3 seconds.\n- IF a member attempts to publish without verified email, THEN THE civicDebateBoard SHALL block the action and provide a clear verification path without content loss.\n- WHERE a post is newly created by its author, THE civicDebateBoard SHALL allow self-editing for up to 15 minutes from initial publication.\n- IF an edit is attempted after the self-edit window and the change is material, THEN THE civicDebateBoard SHALL route the edit for review and retain the original until a decision is made.\n- WHILE a post is under pre-moderation due to policy or trust signals, THE civicDebateBoard SHALL keep the post non-public and display pending status to the author.\n- WHEN a member follows a topic, THE civicDebateBoard SHALL include relevant new posts in the member’s personalized feed within 1 minute of publication.\n\n### AMA Sessions (Verified Expertise)\n- WHERE a session is tagged as \"expert\", THE civicDebateBoard SHALL restrict creation to verifiedMember and above.\n- WHEN an AMA is scheduled, THE civicDebateBoard SHALL publish the session post at the scheduled time in the host’s configured timezone.\n- WHEN questions are submitted to an active AMA, THE civicDebateBoard SHALL queue them for the host and reflect accepted questions to readers within 1 minute.\n- IF an AMA session ends, THEN THE civicDebateBoard SHALL present a summary section and archive the session for read access.\n\n### Reactions, Voting, and Anti-Manipulation\n- WHERE an account is newly created or low-trust, THE civicDebateBoard SHALL apply stricter voting and reaction rate limits than for established members.\n- WHEN a member casts a vote, THE civicDebateBoard SHALL reflect the vote effect in aggregates within 2 seconds.\n- IF correlated voting patterns exceed manipulation thresholds, THEN THE civicDebateBoard SHALL dampen aggregated impact and flag the activity for moderator review.\n- WHEN a member withdraws a vote within 10 minutes, THE civicDebateBoard SHALL reverse the aggregation accordingly.\n\n### Reporting and Moderation\n- WHEN a member submits a content report, THE civicDebateBoard SHALL acknowledge receipt instantly and assign a severity.\n- WHERE a report is high severity (e.g., doxxing, threats), THE civicDebateBoard SHALL notify a moderator queue within 2 minutes.\n- WHEN a moderator decides an outcome, THE civicDebateBoard SHALL notify the reporter and the author with the decision rationale within 1 minute of decision.\n- IF a report is dismissed, THEN THE civicDebateBoard SHALL record the dismissal rationale in the audit log and mark the report resolved.\n- WHEN a sanction is applied, THE civicDebateBoard SHALL enforce the sanction immediately across all user actions and persist its duration.\n- WHERE a conflict-of-interest is detected for a reviewer, THE civicDebateBoard SHALL reassign the case and record the recusal with rationale.\n\n### Fact-Checking and Annotations\n- WHEN a factChecker adds an annotation with sources, THE civicDebateBoard SHALL display the annotation contextually on the referenced claim within 3 seconds to all readers.\n- IF a factChecker proposes an enforcement-affecting label (e.g., reduced amplification), THEN THE civicDebateBoard SHALL require moderator confirmation before the label affects visibility.\n- WHERE a conflict of interest is declared, THE civicDebateBoard SHALL route the annotation to an independent reviewer and pause enforcement changes until review completes.\n- WHEN an author submits a correction addressing an accepted annotation, THE civicDebateBoard SHALL update the label to reflect the correction and display a transparency note.\n\n### Appeals and Restorative Processes\n- WHEN an author appeals a sanction within the allowed window, THE civicDebateBoard SHALL confirm receipt immediately and assign the appeal to a reviewer distinct from the original decision-maker.\n- WHILE an appeal is pending, THE civicDebateBoard SHALL maintain the current enforcement unless policy specifies otherwise.\n- WHEN an appeal is upheld, THE civicDebateBoard SHALL restore content visibility and notify affected parties within 1 minute.\n- IF an appeal results in modified sanctions, THEN THE civicDebateBoard SHALL update enforcement and communicate changes with rationale.\n\n### Notifications and Subscriptions (Instant and Digest)\n- WHEN a followed thread receives a direct reply to the member’s content, THE civicDebateBoard SHALL send a notification within 1 minute.\n- WHERE a member disables a notification category, THE civicDebateBoard SHALL cease notifications for that category within 1 minute.\n- IF a notification cannot be delivered, THEN THE civicDebateBoard SHALL record a delivery failure and retry according to policy without duplicating user-visible messages.\n- WHEN a member opts into daily digests for a category, THE civicDebateBoard SHALL include top items and deliver the digest according to the configured schedule.\n\n### Account Lifecycle and Sessions\n- WHEN a member revokes all sessions, THE civicDebateBoard SHALL terminate active sessions within 1 minute and require re-authentication.\n- WHERE an account is suspended, THE civicDebateBoard SHALL restrict all posting, voting, and reporting actions for the suspension duration and label historical content per policy.\n- IF a suspended account attempts a restricted action, THEN THE civicDebateBoard SHALL deny the action and display the remaining suspension duration.\n\n### Accessibility, Inclusivity, and Localization\n- THE civicDebateBoard SHALL present timestamps according to the user’s timezone preference with clear offset indicators.\n- WHERE content includes sensitive topics, THE civicDebateBoard SHALL allow readers to access contextual safety and policy information within 2 clicks from the content.\n- THE civicDebateBoard SHALL ensure that all user-facing messages are concise, unambiguous, and free of technical jargon.\n\n### Transparency and Auditability\n- WHEN any moderation or fact-check event occurs, THE civicDebateBoard SHALL record who initiated it, the reason category, the decision, and the time, in an immutable audit trail.\n- IF a moderator is reassigned due to conflict of interest, THEN THE civicDebateBoard SHALL record the reassignment with rationale and timestamps.\n- WHERE a role change is performed by an admin, THE civicDebateBoard SHALL notify the affected user and list the effective permissions change.\n- WHEN an election window is activated, THE civicDebateBoard SHALL display an activation notice in transparency logs and apply elevated SLAs to relevant categories.\n\n### Performance and Experience Expectations\n- THE civicDebateBoard SHALL render user-triggered state changes (publish, vote, follow, report) as complete within 3 seconds in typical conditions.\n- WHERE system load is elevated, THE civicDebateBoard SHALL continue to acknowledge user actions instantly and complete processing within published SLAs.\n\n## Traceability and References\n- Strategic and business model context: [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Stepwise business workflows and diagrams: [User Flows and Processes](./05-user-flows-and-processes.md).\n- Formal capabilities, validations, and rules: [Functional Requirements](./06-functional-requirements.md).\n\nEnd of document.","tokenUsage":{"total":76893,"input":{"total":68853,"cached":0},"output":{"total":8040,"reasoning":1536,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":6,"step":0,"created_at":"2025-08-15T02:43:24.631Z"},"tokenUsage":{"aggregate":{"total":708763,"input":{"total":593457,"cached":19328},"output":{"total":115306,"reasoning":37696,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":705941,"input":{"total":591150,"cached":19328},"output":{"total":114791,"reasoning":37312,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Set measurable expectations for performance, availability, scalability, and operability from a user-experience perspective.","filename":"08-non-functional-requirements-and-slas.md","documentType":"requirement","outline":["Performance Targets (response time by scenario)","Availability and Reliability Objectives","Capacity and Scalability Goals","Rate Limiting and Fair-Use Policies","Observability Expectations (logging, metrics, alerting in business terms)","Backup and Disaster Recovery Objectives (RTO/RPO)","Internationalization and Timezone Considerations","EARS-Formatted Non-Functional Requirements"],"audience":"development team","keyQuestions":["What performance should users experience in common and peak scenarios?","What availability and recovery objectives are required?","How should fair use be enforced?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","09-security-privacy-and-compliance.md"],"constraints":["All targets must be specific and measurable","Use EARS where applicable","Avoid architecture or technology prescriptions"],"content":"# Non-Functional Requirements and SLAs — civicDebateBoard\n\nThis document defines business expectations for performance, availability, scalability, operability, and continuity of the civicDebateBoard service. It describes WHAT the system must achieve from a user-experience perspective and operational outcomes. All technical implementation decisions (architecture, APIs, databases, tooling) are at the discretion of the development team.\n\n## Performance Targets (response time by scenario)\n\nPerformance targets are expressed at percentile levels measured at the service boundary from the user’s request to the system’s response, excluding end-user network variability but including all server-side processing. Targets apply during normal operations; separate peak and surge targets are defined for predictable events (e.g., elections, major civic news cycles).\n\n### Core Read Scenarios\n- Thread view (initial load of a discussion with first page of comments)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Subsequent page loads in same thread: p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Topic/Category feed listing (first page)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Pagination/“next” fetches: p95 ≤ 0.7 s; p99 ≤ 1.4 s\n- Notifications list fetch (latest 50 items)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- User profile read (public view)\n  - p95 ≤ 0.7 s; p99 ≤ 1.2 s\n\n### Write and Interaction Scenarios\n- Create post (including server-side validations and topic/tag processing)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n- Edit post within allowed policy window\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Create comment or reply\n  - p95 ≤ 0.9 s; p99 ≤ 1.8 s\n- Add reaction (like/support) or cast vote\n  - p95 ≤ 0.5 s; p99 ≤ 1.0 s\n  - Cross-device reflection of the action (eventual consistency): visible to the same user’s other sessions within 2.0 s (p95) and 5.0 s (p99)\n- Report content (submit report with category and notes)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Fact-check annotation submission (by factChecker)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n\n### Search and Discovery\n- Simple search (keyword over titles/content, default filters)\n  - p95 ≤ 1.5 s; p99 ≤ 3.0 s\n- Advanced search (multiple filters such as date range, tags, author)\n  - p95 ≤ 2.5 s; p99 ≤ 5.0 s\n- Autocomplete suggestions (typeahead)\n  - p95 ≤ 0.3 s; p99 ≤ 0.6 s\n\n### Authentication and Account Management (business perspective)\n- Login with valid credentials\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n- Email verification link consumption\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Password reset flow (token validation and new password set)\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n\n### Background and Asynchronous Outcomes (user-observable)\n- Notification delivery for direct mentions and replies\n  - p95 ≤ 10 s; p99 ≤ 30 s from event occurrence\n- Moderation decision visibility after decision recorded\n  - p95 ≤ 10 s; p99 ≤ 60 s to all relevant views\n- Indexing latency for search after new content\n  - p95 ≤ 30 s; p99 ≤ 120 s\n\n### Concurrency and Throughput Assumptions (business-facing)\n- Baseline steady state: 10,000 concurrent authenticated users, 2,000 read requests/s, 500 write requests/s\n- Peak predictable events (e.g., election nights): up to 50,000 concurrent users, 10,000 read requests/s, 2,000 write requests/s\n- Short surge (≤ 10 minutes) due to breaking news: up to 2× peak for reads and 1.5× peak for writes\n- Performance targets SHALL hold under baseline; during peak/surge windows, p95 and p99 targets may degrade by at most +30% latency while maintaining availability objectives\n\n## Availability and Reliability Objectives\n\nAvailability targets define user-facing uptime for core capabilities. Objectives are measured monthly unless specified.\n\n### Service-Level Objectives (SLOs)\n- Core read operations (view thread, list feeds): SLO 99.95% monthly availability\n- Core write operations (create/edit posts/comments, vote/reaction): SLO 99.90% monthly availability\n- Authentication and session operations: SLO 99.90% monthly availability\n- Search services: SLO 99.90% monthly availability\n\n### Error Budgets (aligned to SLOs)\n- 99.95% monthly leaves 21.6 minutes unavailability budget\n- 99.90% monthly leaves 43.8 minutes unavailability budget\n- Error budget consumption triggers progressive change freeze: at 50% consumption, restrict non-critical changes; at 100% consumption, freeze non-emergency changes until budget resets\n\n### Maintenance Windows\n- Planned maintenance may occur up to 60 minutes per month, scheduled at low-traffic times and announced at least 72 hours in advance, with local-time communication for impacted regions.\n- Degraded-mode maintenance (read-only) is preferred over full downtime.\n\n### Graceful Degradation Expectations\n- During service impairment, the system prioritizes read availability over non-critical write operations and background tasks to preserve civic discourse continuity.\n- Non-critical features (e.g., heavy analytics exports) may be temporarily disabled to protect core SLOs.\n\n## Capacity and Scalability Goals\n\n- Capacity planning horizon: 12 months rolling with quarterly review.\n- Headroom policy: maintain ≥ 30% spare capacity over the 95th percentile observed demand; ≥ 50% spare during scheduled high-impact civic events.\n- Elasticity: scale-out actions shall commence within 2 minutes of sustained (≥ 5 minutes) demand beyond headroom; scale-in after 30 minutes of sub-70% utilization to avoid thrashing.\n- Data growth assumptions: 1–2 million new posts/month, 10–20 million new comments/month, linear growth in reactions and votes.\n- Multi-tenant fairness: ensure per-topic or per-region spikes do not starve other topics/regions.\n\n## Rate Limiting and Fair-Use Policies\n\nRate limits exist to protect platform health, fairness, and discourse integrity. Limits are enforced per authenticated user and, where applicable, per-IP to mitigate abuse. Role-specific limits reflect trust and responsibility. Administrative and moderation functions required to maintain safety are exempt from general content-creation caps but remain subject to overall platform protection measures.\n\n### Action-Based Daily Quotas by Role\n\n| Action (per 24h rolling window) | member | verifiedMember | factChecker | moderator | admin |\n|---------------------------------|--------|----------------|-------------|-----------|-------|\n| Create posts                    | 30     | 60             | 60          | 120       | 240   |\n| Comments/replies                | 300    | 600            | 600         | 1,200     | 2,400 |\n| Reactions (likes/support)       | 3,000  | 5,000          | 5,000       | 10,000    | 20,000|\n| Votes (polls/ballots)           | 1,000  | 2,000          | 2,000       | 5,000     | 10,000|\n| Reports submitted               | 100    | 200            | 300         | 5,000     | 5,000 |\n| Fact-check annotations          | —      | —              | 100         | 300       | 300   |\n| Data exports (on-demand)        | 2      | 2              | 4           | 10        | 20    |\n\nNotes:\n- “—” means action not available to that role.\n- High-volume administrative operations that affect many items may require additional confirmations and audit entries per policy in the moderation and compliance documents.\n\n### Per-User and Per-IP Request Shaping\n- Sustained per-user request rate: 60 requests/minute with burst up to 3× for 10 seconds; cooldown applies if exceeded.\n- Per-IP guideline: 120 requests/minute with burst up to 3× for 10 seconds; stricter thresholds may apply for shared networks exhibiting abusive patterns.\n- Search-specific limit: 20 queries/minute (member), 40 (verifiedMember), 60 (factChecker), 120 (moderator/admin). Hourly caps 100/200/300/600 respectively.\n\n### Abuse Response and Recovery\n- Progressive throttling: soft warnings, temporary slowdowns, then hard blocks within the 24h window; resets occur after the rolling window elapses.\n- Human verification steps may be required when automated abuse signals exceed thresholds.\n- Accuracy-weighted reporting: frequent inaccurate reporters may see reduced report quotas until accuracy improves per moderation policies.\n\n## Observability Expectations (business terms)\n\nObservability ensures the team can detect, triage, and resolve issues quickly, protecting user experience and SLAs. Expectations are expressed as outcomes and signal categories, not tooling.\n\n### Business Event Logging\n- Authentication events: registration, login success/failure, logout, email verification, password reset, device/session revocation.\n- Content lifecycle: post/comment creation, edits, deletions, restores, visibility changes (e.g., moderation actions), tagging/topic updates.\n- User safety: reports, triage outcomes, sanctions applied, appeals and outcomes.\n- Configuration and policy changes: role assignments, feature toggles, category/tag configuration, sanctions configuration.\n- Data access requiring elevated permissions: exports and policy audits.\n\nLogs must include sufficient context to trace who acted, what changed, and when, in a privacy-compliant manner consistent with security and compliance requirements.\n\n### Metrics and Health Indicators\n- Latency distributions: p50/p95/p99 for key endpoints and flows defined in Performance Targets.\n- Availability: success rate per capability, excluding client/network errors beyond the service boundary.\n- Saturation: indicators of constrained capacity (e.g., queue depth, worker utilization) expressed as high-level health signals.\n- Workload: request rates, concurrency, job backlogs.\n- Business KPIs for operability: report backlog age, moderation decision latency, notification delivery latency.\n\n### Alerting and Operational Response\n- Alerting thresholds map to SLOs and user impact:\n  - Critical: immediate paging when projected to breach SLO within 30 minutes or when user-visible errors exceed 2% for 5 minutes.\n  - High: paging when p99 latency exceeds target by 50% for 10 minutes during baseline.\n  - Moderate: ticketing for chronic degradations not immediately user-visible.\n- On-call availability: 24/7 coverage with acknowledgement within 5 minutes (critical) and 15 minutes (high); mitigation or rollback initiated within 15 minutes (critical) and 30 minutes (high).\n- Post-incident review: completed within 5 business days with action items tracked to completion.\n\n#### Incident Alerting and Escalation Flow\n```mermaid\nsequenceDiagram\n  participant U as \"User Experience\"\n  participant M as \"Metrics/Alerts\"\n  participant OC as \"On-Call Engineer\"\n  participant IM as \"Incident Manager\"\n  participant ST as \"Service Team\"\n  U->>M: \"User-visible degradation detected\"\n  M-->>OC: \"Page (critical/high)\"\n  OC->>U: \"Mitigation actions (traffic shaping, feature gating)\"\n  OC->>IM: \"Declare incident and severity\"\n  IM->>ST: \"Coordinate response and updates\"\n  ST->>U: \"Restore service and confirm SLO compliance\"\n```\n\n## Backup and Disaster Recovery Objectives (RTO/RPO)\n\n- Backup coverage: all user-generated content, policy configurations, and audit records required for legal and operational accountability.\n- Backup frequency: at least every 15 minutes for critical transactional data; daily immutable snapshots for full datasets.\n- Retention: minimum 30 days online; 180 days in archive for compliance-relevant records, subject to privacy obligations.\n- Recovery Point Objective (RPO): ≤ 15 minutes for critical data; ≤ 60 minutes for non-critical indexes and caches.\n- Recovery Time Objective (RTO): ≤ 60 minutes for single-region outages affecting core operations; ≤ 4 hours for full regional failover.\n- Restore testing: quarterly restore drills for critical datasets with evidence of success and measured RTO/RPO compliance.\n\n#### Disaster Recovery Decision Flow\n```mermaid\ngraph LR\n  A[\"Degradation or Outage Detected\"] --> B{\"Within Error Budget?\"}\n  B -->|\"Yes\"| C[\"Mitigate and Monitor\"]\n  B -->|\"No\"| D[\"Initiate Failover Runbook\"]\n  C --> E{\"Resolved < 30 min?\"}\n  E -->|\"Yes\"| F[\"Close Incident\"]\n  E -->|\"No\"| D\n  D --> G[\"Restore Data to RPO Targets\"]\n  G --> H[\"Validate Core Capabilities\"]\n  H --> I{\"Meets RTO?\"}\n  I -->|\"Yes\"| F\n  I -->|\"No\"| J[\"Escalate and Communicate Extended ETA\"]\n```\n\n## Internationalization and Timezone Considerations\n\n- All user-visible timestamps are displayed in the user’s configured timezone and locale formats, with an option to view in UTC.\n- Relative time phrasing is acceptable when unambiguous and accompanied by absolute time upon request.\n- Daylight saving and regional calendar differences are respected when presenting date ranges and limits.\n- Rolling windows for rate limits are anchored to UTC for fairness and predictability, while user interfaces communicate remaining quotas in the user’s timezone.\n- Notifications and scheduled communications are delivered respecting the recipient’s local time windows when applicable (e.g., avoid sending at night based on preferences).\n\n## EARS-Formatted Non-Functional Requirements\n\n### Performance (Event-driven and Ubiquitous)\n- THE civicDebateBoard SHALL deliver thread view responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL deliver topic feed responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process post creation within 1.2 s at p95 and 2.5 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process comment creation within 0.9 s at p95 and 1.8 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process reactions and votes within 0.5 s at p95 and 1.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL make user actions visible across the user’s sessions within 2.0 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver simple search results within 1.5 s at p95 and 3.0 s at p99; advanced search within 2.5 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver login responses within 2.0 s at p95 and 4.0 s at p99.\n- THE civicDebateBoard SHALL deliver notifications within 10 s at p95 and 30 s at p99 from the triggering event.\n- WHERE peak or surge conditions occur, THE civicDebateBoard SHALL keep all latency targets within +30% of baseline p95/p99 values.\n\n### Availability and Reliability\n- THE civicDebateBoard SHALL maintain 99.95% monthly availability for core read operations.\n- THE civicDebateBoard SHALL maintain 99.90% monthly availability for core write operations, authentication, and search.\n- THE civicDebateBoard SHALL enforce error budgets aligned to SLOs and apply change freezes upon 100% budget consumption.\n- WHEN planned maintenance is required, THE civicDebateBoard SHALL announce at least 72 hours in advance and prefer read-only modes over downtime.\n- IF service impairment occurs, THEN THE civicDebateBoard SHALL degrade non-critical features to preserve read availability.\n\n### Capacity and Scalability\n- THE civicDebateBoard SHALL sustain baseline concurrency of 10,000 authenticated users, 2,000 read requests/s, and 500 write requests/s.\n- WHERE predictable civic events occur, THE civicDebateBoard SHALL sustain 50,000 concurrent users, 10,000 read requests/s, and 2,000 write requests/s.\n- WHILE demand exceeds headroom for ≥ 5 minutes, THE civicDebateBoard SHALL initiate scale-out so that user-facing performance targets continue to hold.\n- THE civicDebateBoard SHALL maintain ≥ 30% spare capacity over 95th percentile load and ≥ 50% during scheduled high-impact events.\n\n### Rate Limiting and Fair Use\n- THE civicDebateBoard SHALL enforce daily action quotas per role as specified in the Rate Limiting and Fair-Use Policies table.\n- THE civicDebateBoard SHALL enforce sustained per-user request rate of 60 requests/min with 3× burst for 10 seconds and apply cooldowns after exceedance.\n- THE civicDebateBoard SHALL enforce per-IP guidelines of 120 requests/min with 3× burst, with stricter controls for abusive patterns.\n- IF a user exceeds fair-use thresholds, THEN THE civicDebateBoard SHALL apply progressive throttling culminating in temporary blocks within the same 24h rolling window.\n- WHERE a user’s report accuracy score declines materially, THE civicDebateBoard SHALL proportionally reduce report quotas until accuracy improves.\n\n### Observability and Operations\n- THE civicDebateBoard SHALL record business events for authentication, content lifecycle, user safety, configuration changes, and elevated data access with sufficient context for accountability.\n- THE civicDebateBoard SHALL publish latency distributions (p50/p95/p99), availability rates, saturation, workload, and operability KPIs at a cadence suitable for real-time alerting and weekly reviews.\n- WHEN indicators project an SLO breach within 30 minutes, THE civicDebateBoard SHALL trigger critical alerts to on-call.\n- THE civicDebateBoard SHALL ensure on-call acknowledgement within 5 minutes for critical alerts and 15 minutes for high alerts.\n- THE civicDebateBoard SHALL initiate mitigation or rollback within 15 minutes for critical incidents and 30 minutes for high incidents.\n- THE civicDebateBoard SHALL complete post-incident reviews within 5 business days with tracked actions.\n\n### Backup and Disaster Recovery\n- THE civicDebateBoard SHALL create backups of critical transactional data at least every 15 minutes and daily immutable full snapshots.\n- THE civicDebateBoard SHALL meet RPO ≤ 15 minutes for critical data and ≤ 60 minutes for non-critical indexes and caches.\n- THE civicDebateBoard SHALL meet RTO ≤ 60 minutes for single-region core outages and ≤ 4 hours for full regional failover.\n- THE civicDebateBoard SHALL conduct quarterly restore drills and document evidence of success.\n\n### Internationalization and Timezone\n- THE civicDebateBoard SHALL display timestamps in the user’s configured timezone and locale, with an option to view in UTC.\n- THE civicDebateBoard SHALL anchor rolling-rate-limit windows to UTC while communicating remaining quotas in the user’s local time.\n- THE civicDebateBoard SHALL respect daylight saving rules and regional calendar differences when presenting ranges and limits.\n- WHERE user preferences specify quiet hours, THE civicDebateBoard SHALL align notification delivery windows accordingly.\n\n## References\n- See the [Functional Requirements Document](./06-functional-requirements.md) for business capabilities and rules related to content, discussions, and workflows.\n- See the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for obligations that intersect with observability, audit logging, data retention, and user rights.\n"},"plan":"Structure based on the provided outline:\n1) Performance Targets (response time by scenario) including baseline, peak, surge, async latencies, and concurrency/throughput assumptions.\n2) Availability and Reliability Objectives with SLOs, error budgets, maintenance windows, graceful degradation, and SLA measurement definitions.\n3) Capacity and Scalability Goals covering headroom, elasticity timing, data growth, and multi-tenant fairness.\n4) Rate Limiting and Fair-Use Policies with role-based quotas, per-user/IP shaping, abuse response and recovery.\n5) Observability Expectations (logging, metrics, alerting in business terms) including event logging scope, metrics, alerting, on-call SLAs, and incident flow.\n6) Backup and Disaster Recovery Objectives (RTO/RPO) with coverage, frequency, retention, restore testing, and DR decision flow.\n7) Internationalization and Timezone Considerations addressing timestamp display, DST, UTC anchoring for rate limits, and quiet hours.\n8) EARS-Formatted Non-Functional Requirements consolidating all enforceable outcomes.\nAdd supporting subsections for SLA Measurement & Reporting, Change Management & Release Governance, User-Facing Status Communications, Data Consistency Visibility, Third-Party Dependency Expectations, and Regionalization nuances, keeping within business requirements only.","review":"Enhance for completeness, specificity, and EARS compliance. Targets must be measurable with percentiles and explicit thresholds. Include SLA measurement methodology, exclusions, and user-facing communications. Ensure role-aware fair-use limits, observability outcomes (not tooling), incident response SLAs, RTO/RPO with cadence for restore tests, internationalization/timezone handling, and links using descriptive titles. Mermaid: all labels in double quotes, no spaces between brackets/braces and quotes, correct arrows (-->), LR orientation preferred, no nested quotes. Prohibit technical prescriptions (no APIs, schemas, or architecture). Remove vague phrases; convert to EARS where applicable. Document length 5,000–30,000+ characters. Maintain business-only scope and developer autonomy over implementation.","content":"# Non-Functional Requirements and SLAs — civicDebateBoard\n\n## Performance Targets (response time by scenario)\n\nPerformance targets use percentile-based latency measured at the service boundary from user request receipt to first byte of server response. Targets exclude end-user network variability and device rendering but include all server-side processing and coordinated async acknowledgements documented as user-observable outcomes. Baseline, peak, and surge windows are defined to reflect civic-event dynamics.\n\n### Core Read Scenarios\n- Thread view (initial load of a discussion with first page of comments)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Subsequent page loads in same thread: p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Topic/Category feed listing (first page)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Pagination/“next” fetches: p95 ≤ 0.7 s; p99 ≤ 1.4 s\n- Notifications list fetch (latest 50 items)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- User profile read (public view)\n  - p95 ≤ 0.7 s; p99 ≤ 1.2 s\n\n### Write and Interaction Scenarios\n- Create post (including server-side validations and topic/tag processing)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n- Edit post within allowed policy window\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Create comment or reply\n  - p95 ≤ 0.9 s; p99 ≤ 1.8 s\n- Add reaction (like/support) or cast vote\n  - p95 ≤ 0.5 s; p99 ≤ 1.0 s\n  - Cross-device reflection (eventual consistency): visible to the same user’s other sessions within 2.0 s (p95) and 5.0 s (p99)\n- Report content (submit report with category and notes)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Fact-check annotation submission (by factChecker)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n\n### Search and Discovery\n- Simple search (keyword over titles/content, default filters)\n  - p95 ≤ 1.5 s; p99 ≤ 3.0 s\n- Advanced search (multiple filters such as date range, tags, author)\n  - p95 ≤ 2.5 s; p99 ≤ 5.0 s\n- Autocomplete suggestions (typeahead)\n  - p95 ≤ 0.3 s; p99 ≤ 0.6 s\n\n### Authentication and Account Management (business perspective)\n- Login with valid credentials\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n- Email verification link consumption\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Password reset flow (token validation and new password set)\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n\n### Background and Asynchronous Outcomes (user-observable)\n- Notification delivery for direct mentions and replies\n  - p95 ≤ 10 s; p99 ≤ 30 s from event occurrence\n- Moderation decision visibility after decision recorded\n  - p95 ≤ 10 s; p99 ≤ 60 s to all relevant views\n- Indexing latency for search after new content\n  - p95 ≤ 30 s; p99 ≤ 120 s\n\n### Concurrency and Throughput Assumptions (business-facing)\n- Baseline steady state: 10,000 concurrent authenticated users, 2,000 read requests/s, 500 write requests/s\n- Peak predictable events (e.g., election nights): up to 50,000 concurrent users, 10,000 read requests/s, 2,000 write requests/s\n- Short surge (≤ 10 minutes) due to breaking news: up to 2× peak for reads and 1.5× peak for writes\n- Targets SHALL hold under baseline; during peak/surge windows, p95 and p99 targets may degrade by at most +30% latency while maintaining availability objectives\n\n### Cold-Start and Cache Warm-Up Behavior\n- First access after cache cold start for any high-volume listing (topic feed, home feed) may incur up to +20% additional latency at p95 for ≤ 5 minutes after deployment or failover; p99 must remain within +30% of baseline.\n- Warm cache steady-state must regain baseline targets within 5 minutes of stabilization.\n\n### Payload and Pagination Consistency Expectations\n- Result pages for feeds and search SHALL contain 20 items by default with stable sorting and no duplicates across contiguous pages under the same query parameters.\n- Aggregated counters (reactions, votes) may be eventually consistent across sessions but MUST converge within 5 seconds at p99 for the acting user’s view.\n\n## Availability and Reliability Objectives\n\nAvailability targets are measured monthly unless specified. Availability is the proportion of successful user operations over total attempted operations for the capability, excluding client-originated failures outside the service boundary and scheduled maintenance within the announced window.\n\n### Service-Level Objectives (SLOs)\n- Core read operations (view thread, list feeds): 99.95% monthly availability\n- Core write operations (create/edit posts/comments, vote/reaction): 99.90% monthly availability\n- Authentication and session operations: 99.90% monthly availability\n- Search services: 99.90% monthly availability\n\n### Error Budgets and Release Governance\n- 99.95% monthly leaves 21.6 minutes unavailability budget; 99.90% leaves 43.8 minutes.\n- At 50% budget consumption: restrict non-critical changes and require explicit approval for risk-elevating deployments.\n- At 100% consumption: freeze non-emergency changes until budget resets.\n\n#### Change Freeze Trigger Flow\n```mermaid\ngraph LR\n  A[\"Track Error Budget Consumption\"] --> B{\"Reached 50%?\"}\n  B -->|\"Yes\"| C[\"Restrict Non-Critical Changes\"]\n  B -->|\"No\"| D[\"Continue Normal Changes\"]\n  C --> E{\"Reached 100%?\"}\n  D --> E\n  E -->|\"Yes\"| F[\"Freeze Non-Emergency Changes\"]\n  E -->|\"No\"| G[\"Monitor & Reassess Daily\"]\n```\n\n### Maintenance Windows\n- Planned maintenance up to 60 minutes per month, scheduled at low-traffic times and announced at least 72 hours in advance with local-time communication for impacted regions.\n- Prefer degraded-mode maintenance (read-only) over full downtime with clear user notices.\n\n### Graceful Degradation Expectations\n- Prioritize read availability over non-critical write operations and background tasks during impairments.\n- Temporarily disable heavy, non-essential features (e.g., bulk data exports) to protect core SLOs.\n\n### SLA Measurement and Reporting\n- Measurement window: monthly calendar period with daily rollups.\n- Inclusion criteria: successful operations are those completed within published latency and functional correctness; degraded but retried within the same interaction counts as success if within user-visible SLA.\n- Exclusions: client-side network errors, third-party outages beyond control with documented supplier incident references, and scheduled maintenance communicated ≥ 72 hours in advance.\n- Reporting: publish monthly availability summaries per capability with error budget status and top contributing incidents.\n\n### User-Facing Status Communications\n- Incident status pages and in-product banners must reflect current impact, affected capabilities, start time, and next update ETA.\n- Update cadence: every 30 minutes for active major incidents; every 60 minutes for minor incidents until resolved.\n\n## Capacity and Scalability Goals\n\n- Planning horizon: 12 months rolling with quarterly review.\n- Headroom policy: maintain ≥ 30% spare capacity over the 95th percentile observed demand; ≥ 50% during known high-impact civic events.\n- Elasticity: scale-out actions commence within 2 minutes of sustained (≥ 5 minutes) demand beyond headroom; scale-in after 30 minutes of sub-70% utilization to avoid thrashing.\n- Data growth assumptions: 1–2 million new posts/month, 10–20 million new comments/month; proportional growth in reactions and votes.\n- Multi-tenant fairness: per-topic or per-region spikes must not starve other topics/regions; apply isolation and quotas to protect fairness.\n\n### Data Consistency and Backlog Management\n- Async backlogs (notifications, indexing) must drain to within normal operating thresholds within 15 minutes after surge subsides.\n- Search indexing lag must meet p95 ≤ 30 s; p99 ≤ 120 s under steady-state and return to targets within 10 minutes post-surge.\n\n## Rate Limiting and Fair-Use Policies\n\nRate limits protect platform health and fairness. Limits are enforced per authenticated user and, where applicable, per-IP to mitigate abuse. Role-specific limits reflect trust and responsibility. Administrative and moderation functions necessary for safety are exempt from general content-creation caps but remain subject to platform protection.\n\n### Action-Based Daily Quotas by Role\n\n| Action (per 24h rolling window) | member | verifiedMember | factChecker | moderator | admin |\n|---------------------------------|--------|----------------|-------------|-----------|-------|\n| Create posts                    | 30     | 60             | 60          | 120       | 240   |\n| Comments/replies                | 300    | 600            | 600         | 1,200     | 2,400 |\n| Reactions (likes/support)       | 3,000  | 5,000          | 5,000       | 10,000    | 20,000|\n| Votes (polls/ballots)           | 1,000  | 2,000          | 2,000       | 5,000     | 10,000|\n| Reports submitted               | 100    | 200            | 300         | 5,000     | 5,000 |\n| Fact-check annotations          | —      | —              | 100         | 300       | 300   |\n| Data exports (on-demand)        | 2      | 2              | 4           | 10        | 20    |\n\nNotes:\n- “—” denotes action not available to that role.\n- High-volume administrative operations affecting many items may require additional confirmations and audit entries per safety and compliance policies.\n\n### Per-User and Per-IP Request Shaping\n- Sustained per-user request rate: 60 requests/minute with burst up to 3× for 10 seconds; cooldown applies if exceeded.\n- Per-IP guideline: 120 requests/minute with burst up to 3× for 10 seconds; stricter thresholds may apply for shared networks with abusive patterns.\n- Search-specific limit per minute/hour: 20/100 (member), 40/200 (verifiedMember), 60/300 (factChecker), 120/600 (moderator/admin).\n\n### Abuse Response and Recovery\n- Progressive throttling: soft warnings → temporary slowdowns → temporary blocks within the same 24h window; resets after the rolling window elapses.\n- Human verification may be required when automated abuse signals exceed thresholds.\n- Accuracy-weighted reporting: frequent inaccurate reporters may see reduced report quotas until accuracy improves per moderation policies.\n\n## Observability Expectations (business terms)\n\nObservability enables rapid detection, triage, and resolution of issues to protect user experience and SLAs. Expectations are stated as outcomes and signal categories, not tooling.\n\n### Business Event Logging\n- Authentication events: registration, login success/failure, logout, email verification, password reset, device/session revocation.\n- Content lifecycle: post/comment creation, edits, deletions, restores, visibility changes (e.g., moderation actions), tagging/topic updates.\n- User safety: reports, triage outcomes, sanctions applied, appeals and outcomes.\n- Configuration and policy changes: role assignments, feature toggles, category/tag configuration, sanctions configuration.\n- Elevated data access: exports and policy audits.\n\nLogs include sufficient context to trace who acted, what changed, and when, with privacy compliance consistent with security and compliance requirements.\n\n### Metrics and Health Indicators\n- Latency distributions: p50/p95/p99 for key flows defined in Performance Targets.\n- Availability: success rate per capability excluding client/network errors.\n- Saturation: high-level indicators (queue depth, worker utilization) of constrained capacity.\n- Workload: request rates, concurrency, job backlogs.\n- Operability KPIs: report backlog age, moderation decision latency, notification delivery latency.\n\n### Alerting and Operational Response\n- Thresholds mapped to SLOs and user impact:\n  - Critical: page immediately when projected to breach SLO within 30 minutes or user-visible errors exceed 2% for 5 minutes.\n  - High: page when p99 latency exceeds target by 50% for 10 minutes under baseline.\n  - Moderate: ticket for chronic degradations without immediate user impact.\n- On-call availability: 24/7 coverage with acknowledgement within 5 minutes (critical) and 15 minutes (high); mitigation or rollback initiated within 15 minutes (critical) and 30 minutes (high).\n- Post-incident review: completed within 5 business days with action items tracked to completion.\n\n#### Incident Alerting and Escalation Flow\n```mermaid\nsequenceDiagram\n  participant U as \"User Experience\"\n  participant M as \"Metrics/Alerts\"\n  participant OC as \"On-Call Engineer\"\n  participant IM as \"Incident Manager\"\n  participant ST as \"Service Team\"\n  U->>M: \"User-visible degradation detected\"\n  M-->>OC: \"Page (critical/high)\"\n  OC->>U: \"Mitigation actions(traffic shaping, feature gating)\"\n  OC->>IM: \"Declare incident and severity\"\n  IM->>ST: \"Coordinate response and updates\"\n  ST->>U: \"Restore service and confirm SLO compliance\"\n```\n\n### Change Management and Release Governance\n- Release windows: prefer low-traffic times aligned to major user regions; avoid scheduled releases during published election windows.\n- Canary/gradual rollout expectations: progressive exposure with rollback criteria tied to SLO deltas and error budget consumption.\n- Rollback targets: decision within 15 minutes of critical alert if regression persists.\n\n## Backup and Disaster Recovery Objectives (RTO/RPO)\n\n- Backup coverage: user-generated content, policy configurations, and audit records required for legal and operational accountability.\n- Backup frequency: at least every 15 minutes for critical transactional data; daily immutable snapshots for full datasets.\n- Retention: minimum 30 days online; 180 days in archive for compliance-relevant records, subject to privacy obligations.\n- Recovery Point Objective (RPO): ≤ 15 minutes for critical data; ≤ 60 minutes for non-critical indexes and caches.\n- Recovery Time Objective (RTO): ≤ 60 minutes for single-region outages affecting core operations; ≤ 4 hours for full regional failover.\n- Restore testing: quarterly restore drills for critical datasets with evidence of success and measured RTO/RPO compliance.\n\n#### Disaster Recovery Decision Flow\n```mermaid\ngraph LR\n  A[\"Degradation or Outage Detected\"] --> B{\"Within Error Budget?\"}\n  B -->|\"Yes\"| C[\"Mitigate and Monitor\"]\n  B -->|\"No\"| D[\"Initiate Failover Runbook\"]\n  C --> E{\"Resolved < 30 min?\"}\n  E -->|\"Yes\"| F[\"Close Incident\"]\n  E -->|\"No\"| D\n  D --> G[\"Restore Data to RPO Targets\"]\n  G --> H[\"Validate Core Capabilities\"]\n  H --> I{\"Meets RTO?\"}\n  I -->|\"Yes\"| F\n  I -->|\"No\"| J[\"Escalate and Communicate Extended ETA\"]\n```\n\n## Internationalization and Timezone Considerations\n\n- Timestamps are displayed in the user’s configured timezone and locale formats, with an option to view in UTC.\n- Relative time phrasing is acceptable when unambiguous and accompanied by absolute time upon request.\n- Daylight saving and regional calendar differences are respected for date ranges and limits.\n- Rolling windows for rate limits are anchored to UTC for fairness and predictability; user interfaces communicate remaining quotas in the user’s timezone.\n- Notifications and scheduled communications respect the recipient’s local quiet hours where configured.\n- Regional incident communications are localized to impacted regions’ local time with clear conversion to UTC for audit.\n\n## EARS-Formatted Non-Functional Requirements\n\n### Performance\n- THE civicDebateBoard SHALL deliver thread view responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL deliver topic feed responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process post creation within 1.2 s at p95 and 2.5 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process comment creation within 0.9 s at p95 and 1.8 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process reactions and votes within 0.5 s at p95 and 1.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL make user actions visible across the user’s sessions within 2.0 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver simple search results within 1.5 s at p95 and 3.0 s at p99; advanced search within 2.5 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver login responses within 2.0 s at p95 and 4.0 s at p99.\n- THE civicDebateBoard SHALL deliver notifications within 10 s at p95 and 30 s at p99 from the triggering event.\n- WHERE peak or surge conditions occur, THE civicDebateBoard SHALL keep latency targets within +30% of baseline p95/p99 values.\n- WHERE cache cold-start occurs after deployment or failover, THE civicDebateBoard SHALL restore baseline p95 latency within 5 minutes of stabilization.\n\n### Availability and Reliability\n- THE civicDebateBoard SHALL maintain 99.95% monthly availability for core read operations.\n- THE civicDebateBoard SHALL maintain 99.90% monthly availability for core write operations, authentication, and search.\n- THE civicDebateBoard SHALL enforce error budgets aligned to SLOs and apply change freezes upon 100% budget consumption.\n- WHEN planned maintenance is required, THE civicDebateBoard SHALL announce at least 72 hours in advance and prefer read-only modes over downtime.\n- IF service impairment occurs, THEN THE civicDebateBoard SHALL degrade non-critical features to preserve read availability.\n- THE civicDebateBoard SHALL publish monthly availability summaries per capability with error budget status and top contributing incidents.\n- WHEN a major incident is active, THE civicDebateBoard SHALL update the user-facing status at least every 30 minutes until resolution.\n\n### Capacity and Scalability\n- THE civicDebateBoard SHALL sustain baseline concurrency of 10,000 authenticated users, 2,000 read requests/s, and 500 write requests/s.\n- WHERE predictable civic events occur, THE civicDebateBoard SHALL sustain 50,000 concurrent users, 10,000 read requests/s, and 2,000 write requests/s.\n- WHILE demand exceeds headroom for ≥ 5 minutes, THE civicDebateBoard SHALL initiate scale-out to keep performance targets in compliance.\n- THE civicDebateBoard SHALL maintain ≥ 30% spare capacity over 95th percentile load and ≥ 50% during scheduled high-impact events.\n- WHEN async backlogs exceed normal thresholds during surge, THE civicDebateBoard SHALL recover to steady-state within 15 minutes after surge subsides.\n\n### Rate Limiting and Fair Use\n- THE civicDebateBoard SHALL enforce daily action quotas per role as specified in the Rate Limiting and Fair-Use Policies table.\n- THE civicDebateBoard SHALL enforce sustained per-user request rate of 60 requests/min with 3× burst for 10 seconds and apply cooldowns after exceedance.\n- THE civicDebateBoard SHALL enforce per-IP guidelines of 120 requests/min with 3× burst, with stricter controls for abusive patterns.\n- IF a user exceeds fair-use thresholds, THEN THE civicDebateBoard SHALL apply progressive throttling culminating in temporary blocks within the same 24h rolling window.\n- WHERE a user’s report accuracy score declines materially, THE civicDebateBoard SHALL proportionally reduce report quotas until accuracy improves.\n\n### Observability and Operations\n- THE civicDebateBoard SHALL record business events for authentication, content lifecycle, user safety, configuration changes, and elevated data access with sufficient context for accountability.\n- THE civicDebateBoard SHALL publish latency distributions (p50/p95/p99), availability rates, saturation, workload, and operability KPIs for real-time alerting and weekly reviews.\n- WHEN indicators project an SLO breach within 30 minutes, THE civicDebateBoard SHALL trigger critical alerts to on-call.\n- THE civicDebateBoard SHALL ensure on-call acknowledgement within 5 minutes for critical alerts and 15 minutes for high alerts.\n- THE civicDebateBoard SHALL initiate mitigation or rollback within 15 minutes for critical incidents and 30 minutes for high incidents.\n- THE civicDebateBoard SHALL complete post-incident reviews within 5 business days with tracked actions.\n- WHERE release risk is elevated, THE civicDebateBoard SHALL use progressive rollout and SHALL define rollback criteria tied to SLO deltas.\n\n### Backup and Disaster Recovery\n- THE civicDebateBoard SHALL create backups of critical transactional data at least every 15 minutes and daily immutable full snapshots.\n- THE civicDebateBoard SHALL meet RPO ≤ 15 minutes for critical data and ≤ 60 minutes for non-critical indexes and caches.\n- THE civicDebateBoard SHALL meet RTO ≤ 60 minutes for single-region core outages and ≤ 4 hours for full regional failover.\n- THE civicDebateBoard SHALL conduct quarterly restore drills and document evidence of success.\n- WHEN error budget thresholds are exceeded during an outage, THE civicDebateBoard SHALL initiate failover per the DR decision flow.\n\n### Internationalization and Timezone\n- THE civicDebateBoard SHALL display timestamps in the user’s configured timezone and locale, with an option to view in UTC.\n- THE civicDebateBoard SHALL anchor rolling-rate-limit windows to UTC while communicating remaining quotas in the user’s local time.\n- THE civicDebateBoard SHALL respect daylight saving rules and regional calendar differences when presenting ranges and limits.\n- WHERE user preferences specify quiet hours, THE civicDebateBoard SHALL align notification delivery windows accordingly.\n- WHEN incidents impact specific regions, THE civicDebateBoard SHALL localize communications to affected timezones and include UTC references.\n\n## References\n- Refer to the [Functional Requirements Specification](./06-functional-requirements.md) for capabilities and rules related to content, discussions, and workflows.\n- Refer to the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for obligations intersecting with observability, audit logging, data retention, and user rights.\n","tokenUsage":{"total":76717,"input":{"total":68888,"cached":0},"output":{"total":7829,"reasoning":2240,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":7,"step":0,"created_at":"2025-08-15T02:43:35.181Z"},"tokenUsage":{"aggregate":{"total":785480,"input":{"total":662345,"cached":19328},"output":{"total":123135,"reasoning":39936,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":782658,"input":{"total":660038,"cached":19328},"output":{"total":122620,"reasoning":39552,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Define authenticated roles, permissions, session behavior, and the business rules of authentication and authorization.","filename":"03-user-roles-and-authentication.md","documentType":"requirement","outline":["Authentication Requirements (Registration, Login, Logout, Email Verification, Password Reset, Session Management, Device Revocation)","Role Hierarchy and Permissions (member, verifiedMember, factChecker, moderator, admin)","Token Management (JWT) and Session Expiration Policies","Permission Matrix (Actions vs Roles)","Account Lifecycle (Creation, Verification, Suspension, Deletion, Appeals)","Auditability and Transparency Requirements"],"audience":"development team","keyQuestions":["What are the authenticated roles and what can each do or not do?","What business rules govern authentication, sessions, and token lifecycles?","How are account states handled across the lifecycle?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","07-content-moderation-and-safety-policies.md","09-security-privacy-and-compliance.md"],"constraints":["Must specify JWT-based token management requirements in business terms (access and refresh lifetimes, revocation expectations)","Must include a clear permission matrix","Use EARS for all applicable requirements","Avoid API or database specifications"],"content":"# User Roles and Authentication Requirements for civicDebateBoard\n\nThis document defines business requirements for authentication, authorization, user roles and permissions, token/session behavior, account lifecycle, and auditability for the civicDebateBoard service. It provides business requirements only; all technical implementation decisions (architecture, APIs, database design, cryptography choices, storage mechanisms) belong to the development team. This document describes WHAT the system must do in business terms, not HOW to build it.\n\nConsistent terminology in this document:\n- “the system” means the civicDebateBoard service.\n- “user” means a human end-user operating an account.\n- “session” means a login state tied to a device and a token pair.\n\nFor broader functional capabilities, refer to the [Functional Requirements Specification](./06-functional-requirements.md), the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md), and the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n\n## 1) Definitions and Role Overview\n\n- member: Authenticated community participant who can create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules.\n- verifiedMember: Identity- or expertise-verified participant with elevated trust level; may create expert-tagged posts, host AMAs, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while remaining subject to all policies.\n- factChecker: Trusted role allowed to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes; cannot apply sanctions directly.\n- moderator: Role responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, handling appeals within scope, and maintaining community health.\n- admin: Top-level role managing platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions plus administrative operations.\n\nEARS global principle:\n- THE civicDebateBoard service SHALL protect accounts, content integrity, and community safety through role-based access control, tokenized sessions, and auditable decision-making.\n\n## 2) Authentication Requirements\n\n### 2.1 Registration\n- WHEN a visitor provides required registration attributes (email and password), THE system SHALL create a pending account and send a verification message.\n- THE system SHALL require email uniqueness per account.\n- THE system SHALL enforce password policy at creation (see 2.5 Password Policy).\n- IF the email is already in use, THEN THE system SHALL reject registration with a clear, non-disclosing message.\n- WHERE legal age or jurisdictional constraints apply, THE system SHALL require age attestation and reject accounts that fail attestation.\n- THE system SHALL limit registration attempts to a maximum of 5 per IP within 1 hour and 2 per email within 24 hours.\n- IF registration throttling thresholds are exceeded, THEN THE system SHALL delay or block further attempts for the applicable cool-down period (minimum 1 hour).\n\n### 2.2 Email Verification\n- WHEN a registration completes, THE system SHALL send a verification link with a validity of 24 hours.\n- WHEN a user requests re-send, THE system SHALL allow up to 3 re-sends within 24 hours.\n- IF the verification link is expired or invalid, THEN THE system SHALL deny verification and provide a re-send path.\n- WHILE the account is unverified, THE system SHALL restrict posting and interaction capabilities to read-only and profile completion functions.\n- WHEN email verification succeeds, THE system SHALL mark the account as verified and lift unverified restrictions.\n\n### 2.3 Login\n- WHEN a user submits email and password, THE system SHALL validate credentials and respond within 2 seconds under normal load.\n- IF the credentials are invalid, THEN THE system SHALL reject login and increment a failed-attempt counter.\n- IF there are 10 failed login attempts for the same account within 15 minutes, THEN THE system SHALL lock login attempts for that account for 15 minutes and notify the user via the primary email.\n- WHERE optional multi-factor verification is required by policy or risk, THE system SHALL challenge with a secondary factor before establishing a session.\n- WHEN login succeeds, THE system SHALL establish a session associated with a specific device context and issue tokens per Section 4.\n\n### 2.4 Logout\n- WHEN a user invokes logout on a device, THE system SHALL immediately invalidate the corresponding session for that device.\n- WHEN a user invokes “logout from all devices”, THE system SHALL invalidate all sessions and tokens for that user within 60 seconds.\n\n### 2.5 Password Policy and Reset\n- THE system SHALL enforce password complexity at creation and change: minimum 10 characters; must include at least 3 of the following: uppercase letters, lowercase letters, digits, symbols; shall not contain the email local-part; shall not be one of the last 5 used passwords.\n- WHEN a user requests password reset, THE system SHALL send a reset link valid for 60 minutes.\n- IF a reset token is expired, revoked, or invalid, THEN THE system SHALL deny the reset and allow issuing a new token subject to rate limits (max 3 per 24 hours per account).\n- WHEN a password is successfully reset, THE system SHALL revoke all existing sessions and require re-login on all devices.\n\n### 2.6 Session Management\n- THE system SHALL associate each session with a user, a device context, and a token pair with independent lifetimes (see Section 4).\n- THE system SHALL allow up to 10 concurrent active sessions per user by default.\n- WHERE an organization or policy sets a lower limit, THE system SHALL enforce the configured maximum sessions per user.\n- WHEN a session exceeds its refresh lifetime, THE system SHALL require full login to re-establish a session.\n- WHILE a session is valid, THE system SHALL honor access tokens for authorization checks within their lifetime.\n\n### 2.7 Device Management and Revocation\n- THE system SHALL maintain a list of active sessions and device contexts visible to the account owner (device name, last activity time, approximate location, and creation time) without exposing sensitive identifiers.\n- WHEN the account owner revokes a device session, THE system SHALL invalidate that session’s tokens within 60 seconds and block further refresh for that session.\n- WHEN suspicious activity is detected (e.g., impossible travel, many failed refresh attempts), THE system SHALL flag the session for review and may require re-authentication on next action.\n\n## 3) Role Hierarchy and Permissions\n\nRole scope and escalation model:\n- THE system SHALL implement a hierarchical permission model where admin encompasses moderator permissions; moderator does not encompass admin; factChecker, verifiedMember, and member are orthogonal in scope except where explicitly extended.\n- WHERE a user holds multiple roles, THE system SHALL grant the union of permissions and enforce the strictest accountability and transparency rules that apply to any held role.\n\nRole capabilities (business-level):\n- member\n  - Create, edit, and delete own posts and comments within edit windows and policy.\n  - React, vote, follow topics, bookmark items, and report content.\n  - Manage own account and sessions within limits.\n- verifiedMember\n  - All member capabilities.\n  - Create expert-tagged posts; host AMAs; enjoy reduced pre-moderation and rate limits as defined by policy.\n  - Elevated accountability: content may require more detailed disclosures where applicable.\n- factChecker\n  - Add fact-check annotations tied to specific claims; attach sources and confidence levels.\n  - Flag misleading claims for review; propose corrections; generate transparency notes.\n  - No sanction powers; cannot edit or delete others’ content.\n- moderator\n  - Review reports and queues; apply policy decisions; edit/remove violating content.\n  - Issue warnings, mutes, suspensions within scope; handle appeals at first level.\n  - Access limited audit views necessary for case handling.\n- admin\n  - All moderator capabilities.\n  - Manage platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews.\n\nEARS role control examples:\n- WHEN a member attempts to apply a sanction, THE system SHALL deny the action and display insufficient permission.\n- WHEN a factChecker submits a fact-check note, THE system SHALL record it with attribution and route for visibility according to policy.\n- WHEN a moderator removes content, THE system SHALL record the reason, policy reference, and notify the content owner.\n- WHEN an admin changes a user’s role, THE system SHALL record the actor, old role(s), new role(s), timestamp, and justification.\n\n## 4) Token Management (JWT) and Session Expiration Policies\n\nBusiness requirements for tokenized sessions:\n- THE system SHALL use JWT for access and refresh tokens.\n- THE access token lifetime SHALL be 15 minutes.\n- THE refresh token lifetime SHALL be 14 days, with sliding renewal on successful refresh (rotation) up to a maximum of 30 days from last credentialed login.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and invalidate the previous refresh token.\n- IF a previously used refresh token is presented again (reuse), THEN THE system SHALL revoke the corresponding session and require full re-authentication.\n- WHEN a user logs out, THE system SHALL invalidate the associated refresh token(s) and disallow further refresh for that session.\n- THE JWT payload SHALL include at minimum: userId, role, permissions array suitable for authorization checks, issued-at time, expiry time, and a session identifier.\n- WHERE additional security context is configured (e.g., device identifier, risk score), THE system SHALL include business-relevant claims without exposing sensitive personal data.\n- THE system SHALL support immediate revocation within 60 seconds for logout-all and device revocation actions.\n\n## 5) Permission Matrix (Actions vs Roles)\n\nThe following matrix defines baseline permissions. Business rules and rate limits from related documents still apply. A check mark means “allowed by default,” a cross means “not allowed”; some actions are “Conditional” as noted.\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|---|---|---|---|---|---|\n| Register account | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Login / Logout | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View public content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Create post | ✅ (rate-limited) | ✅ (reduced limits) | ✅ (within policy) | ✅ | ✅ |\n| Create expert-tagged post | ❌ | ✅ | ❌ | ❌ | ✅ (for official posts) |\n| Edit own post (within window) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Delete own post (within window/policy) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Comment on posts | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Vote/React | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Follow topics / Bookmark | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Report content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Add fact-check annotation | ❌ | ❌ | ✅ | ✅ (with tag) | ✅ |\n| Flag misleading claims for review | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Propose corrections | ❌ | ❌ | ✅ | ✅ | ✅ |\n| Edit/remove others’ content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue warnings | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue mutes/suspensions | ❌ | ❌ | ❌ | ✅ (within scope) | ✅ |\n| Handle appeals (first level) | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Overturn moderator decision | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage roles and verifications | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage policies/categories/tags | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Approve data exports | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Access audit logs (case-limited) | ❌ | ❌ | ❌ | ✅ (need-to-know) | ✅ (full) |\n| Host AMAs | ❌ | ✅ | ❌ | ✅ (official) | ✅ |\n\nClarifications:\n- “within window” means within the edit/delete grace windows defined in the [Functional Requirements Specification](./06-functional-requirements.md).\n- “within scope” means within the sanction ranges and SLAs defined in the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## 6) Authorization Rules and Validation (Business Terms)\n\nGeneral authorization checks:\n- WHEN an action requires a specific role, THE system SHALL validate that the role is present in the current session’s permissions.\n- WHEN content ownership is required (e.g., edit own post), THE system SHALL validate the actor is the content owner and the action is within permitted time windows.\n- WHERE actions are rate-limited, THE system SHALL enforce limits per user and per device to prevent abuse.\n\nError-handling:\n- IF authorization fails, THEN THE system SHALL deny the action with an explanation appropriate to the user’s role and context without revealing sensitive internal details.\n- IF ownership validation fails, THEN THE system SHALL deny the action and indicate that only the owner may perform it within the permitted window.\n\n## 7) Account Lifecycle\n\nStates (business-level):\n- Registered(Unverified)\n- Email Verified\n- Active\n- Verified Member (overlay role state)\n- Muted (temporary, limited interactions)\n- Suspended (temporary, login allowed only to view notices and appeal)\n- Banned (permanent or long-term; login allowed only for appeals if policy allows)\n- Deleted (pending grace period) / Hard Deleted\n- Appeal Pending (overlay state)\n\nTransitions and rules:\n- WHEN registration completes, THE system SHALL place the account in Registered(Unverified).\n- WHEN email is verified within 24 hours, THE system SHALL transition to Email Verified.\n- WHEN profile minimums are met (if required), THE system SHALL mark the account Active.\n- WHERE identity or expertise verification is approved by admins, THE system SHALL grant verifiedMember.\n- WHEN a mute sanction is applied, THE system SHALL restrict posting and commenting for the mute duration while allowing read access.\n- WHEN a suspension is applied, THE system SHALL restrict all posting and commenting; login is allowed for reviewing notices and filing appeals.\n- WHEN a ban is applied, THE system SHALL disable access except appeal functions as policy dictates.\n- WHEN a user requests deletion, THE system SHALL place the account in Deleted (pending) state with a 30-day grace period for reversal.\n- IF the deletion grace period elapses without reversal, THEN THE system SHALL hard delete the account and irreversibly remove personal data subject to legal and audit obligations.\n- WHEN an appeal is filed, THE system SHALL mark the case Appeal Pending and pause escalation timelines until a decision is issued.\n- WHEN an appeal is granted, THE system SHALL restore the prior permissible state and record the justification.\n- WHEN an appeal is denied, THE system SHALL maintain the sanction state and record the justification.\n\nNotifications:\n- THE system SHALL notify users of state changes (verification, sanctions, appeals decisions, deletion) using their preferred notification channels per the [Functional Requirements Specification](./06-functional-requirements.md).\n\n## 8) Auditability and Transparency Requirements\n\n- THE system SHALL produce an immutable audit trail for security- and policy-relevant events: registrations, logins, logouts, token refreshes and revocations, password changes/resets, role assignments, sanctions, and appeals decisions.\n- THE system SHALL capture for each audited event: actor (user or system), target (user/content), action, timestamp, outcome (success/failure), and justification where applicable.\n- WHERE personal data minimization is required, THE system SHALL record only the minimum necessary identifiers.\n- WHEN moderators or admins take actions affecting user content or state, THE system SHALL require entering a policy reference and rationale.\n- THE system SHALL provide role-appropriate audit access: moderators see case-relevant records; admins can run compliance reviews.\n- IF evidence (e.g., screenshots, links) is attached to a moderation action, THEN THE system SHALL preserve references consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n\n## 9) Non-Functional Expectations for Authentication\n\n- THE system SHALL respond to successful login within 2 seconds under normal load (p95) and 4 seconds under peak load (p95).\n- THE system SHALL deliver verification and reset emails within 2 minutes under normal conditions; retries SHALL occur for transient failures for up to 30 minutes.\n- THE system SHALL support immediate logout-all and device revocation propagation within 60 seconds p95.\n- THE system SHALL enforce rate limits for registration, login, and reset flows as defined in Sections 2.1, 2.3, and 2.5.\n- WHERE service degradation occurs, THE system SHALL provide clear user-facing messages and safe fallback behaviors without exposing internal details.\n\n## 10) Detailed EARS Acceptance Criteria by Flow\n\n### 10.1 Registration and Verification\n- WHEN a user completes the sign-up form with a unique email and compliant password, THE system SHALL create an unverified account and send a verification email within 2 minutes.\n- IF the email is already registered, THEN THE system SHALL prevent account creation and present a non-enumerating message.\n- IF the verification link is invalid or expired, THEN THE system SHALL refuse verification and allow requesting a new link subject to rate limits.\n- WHEN verification is successful, THE system SHALL elevate the account to verified state and unlock standard interactions.\n\n### 10.2 Login, Logout, and Lockout\n- WHEN valid credentials are submitted, THE system SHALL issue tokens and create a session in less than 2 seconds.\n- IF invalid credentials are submitted, THEN THE system SHALL increment a failure counter and return an error without indicating which field is incorrect.\n- IF the account reaches 10 failed attempts in 15 minutes, THEN THE system SHALL impose a 15-minute lockout and notify the user’s email.\n- WHEN logout is requested, THE system SHALL invalidate the associated session’s refresh token within 60 seconds.\n- WHEN logout-all is requested, THE system SHALL invalidate all sessions for that user within 60 seconds.\n\n### 10.3 Password Reset and Change\n- WHEN a reset is requested, THE system SHALL send a reset link valid for 60 minutes and rate-limit to 3 per day per account.\n- WHEN a password is reset successfully, THE system SHALL revoke all sessions and require fresh login everywhere.\n- IF the new password fails complexity or reuse checks, THEN THE system SHALL reject the change with specific, actionable messages.\n\n### 10.4 Token Refresh and Reuse Detection\n- WHEN an access token expires, THE system SHALL allow refresh using a valid refresh token within its lifetime.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and issue a new access token.\n- IF a refresh token is detected as reused, THEN THE system SHALL revoke the session and require full login.\n\n### 10.5 Authorization by Role\n- WHEN an action requires moderator privileges, THE system SHALL permit the action only if the session includes moderator or admin roles.\n- WHEN a fact-check annotation is submitted, THE system SHALL record the annotation and attribute it to the factChecker role user.\n- IF a user without verifiedMember status attempts to create an expert-tagged post, THEN THE system SHALL deny the action and indicate the verification requirement.\n\n## 11) Diagrams\n\n### 11.1 Authentication and Token Refresh Flow\n```mermaid\ngraph LR\n  subgraph \"User Device\"\n    A[\"Submit Login(Email,Password)\"] --> B[\"Wait For Response\"]\n    H[\"Use Access Token For Requests\"] --> I{\"Access Token Expired?\"}\n    I -->|\"Yes\"| J[\"Send Refresh Token\"]\n    I -->|\"No\"| H\n  end\n  subgraph \"civicDebateBoard Service\"\n    C[\"Validate Credentials\"] --> D{\"Account State OK?\"}\n    D -->|\"Yes\"| E[\"Issue Access & Refresh Tokens\"]\n    D -->|\"No\"| F[\"Deny With Reason\"]\n    K[\"Validate Refresh Token\"] --> L{\"Refresh Valid?\"}\n    L -->|\"Yes\"| M[\"Rotate Refresh & Issue New Access\"]\n    L -->|\"No\"| F\n  end\n  A --> C\n  E --> B\n  B --> H\n  J --> K\n  M --> H\n```\n\n### 11.2 Account Lifecycle Overview\n```mermaid\ngraph LR\n  A[\"Registered(Unverified)\"] -->|\"Verify Email(<24h)\"| B[\"Email Verified\"]\n  B -->|\"Profile Minimums Met\"| C[\"Active\"]\n  C -->|\"Admin Grants Verification\"| D[\"Verified Member\"]\n  C -->|\"Issue Mute(<=7d)\"| E[\"Muted\"]\n  C -->|\"Issue Suspension(<=30d)\"| F[\"Suspended\"]\n  C -->|\"Ban\"| G[\"Banned\"]\n  E -->|\"Mute Ends\"| C\n  F -->|\"Suspension Ends\"| C\n  G -->|\"Appeal Filed\"| H[\"Appeal Pending\"]\n  H -->|\"Appeal Upheld\"| C\n  H -->|\"Appeal Denied\"| G\n  C -->|\"User Requests Deletion\"| I[\"Deleted(Pending)\"]\n  I -->|\"Grace Ends(30d)\"| J[\"Hard Deleted\"]\n  I -->|\"User Cancels Deletion\"| C\n```\n\n## 12) Data and Privacy Alignment (Business Terms)\n\n- THE system SHALL minimize personal data exposure in session and audit records consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n- WHERE legal hold or regulatory retention applies, THE system SHALL retain essential audit records without restoring interactive access for deleted or banned accounts.\n\n## 13) Success Criteria\n\n- Complete and correct enforcement of role-based permissions per matrix.\n- Reliable session handling with timely revocation and token rotation.\n- Clear, testable EARS requirements for all major flows (registration, login, logout, reset, refresh, authorization, lifecycle, auditability).\n- Alignment with safety policies and compliance documents without prescribing implementation.\n\nEnd of document."},"plan":"Document type: requirement. Audience: development team. Filename: 03-user-roles-and-authentication.md. Objective: Define authenticated roles, permissions, session behavior, and business rules for authentication/authorization. Outline to cover:\n1) Authentication Requirements (Registration, Login, Logout, Email Verification, Password Reset/Change, Session Management, Device Revocation, MFA, Idle Timeout/Remember Device, Email Change & Account Recovery)\n2) Role Hierarchy and Permissions (member, verifiedMember, factChecker, moderator, admin)\n3) Token Management (JWT) and Session Expiration Policies (lifetimes, rotation, reuse detection, revocation, payload claims, business key-management)\n4) Permission Matrix (Actions vs Roles)\n5) Authorization Rules and Validation\n6) Account Lifecycle (Creation, Verification, Suspension, Deletion, Appeals)\n7) Auditability and Transparency Requirements\n8) Non-Functional Expectations for Authentication\n9) Detailed EARS Acceptance Criteria by Flow (registration/verification, login/logout/lockout, password reset/change, token refresh/reuse detection, MFA, email change/recovery, session idle timeout/remember device, authorization by role)\n10) Diagrams (Auth/Refresh flow, Account Lifecycle)\n11) Data and Privacy Alignment\n12) Success Criteria\nConstraints: Use EARS extensively; include clear permission matrix; specify JWT lifetimes and revocation in business terms; avoid APIs/schemas/architecture; correct Mermaid syntax; descriptive links.","review":"Enhance to meet business-requirement standards with EARS compliance, correct Mermaid syntax, and completeness for authentication/authorization:\n- Length: 5,000–30,000+ chars, exhaustive, no placeholders\n- Requirements: Specific, measurable, testable; use EARS (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL)\n- Content scope: Business requirements only; no APIs, schemas, or implementation details\n- Auth completeness: Registration, login, logout, email verification, password reset/change, session management, device revocation, MFA, idle timeout, remember-device, email change, account recovery\n- Roles: member, verifiedMember, factChecker, moderator, admin; union-of-permissions with strictest accountability; permission matrix required\n- Token management (JWT): Access 15m, Refresh 14d sliding up to 30d; rotation and reuse detection; payload claims (userId, role, permissions, iat, exp, sessionId); revocation within 60s; business key-management obligations (rotation cadence, protection)\n- Lifecycle: States and transitions (unverified, verified, active, muted, suspended, banned, deleted pending/hard, appeal pending); notifications\n- Authorization: Ownership checks, rate limits, denial messaging; conflict-of-interest guardrails for elevated roles\n- Auditability: Immutable audit trail; evidence preservation; role-appropriate access; alignment with privacy/compliance\n- Non-functional auth expectations: Response time targets, email delivery SLAs, propagation windows\n- Mermaid: All labels in double quotes; no spaces between brackets/braces and quotes; correct arrow syntax (-->); subgraph names quoted; LR orientation preferred\n- Links: Descriptive link text only, relative paths valid\n- Prohibited: No database schemas, API specs, or architecture details","content":"# User Roles and Authentication Requirements for civicDebateBoard\n\nBusiness requirements for authentication, authorization, user roles and permissions, token/session behavior, account lifecycle, and auditability for the civicDebateBoard service. Business scope only; all technical implementation decisions (architecture, APIs, database design, cryptography choices, storage mechanisms) belong to the development team. Describes WHAT the system must do in business terms, not HOW to build it.\n\nTerminology\n- “the system”: the civicDebateBoard service\n- “user”: a human end-user operating an account\n- “session”: a login state tied to a device and a token pair\n\nRelated context\n- Functional capabilities: [Functional Requirements Specification](./06-functional-requirements.md)\n- Safety policies: [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md)\n- Security and privacy: [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md)\n\n## 1) Definitions and Role Overview\n\n- member: Authenticated community participant who can create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules.\n- verifiedMember: Identity- or expertise-verified participant with elevated trust level; may create expert-tagged posts, host AMAs, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while remaining subject to all policies.\n- factChecker: Trusted role allowed to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes; cannot apply sanctions directly.\n- moderator: Role responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, handling appeals within scope, and maintaining community health.\n- admin: Top-level role managing platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions plus administrative operations.\n\nEARS global principle\n- THE civicDebateBoard service SHALL protect accounts, content integrity, and community safety through role-based access control, tokenized sessions, and auditable decision-making.\n\n## 2) Authentication Requirements\n\n### 2.1 Registration\n- WHEN a visitor provides required registration attributes (email and password), THE system SHALL create a pending account and send a verification message.\n- THE system SHALL require email uniqueness per account.\n- THE system SHALL enforce password policy at creation (see 2.5 Password Policy and Reset).\n- IF the email is already in use, THEN THE system SHALL reject registration with a clear, non-enumerating message.\n- WHERE legal age or jurisdictional constraints apply, THE system SHALL require age attestation and reject accounts that fail attestation.\n- THE system SHALL limit registration attempts to a maximum of 5 per IP within 1 hour and 2 per email within 24 hours.\n- IF registration throttling thresholds are exceeded, THEN THE system SHALL delay or block further attempts for the applicable cool-down period (minimum 1 hour).\n\n### 2.2 Email Verification\n- WHEN a registration completes, THE system SHALL send a verification link with a validity of 24 hours.\n- WHEN a user requests re-send, THE system SHALL allow up to 3 re-sends within 24 hours.\n- IF the verification link is expired or invalid, THEN THE system SHALL deny verification and provide a re-send path.\n- WHILE the account is unverified, THE system SHALL restrict posting and interaction capabilities to read-only and profile completion functions.\n- WHEN email verification succeeds, THE system SHALL mark the account as verified and lift unverified restrictions.\n\n### 2.3 Login\n- WHEN a user submits email and password, THE system SHALL validate credentials and respond within 2 seconds under normal load.\n- IF the credentials are invalid, THEN THE system SHALL reject login and increment a failed-attempt counter.\n- IF there are 10 failed login attempts for the same account within 15 minutes, THEN THE system SHALL lock login attempts for that account for 15 minutes and notify the user via the primary email.\n- WHERE multi-factor verification is required by policy or risk, THE system SHALL challenge with a secondary factor before establishing a session (see 2.8 Multi-Factor Authentication).\n- WHEN login succeeds, THE system SHALL establish a session associated with a specific device context and issue tokens per Section 4.\n\n### 2.4 Logout\n- WHEN a user invokes logout on a device, THE system SHALL immediately invalidate the corresponding session for that device.\n- WHEN a user invokes “logout from all devices”, THE system SHALL invalidate all sessions and tokens for that user within 60 seconds.\n\n### 2.5 Password Policy and Reset\n- THE system SHALL enforce password complexity at creation and change: minimum 10 characters; must include at least 3 of the following: uppercase letters, lowercase letters, digits, symbols; shall not contain the email local-part; shall not be one of the last 5 used passwords.\n- WHEN a user requests password reset, THE system SHALL send a reset link valid for 60 minutes.\n- IF a reset token is expired, revoked, or invalid, THEN THE system SHALL deny the reset and allow issuing a new token subject to rate limits (max 3 per 24 hours per account).\n- WHEN a password is successfully reset, THE system SHALL revoke all existing sessions and require re-login on all devices.\n- WHEN a user changes password while authenticated, THE system SHALL enforce the same complexity and reuse rules and SHALL revoke all other device sessions within 60 seconds.\n\n### 2.6 Session Management\n- THE system SHALL associate each session with a user, a device context, and a token pair with independent lifetimes (see Section 4).\n- THE system SHALL allow up to 10 concurrent active sessions per user by default.\n- WHERE an organization or policy sets a lower limit, THE system SHALL enforce the configured maximum sessions per user.\n- WHEN a session exceeds its refresh lifetime, THE system SHALL require full login to re-establish a session.\n- WHILE a session is valid, THE system SHALL honor access tokens for authorization checks within their lifetime.\n\n### 2.7 Device Management and Revocation\n- THE system SHALL maintain a list of active sessions and device contexts visible to the account owner (device name, last activity time, approximate location, and creation time) without exposing sensitive identifiers.\n- WHEN the account owner revokes a device session, THE system SHALL invalidate that session’s tokens within 60 seconds and block further refresh for that session.\n- WHEN suspicious activity is detected (e.g., impossible travel, many failed refresh attempts), THE system SHALL flag the session for review and may require re-authentication on next action.\n\n### 2.8 Multi-Factor Authentication (MFA)\n- WHERE policy, risk scoring, or user preference requires MFA, THE system SHALL require a second factor in addition to password before session establishment.\n- THE system SHALL support recovery options appropriate to policy (e.g., backup codes) without prescribing mechanisms; recovery use SHALL be logged in audit trails.\n- WHERE a device is marked as trusted, THE system SHALL allow skipping MFA for that device for up to 30 days, after which MFA SHALL be required again.\n- IF MFA verification fails 5 times within 15 minutes, THEN THE system SHALL require a cool-down of 15 minutes before another attempt and SHALL notify the account email.\n\n### 2.9 Email Change and Account Recovery\n- WHEN a user requests to change the primary email, THE system SHALL verify current authentication, send confirmation to both old and new emails, and require confirmation within 24 hours to complete the change.\n- IF email change is not confirmed within 24 hours, THEN THE system SHALL cancel the change and retain the old email.\n- WHEN email is changed successfully, THE system SHALL require re-verification of the new email and SHALL revoke all active sessions except the current device session used to complete the change.\n- WHEN an account recovery is initiated due to lost email access, THE system SHALL require additional verification steps defined by policy and SHALL limit account functionality until recovery completes.\n\n### 2.10 Session Idle Timeout and Remember Device\n- WHILE a session is idle, THE system SHALL expire the interactive session after 30 minutes of inactivity and require re-authentication for further actions, without affecting the refresh token lifetime.\n- WHERE a “remember this device” preference is set, THE system SHALL maintain session refresh eligibility for up to 30 days from last credentialed login per Section 4, subject to revocation.\n- IF a high-risk action is initiated (e.g., role change, password change), THEN THE system SHALL require recent re-authentication regardless of idle time or remember-device status.\n\n## 3) Role Hierarchy and Permissions\n\nRole scope and escalation model\n- THE system SHALL implement a hierarchical permission model where admin encompasses moderator permissions; moderator does not encompass admin; factChecker, verifiedMember, and member are orthogonal in scope except where explicitly extended.\n- WHERE a user holds multiple roles, THE system SHALL grant the union of permissions and enforce the strictest accountability and transparency rules that apply to any held role.\n\nRole capabilities (business-level)\n- member\n  - Create, edit, and delete own posts and comments within edit windows and policy.\n  - React, vote, follow topics, bookmark items, and report content.\n  - Manage own account and sessions within limits.\n- verifiedMember\n  - All member capabilities.\n  - Create expert-tagged posts; host AMAs; enjoy reduced pre-moderation and rate limits as defined by policy.\n  - Elevated accountability: content may require more detailed disclosures where applicable.\n- factChecker\n  - Add fact-check annotations tied to specific claims; attach sources and confidence levels.\n  - Flag misleading claims for review; propose corrections; generate transparency notes.\n  - No sanction powers; cannot edit or delete others’ content.\n- moderator\n  - Review reports and queues; apply policy decisions; edit/remove violating content.\n  - Issue warnings, mutes, suspensions within scope; handle appeals at first level.\n  - Access limited audit views necessary for case handling.\n- admin\n  - All moderator capabilities.\n  - Manage platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews.\n\nEARS role controls\n- WHEN a member attempts to apply a sanction, THE system SHALL deny the action and display insufficient permission.\n- WHEN a factChecker submits a fact-check note, THE system SHALL record it with attribution and route for visibility according to policy.\n- WHEN a moderator removes content, THE system SHALL record the reason, policy reference, and notify the content owner.\n- WHEN an admin changes a user’s role, THE system SHALL record the actor, old role(s), new role(s), timestamp, and justification and SHALL notify the affected user.\n\n## 4) Token Management (JWT) and Session Expiration Policies\n\nBusiness requirements for tokenized sessions\n- THE system SHALL use JWT for access and refresh tokens.\n- THE access token lifetime SHALL be 15 minutes.\n- THE refresh token lifetime SHALL be 14 days, with sliding renewal on successful refresh (rotation) up to a maximum of 30 days from last credentialed login.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and invalidate the previous refresh token.\n- IF a previously used refresh token is presented again (reuse), THEN THE system SHALL revoke the corresponding session and require full re-authentication.\n- WHEN a user logs out, THE system SHALL invalidate the associated refresh token(s) and disallow further refresh for that session.\n- THE JWT payload SHALL include at minimum: userId, role, permissions array suitable for authorization checks, issued-at time, expiry time, and a session identifier.\n- WHERE additional security context is configured (e.g., device identifier, risk score), THE system SHALL include business-relevant claims without exposing sensitive personal data.\n- THE system SHALL support immediate revocation within 60 seconds for logout-all and device revocation actions.\n- WHERE clock skew between clients and the system exists, THE system SHALL allow a tolerance of up to 60 seconds for token validation decisions without extending token lifetimes.\n\nBusiness obligations for signing key management (non-technical)\n- THE system SHALL protect token-signing secrets as confidential business assets with access limited to personnel with a defined business need.\n- THE system SHALL rotate token-signing secrets on a regular cadence not to exceed 90 days and upon suspected exposure.\n- WHEN a key rotation occurs, THE system SHALL honor active sessions signed by prior keys for a limited overlap window consistent with security policy while ensuring new tokens use the new key.\n\n## 5) Permission Matrix (Actions vs Roles)\n\nBaseline permissions. Rate limits and policy rules still apply. A check mark means “allowed by default,” a cross means “not allowed”; some actions are “Conditional” as noted.\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|---|---|---|---|---|---|\n| Register account | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Login / Logout | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View public content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Create post | ✅ (rate-limited) | ✅ (reduced limits) | ✅ (within policy) | ✅ | ✅ |\n| Create expert-tagged post | ❌ | ✅ | ❌ | ❌ | ✅ (for official posts) |\n| Edit own post (within window) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Delete own post (within window/policy) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Comment on posts | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Vote/React | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Follow topics / Bookmark | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Report content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Add fact-check annotation | ❌ | ❌ | ✅ | ✅ (with tag) | ✅ |\n| Flag misleading claims for review | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Propose corrections | ❌ | ❌ | ✅ | ✅ | ✅ |\n| Edit/remove others’ content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue warnings | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue mutes/suspensions | ❌ | ❌ | ❌ | ✅ (within scope) | ✅ |\n| Handle appeals (first level) | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Overturn moderator decision | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage roles and verifications | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage policies/categories/tags | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Approve data exports | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Access audit logs (case-limited) | ❌ | ❌ | ❌ | ✅ (need-to-know) | ✅ (full) |\n| Host AMAs | ❌ | ✅ | ❌ | ✅ (official) | ✅ |\n\nClarifications\n- “within window” means within the edit/delete grace windows in the [Functional Requirements Specification](./06-functional-requirements.md).\n- “within scope” means within sanction ranges and SLAs in the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## 6) Authorization Rules and Validation (Business Terms)\n\nGeneral authorization checks\n- WHEN an action requires a specific role, THE system SHALL validate that the role is present in the current session’s permissions.\n- WHEN content ownership is required (e.g., edit own post), THE system SHALL validate the actor is the content owner and the action is within permitted time windows.\n- WHERE actions are rate-limited, THE system SHALL enforce limits per user and per device to prevent abuse.\n\nConflict-of-interest and sensitive actions\n- WHERE an action materially affects another user’s account state (e.g., permanent ban), THE system SHALL require the appropriate role and SHALL capture policy basis and rationale.\n- WHERE sanctions beyond 14 days are considered, THE system SHALL require admin review per safety policy documents.\n\nError-handling\n- IF authorization fails, THEN THE system SHALL deny the action with an explanation appropriate to the user’s role and context without revealing sensitive internal details.\n- IF ownership validation fails, THEN THE system SHALL deny the action and indicate that only the owner may perform it within the permitted window.\n\n## 7) Account Lifecycle\n\nStates (business-level)\n- Registered(Unverified)\n- Email Verified\n- Active\n- Verified Member (overlay role state)\n- Muted (temporary, limited interactions)\n- Suspended (temporary, login allowed only to view notices and appeal)\n- Banned (permanent or long-term; login allowed only for appeals if policy allows)\n- Deleted (pending grace period) / Hard Deleted\n- Appeal Pending (overlay state)\n- Dormant (overlay state for inactivity beyond policy threshold)\n\nTransitions and rules\n- WHEN registration completes, THE system SHALL place the account in Registered(Unverified).\n- WHEN email is verified within 24 hours, THE system SHALL transition to Email Verified.\n- WHEN profile minimums are met (if required), THE system SHALL mark the account Active.\n- WHERE identity or expertise verification is approved by admins, THE system SHALL grant verifiedMember.\n- WHEN a mute sanction is applied, THE system SHALL restrict posting and commenting for the mute duration while allowing read access.\n- WHEN a suspension is applied, THE system SHALL restrict all posting and commenting; login is allowed for reviewing notices and filing appeals.\n- WHEN a ban is applied, THE system SHALL disable access except appeal functions as policy dictates.\n- WHEN a user requests deletion, THE system SHALL place the account in Deleted (pending) with a 30-day grace period for reversal.\n- IF the deletion grace period elapses without reversal, THEN THE system SHALL hard delete the account and irreversibly remove personal data subject to legal and audit obligations.\n- WHEN an appeal is filed, THE system SHALL mark the case Appeal Pending and pause escalation timelines until a decision is issued.\n- WHEN an appeal is granted, THE system SHALL restore the prior permissible state and record the justification.\n- WHEN an appeal is denied, THE system SHALL maintain the sanction state and record the justification.\n- WHERE an account shows no activity for 12 months, THE system SHALL mark it Dormant and SHALL require re-verification on next login.\n\nNotifications\n- THE system SHALL notify users of state changes (verification, sanctions, appeals decisions, deletion, dormancy) using preferred channels per the [Functional Requirements Specification](./06-functional-requirements.md).\n\n## 8) Auditability and Transparency Requirements\n\n- THE system SHALL produce an immutable audit trail for security- and policy-relevant events: registrations, logins, logouts, token refreshes and revocations, password changes/resets, role assignments, sanctions, appeals decisions, email changes, MFA events, and recovery actions.\n- THE system SHALL capture for each audited event: actor (user or system), target (user/content), action, timestamp, outcome (success/failure), and justification where applicable.\n- WHERE personal data minimization is required, THE system SHALL record only the minimum necessary identifiers.\n- WHEN moderators or admins take actions affecting user content or state, THE system SHALL require entering a policy reference and rationale.\n- THE system SHALL provide role-appropriate audit access: moderators see case-relevant records; admins can run compliance reviews.\n- IF evidence (e.g., screenshots, links) is attached to a moderation action, THEN THE system SHALL preserve references consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n\n## 9) Non-Functional Expectations for Authentication\n\n- THE system SHALL respond to successful login within 2 seconds under normal load (p95) and 4 seconds under peak load (p95).\n- THE system SHALL deliver verification and reset emails within 2 minutes under normal conditions; retries SHALL occur for transient failures for up to 30 minutes.\n- THE system SHALL support immediate logout-all and device revocation propagation within 60 seconds p95.\n- THE system SHALL enforce rate limits for registration, login, reset, MFA, and recovery flows as defined in Sections 2.1, 2.3, 2.5, and 2.8–2.9.\n- WHERE service degradation occurs, THE system SHALL provide clear user-facing messages and safe fallback behaviors without exposing internal details.\n\n## 10) Detailed EARS Acceptance Criteria by Flow\n\n### 10.1 Registration and Verification\n- WHEN a user completes the sign-up form with a unique email and compliant password, THE system SHALL create an unverified account and send a verification email within 2 minutes.\n- IF the email is already registered, THEN THE system SHALL prevent account creation and present a non-enumerating message.\n- IF the verification link is invalid or expired, THEN THE system SHALL refuse verification and allow requesting a new link subject to rate limits.\n- WHEN verification is successful, THE system SHALL elevate the account to verified state and unlock standard interactions.\n\n### 10.2 Login, Logout, and Lockout\n- WHEN valid credentials are submitted, THE system SHALL issue tokens and create a session in less than 2 seconds.\n- IF invalid credentials are submitted, THEN THE system SHALL increment a failure counter and return an error without indicating which field is incorrect.\n- IF the account reaches 10 failed attempts in 15 minutes, THEN THE system SHALL impose a 15-minute lockout and notify the user’s email.\n- WHEN logout is requested, THE system SHALL invalidate the associated session’s refresh token within 60 seconds.\n- WHEN logout-all is requested, THE system SHALL invalidate all sessions for that user within 60 seconds.\n\n### 10.3 Password Reset and Change\n- WHEN a reset is requested, THE system SHALL send a reset link valid for 60 minutes and rate-limit to 3 per day per account.\n- WHEN a password is reset successfully, THE system SHALL revoke all sessions and require fresh login everywhere.\n- IF the new password fails complexity or reuse checks, THEN THE system SHALL reject the change with specific, actionable messages.\n- WHEN a password is changed by an authenticated user, THE system SHALL revoke all other device sessions within 60 seconds.\n\n### 10.4 Token Refresh and Reuse Detection\n- WHEN an access token expires, THE system SHALL allow refresh using a valid refresh token within its lifetime.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and issue a new access token.\n- IF a refresh token is detected as reused, THEN THE system SHALL revoke the session and require full login.\n- WHERE clock skew is present, THE system SHALL tolerate up to 60 seconds skew without extending token lifetime.\n\n### 10.5 Multi-Factor Authentication\n- WHEN MFA is required, THE system SHALL prompt for a second factor before completing login.\n- IF MFA attempts fail 5 times within 15 minutes, THEN THE system SHALL apply a 15-minute cool-down and notify the account email.\n- WHERE a device is marked trusted, THE system SHALL bypass MFA on that device for up to 30 days unless risk signals require re-prompt.\n\n### 10.6 Email Change and Account Recovery\n- WHEN a user requests to change the email, THE system SHALL send confirmations to old and new emails and SHALL require confirmation within 24 hours to complete.\n- IF the email change is not confirmed within 24 hours, THEN THE system SHALL cancel the change and retain the old email.\n- WHEN account recovery is initiated, THE system SHALL restrict sensitive actions until recovery completes and SHALL record recovery steps in the audit trail.\n\n### 10.7 Session Idle Timeout and Re-Authentication for Sensitive Actions\n- WHILE a session is idle for 30 minutes, THE system SHALL expire interactive access and require re-authentication for further actions.\n- WHEN a sensitive action is attempted (e.g., password change, role change), THE system SHALL require recent re-authentication even if within the idle window.\n\n### 10.8 Authorization by Role\n- WHEN an action requires moderator privileges, THE system SHALL permit the action only if the session includes moderator or admin roles.\n- WHEN a fact-check annotation is submitted, THE system SHALL record the annotation and attribute it to the factChecker role user.\n- IF a user without verifiedMember status attempts to create an expert-tagged post, THEN THE system SHALL deny the action and indicate the verification requirement.\n\n## 11) Diagrams\n\n### 11.1 Authentication and Token Refresh Flow\n```mermaid\ngraph LR\n  subgraph \"User Device\"\n    A[\"Submit Login(Email,Password)\"] --> B[\"Wait For Response\"]\n    H[\"Use Access Token For Requests\"] --> I{\"Access Token Expired?\"}\n    I -->|\"Yes\"| J[\"Send Refresh Token\"]\n    I -->|\"No\"| H\n  end\n  subgraph \"civicDebateBoard Service\"\n    C[\"Validate Credentials\"] --> D{\"Account State OK?\"}\n    D -->|\"Yes\"| E[\"Issue Access & Refresh Tokens\"]\n    D -->|\"No\"| F[\"Deny With Reason\"]\n    K[\"Validate Refresh Token\"] --> L{\"Refresh Valid?\"}\n    L -->|\"Yes\"| M[\"Rotate Refresh & Issue New Access\"]\n    L -->|\"No\"| F\n  end\n  A --> C\n  E --> B\n  B --> H\n  J --> K\n  M --> H\n```\n\n### 11.2 Account Lifecycle Overview\n```mermaid\ngraph LR\n  A[\"Registered(Unverified)\"] -->|\"Verify Email(<24h)\"| B[\"Email Verified\"]\n  B -->|\"Profile Minimums Met\"| C[\"Active\"]\n  C -->|\"Admin Grants Verification\"| D[\"Verified Member\"]\n  C -->|\"Issue Mute(<=7d)\"| E[\"Muted\"]\n  C -->|\"Issue Suspension(<=30d)\"| F[\"Suspended\"]\n  C -->|\"Ban\"| G[\"Banned\"]\n  E -->|\"Mute Ends\"| C\n  F -->|\"Suspension Ends\"| C\n  G -->|\"Appeal Filed\"| H[\"Appeal Pending\"]\n  H -->|\"Appeal Upheld\"| C\n  H -->|\"Appeal Denied\"| G\n  C -->|\"User Requests Deletion\"| I[\"Deleted(Pending)\"]\n  I -->|\"Grace Ends(30d)\"| J[\"Hard Deleted\"]\n  I -->|\"User Cancels Deletion\"| C\n  C -->|\"No Activity(12mo)\"| K[\"Dormant\"]\n  K -->|\"Login Attempt\"| B\n```\n\n## 12) Data and Privacy Alignment (Business Terms)\n\n- THE system SHALL minimize personal data exposure in session and audit records consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n- WHERE legal hold or regulatory retention applies, THE system SHALL retain essential audit records without restoring interactive access for deleted or banned accounts.\n\n## 13) Success Criteria\n\n- Complete and correct enforcement of role-based permissions per matrix.\n- Reliable session handling with timely revocation and token rotation.\n- Clear, testable EARS requirements for all major flows, including MFA, email change, idle timeout, and recovery.\n- Alignment with safety policies and compliance documents without prescribing implementation.\n","tokenUsage":{"total":78246,"input":{"total":69370,"cached":0},"output":{"total":8876,"reasoning":2176,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":8,"step":0,"created_at":"2025-08-15T02:44:01.384Z"},"tokenUsage":{"aggregate":{"total":863726,"input":{"total":731715,"cached":19328},"output":{"total":132011,"reasoning":42112,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":860904,"input":{"total":729408,"cached":19328},"output":{"total":131496,"reasoning":41728,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Define all functional capabilities, rules, and validations for the discussion board in unambiguous terms.","filename":"06-functional-requirements.md","documentType":"requirement","outline":["Content Model and Relationships (conceptual, non-technical)","Threading and Discussion Rules","Tagging, Topics, and Categories","Search and Discovery (filters, sorting)","Notifications and Subscriptions","Bookmarks and Follows","Localization and Timezone Handling (business perspective)","Accessibility and Inclusivity Expectations","Acceptance Criteria (EARS for all applicable requirements)"],"audience":"development team","keyQuestions":["What can users do and under what business rules?","What validations and constraints apply to actions?","How should content be organized and discovered?"],"detailLevel":"detailed specification","relatedDocuments":["05-user-flows-and-processes.md","07-content-moderation-and-safety-policies.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS format extensively","Specify measurable, testable business requirements","Avoid technical specifications (no APIs, schemas, or code)"],"content":"# Functional Requirements for civicDebateBoard\n\nThis document defines the complete set of business-functional requirements for the civicDebateBoard service. It specifies WHAT the system must do from a business perspective and how it should behave for users, without prescribing technical implementation details, APIs, database schemas, or infrastructure. All enforceable requirements are expressed in EARS where applicable to ensure clarity and testability. Developers retain full autonomy over architecture, APIs, and data design.\n\n## 1) Introduction and Scope\n- Purpose: Provide unambiguous, testable business rules governing content creation, discussion flows, organization, discovery, subscriptions, and user interactions for a civic discourse platform.\n- In-Scope: Posts, threads, comments/replies, reactions/votes, fact-check annotations, tags/topics/categories, search and discovery, notifications and subscriptions, bookmarks and follows, localization/timezone, accessibility and inclusivity, cross-cutting business rules (edits/deletions, attachments, mentions, rate limiting).\n- Out of Scope: Technical mechanisms (APIs, DB schemas, auth token formats), UI layout, styling, frontend interactions beyond business behavior.\n- Primary Roles: member, verifiedMember, factChecker, moderator, admin.\n\n## 2) Content Model and Relationships (conceptual, non-technical)\nConceptual entities (business definitions):\n- Post: Top-level content item that starts a discussion thread. Contains title, body, optional attachments/links, and optional tags/topics/categories.\n- Comment: A response to a Post or another Comment. Supports single-threaded parent-child relationships (reply chains) with depth limits.\n- Thread: The collection of a Post and all its Comments in hierarchical order.\n- Reaction/Vote: A simple expression of support or sentiment on a Post or Comment. Voting is limited to one per user per item per reaction type.\n- Fact-Check Annotation: A structured annotation attached to a Post or Comment by a factChecker, containing claim excerpts, ratings, evidence citations, and notes.\n- Report: A user-initiated flag on content for possible policy violation or quality issue.\n- Topic: A thematic grouping users can follow to receive relevant updates.\n- Tag: A free-form or controlled keyword applied to content for categorization and discovery.\n- Category: A curated taxonomy level for organizing threads (e.g., local issues, national policy, elections).\n- Subscription: A user’s preference to receive notifications about content, authors, or topics.\n- Bookmark: A user’s personal saved reference to content.\n\nMermaid relationship overview (conceptual):\n```mermaid\ngraph LR\n  A[\"User\"] --> B[\"Post\"]\n  B --> C[\"Comment\"]\n  C --> C2[\"Comment(Reply)\"]\n  B --> D[\"Reaction/Vote\"]\n  C --> D2[\"Reaction/Vote\"]\n  B --> E[\"Fact-Check Annotation\"]\n  C --> E2[\"Fact-Check Annotation\"]\n  B --> F[\"Report\"]\n  C --> F2[\"Report\"]\n  B --> G[\"Tag\"]\n  B --> H[\"Topic\"]\n  B --> I[\"Category\"]\n  A --> J[\"Subscription\"]\n  A --> K[\"Bookmark\"]\n```\n\nEARS requirements (core concepts and lifecycle):\n- THE civicDebateBoard SHALL treat a \"Post\" as the root item of a thread with a title and body.\n- THE civicDebateBoard SHALL treat a \"Comment\" as a reply to a Post or another Comment with exactly one parent.\n- THE civicDebateBoard SHALL allow a user to create exactly one Reaction/Vote per content item per reaction type.\n- THE civicDebateBoard SHALL associate zero or more Tags and zero or more Topics to a Post.\n- THE civicDebateBoard SHALL associate exactly one Category to a Post where category policy requires a single category.\n- THE civicDebateBoard SHALL allow factChecker to attach Fact-Check Annotations to Posts and Comments.\n- THE civicDebateBoard SHALL allow any authenticated user to create a Report on Posts and Comments within rate limits.\n- THE civicDebateBoard SHALL allow any authenticated user to create Bookmarks on Posts and Comments.\n\n## 3) Threading and Discussion Rules\n### 3.1 Posting and Commenting Permissions\n- WHERE role is \"member\" or \"verifiedMember\", THE civicDebateBoard SHALL permit creating Posts and Comments subject to community rules and rate limits.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL permit creating Posts and Comments under the same rules as member and adding Fact-Check Annotations.\n- WHERE role is \"moderator\" or \"admin\", THE civicDebateBoard SHALL permit all posting and commenting actions plus moderation controls defined in the content policies.\n- IF user is unauthenticated, THEN THE civicDebateBoard SHALL deny creating Posts or Comments and return an appropriate error.\n\n### 3.2 Validation Rules for Posts\n- THE civicDebateBoard SHALL require Post titles with length 10–150 characters.\n- THE civicDebateBoard SHALL require Post bodies with length 20–50,000 characters.\n- WHERE Post includes attachments, THE civicDebateBoard SHALL allow up to 5 attachments per Post with cumulative size up to 25 MB.\n- WHERE Post includes external links, THE civicDebateBoard SHALL require each link to use http or https and include a resolvable hostname.\n- WHERE role is \"verifiedMember\" and the post is marked as expert-tagged, THE civicDebateBoard SHALL require a topic area selection and an expertise declaration note up to 500 characters.\n\n### 3.3 Validation Rules for Comments\n- THE civicDebateBoard SHALL require Comment bodies with length 1–20,000 characters.\n- THE civicDebateBoard SHALL allow up to 3 attachments per Comment with cumulative size up to 10 MB.\n- THE civicDebateBoard SHALL allow a maximum reply depth of 5 levels including the root Post.\n\n### 3.4 Edits, Deletions, and Locking\n- WHEN a user edits their own Post, THE civicDebateBoard SHALL allow edits for 24 hours from creation unless the Post has been locked or sanctioned.\n- WHEN a user edits their own Comment, THE civicDebateBoard SHALL allow edits for 60 minutes from creation unless the thread is locked or sanctioned.\n- WHEN content is edited, THE civicDebateBoard SHALL preserve prior versions for audit visibility to moderators and admins.\n- IF a thread is locked by a moderator, THEN THE civicDebateBoard SHALL prohibit new Comments and further edits by non-moderators.\n- IF a Post is deleted by its author within 24 hours and has no Comments, THEN THE civicDebateBoard SHALL remove it from public discovery and retain a soft-deleted record for 30 days for audit.\n- IF a Comment is deleted by its author within 60 minutes, THEN THE civicDebateBoard SHALL replace it with a tombstone indicating deletion by author.\n\n### 3.5 Reactions and Voting\n- THE civicDebateBoard SHALL support one upvote per user per content item and allow removal (unvote) at any time.\n- WHERE reaction types include \"upvote\" and \"respectful\" reactions, THE civicDebateBoard SHALL limit to one per user per item per type.\n- WHEN a user attempts a duplicate reaction on the same item and type, THE civicDebateBoard SHALL toggle the reaction off.\n- IF a user attempts to react to their own content, THEN THE civicDebateBoard SHALL deny the action.\n\n### 3.6 Mentions\n- THE civicDebateBoard SHALL allow mentioning other users by handle within Posts and Comments using a validated handle format.\n- IF a mentioned user has blocked the author, THEN THE civicDebateBoard SHALL prevent the mention and inform the author.\n\n### 3.7 Fact-Check Annotations\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL allow attaching an annotation that includes: claim excerpt (1–1,000 chars), rating (e.g., \"accurate\", \"needs context\", \"misleading\", \"false\"), at least one source citation (valid http/https URL), and an explanation (1–2,000 chars).\n- WHEN an annotation is published, THE civicDebateBoard SHALL display an annotation badge and summary linked to the detailed note.\n- IF an annotation is flagged for policy issues, THEN THE civicDebateBoard SHALL queue it for moderator review and temporarily withhold visibility until resolved.\n\n## 4) Tagging, Topics, and Categories\n### 4.1 Tags\n- THE civicDebateBoard SHALL allow 0–10 tags per Post, each 1–30 characters, alphanumeric plus hyphens.\n- WHERE tags are controlled, THE civicDebateBoard SHALL restrict selection to approved tags; WHERE tags are free-form, THE civicDebateBoard SHALL normalize case and trim whitespace.\n\n### 4.2 Topics\n- THE civicDebateBoard SHALL allow users to follow Topics to receive notifications and discovery prioritization.\n- THE civicDebateBoard SHALL allow Post authors to associate 0–5 Topics with each Post.\n\n### 4.3 Categories\n- THE civicDebateBoard SHALL require exactly one Category per Post chosen from the active taxonomy.\n- WHERE a Category is changed by a moderator for policy reasons, THE civicDebateBoard SHALL update the Post categorization and record a moderation note.\n\n## 5) Search and Discovery (filters, sorting)\n### 5.1 Search Inputs and Validation\n- THE civicDebateBoard SHALL accept keyword search queries 1–100 characters and ignore stopwords.\n- THE civicDebateBoard SHALL support filtering by Category, Topic, Tag, author, role (author type), time range, and content type (Post or Comment).\n- THE civicDebateBoard SHALL support exclusion filters for Tags and Topics.\n\n### 5.2 Sorting Rules\n- THE civicDebateBoard SHALL support sorting by newest, oldest, most upvoted (24h, 7d, 30d, all-time), most commented (24h, 7d, 30d, all-time), and relevance for keyword queries.\n- WHERE no sort is specified, THE civicDebateBoard SHALL default to newest for non-search results and relevance for search results.\n\n### 5.3 Pagination and Result Limits\n- THE civicDebateBoard SHALL return results in pages of 20 items by default with user-selectable options of 10, 20, 50 per page.\n- THE civicDebateBoard SHALL cap total retrievable pages at 100 per query to ensure fair use.\n\n### 5.4 Safety and Quality in Discovery\n- IF a Post is under active moderation hold, THEN THE civicDebateBoard SHALL exclude it from public discovery views until resolved.\n- WHERE fact-check annotations exist, THE civicDebateBoard SHALL surface an annotation indicator in listings and allow filtering by annotation rating.\n\n## 6) Notifications and Subscriptions\n### 6.1 Subscription Types\n- THE civicDebateBoard SHALL allow users to subscribe to: author updates, thread updates (Post-level), Topic updates, and Category digests.\n\n### 6.2 Triggering Events\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL notify subscribers within 1 minute.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify the mentioned user within 1 minute.\n- WHEN a factChecker publishes an annotation on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n- WHERE Category digests are enabled, THE civicDebateBoard SHALL send a daily summary including top items by votes and comments.\n\n### 6.3 Frequency and Throttling\n- THE civicDebateBoard SHALL bundle notifications for the same thread within a 10-minute window.\n- IF a user disables notifications for a specific thread, THEN THE civicDebateBoard SHALL cease further notifications for that thread until re-enabled.\n\n## 7) Bookmarks and Follows\n- THE civicDebateBoard SHALL allow users to bookmark any Post or Comment for later reference.\n- THE civicDebateBoard SHALL allow users to follow authors and Topics to personalize discovery and notifications.\n- IF a user unfollows an author or Topic, THEN THE civicDebateBoard SHALL immediately stop related notifications and de-prioritize content from those sources in personalized lists.\n\n## 8) Localization and Timezone Handling (business perspective)\n- THE civicDebateBoard SHALL store and display timestamps relative to the user’s preferred timezone while preserving the canonical time for audit and consistency.\n- WHERE users have not set a preferred timezone, THE civicDebateBoard SHALL default to the user’s device or profile locale setting.\n- WHERE scheduled publication features are enabled, THE civicDebateBoard SHALL interpret schedule times in the author’s selected timezone and indicate the canonical time in content metadata.\n- THE civicDebateBoard SHALL allow user-selectable language preferences for interface text and content filters while preserving original content language.\n\n## 9) Accessibility and Inclusivity Expectations\n- THE civicDebateBoard SHALL require alternative text descriptions for image attachments with length 5–500 characters.\n- THE civicDebateBoard SHALL support content warnings for sensitive topics allowing users to proceed or skip as per preferences.\n- WHERE audio or video attachments are allowed, THE civicDebateBoard SHALL require caption files or transcripts to be provided by the uploader.\n- THE civicDebateBoard SHALL support respectful discourse by disallowing harassment and hate content per policy and enabling report and moderation flows.\n\n## 10) Cross-cutting Business Rules\n### 10.1 Rate Limiting (business fairness)\n- WHERE role is \"member\", THE civicDebateBoard SHALL limit to 10 Posts per 24 hours and 100 Comments per 24 hours.\n- WHERE role is \"verifiedMember\", THE civicDebateBoard SHALL limit to 20 Posts per 24 hours and 200 Comments per 24 hours.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL limit annotations to 100 per 24 hours and otherwise follow verifiedMember limits.\n- THE civicDebateBoard SHALL limit reactions to 500 per 24 hours per user and reports to 50 per 24 hours per user.\n- IF rate limits are exceeded, THEN THE civicDebateBoard SHALL deny the action with a message indicating the limit and reset time.\n\n### 10.2 Attachments and Links\n- THE civicDebateBoard SHALL allow attachment types: images and documents as per policy; executable formats are disallowed.\n- IF an attachment or link is detected as malicious or violates policy, THEN THE civicDebateBoard SHALL block it and record a safety event.\n\n### 10.3 Mentions and Blocks\n- THE civicDebateBoard SHALL allow users to block others which prevents mentions and direct notification triggers.\n- IF a blocked user attempts to interact (mention, follow) with the blocker’s content, THEN THE civicDebateBoard SHALL deny and avoid notifying the blocker.\n\n### 10.4 Ownership and Accountability\n- THE civicDebateBoard SHALL attribute all content to a single author account and record any role attributes at time of posting for accountability.\n- WHERE a user changes role (e.g., becomes verifiedMember), THE civicDebateBoard SHALL not retroactively alter existing content role labels.\n\n## 11) Role-Based Capabilities Summary (business perspective)\nBusiness matrix for core content actions:\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|--------|--------|----------------|------------|-----------|-------|\n| Create Post | ✅ | ✅ (can mark expert) | ✅ | ✅ | ✅ |\n| Create Comment | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Post (24h) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Comment (60m) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| React/Vote | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Fact-Check Annotation | ❌ | ❌ | ✅ | ✅ (review/approve) | ✅ |\n| Lock/Unlock Thread | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Change Category | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Remove Violating Content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue Sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n\nNotes:\n- Moderators and admins inherit all content capabilities and add enforcement controls as defined in policy documents.\n\n## 12) Acceptance Criteria (EARS for all applicable requirements)\nThis section consolidates key EARS requirements for verification and testing. It complements, and does not replace, the rules enumerated above.\n\n### 12.1 Posting and Commenting\n- WHEN a user submits a Post with title length between 10 and 150 and body length between 20 and 50,000, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Post title is shorter than 10 or longer than 150 characters, THEN THE civicDebateBoard SHALL reject the Post with a validation message specifying the title length constraint.\n- IF a Post body is shorter than 20 or longer than 50,000 characters, THEN THE civicDebateBoard SHALL reject the Post with a validation message specifying the body length constraint.\n- WHEN a user submits a Comment with body length 1–20,000 at a depth not exceeding 5, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Comment would exceed the maximum depth of 5, THEN THE civicDebateBoard SHALL reject it with a message indicating depth limits.\n\n### 12.2 Edits and Deletions\n- WHEN an author edits their Post within 24 hours and the thread is not locked, THE civicDebateBoard SHALL save the new version and maintain an immutable version history accessible to moderators.\n- IF a user attempts to edit a Post after 24 hours, THEN THE civicDebateBoard SHALL deny the edit and inform the user of the elapsed edit window.\n- WHEN an author deletes a Post within 24 hours that has no Comments, THE civicDebateBoard SHALL remove it from discovery and retain a soft-deleted record for 30 days.\n- WHEN an author deletes a Comment within 60 minutes, THE civicDebateBoard SHALL replace it with a tombstone label \"Deleted by author\".\n\n### 12.3 Reactions and Voting\n- WHEN a user upvotes a Post or Comment they did not author and has not previously upvoted, THE civicDebateBoard SHALL record the upvote and increase the visible count immediately.\n- WHEN a user upvotes again on the same item, THE civicDebateBoard SHALL remove their previous upvote (toggle behavior).\n- IF a user attempts to upvote their own content, THEN THE civicDebateBoard SHALL deny the action with an explanatory message.\n\n### 12.4 Fact-Check Annotations\n- WHEN a factChecker submits an annotation with required fields (claim excerpt, rating, at least one valid URL source, explanation), THE civicDebateBoard SHALL publish the annotation and display a badge on the content within 1 minute.\n- IF an annotation misses required fields or includes an invalid URL, THEN THE civicDebateBoard SHALL reject it with field-specific messages.\n\n### 12.5 Tags, Topics, Categories\n- WHEN a Post includes 0–10 valid tags, THE civicDebateBoard SHALL accept and store the tags; IF any tag violates length or character rules, THEN THE civicDebateBoard SHALL reject the Post with tag-specific messages.\n- WHEN a Post is submitted with a Category from the active taxonomy, THE civicDebateBoard SHALL accept it; IF the Category is missing or invalid, THEN THE civicDebateBoard SHALL reject the submission.\n\n### 12.6 Search and Discovery\n- WHEN a user searches with a 1–100 character keyword, THE civicDebateBoard SHALL return results sorted by relevance unless another sort is chosen, with page size default 20.\n- WHERE filters for Category, Topic, Tag, author, role, time range, or content type are applied, THE civicDebateBoard SHALL restrict results accordingly.\n- IF a content item is under moderation hold, THEN THE civicDebateBoard SHALL exclude it from public discovery results.\n\n### 12.7 Notifications and Subscriptions\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL deliver a notification to subscribers within 1 minute, bundling events within 10-minute windows.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify the mentioned user within 1 minute unless they have blocked the author.\n- WHEN a fact-check is published on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n\n### 12.8 Bookmarks and Follows\n- WHEN a user bookmarks a Post or Comment, THE civicDebateBoard SHALL record the bookmark and make it retrievable in the user’s saved list.\n- WHEN a user follows an author or Topic, THE civicDebateBoard SHALL include related content in personalized discovery and generate notifications per user settings.\n- IF a user unfollows, THEN THE civicDebateBoard SHALL cease related notifications immediately.\n\n### 12.9 Localization and Timezones\n- WHEN a user sets a preferred timezone, THE civicDebateBoard SHALL display all timestamps in that timezone while retaining canonical timestamps for audit.\n- WHEN a Post is scheduled for publication at a specified local time, THE civicDebateBoard SHALL publish according to the author’s chosen timezone and display both local and canonical times in metadata.\n\n### 12.10 Accessibility and Inclusivity\n- WHEN an image attachment is uploaded, THE civicDebateBoard SHALL require an alt-text of 5–500 characters.\n- WHERE a content warning is set by the author or moderator, THE civicDebateBoard SHALL gate the content behind a warning banner until the user opts to proceed.\n- WHEN an audio/video attachment is uploaded, THE civicDebateBoard SHALL require captions or transcripts before making it publicly discoverable.\n\n### 12.11 Rate Limits and Abuse Prevention\n- WHEN a user reaches a rate limit for Posts, Comments, reactions, or reports, THE civicDebateBoard SHALL return a clear error including remaining cooldown time.\n- IF repeated violation attempts occur after rate-limit errors, THEN THE civicDebateBoard SHALL extend the cooldown period and log a potential abuse event for moderation review.\n\n## 13) References to Related Documents\n- For end-to-end workflows, see the [User Flows and Processes](./05-user-flows-and-processes.md).\n- For content safety, sanctions, and enforcement specifics, see the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n- For performance, availability, and operability targets, see the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\nEnd of document."},"plan":"Document type: requirement\nPurpose: Define all functional capabilities, rules, and validations for civicDebateBoard in unambiguous, testable business terms, aligned to roles.\nOutline to cover:\n1) Content Model and Relationships (conceptual)\n2) Threading and Discussion Rules\n3) Tagging, Topics, and Categories\n4) Search and Discovery (filters, sorting)\n5) Notifications and Subscriptions\n6) Bookmarks and Follows\n7) Localization and Timezone Handling (business perspective)\n8) Accessibility and Inclusivity Expectations\n9) Acceptance Criteria (EARS)\nAdditional completeness sections to include:\n- Cross-cutting business rules (rate limits, attachments, mentions/blocks, ownership/accountability)\n- Content states and visibility rules\n- Role-based capabilities summary\n- Error handling and recovery expectations\n- References to related documents using descriptive links","review":"Enhance to be implementation-ready for backend developers using business requirements only. Apply the following criteria:\n- Length: 5,000–30,000+ characters; fully expand all sections of the outline\n- EARS compliance: Use EARS (WHEN, WHILE, IF, THEN, WHERE, THE, SHALL) for all actionable requirements\n- Specificity: Measurable limits (length ranges, counts, time windows, response-time expectations), clear validation rules, explicit error conditions\n- Role coverage: member, verifiedMember, factChecker, moderator, admin with business permissions\n- Mermaid diagrams: double quotes around ALL labels, no spaces between brackets/braces and quotes, correct arrow syntax (-->), no nested quotes\n- Links: Use descriptive link text for related docs\n- Prohibitions: No APIs, no database schemas, no code, no UI design\n- Completeness: Include content states/visibility rules, error handling, moderation holds, personalization (follows/mutes), subscription and notification throttling, search behavior, pagination, and acceptance criteria\n- Consistency: Align with related documents for moderation and non-functional targets; do not contradict them","content":"# Functional Requirements for civicDebateBoard\n\nBusiness-functional rules define WHAT civicDebateBoard must do for users without prescribing technical implementations. All enforceable requirements use EARS to ensure clarity and testability. Developers have full autonomy over architecture, APIs, and data models; the statements below express business behavior only.\n\n## 1) Introduction and Scope\n- Purpose: Provide unambiguous, testable rules governing content creation, discussion, organization, discovery, subscriptions, notifications, personalization, localization, accessibility, and cross-cutting policies.\n- In Scope: Posts, comments/replies, threads, reactions/votes, fact-check annotations, tags/topics/categories, search and discovery, notifications and subscriptions, bookmarks and follows, localization/timezone, accessibility and inclusivity, content states and visibility, error handling, rate limits, ownership and accountability.\n- Out of Scope: Technical mechanisms (APIs, DB schemas, infra), UI layout/visual design, low-level implementation details.\n- Roles: member, verifiedMember, factChecker, moderator, admin.\n\n## 2) Content Model and Relationships (conceptual, non-technical)\nConceptual entities and relationships (business meaning):\n- Post: Root item of a discussion with title, body, optional attachments/links, tags, topics, exactly one category.\n- Comment: Reply to a Post or another Comment with exactly one parent; forms hierarchical chains with a defined maximum depth.\n- Thread: A Post and all its descendant Comments.\n- Reaction/Vote: Per-user expression on an item; one per user per item per reaction type.\n- Fact-Check Annotation: Structured note by factChecker attached to a specific Post or Comment with citations.\n- Report: User-initiated flag for policy or quality issues.\n- Topic: Thematic grouping that users can follow.\n- Tag: Keyword label; may be controlled (curated) or free-form (normalized).\n- Category: Curated taxonomy node; each Post selects exactly one active Category.\n- Subscription: User preference to receive updates about authors, threads, topics, or category digests.\n- Bookmark: User’s saved reference to content.\n\nConceptual relationship overview:\n```mermaid\ngraph LR\n  U[\"User\"] --> P[\"Post\"]\n  P --> C[\"Comment\"]\n  C --> C2[\"Comment(Reply)\"]\n  P --> R1[\"Reaction/Vote\"]\n  C --> R2[\"Reaction/Vote\"]\n  P --> FC1[\"Fact-Check Annotation\"]\n  C --> FC2[\"Fact-Check Annotation\"]\n  P --> REP1[\"Report\"]\n  C --> REP2[\"Report\"]\n  P --> TG[\"Tag\"]\n  P --> TP[\"Topic\"]\n  P --> CAT[\"Category\"]\n  U --> SUB[\"Subscription\"]\n  U --> BM[\"Bookmark\"]\n```\n\nEARS requirements (core):\n- THE civicDebateBoard SHALL treat a Post as the root item of a thread with a title and body.\n- THE civicDebateBoard SHALL treat a Comment as a reply to a Post or another Comment with exactly one parent.\n- THE civicDebateBoard SHALL allow one Reaction/Vote per user per item per reaction type and allow removal at any time.\n- THE civicDebateBoard SHALL associate zero or more Tags and zero or more Topics to a Post.\n- THE civicDebateBoard SHALL require exactly one Category for each Post selected from the active taxonomy.\n- THE civicDebateBoard SHALL allow factChecker to attach Fact-Check Annotations to Posts and Comments.\n- THE civicDebateBoard SHALL allow any authenticated user to create a Report on Posts and Comments within rate limits.\n- THE civicDebateBoard SHALL allow any authenticated user to create Bookmarks on Posts and Comments.\n\n## 3) Threading and Discussion Rules\n### 3.1 Participation and Permissions\n- WHERE role is \"member\" or \"verifiedMember\", THE civicDebateBoard SHALL permit creating Posts and Comments subject to policy and rate limits.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL permit creating Posts and Comments and SHALL permit adding Fact-Check Annotations.\n- WHERE role is \"moderator\" or \"admin\", THE civicDebateBoard SHALL permit all posting/commenting and SHALL permit enforcement actions per policy.\n- IF user is unauthenticated, THEN THE civicDebateBoard SHALL deny creating Posts or Comments and SHALL present an appropriate error.\n- WHERE account is muted or suspended, THE civicDebateBoard SHALL deny posting/commenting and SHALL show remaining sanction duration.\n\n### 3.2 Validation Rules for Posts\n- THE civicDebateBoard SHALL require Post titles with length 10–150 characters.\n- THE civicDebateBoard SHALL require Post bodies with length 20–50,000 characters.\n- WHERE Post includes attachments, THE civicDebateBoard SHALL allow up to 5 attachments per Post with cumulative size up to 25 MB.\n- WHERE Post includes external links, THE civicDebateBoard SHALL require each link to use http or https and include a resolvable hostname.\n- WHERE role is \"verifiedMember\" and the post is marked as expert-tagged, THE civicDebateBoard SHALL require a topic area selection and an expertise declaration note up to 500 characters.\n- WHERE content warnings are used, THE civicDebateBoard SHALL allow authors to select one or more warning categories (e.g., graphic, sensitive, adult) and SHALL gate visibility accordingly.\n\n### 3.3 Validation Rules for Comments\n- THE civicDebateBoard SHALL require Comment bodies with length 1–20,000 characters.\n- THE civicDebateBoard SHALL allow up to 3 attachments per Comment with cumulative size up to 10 MB.\n- THE civicDebateBoard SHALL allow a maximum reply depth of 5 levels including the root Post.\n\n### 3.4 Mentions and Handle Rules\n- THE civicDebateBoard SHALL allow mentions using a handle format 3–30 characters, alphanumeric plus underscores and hyphens, starting with a letter.\n- IF a mentioned user has blocked the author, THEN THE civicDebateBoard SHALL prevent the mention and SHALL inform the author without notifying the blocked user.\n- IF a handle does not match the allowed format, THEN THE civicDebateBoard SHALL reject the content with a field-specific message.\n\n### 3.5 Edits, Deletions, and Locking\n- WHEN a user edits their own Post, THE civicDebateBoard SHALL allow edits for 24 hours from creation unless the Post is locked or sanctioned.\n- WHEN a user edits their own Comment, THE civicDebateBoard SHALL allow edits for 60 minutes from creation unless the thread is locked or sanctioned.\n- WHEN content is edited, THE civicDebateBoard SHALL preserve prior versions for audit visibility to moderators and admins.\n- IF a thread is locked by a moderator, THEN THE civicDebateBoard SHALL prohibit new Comments and further edits by non-moderators.\n- IF a Post is deleted by its author within 24 hours and has no Comments, THEN THE civicDebateBoard SHALL remove it from public discovery and SHALL retain a soft-deleted record for 30 days for audit.\n- IF a Comment is deleted by its author within 60 minutes, THEN THE civicDebateBoard SHALL replace it with a tombstone indicating deletion by author.\n- WHERE content is removed by policy, THE civicDebateBoard SHALL show a standardized placeholder indicating removal reason to users permitted to see the placeholder.\n\n### 3.6 Reactions and Voting\n- THE civicDebateBoard SHALL support one upvote per user per item and allow removal (toggle behavior on duplicate).\n- WHERE reaction types include \"upvote\" and \"respectful\" reactions, THE civicDebateBoard SHALL limit to one per user per item per type.\n- IF a user attempts to react to their own content, THEN THE civicDebateBoard SHALL deny the action with an explanatory message.\n\n### 3.7 Fact-Check Annotations\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL allow an annotation with: claim excerpt (1–1,000), rating (e.g., accurate, needs context, misleading, false), at least one source (valid http/https URL), and explanation (1–2,000).\n- WHEN an annotation is published, THE civicDebateBoard SHALL display an annotation badge and a link to the note within 1 minute.\n- IF an annotation is flagged for policy issues, THEN THE civicDebateBoard SHALL queue it for moderator review and SHALL withhold visibility until resolved for enforcement-affecting labels.\n\n### 3.8 Content States and Visibility\nStates (business-level): Draft, Published, Pending Review, Locked, Soft-Deleted, Removed by Policy, Under Moderation Hold.\n- THE civicDebateBoard SHALL maintain a state for each content item among the defined states.\n- WHEN content is Pending Review or Under Moderation Hold, THE civicDebateBoard SHALL restrict visibility to the author, moderators, and admins.\n- WHEN content is Locked, THE civicDebateBoard SHALL allow reads and SHALL deny new comments/edits by non-moderators.\n- WHEN content is Soft-Deleted by the author, THE civicDebateBoard SHALL remove it from public discovery and SHALL allow moderators to view for 30 days.\n- WHEN content is Removed by Policy, THE civicDebateBoard SHALL keep an audit reference accessible to moderators and admins and SHALL present a removal placeholder to eligible viewers.\n\n## 4) Tagging, Topics, and Categories\n### 4.1 Tags\n- THE civicDebateBoard SHALL allow 0–10 tags per Post, each 1–30 characters, alphanumeric plus hyphens.\n- WHERE tags are controlled, THE civicDebateBoard SHALL restrict selection to approved tags; WHERE tags are free-form, THE civicDebateBoard SHALL normalize case and trim whitespace.\n- IF any tag violates length or character rules, THEN THE civicDebateBoard SHALL reject the submission with tag-specific messages.\n\n### 4.2 Topics\n- THE civicDebateBoard SHALL allow Post authors to associate 0–5 Topics with each Post.\n- THE civicDebateBoard SHALL allow users to follow Topics to receive notifications and discovery prioritization.\n- IF a Topic is deprecated by admins, THEN THE civicDebateBoard SHALL prevent new associations and SHALL preserve existing associations on historical content.\n\n### 4.3 Categories\n- THE civicDebateBoard SHALL require exactly one Category per Post chosen from the active taxonomy.\n- WHERE a Category is changed by a moderator for policy reasons, THE civicDebateBoard SHALL update the Post categorization and SHALL record a moderation note.\n\n## 5) Search and Discovery (filters, sorting)\n### 5.1 Search Inputs and Validation\n- THE civicDebateBoard SHALL accept keyword queries 1–100 characters and SHALL ignore stopwords.\n- THE civicDebateBoard SHALL support filtering by Category, Topic, Tag, author, role (author type), time range, and content type (Post or Comment).\n- THE civicDebateBoard SHALL support exclusion filters for Tags and Topics.\n- WHERE illegal or dangerous query patterns are detected (e.g., CSAM indicators), THE civicDebateBoard SHALL deny search and SHALL log a safety event.\n\n### 5.2 Sorting Rules and Tie-Breakers\n- THE civicDebateBoard SHALL support sorting by newest, oldest, most upvoted (24h, 7d, 30d, all-time), most commented (24h, 7d, 30d, all-time), and relevance for keyword queries.\n- WHERE no sort is specified, THE civicDebateBoard SHALL default to newest for non-search results and relevance for search results.\n- WHERE multiple items tie on a primary sort key, THE civicDebateBoard SHALL break ties using recency (newer first) and THEN by stable identifier.\n\n### 5.3 Pagination and Limits\n- THE civicDebateBoard SHALL return results in pages of 20 items by default with options of 10, 20, or 50 per page.\n- THE civicDebateBoard SHALL cap total retrievable pages at 100 per query to ensure fair use.\n- THE civicDebateBoard SHALL prevent requesting negative pages, zero page size, or sizes exceeding 50.\n\n### 5.4 Safety and Quality in Discovery\n- IF a Post is under active moderation hold, THEN THE civicDebateBoard SHALL exclude it from public discovery until resolved.\n- WHERE fact-check annotations exist, THE civicDebateBoard SHALL surface an annotation indicator in listings and SHALL allow filtering by annotation rating.\n- WHERE content warnings are present, THE civicDebateBoard SHALL display warning indicators in discovery and SHALL respect user preferences for gating.\n\nSearch flow (business-level):\n```mermaid\ngraph LR\n  Q[\"Receive Query(Keyword/Filters)\"] --> V[\"Validate Inputs\"]\n  V --> D{\"Valid?\"}\n  D -->|\"No\"| E[\"Reject with Messages\"]\n  D -->|\"Yes\"| F[\"Apply Safety Exclusions\"]\n  F --> S[\"Apply Sort & Pagination\"]\n  S --> R[\"Return Results Page\"]\n```\n\n## 6) Notifications and Subscriptions\n### 6.1 Subscription Types and Preferences\n- THE civicDebateBoard SHALL allow users to subscribe to author updates, thread updates, Topic updates, and Category digests.\n- THE civicDebateBoard SHALL allow users to configure instant vs digest delivery and to mute categories (except mandatory compliance notices).\n- WHERE quiet hours are set, THE civicDebateBoard SHALL defer non-urgent notifications to outside the quiet window.\n\n### 6.2 Triggering Events and Latency Expectations\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL notify subscribers within 1 minute.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify the mentioned user within 1 minute.\n- WHEN a factChecker publishes an annotation on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n- WHERE Category digests are enabled, THE civicDebateBoard SHALL send a daily summary including top items by votes and comments.\n\n### 6.3 Frequency, Bundling, and Opt-Outs\n- THE civicDebateBoard SHALL bundle notifications for the same thread within a 10-minute window.\n- IF a user disables notifications for a specific thread, THEN THE civicDebateBoard SHALL cease further notifications for that thread until re-enabled.\n- THE civicDebateBoard SHALL provide per-category opt-out that takes effect within 1 minute of change.\n\nNotification flow (business-level):\n```mermaid\ngraph LR\n  E[\"Event Occurs(Reply/Mention/Annotation)\"] --> RCV[\"Resolve Recipients & Preferences\"]\n  RCV --> FIL[\"Apply Mutes & Quiet Hours\"]\n  FIL --> BND{\"Bundle Window?\"}\n  BND -->|\"Yes\"| AGG[\"Aggregate into Bundle\"]\n  BND -->|\"No\"| QN[\"Queue Instant Delivery\"]\n  AGG --> SND[\"Schedule Send\"]\n  QN --> SND\n  SND --> ACK[\"Mark Delivered/Failed\"]\n```\n\n## 7) Bookmarks and Follows\n- THE civicDebateBoard SHALL allow users to bookmark Posts and Comments for later reference.\n- THE civicDebateBoard SHALL allow users to follow authors and Topics to personalize discovery and notifications.\n- IF a user unfollows an author or Topic, THEN THE civicDebateBoard SHALL immediately stop related notifications and SHALL de-prioritize content from those sources in personalized lists.\n- WHERE limits are required for system health, THE civicDebateBoard SHALL cap bookmarks at 2,000 per user and follows at 1,000 authors and 1,000 topics per user.\n- IF a user attempts to exceed bookmark or follow limits, THEN THE civicDebateBoard SHALL deny the action and SHALL present the applicable limit.\n\n## 8) Localization and Timezone Handling (business perspective)\n- THE civicDebateBoard SHALL store and present timestamps relative to the user’s preferred timezone while preserving canonical audit time.\n- WHERE a preferred timezone is not set, THE civicDebateBoard SHALL default to a reasonable timezone based on locale or device signals.\n- WHERE scheduled publication is used, THE civicDebateBoard SHALL interpret schedule times in the author’s selected timezone and SHALL display both local and canonical times in metadata.\n- THE civicDebateBoard SHALL allow language preferences for interface text and filters while preserving original content language for authored items.\n\n## 9) Accessibility and Inclusivity Expectations\n- THE civicDebateBoard SHALL require alt text for image attachments with length 5–500 characters.\n- THE civicDebateBoard SHALL support content warnings for sensitive topics and SHALL allow users to proceed or skip as per preferences.\n- WHERE audio or video attachments are allowed, THE civicDebateBoard SHALL require caption files or transcripts to be provided by the uploader before public discovery.\n- THE civicDebateBoard SHALL support respectful discourse by disallowing harassment and hate content per policy and by enabling reporting and moderation flows.\n\n## 10) Cross-Cutting Business Rules\n### 10.1 Rate Limiting and Fairness\n- WHERE role is \"member\", THE civicDebateBoard SHALL limit to 10 Posts per 24 hours and 100 Comments per 24 hours.\n- WHERE role is \"verifiedMember\", THE civicDebateBoard SHALL limit to 20 Posts per 24 hours and 200 Comments per 24 hours.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL limit annotations to 100 per 24 hours and otherwise follow verifiedMember limits.\n- THE civicDebateBoard SHALL limit reactions to 500 per 24 hours per user and reports to 50 per 24 hours per user.\n- IF a rate limit is exceeded, THEN THE civicDebateBoard SHALL deny the action with a message indicating the limit and reset time.\n\n### 10.2 Attachments and Links\n- THE civicDebateBoard SHALL allow attachment types permitted by policy (e.g., images, documents) and SHALL disallow executable formats.\n- IF an attachment or link is detected as malicious or policy-violating, THEN THE civicDebateBoard SHALL block it and SHALL record a safety event.\n- WHERE images are uploaded, THE civicDebateBoard SHALL require reasonable dimension limits (e.g., up to 10,000×10,000 pixels) and SHALL enforce total size limits per item.\n\n### 10.3 Mentions, Blocks, and Mutes\n- THE civicDebateBoard SHALL allow users to block others which prevents mentions and direct notifications.\n- IF a blocked user attempts to interact (mention, follow) with the blocker’s content, THEN THE civicDebateBoard SHALL deny the action and SHALL avoid notifying the blocker.\n- THE civicDebateBoard SHALL allow users to mute topics or authors to reduce visibility and notifications from those sources.\n\n### 10.4 Ownership and Accountability\n- THE civicDebateBoard SHALL attribute all content to a single author account and SHALL record role attributes at time of posting for accountability.\n- WHERE a user changes role (e.g., becomes verifiedMember), THE civicDebateBoard SHALL not retroactively alter role labels on existing content.\n\n## 11) Role-Based Capabilities Summary (business perspective)\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|--------|--------|----------------|------------|-----------|-------|\n| Create Post | ✅ | ✅ (can mark expert) | ✅ | ✅ | ✅ |\n| Create Comment | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Post (24h) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Comment (60m) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| React/Vote | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Fact-Check Annotation | ❌ | ❌ | ✅ | ✅ (review/approve) | ✅ |\n| Lock/Unlock Thread | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Change Category | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Remove Violating Content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue Sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n\nNotes: Moderators and admins inherit content capabilities and add enforcement controls per policies.\n\n## 12) Acceptance Criteria (EARS for all applicable requirements)\nConsolidated, testable criteria complement the rules above.\n\n### 12.1 Posting and Commenting\n- WHEN a Post with title length 10–150 and body length 20–50,000 is submitted by a permitted role, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Post title is outside 10–150 characters, THEN THE civicDebateBoard SHALL reject the Post with a title-length message.\n- IF a Post body is outside 20–50,000 characters, THEN THE civicDebateBoard SHALL reject the Post with a body-length message.\n- WHEN a Comment with body length 1–20,000 at a depth ≤ 5 is submitted, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Comment would exceed depth 5, THEN THE civicDebateBoard SHALL reject it with a depth-limit message.\n- IF the author is muted or suspended, THEN THE civicDebateBoard SHALL deny posting and SHALL present remaining sanction duration.\n\n### 12.2 Edits, Deletions, and States\n- WHEN an author edits a Post within 24 hours and the thread is not locked, THE civicDebateBoard SHALL save the new version and SHALL maintain immutable history for moderators.\n- IF a user attempts to edit a Post after 24 hours, THEN THE civicDebateBoard SHALL deny the edit and SHALL indicate the elapsed window.\n- WHEN an author deletes a Post within 24 hours that has no Comments, THE civicDebateBoard SHALL remove it from discovery and SHALL retain a soft-deleted record for 30 days.\n- WHEN an author deletes a Comment within 60 minutes, THE civicDebateBoard SHALL replace it with a tombstone label.\n- WHEN content is placed Under Moderation Hold, THE civicDebateBoard SHALL hide it from public discovery and SHALL show status to the author.\n\n### 12.3 Reactions and Voting\n- WHEN a user upvotes an item they did not author and has not previously upvoted, THE civicDebateBoard SHALL record the upvote and SHALL increase the count immediately.\n- WHEN a user repeats an upvote on the same item, THE civicDebateBoard SHALL remove their upvote (toggle behavior).\n- IF a user attempts to upvote their own content, THEN THE civicDebateBoard SHALL deny the action with an explanatory message.\n\n### 12.4 Mentions and Blocks\n- WHEN a handle matches the allowed format, THE civicDebateBoard SHALL resolve the mention and SHALL notify the mentioned user unless they have blocked the author.\n- IF a handle fails format validation, THEN THE civicDebateBoard SHALL reject the submission with a handle-format message.\n- IF a mentioned user has blocked the author, THEN THE civicDebateBoard SHALL prevent the mention and SHALL inform the author.\n\n### 12.5 Fact-Check Annotations\n- WHEN a factChecker submits an annotation with required fields and at least one valid URL, THE civicDebateBoard SHALL publish the annotation and SHALL display a badge within 1 minute.\n- IF required fields are missing or URLs are invalid, THEN THE civicDebateBoard SHALL reject the annotation with field-specific messages.\n\n### 12.6 Tags, Topics, Categories\n- WHEN a Post includes 0–10 valid tags, THE civicDebateBoard SHALL accept and store them; IF any tag violates rules, THEN THE civicDebateBoard SHALL reject the Post with tag-specific messages.\n- WHEN a Post includes a Category from the active taxonomy, THE civicDebateBoard SHALL accept it; IF missing or invalid, THEN THE civicDebateBoard SHALL reject the submission.\n- WHEN a deprecated Topic is selected, THE civicDebateBoard SHALL prevent association and SHALL report the deprecation to the author.\n\n### 12.7 Search and Discovery\n- WHEN a keyword query 1–100 characters is submitted, THE civicDebateBoard SHALL return results sorted by relevance unless another sort is chosen, with default page size 20.\n- WHERE filters (Category, Topic, Tag, author, role, time range, content type) are applied, THE civicDebateBoard SHALL restrict results accordingly.\n- IF a content item is Under Moderation Hold, THEN THE civicDebateBoard SHALL exclude it from public discovery results.\n- IF a query matches illegal or dangerous patterns, THEN THE civicDebateBoard SHALL deny the search and SHALL log a safety event.\n\n### 12.8 Notifications and Subscriptions\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL deliver a notification within 1 minute and SHALL bundle events within 10 minutes.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify within 1 minute unless the mentioned user has blocked the author or muted the category.\n- WHEN a fact-check is published on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n- WHEN a user sets quiet hours, THE civicDebateBoard SHALL defer non-urgent notifications until quiet hours end.\n\n### 12.9 Bookmarks and Follows\n- WHEN a user bookmarks content and is under the 2,000-bookmark cap, THE civicDebateBoard SHALL record it and SHALL make it retrievable in saved items.\n- WHEN a user follows an author/topic and is under cap, THE civicDebateBoard SHALL include related content in personalized discovery and SHALL generate notifications per settings.\n- IF a user exceeds bookmark or follow caps, THEN THE civicDebateBoard SHALL deny the action and SHALL present the applicable cap.\n- IF a user unfollows, THEN THE civicDebateBoard SHALL cease related notifications immediately and SHALL de-prioritize related content in personalized lists.\n\n### 12.10 Localization and Timezones\n- WHEN a user sets a preferred timezone, THE civicDebateBoard SHALL display timestamps in that timezone and SHALL retain canonical timestamps for audit.\n- WHEN a Post is scheduled for publication at a local time, THE civicDebateBoard SHALL publish according to the author’s timezone and SHALL display local and canonical times.\n\n### 12.11 Accessibility and Inclusivity\n- WHEN an image is uploaded, THE civicDebateBoard SHALL require alt text 5–500 characters.\n- WHERE sensitive content warnings are set, THE civicDebateBoard SHALL gate content behind a warning until the user opts to proceed.\n- WHEN audio/video is uploaded, THE civicDebateBoard SHALL require captions or transcripts before public discovery.\n\n### 12.12 Rate Limits and Abuse Prevention\n- WHEN a user reaches a rate limit for Posts, Comments, reactions, or reports, THE civicDebateBoard SHALL return a clear error including remaining cooldown time.\n- IF repeated violation attempts occur after rate-limit errors, THEN THE civicDebateBoard SHALL extend cooldown and SHALL log a potential abuse event for moderation review.\n\n## 13) Error Handling and Recovery — User-Facing Expectations\n- WHEN validation fails, THE civicDebateBoard SHALL present field-specific reasons and SHALL preserve unsaved user input for resubmission.\n- WHEN a referenced target is not visible (e.g., parent removed), THE civicDebateBoard SHALL return a non-disclosing not-available message.\n- WHEN background processing delays discovery (e.g., indexing), THE civicDebateBoard SHALL present the item in direct thread views while it propagates to search.\n\n## 14) References to Related Documents\n- For end-to-end workflows, see the [User Flows and Processes](./05-user-flows-and-processes.md).\n- For content safety, sanctions, and enforcement specifics, see the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n- For performance, availability, and operability targets, see the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n","tokenUsage":{"total":78395,"input":{"total":69357,"cached":0},"output":{"total":9038,"reasoning":2496,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":9,"step":0,"created_at":"2025-08-15T02:44:06.064Z"},"tokenUsage":{"aggregate":{"total":942121,"input":{"total":801072,"cached":19328},"output":{"total":141049,"reasoning":44608,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":939299,"input":{"total":798765,"cached":19328},"output":{"total":140534,"reasoning":44224,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Align revenue strategy, ethical analytics, and measurement with platform goals to guide ongoing optimization.","filename":"10-business-model-and-analytics.md","documentType":"business-model","outline":["Why This Service Exists (recap)","Revenue Strategy Options (ads, sponsorships, subscriptions) and Guardrails","User Acquisition and Growth Strategy","Analytics KPIs and Reporting Cadence","Content Quality and Community Health Metrics","Moderation and Safety Metrics","Governance for Data Use and Ethics","Success Metrics and Review Process"],"audience":"business stakeholders","keyQuestions":["How will the service sustain itself financially?","What KPIs define growth, engagement, and quality?","What governance ensures ethical data use?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md","08-non-functional-requirements-and-slas.md"],"constraints":["Must define measurable KPIs and review cadence","Avoid technical analytics tooling specifications","Ensure alignment with privacy obligations"],"content":"# civicDebateBoard — Business Model and Analytics\n\nThis document defines business requirements only. All technical implementation decisions (architecture, APIs, data pipelines, analytics tooling, storage, and dashboards) are at the discretion of the development team. The document describes WHAT the system must achieve from a business perspective, not HOW to implement it.\n\n## 1) Why This Service Exists (recap)\n\ncivicDebateBoard exists to improve the quality, transparency, and civility of online civic discourse. The platform enables structured discussions, integrates fact-checking roles, and equips moderators with policy-aligned workflows so that communities can debate complex topics responsibly. The service differentiates through:\n- A role design that includes verifiedMember and factChecker, elevating credibility and corrections.\n- Embedded, measurable safety and transparency requirements that prioritize community health over raw engagement.\n- Governance for data use and ethical analytics that protects user privacy and democratic processes.\n\nAlignment with related documents:\n- Strategic vision and scope are summarized in the [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Capabilities and constraints for user actions are detailed in the [Functional Requirements](./06-functional-requirements.md).\n- Experience-focused performance and availability targets are defined in the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## 2) Revenue Strategy Options and Guardrails\n\nThe revenue model must sustain the platform without compromising civic integrity or user trust. Monetization approaches are complementary and can be combined, subject to strict guardrails.\n\n### 2.1 Advertising (Contextual, Non-Microtargeted)\n- Contextual display and sponsorship placements adjacent to topics, never within user-generated arguments to avoid misattribution.\n- No behavioral microtargeting based on sensitive attributes or political beliefs.\n- Frequency caps and clear disclosures for all paid placements.\n\nEARS Requirements — Advertising\n- THE civicDebateBoard SHALL label all paid placements with an unambiguous disclosure visible wherever the placement appears.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL apply a user-level daily impression cap of 3 impressions per unique campaign.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL prohibit targeting based on sensitive attributes including political affiliation, religion, health status, or inferred beliefs.\n- IF a paid placement conflicts with community safety policies (e.g., misinformation, hate speech, election manipulation), THEN THE civicDebateBoard SHALL reject the placement and provide reasoned feedback to the advertiser.\n- WHEN a user opts out of personalized ads, THE civicDebateBoard SHALL restrict ad selection to contextual signals only and record the consent state for compliance reporting.\n- WHILE a live political event period (e.g., election blackout windows) is active, THE civicDebateBoard SHALL disable new political ad activations and freeze existing political campaigns.\n\n### 2.2 Sponsorships (Topic, Series, or Event-Based)\n- Brand sponsorship of topic hubs, expert AMAs, or fact-checking series with guardrails to prevent content interference.\n- Sponsors can fund public-interest fact-checking efforts without editorial control.\n\nEARS Requirements — Sponsorships\n- THE civicDebateBoard SHALL disclose sponsor identity on all sponsored surfaces associated with the sponsor.\n- WHERE a content area is sponsored, THE civicDebateBoard SHALL prevent sponsor accounts from editing or removing user content or fact-check annotations.\n- IF a sponsor attempts to influence moderation or fact-check outcomes, THEN THE civicDebateBoard SHALL document the attempt and escalate to policy governance for review.\n- WHEN a sponsored AMA is scheduled, THE civicDebateBoard SHALL present the sponsorship disclosure on the AMA announcement and session surfaces for the duration of the campaign.\n\n### 2.3 Subscriptions (Member-Supported)\n- Optional subscription for power users and institutions for benefits such as reduced ads, advanced topic insights, and community support for fact-checking capacity.\n- No paywalling of core civic participation (reading, posting, voting) to preserve accessibility.\n\nEARS Requirements — Subscriptions\n- THE civicDebateBoard SHALL keep core participation features (reading, posting, voting, reporting) accessible without payment.\n- WHERE subscriptions are active, THE civicDebateBoard SHALL provide a clear list of benefits before purchase and on the account page thereafter.\n- IF a payment fails or a subscription lapses, THEN THE civicDebateBoard SHALL revert benefits within 24 hours and retain access to core participation features.\n- WHEN a user cancels a subscription, THE civicDebateBoard SHALL stop future billing immediately and retain benefits until the end of the current paid period.\n- WHERE institutional subscriptions are active, THE civicDebateBoard SHALL allow assignment and revocation of seats without affecting user data ownership or posting history.\n\n### 2.4 General Monetization Guardrails\n- No sale of personal data; revenue must not depend on data brokerage.\n- Monetization experiments must pass a policy and privacy review before launch.\n\nEARS Requirements — Monetization Guardrails\n- THE civicDebateBoard SHALL refrain from selling or licensing personal data to third parties for unrelated purposes.\n- WHEN launching a new monetization experiment, THE civicDebateBoard SHALL require prior approval by policy and privacy governance with documented objectives, metrics, and guardrails.\n- IF revenue objectives conflict with community safety or integrity metrics, THEN THE civicDebateBoard SHALL prioritize safety and integrity outcomes and pause conflicting experiments.\n\n## 3) User Acquisition and Growth Strategy\n\nGrowth will emphasize trust, transparency, and real utility over vanity metrics. Core tactics include:\n- Partnerships with civic organizations, universities, and local newsrooms for verifiedMember onboarding and sponsored educational threads.\n- Invite flows and topic follows that bring participants back to relevant discussions without spam.\n- Reputation-based prompts that recognize high-quality contributions rather than quantity.\n\nEARS Requirements — Growth\n- THE civicDebateBoard SHALL prohibit dark patterns (e.g., confusing consent, disguised ads, forced continuity) in any acquisition or retention flow.\n- WHEN a user invites a contact, THE civicDebateBoard SHALL send a single, clearly labeled invitation and SHALL not re-message the contact without explicit consent.\n- WHERE growth notifications are enabled, THE civicDebateBoard SHALL limit notification sends to a maximum of 2 per user per day and SHALL include a single-click opt-out per category.\n- IF a partner’s onboarding content violates safety policies, THEN THE civicDebateBoard SHALL remove the content and notify the partner with policy references.\n- WHEN a verifiedMember application is approved by policy criteria, THE civicDebateBoard SHALL elevate the account status and update applicable rate limits within 1 hour.\n\n## 4) Analytics KPIs and Reporting Cadence\n\nKPIs are defined to capture growth, engagement, quality, safety, and revenue without compromising user privacy. All metrics should be aggregations at appropriate levels with data minimization and consent-respecting collection.\n\nEARS Requirements — Analytics and Reporting\n- THE civicDebateBoard SHALL maintain a weekly operational report covering growth, engagement, quality, safety, and monetization KPIs with owner accountability.\n- WHEN a KPI crosses an alert threshold (as defined below), THE civicDebateBoard SHALL create an incident entry in the business review log within 24 hours and assign a responsible owner.\n- WHERE consent is required for analytics, THE civicDebateBoard SHALL exclude non-consenting users from analytics cohorts and annotate reports accordingly.\n- IF a metric requires sensitive data to compute, THEN THE civicDebateBoard SHALL either use a privacy-preserving aggregate or omit the metric and document the omission.\n\n### KPI Catalog and Targets\n\n| KPI | Definition | Target (Green) | Alert Threshold (Amber/Red) | Required Breakdowns | Primary Owner | Cadence |\n|-----|------------|----------------|------------------------------|---------------------|---------------|---------|\n| Monthly Active Users (MAU) | Count of unique authenticated users active at least once in a calendar month | ≥ 100,000 | Amber: < 80,000; Red: < 60,000 | Role, geography (region), acquisition source | Growth Lead | Monthly |\n| Daily Active Users (DAU) | Unique authenticated users active on a given day | DAU/MAU ≥ 40% | Amber: 30–39%; Red: < 30% | Role, topic category | Growth Lead | Daily |\n| New Registrations | New accounts created | ≥ 15,000/month | Amber: < 10,000; Red: < 7,000 | Source, geography | Growth Lead | Weekly |\n| Activation Rate | Share of new users who complete first post or comment within 7 days | ≥ 60% | Amber: 45–59%; Red: < 45% | Role, source | Product Lead | Weekly |\n| 7-Day Retention | Percent of new users active 7 days after registration | ≥ 35% | Amber: 25–34%; Red: < 25% | Role, source | Product Analytics | Weekly |\n| 30-Day Retention | Percent of new users active 30 days after registration | ≥ 20% | Amber: 15–19%; Red: < 15% | Role, source | Product Analytics | Monthly |\n| Posts per Active Member | Average posts per DAU | 0.20–0.35 | Amber: < 0.15; Red: < 0.10 | Role, topic | Community Ops | Weekly |\n| Comments per Post | Average comments per post within 7 days | ≥ 3.0 | Amber: 2.0–2.9; Red: < 2.0 | Topic, role of author | Community Ops | Weekly |\n| Net Helpfulness Score | Net “helpful” minus “unhelpful” reactions per post over 7 days | ≥ +1.0 | Amber: 0.0–0.9; Red: < 0 | Topic, role, verification status | Community Ops | Weekly |\n| Fact-Check Coverage | Share of flagged claims with at least one fact-check annotation within 24 hours | ≥ 90% | Amber: 80–89%; Red: < 80% | Topic, severity | Policy Lead | Weekly |\n| Correction Adoption Rate | Share of content with accepted corrections visible within 24 hours of verification | ≥ 85% | Amber: 70–84%; Red: < 70% | Topic, role | Policy Lead | Weekly |\n| Time to First Moderator View (Critical) | Minutes from critical report to first moderator view | ≤ 30 min | Amber: 31–60; Red: > 60 | Severity, time of day | Safety Lead | Daily |\n| Report Review SLA (Standard) | Hours to decision for standard reports | ≤ 24 h | Amber: 25–48; Red: > 48 | Category, moderator team | Safety Lead | Daily |\n| False Positive Rate (Moderation) | Share of sanctions overturned on appeal | ≤ 5% | Amber: 5.1–8%; Red: > 8% | Category, team | Safety QA | Monthly |\n| Re-offense Rate | Share of sanctioned users who re-offend within 60 days | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Category, sanction type | Safety QA | Monthly |\n| Subscription Conversion | Percent of eligible users who start a paid plan within 30 days | ≥ 2.5% | Amber: 1.5–2.4%; Red: < 1.5% | Role, geography | Monetization Lead | Monthly |\n| ARPPU | Average revenue per paying user per month | ≥ $8.00 | Amber: $6.00–7.99; Red: < $6.00 | Plan type, region | Finance | Monthly |\n| Ad Fill Rate | Served ad impressions / eligible ad opportunities | ≥ 85% | Amber: 70–84%; Red: < 70% | Context, region | Monetization Lead | Weekly |\n| Ad Frequency (per user/day) | Average ads per user per day where ads enabled | ≤ 2.0 | Amber: 2.1–3.0; Red: > 3.0 | Role, region | Monetization Lead | Weekly |\n| Opt-out Rate (Personalized Ads) | Percent of users opting out of personalized ads | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Region | Privacy Lead | Monthly |\n| Consent Coverage | Percent of active users with recorded analytics consent state | 100% | Amber: 98–99.9%; Red: < 98% | Region | Privacy Lead | Monthly |\n\nReporting Cadence\n- Weekly Ops Review: Growth, engagement, quality, safety, revenue highlights; action items with owners and due dates.\n- Monthly Business Review: Trend analysis, budget vs. actuals, experiment outcomes, compliance review notes.\n- Quarterly Strategy Review: Deep-dive on mission metrics, long-term risks, policy landscape, and roadmap adjustments.\n\n## 5) Content Quality and Community Health Metrics\n\nQuality and health take precedence over pure volume. Metrics emphasize constructive engagement and corrective transparency.\n\nEARS Requirements — Quality and Health\n- THE civicDebateBoard SHALL compute quality metrics using privacy-preserving aggregates and SHALL avoid tracking users across unrelated contexts.\n- WHEN a topic’s Net Helpfulness Score remains below 0 for seven consecutive days, THE civicDebateBoard SHALL trigger a community health review with proposed remediation actions.\n- WHERE factChecker coverage falls below the alert threshold, THE civicDebateBoard SHALL prioritize recruitment or scheduling for fact-checking resources in the affected topics.\n- IF a content area exhibits repeated misinformation patterns, THEN THE civicDebateBoard SHALL introduce friction measures (e.g., pre-post reminders, source citation prompts) consistent with policy.\n- WHEN verifiedMember posts include expert tags, THE civicDebateBoard SHALL present expert context labels to readers to improve interpretability.\n\nAdditional Health Metrics (Targets)\n- Civility Incident Rate: ≤ 1.5% of posts flagged for civility violations per week.\n- Repeat Correction Visibility: ≥ 95% of accepted corrections remain visible on the original content indefinitely.\n- Topic Diversity Index: ≥ 0.65 across top 20 topics by volume each quarter.\n\n## 6) Moderation and Safety Metrics\n\nSafety protects both discourse quality and user well-being. Targets must be explicit and testable.\n\nEARS Requirements — Moderation and Safety\n- THE civicDebateBoard SHALL prioritize critical severity reports to the front of the review queue and SHALL meet the Time to First Moderator View target.\n- WHEN a sanction is issued, THE civicDebateBoard SHALL present the policy citation and evidence links to the user at the time of enforcement.\n- WHERE sanctions include temporary restrictions, THE civicDebateBoard SHALL automatically restore privileges upon sanction expiry without further user action.\n- IF an appeal is submitted within the allowed window, THEN THE civicDebateBoard SHALL review and decide within 72 hours and SHALL notify the appellant of the outcome and rationale.\n- WHEN a moderator action is overturned, THE civicDebateBoard SHALL update the audit trail and recalculate related metrics within 24 hours.\n\nSafety SLA Targets\n- Critical Harms (doxxing, threats): First view ≤ 30 minutes; decision ≤ 2 hours.\n- Standard Reports: Decision ≤ 24 hours.\n- Appeals: Decision ≤ 72 hours; overturn rate ≤ 5%.\n\n## 7) Governance for Data Use and Ethics\n\nGovernance ensures analytics and monetization respect privacy, comply with policy, and preserve civic integrity. Governance applies to product, monetization, policy, and research uses of data.\n\nPrinciples\n- Data minimization and purpose limitation for all analytics and monetization uses.\n- Transparency in user-facing disclosures for ads, sponsorships, and data use.\n- No sale of personal data; no political microtargeting based on sensitive attributes.\n\nEARS Requirements — Governance\n- THE civicDebateBoard SHALL maintain a register of analytics metrics with documented purpose, lawful basis or consent requirement, and retention period.\n- WHEN a new metric or experiment is proposed that requires additional data collection, THE civicDebateBoard SHALL conduct a privacy impact assessment and obtain governance approval before launch.\n- WHERE user consent is withdrawn, THE civicDebateBoard SHALL exclude the user’s data from future analytics cohorts and SHALL remove the user from longitudinal tracking cohorts within 7 days where feasible under law.\n- IF an ethics or compliance breach is suspected, THEN THE civicDebateBoard SHALL initiate an incident review within 24 hours and SHALL notify relevant stakeholders per compliance requirements.\n- WHILE a government election moratorium period is active, THE civicDebateBoard SHALL disable political audience refinements and SHALL restrict political ad activations.\n\nGovernance Process Flow\n\n```mermaid\ngraph LR\n  A[\"Propose Metric/Experiment\"] --> B[\"Document Purpose & Data Needs\"]\n  B --> C[\"Privacy Impact Assessment\"]\n  C --> D{\"Approval?\"}\n  D -->|\"Yes\"| E[\"Launch with Guardrails\"]\n  D -->|\"No\"| F[\"Revise or Reject\"]\n  E --> G[\"Monitor KPIs & Thresholds\"]\n  G --> H{\"Any Breach or Threshold Crossed?\"}\n  H -->|\"Yes\"| I[\"Incident Review & Mitigation\"]\n  H -->|\"No\"| J[\"Continue & Schedule Review\"]\n```\n\nRoles and Responsibilities\n- Policy Governance: Owns approvals, moratorium calendars, and ethics reviews.\n- Privacy Lead: Owns consent frameworks, retention, and cohort exclusions.\n- Product Analytics: Owns KPI catalog integrity and reporting cadences.\n- Monetization Lead: Owns revenue experiments, guardrails, and compliance with sponsorship/ads rules.\n\n## 8) Success Metrics and Review Process\n\nSuccess is measured across mission impact, sustainable revenue, and community safety. Reviews drive continuous improvement with ethical guardrails.\n\nMission and Platform Success Metrics (Annual Targets)\n- Mission Integrity Index (composite of civility, correction adoption, and misinformation mitigation): ≥ 75/100.\n- Community Trust (periodic survey): ≥ 70/100 with ≤ 5-point variance across major regions.\n- Sustainable Revenue Mix: ≥ 40% subscriptions/sponsorships, ≤ 60% ads.\n- Safety Assurance: Meet or exceed all safety SLAs ≥ 95% of the time.\n\nEARS Requirements — Reviews and Decision-Making\n- THE civicDebateBoard SHALL conduct a Weekly Ops Review with published notes, KPI deltas, and assigned actions.\n- WHEN a KPI remains in Red for two consecutive review periods, THE civicDebateBoard SHALL initiate a corrective action plan with owner, deadline, and expected impact.\n- WHERE a revenue initiative degrades the Mission Integrity Index by ≥ 3 points in a month, THE civicDebateBoard SHALL pause the initiative and present a remediation plan before resuming.\n- IF quarterly targets are not met for two consecutive quarters, THEN THE civicDebateBoard SHALL run a strategy reset workshop including policy, safety, product, and finance leadership.\n- WHILE a corrective action plan is active, THE civicDebateBoard SHALL track plan-specific leading indicators weekly and SHALL escalate if no improvement is observed within 3 weeks.\n\nReview Artifacts and Cadence\n- Weekly Ops Review: Dashboard snapshot, exceptions, actions (owners, due dates).\n- Monthly Business Review: Trend narratives, budget outcomes, experiment registry updates, compliance annotations.\n- Quarterly Strategy Review: OKR scorecards, policy landscape analysis, risk and contingency updates.\n\n## Appendices\n\nA. Alignment with Privacy and Non-Functional Expectations\n- This document’s requirements align with the privacy and consent expectations described in the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md). Any analytics requiring consent must honor consent state and applicable regulations without exception.\n\nB. Business-Only Scope Statement\n- This document specifies business objectives, measurable KPIs, ethical guardrails, and review cadences. Technical implementation (including, but not limited to, data models, API design, analytics tools, storage, and dashboarding) is the responsibility of the development team and may be implemented using any compliant architecture that meets the business requirements above.\n\nC. Role Considerations for Metrics\n- member: Included in all growth and engagement KPIs; subject to standard rate limits.\n- verifiedMember: Segmented in quality metrics and expert-tag analyses; subject to adjusted rate limits consistent with policy.\n- factChecker: Tracked for fact-check coverage and correction adoption rates; cannot directly sanction.\n- moderator: Accountable for safety SLAs and appeal turnaround metrics.\n- admin: Accountable for governance approvals, monetization guardrails, and cross-functional reviews.\n"},"plan":"Business-model document for civicDebateBoard with sections: 1) Why the Service Exists (recap); 2) Revenue Strategy Options and Guardrails (ads, sponsorships, subscriptions); 3) User Acquisition and Growth Strategy; 4) Analytics KPIs and Reporting Cadence; 5) Content Quality and Community Health Metrics; 6) Moderation and Safety Metrics; 7) Governance for Data Use and Ethics; 8) Success Metrics and Review Process. Audience: business stakeholders. Constraints: measurable KPIs with cadence, avoid tooling/technical specs, align with privacy obligations. Related docs referenced with descriptive links.","review":"Enhance for: completeness, EARS specificity, KPI measurability, privacy alignment, ethical monetization guardrails, correct Mermaid syntax (double quotes everywhere, no spaces between brackets and quotes, proper arrows), descriptive links, no technical implementation details, no API/schema content, business-only scope, role alignment, report cadence clarity. Ensure minimum length, expand governance and experimentation policies, add formulas and thresholds, include error/edge scenarios. Remove “This document …” phrasing while retaining autonomy statement content. Validate all diagrams and link titles.","content":"# civicDebateBoard — Business Model and Analytics\n\nBusiness requirements only; all technical implementation decisions (architecture, APIs, data pipelines, analytics tooling, storage, dashboards) remain at the discretion of the development team. Describes WHAT outcomes must be achieved in business terms, not HOW to implement them.\n\n## 1) Why This Service Exists (recap)\n\ncivicDebateBoard improves the quality, transparency, and civility of online civic discourse. Structured discussions, fact-checking roles, and policy-aligned moderation workflows enable responsible debate on complex topics.\n\nDifferentiators\n- Role design that includes verifiedMember and factChecker to elevate credibility and timely corrections.\n- Measurable safety and transparency requirements that prioritize community health over raw engagement.\n- Governance for data use and analytics that protects privacy and democratic processes.\n\nAlignment with related documents\n- Strategic vision and scope: [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Capabilities and constraints for user actions: [Functional Requirements](./06-functional-requirements.md).\n- Performance and availability expectations: [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## 2) Revenue Strategy Options and Guardrails\n\nSustainable monetization must never compromise civic integrity or user trust. Approaches may be combined under strict guardrails.\n\n### 2.1 Advertising (Contextual, Non-Microtargeted)\n- Contextual placements adjacent to topics; never embedded within arguments to avoid misattribution.\n- No behavioral microtargeting based on sensitive attributes or political beliefs.\n- Frequency caps and clear, persistent disclosures for paid placements.\n\nEARS Requirements — Advertising\n- THE civicDebateBoard SHALL label paid placements with an unambiguous disclosure visible wherever the placement appears.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL apply a per-user daily impression cap of 3 impressions per unique campaign.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL prohibit targeting based on sensitive attributes including political affiliation, religion, health status, or inferred beliefs.\n- IF a paid placement conflicts with safety policies (misinformation, hate speech, election manipulation), THEN THE civicDebateBoard SHALL reject the placement and provide a categorical reason to the advertiser.\n- WHEN a user opts out of personalized ads, THE civicDebateBoard SHALL restrict ad selection to contextual signals and record the consent state for compliance reporting.\n- WHILE a political event moratorium (election blackout) is active, THE civicDebateBoard SHALL disable new political ad activations and freeze existing political campaigns.\n- WHERE an ad appears near user-generated content, THE civicDebateBoard SHALL ensure adjacency rules avoid implying endorsement by the adjacent author.\n\n### 2.2 Sponsorships (Topic, Series, or Event-Based)\n- Brand sponsorship of topic hubs, expert AMAs, or fact-checking series with guardrails to prevent editorial interference.\n- Sponsors may fund public-interest fact-checking efforts without control over outcomes.\n\nEARS Requirements — Sponsorships\n- THE civicDebateBoard SHALL disclose sponsor identity on all sponsored surfaces associated with the sponsor.\n- WHERE a content area is sponsored, THE civicDebateBoard SHALL prevent sponsor accounts from editing or removing user content or fact-check annotations.\n- IF a sponsor attempts to influence moderation or fact-check outcomes, THEN THE civicDebateBoard SHALL document the attempt and escalate to policy governance for review.\n- WHEN a sponsored AMA is scheduled, THE civicDebateBoard SHALL present sponsorship disclosure on the announcement and session surfaces throughout the campaign.\n- WHERE a sponsor has a direct stake in a topic (e.g., active lobbying), THE civicDebateBoard SHALL display a conflict-of-interest label on sponsored surfaces for that topic.\n\n### 2.3 Subscriptions (Member-Supported)\n- Optional subscriptions for power users and institutions: reduced ads, advanced topic insights, and support for fact-checking capacity.\n- No paywalling of core civic participation (reading, posting, voting) to preserve accessibility.\n\nEARS Requirements — Subscriptions\n- THE civicDebateBoard SHALL keep core participation features (reading, posting, voting, reporting) accessible without payment.\n- WHERE subscriptions are active, THE civicDebateBoard SHALL present a clear list of benefits before purchase and on the account page thereafter.\n- IF payment fails or a subscription lapses, THEN THE civicDebateBoard SHALL revert benefits within 24 hours and retain access to core participation features.\n- WHEN a user cancels a subscription, THE civicDebateBoard SHALL stop future billing immediately and retain benefits until the end of the current paid period.\n- WHERE institutional subscriptions are active, THE civicDebateBoard SHALL allow assignment and revocation of seats without affecting user data ownership or posting history.\n- WHERE subscription benefits include reduced ad load, THE civicDebateBoard SHALL cap ad frequency at 0–1 per day per user under the plan.\n\n### 2.4 Grants and Public-Interest Funding\n- Eligibility for grants from foundations and civic institutions to support fact-checking, moderation research, or community education.\n\nEARS Requirements — Grants\n- WHEN grant funding is received for a public-interest initiative, THE civicDebateBoard SHALL separate editorial decision-making from grant reporting structures.\n- WHERE a grant imposes transparency obligations, THE civicDebateBoard SHALL publish required acknowledgments on relevant program pages.\n\n### 2.5 General Monetization Guardrails\n- No sale or licensing of personal data; revenue must not depend on data brokerage.\n- Monetization experiments must pass policy, privacy, and ethics review before launch.\n- No pay-for-reach or pay-to-amplify mechanics in civic discourse.\n\nEARS Requirements — Monetization Guardrails\n- THE civicDebateBoard SHALL refrain from selling or licensing personal data to third parties for unrelated purposes.\n- WHEN launching a monetization experiment, THE civicDebateBoard SHALL require prior governance approval with documented objectives, metrics, and guardrails.\n- IF revenue objectives conflict with safety or integrity metrics, THEN THE civicDebateBoard SHALL prioritize safety and integrity and pause the conflicting initiative.\n- WHERE revenue content intersects with political topics, THE civicDebateBoard SHALL apply election-period restrictions and conflict-of-interest disclosures.\n\n## 3) User Acquisition and Growth Strategy\n\nGrowth emphasizes trust, transparency, and utility over vanity metrics.\n\nTactics\n- Partnerships with civic organizations, universities, and local newsrooms to onboard verifiedMember contributors and host educational threads.\n- Invitation flows and topic follows that return participants to relevant debates without spam or dark patterns.\n- Recognition for high-quality contributions over quantity (e.g., helpfulness signals, accepted corrections).\n\nEARS Requirements — Growth\n- THE civicDebateBoard SHALL prohibit dark patterns (confusing consent, disguised ads, forced continuity) in acquisition or retention flows.\n- WHEN a user invites a contact, THE civicDebateBoard SHALL send a single, clearly labeled invitation and SHALL not re-message the contact without explicit consent.\n- WHERE growth notifications are enabled, THE civicDebateBoard SHALL limit notification sends to a maximum of 2 per user per day and SHALL include a one-click opt-out per category.\n- IF a partner’s onboarding content violates safety policies, THEN THE civicDebateBoard SHALL remove the content and notify the partner with policy references.\n- WHEN a verifiedMember application is approved per policy criteria, THE civicDebateBoard SHALL elevate the account and adjust rate limits within 1 hour.\n- WHERE referral programs operate, THE civicDebateBoard SHALL cap referral benefits to prevent spam incentives and SHALL revoke benefits for abuse.\n\nFunnel Metrics (targets; monitor monthly)\n- Visitor-to-registration conversion: ≥ 15% (Amber: 10–14%; Red: < 10%).\n- Registration-to-activation (first post or comment within 7 days): ≥ 60% (Amber: 45–59%; Red: < 45%).\n- Activation-to-30d retention: ≥ 20% (Amber: 15–19%; Red: < 15%).\n\n## 4) Analytics KPIs and Reporting Cadence\n\nKPI definitions measure growth, engagement, quality, safety, and revenue while honoring privacy and consent. Metrics are aggregated with data minimization; sensitive data is excluded or aggregated as required.\n\nEARS Requirements — Analytics and Reporting\n- THE civicDebateBoard SHALL maintain a weekly operational report covering growth, engagement, quality, safety, and monetization KPIs with owner accountability.\n- WHEN a KPI crosses an alert threshold, THE civicDebateBoard SHALL create an incident entry in the business review log within 24 hours and assign a responsible owner.\n- WHERE consent is required for analytics, THE civicDebateBoard SHALL exclude non-consenting users from analytics cohorts and annotate reports accordingly.\n- IF a metric requires sensitive data to compute, THEN THE civicDebateBoard SHALL use a privacy-preserving aggregate or omit the metric and document the omission.\n- WHERE a KPI definition changes, THE civicDebateBoard SHALL version the definition and annotate trend breaks in the next report.\n\nKPI Catalog and Targets (formulas and targets)\n\n| KPI | Business Definition | Formula (business-level) | Target (Green) | Alert Threshold (Amber/Red) | Required Breakdowns | Owner | Cadence |\n|-----|---------------------|---------------------------|----------------|------------------------------|---------------------|-------|---------|\n| Monthly Active Users (MAU) | Unique authenticated users active in a calendar month | Count of unique users with ≥1 session | ≥ 100,000 | Amber: < 80,000; Red: < 60,000 | Role, region, acquisition source | Growth Lead | Monthly |\n| Daily Active Users (DAU) | Unique authenticated users active on a given day | Count of unique users with ≥1 session | DAU/MAU ≥ 40% | Amber: 30–39%; Red: < 30% | Role, topic category | Growth Lead | Daily |\n| New Registrations | Accounts created | Count of new accounts | ≥ 15,000/mo | Amber: < 10,000; Red: < 7,000 | Source, region | Growth Lead | Weekly |\n| Activation Rate | New users who complete first post or comment within 7 days | Activated users / new registrations | ≥ 60% | Amber: 45–59%; Red: < 45% | Role, source | Product Lead | Weekly |\n| 7-Day Retention | New users active 7 days after registration | Returners day 7 / new registrations | ≥ 35% | Amber: 25–34%; Red: < 25% | Role, source | Product Analytics | Weekly |\n| 30-Day Retention | New users active 30 days after registration | Returners day 30 / new registrations | ≥ 20% | Amber: 15–19%; Red: < 15% | Role, source | Product Analytics | Monthly |\n| Posts per Active Member | Average posts per DAU | Posts / DAU | 0.20–0.35 | Amber: < 0.15; Red: < 0.10 | Role, topic | Community Ops | Weekly |\n| Comments per Post | Average comments per post within 7 days | Comments within 7d / posts | ≥ 3.0 | Amber: 2.0–2.9; Red: < 2.0 | Topic, author role | Community Ops | Weekly |\n| Net Helpfulness Score | Net helpfulness per post over 7 days | Helpful minus unhelpful reactions | ≥ +1.0 | Amber: 0.0–0.9; Red: < 0 | Topic, role, verification | Community Ops | Weekly |\n| Fact-Check Coverage | Flagged claims annotated within 24h | Annotated claims / flagged claims | ≥ 90% | Amber: 80–89%; Red: < 80% | Topic, severity | Policy Lead | Weekly |\n| Correction Adoption Rate | Accepted corrections visible within 24h | Corrected content / content requiring correction | ≥ 85% | Amber: 70–84%; Red: < 70% | Topic, role | Policy Lead | Weekly |\n| Time to First Moderator View (Critical) | Minutes from critical report to first moderator view | Minutes elapsed from report creation | ≤ 30 min | Amber: 31–60; Red: > 60 | Severity, time of day | Safety Lead | Daily |\n| Report Review SLA (Standard) | Hours to decision for standard reports | Hours elapsed from report creation | ≤ 24 h | Amber: 25–48; Red: > 48 | Category, team | Safety Lead | Daily |\n| False Positive Rate (Moderation) | Sanctions overturned on appeal | Overturned / total sanctions | ≤ 5% | Amber: 5.1–8%; Red: > 8% | Category, team | Safety QA | Monthly |\n| Re-offense Rate | Sanctioned users who re-offend within 60 days | Re-offenders / sanctioned users | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Category, sanction | Safety QA | Monthly |\n| Subscription Conversion | Eligible users starting paid plan within 30 days | New subscribers / eligible users | ≥ 2.5% | Amber: 1.5–2.4%; Red: < 1.5% | Role, region | Monetization Lead | Monthly |\n| ARPPU | Average revenue per paying user per month | Revenue from paid users / count of paid users | ≥ $8.00 | Amber: $6.00–7.99; Red: < $6.00 | Plan type, region | Finance | Monthly |\n| Ad Fill Rate | Served ad impressions / eligible ad opportunities | Impressions served / eligible opportunities | ≥ 85% | Amber: 70–84%; Red: < 70% | Context, region | Monetization Lead | Weekly |\n| Ad Frequency (per user/day) | Average ads per eligible user per day | Ads / eligible user-days | ≤ 2.0 | Amber: 2.1–3.0; Red: > 3.0 | Role, region | Monetization Lead | Weekly |\n| Opt-out Rate (Personalized Ads) | Users opting out of personalized ads | Opt-outs / active users | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Region | Privacy Lead | Monthly |\n| Consent Coverage | Active users with recorded analytics consent state | Users with consent state / active users | 100% | Amber: 98–99.9%; Red: < 98% | Region | Privacy Lead | Monthly |\n\nReporting Cadence\n- Weekly Ops Review: Growth, engagement, quality, safety, revenue highlights; action items with owners and due dates.\n- Monthly Business Review: Trend analysis, budget vs. actuals, experiment outcomes, compliance review notes.\n- Quarterly Strategy Review: Deep-dive on mission metrics, risks, policy landscape, and roadmap adjustments.\n\nKPI Governance\n- THE civicDebateBoard SHALL maintain a metric registry with owner, purpose, definition, lawful basis/consent status, retention period, and version history.\n- WHEN a KPI definition changes, THE civicDebateBoard SHALL mark a trend break and attach the new definition version to subsequent reports.\n- WHERE a metric is deprecated, THE civicDebateBoard SHALL archive its definition and rationale in the registry.\n\n## 5) Content Quality and Community Health Metrics\n\nQuality and health take precedence over volume. Metrics emphasize constructive engagement and corrective transparency.\n\nEARS Requirements — Quality and Health\n- THE civicDebateBoard SHALL compute quality metrics using privacy-preserving aggregates and SHALL avoid tracking users across unrelated contexts.\n- WHEN a topic’s Net Helpfulness Score remains below 0 for seven consecutive days, THE civicDebateBoard SHALL trigger a community health review with proposed remediation actions.\n- WHERE factChecker coverage falls below the alert threshold, THE civicDebateBoard SHALL prioritize recruitment or scheduling for fact-checking resources in the affected topics.\n- IF a content area exhibits repeated misinformation patterns, THEN THE civicDebateBoard SHALL introduce friction measures (pre-post reminders, source citation prompts) consistent with policy.\n- WHEN verifiedMember posts include expert tags, THE civicDebateBoard SHALL present expert context labels to readers.\n\nAdditional Health Metrics and Definitions\n- Civility Incident Rate: ≤ 1.5% of posts flagged for civility violations per week. Definition: number of posts flagged for civility divided by total posts that week.\n- Repeat Correction Visibility: ≥ 95% of accepted corrections remain visible on original content indefinitely. Definition: corrected items with visible corrections / total corrected items.\n- Topic Diversity Index: ≥ 0.65 across top 20 topics by volume each quarter. Definition: normalized Shannon diversity index on topic distribution.\n- Constructive Participation Ratio: ≥ 85% of comments pass civility and relevance checks in monitored threads (Amber: 75–84%; Red: < 75%).\n\n## 6) Moderation and Safety Metrics\n\nSafety protects discourse quality and user well-being.\n\nEARS Requirements — Moderation and Safety\n- THE civicDebateBoard SHALL prioritize critical severity reports to the front of the queue and SHALL meet the Time to First Moderator View target.\n- WHEN a sanction is issued, THE civicDebateBoard SHALL present the policy citation and evidence links to the user at enforcement time.\n- WHERE sanctions include temporary restrictions, THE civicDebateBoard SHALL automatically restore privileges upon expiry without further user action.\n- IF an appeal is submitted within the allowed window, THEN THE civicDebateBoard SHALL review and decide within 72 hours and SHALL notify the appellant of the outcome and rationale.\n- WHEN a moderator action is overturned, THE civicDebateBoard SHALL update the audit trail and recalculate related metrics within 24 hours.\n\nSafety SLA Targets\n- Critical Harms (doxxing, threats): First view ≤ 30 minutes; decision ≤ 2 hours.\n- Standard Reports: Decision ≤ 24 hours.\n- Appeals: Decision ≤ 72 hours; overturn rate ≤ 5%.\n- Harm Escalation Rate: ≤ 2% of unresolved P1 items escalate to P0 within 12 hours.\n\n## 7) Governance for Data Use and Ethics\n\nGovernance ensures analytics and monetization respect privacy, comply with policy, and preserve civic integrity. Applies to product, monetization, policy, and research uses of data.\n\nPrinciples\n- Data minimization and purpose limitation for analytics and monetization.\n- Transparency in user disclosures for ads, sponsorships, and data use.\n- No sale of personal data; no political microtargeting based on sensitive attributes.\n\nEARS Requirements — Governance\n- THE civicDebateBoard SHALL maintain a register of analytics metrics with documented purpose, lawful basis or consent requirement, and retention period.\n- WHEN a new metric or experiment requires additional data collection, THE civicDebateBoard SHALL conduct a privacy impact assessment and obtain governance approval before launch.\n- WHERE user consent is withdrawn, THE civicDebateBoard SHALL exclude the user’s data from future analytics and SHALL remove the user from longitudinal cohorts within 7 days where legally feasible.\n- IF an ethics or compliance breach is suspected, THEN THE civicDebateBoard SHALL initiate an incident review within 24 hours and SHALL notify relevant stakeholders per compliance requirements.\n- WHILE a government election moratorium period is active, THE civicDebateBoard SHALL disable political audience refinements and SHALL restrict political ad activations.\n- WHERE a KPI or experiment materially affects user rights or safety SLAs, THE civicDebateBoard SHALL escalate to policy governance for pre-approval.\n\nExperimentation Policy\n- Pre-registration: hypothesis, metrics (including safety guardrails), eligibility, duration, and stop criteria recorded in the experiment registry.\n- Exposure limits: per-user cap of concurrent experiments (e.g., maximum 3) and maximum duration (e.g., 6 weeks) to reduce fatigue and risk.\n- Safety guardrails: experiments must not degrade safety metrics beyond predefined bounds (e.g., no more than +10% P1 incidents vs. control).\n\nEARS Requirements — Experimentation\n- THE civicDebateBoard SHALL require experiment pre-registration including objectives, primary/secondary metrics, and safety guardrails.\n- WHEN an experiment begins, THE civicDebateBoard SHALL create a holdback/control cohort and SHALL enforce exposure caps per user.\n- IF safety guardrails breach (e.g., P1 incidents +10% vs. control), THEN THE civicDebateBoard SHALL pause the experiment within 24 hours and initiate a review.\n- WHERE experiments affect monetization exposure (ads, sponsorships), THE civicDebateBoard SHALL verify compliance with advertising and sponsorship guardrails before launch.\n- WHEN an experiment concludes, THE civicDebateBoard SHALL publish a summary with metric outcomes and decisions in the experiment registry.\n\nAccess Governance and Data Ethics\n- Role-based data access for analytics respecting least-privilege; aggregated outputs for general stakeholders.\n- Retention for analytics datasets aligned to the metric registry; avoid indefinite retention without purpose.\n\nGovernance Process Flow\n\n```mermaid\ngraph LR\n  A[\"Propose Metric/Experiment\"] --> B[\"Document Purpose & Data Needs\"]\n  B --> C[\"Privacy Impact Assessment\"]\n  C --> D{\"Approval?\"}\n  D -->|\"Yes\"| E[\"Launch with Guardrails\"]\n  D -->|\"No\"| F[\"Revise or Reject\"]\n  E --> G[\"Monitor KPIs & Thresholds\"]\n  G --> H{\"Any Breach or Threshold Crossed?\"}\n  H -->|\"Yes\"| I[\"Incident Review & Mitigation\"]\n  H -->|\"No\"| J[\"Continue & Schedule Review\"]\n```\n\nExperiment Lifecycle (illustrative)\n\n```mermaid\ngraph LR\n  X1[\"Pre-Register Hypothesis\"] --> X2[\"Define Success & Safety Bounds\"]\n  X2 --> X3[\"Governance Approval\"]\n  X3 --> X4[\"Launch & Assign Cohorts\"]\n  X4 --> X5{\"Guardrails Breached?\"}\n  X5 -->|\"Yes\"| X6[\"Pause & Review\"]\n  X5 -->|\"No\"| X7[\"Run to Completion\"]\n  X6 --> X8[\"Decide: Modify or Terminate\"]\n  X7 --> X9[\"Analyze & Publish Results\"]\n```\n\nRoles and Responsibilities\n- Policy Governance: Approvals, moratorium calendars, ethics reviews.\n- Privacy Lead: Consent frameworks, retention, cohort exclusions.\n- Product Analytics: KPI catalog integrity, reporting cadences, experiment registry.\n- Monetization Lead: Revenue experiments, guardrails, sponsorship/ads compliance.\n\n## 8) Success Metrics and Review Process\n\nSuccess spans mission impact, sustainable revenue, and community safety. Reviews drive continuous improvement with ethical guardrails.\n\nMission and Platform Success Metrics (Annual Targets)\n- Mission Integrity Index (composite of civility, correction adoption, misinformation mitigation): ≥ 75/100.\n- Community Trust (periodic survey): ≥ 70/100 with ≤ 5-point variance across major regions.\n- Sustainable Revenue Mix: ≥ 40% subscriptions/sponsorships, ≤ 60% ads.\n- Safety Assurance: Meet or exceed all safety SLAs ≥ 95% of the time.\n- Experiment Quality Index: ≥ 80/100 weighted by pre-registration, guardrail adherence, and publication completeness.\n\nEARS Requirements — Reviews and Decision-Making\n- THE civicDebateBoard SHALL conduct a Weekly Ops Review with published notes, KPI deltas, and assigned actions.\n- WHEN a KPI remains in Red for two consecutive periods, THE civicDebateBoard SHALL initiate a corrective action plan with owner, deadline, and expected impact.\n- WHERE a revenue initiative degrades the Mission Integrity Index by ≥ 3 points in a month, THE civicDebateBoard SHALL pause the initiative and present a remediation plan before resuming.\n- IF quarterly targets are not met for two consecutive quarters, THEN THE civicDebateBoard SHALL run a strategy reset workshop including policy, safety, product, and finance leadership.\n- WHILE a corrective action plan is active, THE civicDebateBoard SHALL track leading indicators weekly and SHALL escalate if no improvement is observed within 3 weeks.\n\nReview Artifacts and Cadence\n- Weekly Ops Review: Dashboard snapshot, exceptions, actions (owners, due dates).\n- Monthly Business Review: Trend narratives, budget outcomes, experiment registry updates, compliance annotations.\n- Quarterly Strategy Review: OKR scorecards, policy landscape analysis, risk/contingency updates, revenue mix assessment.\n\nRisk Triggers and Contingencies\n- WHERE MAU falls below 60,000 for two months, THE civicDebateBoard SHALL prioritize retention initiatives over acquisition experiments for the next quarter.\n- WHERE False Positive Rate exceeds 8% in a month, THE civicDebateBoard SHALL conduct a moderation QA calibration within 14 days.\n- WHERE Opt-out Rate for personalized ads exceeds 15% in any region, THE civicDebateBoard SHALL limit personalization levers and review disclosure clarity within 30 days.\n\n## Appendices\n\nA. Privacy and Non-Functional Alignment\n- Requirements align with consent expectations in the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md). Any analytics requiring consent must honor consent state and applicable regulations without exception.\n\nB. Business-Only Scope\n- Business objectives, measurable KPIs, ethical guardrails, and review cadences are specified. Technical implementation (data models, API design, analytics tools, storage, dashboarding) remains at the development team’s discretion.\n\nC. Role Considerations for Metrics\n- member: Included in growth and engagement KPIs; standard rate limits apply.\n- verifiedMember: Segmented in quality metrics and expert-tag analyses; adjusted rate limits per policy.\n- factChecker: Tracked for fact-check coverage and correction adoption; no sanction authority.\n- moderator: Accountable for safety SLAs and appeal turnaround.\n- admin: Accountable for governance approvals, monetization guardrails, and cross-functional reviews.\n","tokenUsage":{"total":76774,"input":{"total":68854,"cached":0},"output":{"total":7920,"reasoning":2048,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":10,"step":0,"created_at":"2025-08-15T02:44:06.207Z"},"tokenUsage":{"aggregate":{"total":1018895,"input":{"total":869926,"cached":19328},"output":{"total":148969,"reasoning":46656,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":1016073,"input":{"total":867619,"cached":19328},"output":{"total":148454,"reasoning":46272,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Describe end-to-end business workflows so developers can implement processes consistently.","filename":"05-user-flows-and-processes.md","documentType":"user-flow","outline":["Posting and Editing Content Flow","Commenting and Replying Flow","Voting and Reactions Flow","Reporting Content and Triage Flow","Moderation Review and Enforcement Flow","Appeals and Reinstatement Flow","Onboarding and Verification Flow","Notification Delivery Flow"],"audience":"development team","keyQuestions":["What are the step-by-step business flows for core actions?","How do reporting, moderation, and appeals progress from start to finish?","What are the key decision points and outcomes?"],"detailLevel":"detailed specification","relatedDocuments":["04-user-personas-and-scenarios.md","06-functional-requirements.md","07-content-moderation-and-safety-policies.md"],"constraints":["Include at least one Mermaid flow diagram per complex flow using strict syntax rules","Describe business logic only; avoid technical implementation details"],"content":"# User Flows and Processes — civicDebateBoard\n\nThis document defines the complete business workflows for civicDebateBoard so backend developers can implement consistent behaviors across all core processes. It describes WHAT the system should do in business terms, not HOW to build it. All technical implementations (architecture, APIs, database design, or UI) are at the discretion of the development team.\n\nRelated context for deeper background can be found in the following documents:\n- See the narrative personas and examples in the [User Personas and Scenarios](./04-user-personas-and-scenarios.md).\n- For the full set of capability rules, refer to the [Functional Requirements Specification](./06-functional-requirements.md).\n- For policy definitions and enforcement guardrails, consult the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## Conventions and Roles Context\n- Roles used throughout: member, verifiedMember, factChecker, moderator, admin.\n- Content types referenced: post, comment, reply, reaction, vote, report, annotation (fact-check), sanction, appeal, notification.\n- Time references are evaluated in the user’s configured timezone; timestamps are stored and presented per business rules in the [Functional Requirements Specification](./06-functional-requirements.md).\n- EARS syntax is used for applicable requirements. EARS keywords (WHEN, WHILE, IF, THEN, WHERE, THE, SHALL) are kept in English.\n\n## Posting and Editing Content Flow\n\n### Business Description\nMembers publish civic discussion posts that may include titles, body text, tags, and topic associations. Certain content may require pre-moderation depending on trust signals (e.g., newly registered users) and policy flags. Authors can edit their own posts subject to time-bound and policy constraints. Verified members may tag posts as expert contributions when permitted.\n\n### Preconditions\n- A user must be authenticated as member or above to create posts.\n- The author’s account must be in good standing (not muted or suspended).\n- Rate limit budgets must not be exhausted.\n\n### Primary Flow (Posting)\n1. Author creates a draft with required fields.\n2. System validates input fields and checks rate limits.\n3. System evaluates whether the post qualifies for pre-moderation or can be immediately visible.\n4. If pre-moderation is required, the post enters a review queue; otherwise, it is published.\n5. On publish, the system schedules notifications to followers or subscribers as per preferences.\n\n### Editing Flow\n1. Author requests to edit own post.\n2. System validates edit window and policy constraints.\n3. System applies edit and records an immutable edit trail.\n4. If the edit materially changes policy-sensitive content, the post may be temporarily hidden or queued for re-review based on rules.\n\n### Key Decisions\n- Whether pre-moderation is required.\n- Whether edit is within allowable window or requires re-review.\n- Whether the user is sanctioned or rate-limited.\n\n### Mermaid Flow Diagram (Posting + Editing)\n```mermaid\ngraph LR\n  A[\"Start (Author Authenticated)\"] --> B[\"Create Draft(Post)\" ]\n  B --> C[\"Validate Input & Rate Limits\" ]\n  C --> D{\"Valid & Within Limits?\"}\n  D -->|\"No\"| E[\"Reject with Errors\" ]\n  D -->|\"Yes\"| F{\"Pre-Moderation Needed?\"}\n  F -->|\"Yes\"| G[\"Queue for Review\" ]\n  F -->|\"No\"| H[\"Publish Immediately\" ]\n  G --> I{\"Approved?\"}\n  I -->|\"Yes\"| H\n  I -->|\"No\"| J[\"Reject with Policy Reason\" ]\n  H --> K[\"Notify Subscribers/Followers\" ]\n  K --> L[\"End (Post Visible)\" ]\n\n  %% Editing sub-flow\n  M[\"Author Requests Edit\" ] --> N[\"Check Edit Window & Sanctions\" ]\n  N --> O{\"Allowed?\"}\n  O -->|\"No\"| P[\"Deny Edit with Reason\" ]\n  O -->|\"Yes\"| Q[\"Apply Edit & Record Trail\" ]\n  Q --> R{\"Triggers Re-Review?\"}\n  R -->|\"Yes\"| S[\"Temporarily Hide & Queue\" ]\n  R -->|\"No\"| T[\"Keep Visible\" ]\n  S --> U{\"Approved?\"}\n  U -->|\"Yes\"| T\n  U -->|\"No\"| V[\"Revert/Reject Edit\" ]\n```\n\n### EARS-Formatted Requirements\n- THE posting service SHALL require authentication as member or higher to create posts.\n- THE posting service SHALL validate required fields: title (non-empty, max length per policy), body (non-empty), and at least one tag/topic where required by policy.\n- WHERE the author is newly registered or under low-trust conditions, THE posting service SHALL route new posts to pre-moderation.\n- WHEN input validation fails, THE posting service SHALL return a structured error containing field-level reasons.\n- WHEN a post is published, THE notification service SHALL enqueue notifications to eligible subscribers within 1 minute.\n- WHILE the post is in review, THE content visibility service SHALL set visibility to non-public and visible to moderators and the author.\n- IF the review is rejected for policy reasons, THEN THE posting service SHALL notify the author with categorical reasons and next-step guidance.\n- WHERE the edit occurs within the allowed self-edit window (e.g., 24 hours) and no sanctions apply, THE posting service SHALL allow edits and record an edit trail accessible to moderators.\n- IF the edit materially changes sensitive content categories, THEN THE posting service SHALL temporarily hide the post and submit for re-review.\n- WHEN rate limits are exhausted, THE posting service SHALL deny the action with a reset time.\n- WHEN a verifiedMember marks a post as expert-tagged, THE posting service SHALL display an expert badge subject to verification policy.\n\n### Error Handling and Recovery\n- IF required fields are missing, THEN THE system SHALL provide explicit field names and constraints in the response message.\n- IF the user is muted or suspended, THEN THE system SHALL block posting and include sanction type and end time.\n- IF duplicate content is detected within a short window, THEN THE system SHALL reject with a duplicate warning.\n\n### Performance and Rate Limiting Expectations\n- WHEN a valid post is submitted without pre-moderation, THE system SHALL complete publication within 2 seconds under normal load.\n- WHEN posts enter pre-moderation, THE system SHALL place the item in the review queue within 1 second and confirm receipt to the author.\n- WHERE rate limits apply, THE system SHALL present remaining quota and next reset time in natural language.\n\n## Commenting and Replying Flow\n\n### Business Description\nUsers add comments to posts and replies to comments to facilitate threaded discussion. Comment visibility and edit rules mirror those of posts, but with shorter edit windows and stricter anti-spam controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Account not under comment-restrictive sanctions.\n- Target post or parent comment is visible and open for comments.\n\n### Mermaid Flow Diagram (Commenting)\n```mermaid\ngraph LR\n  A[\"Start (Authenticated)\" ] --> B[\"Select Target(Post/Comment)\" ]\n  B --> C[\"Validate Target Visibility & Open State\" ]\n  C --> D{\"Allowed to Comment?\"}\n  D -->|\"No\"| E[\"Deny with Reason\" ]\n  D -->|\"Yes\"| F[\"Create Draft(Comment)\" ]\n  F --> G[\"Validate Content & Rate Limits\" ]\n  G --> H{\"Valid?\"}\n  H -->|\"No\"| I[\"Reject with Errors\" ]\n  H -->|\"Yes\"| J{\"Pre-Moderation Needed?\"}\n  J -->|\"Yes\"| K[\"Queue for Review\" ]\n  J -->|\"No\"| L[\"Publish Comment\" ]\n  K --> M{\"Approved?\"}\n  M -->|\"Yes\"| L\n  M -->|\"No\"| N[\"Reject with Policy Reason\" ]\n  L --> O[\"Update Counts & Notify Participants\" ]\n```\n\n### EARS-Formatted Requirements\n- THE commenting service SHALL allow only authenticated users in good standing to submit comments.\n- THE commenting service SHALL validate that the target is visible and open for comments before accepting content.\n- WHERE anti-spam heuristics trigger, THE commenting service SHALL require pre-moderation for the comment.\n- WHEN a comment is published, THE system SHALL notify the post author and recent participants subject to notification preferences.\n- WHERE an edit occurs within a 30-minute window and no replies exist, THE commenting service SHALL allow self-edit with edit trail.\n- IF the parent content is removed, THEN THE commenting service SHALL mark the comment’s visibility per policy (e.g., hidden with placeholder).\n\n### Error Handling and Performance\n- WHEN validation fails, THE system SHALL return field-specific messages within 2 seconds.\n- WHEN a user exceeds comment rate limits, THE system SHALL block the action and provide reset time.\n\n## Voting and Reactions Flow\n\n### Business Description\nUsers express sentiment through votes (e.g., up/down) and reactions (e.g., agree, insightful). Each user may cast at most one vote per item and may update or retract it. Tallying is transparent and subject to anti-abuse controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Target content is visible and not locked.\n\n### Mermaid Flow Diagram (Voting)\n```mermaid\ngraph LR\n  A[\"Start (Authenticated)\" ] --> B[\"Select Target Content\" ]\n  B --> C[\"Check Visibility & Lock State\" ]\n  C --> D{\"Eligible?\"}\n  D -->|\"No\"| E[\"Deny (Not Eligible)\" ]\n  D -->|\"Yes\"| F[\"Check Existing Vote\" ]\n  F --> G{\"Has Existing Vote?\"}\n  G -->|\"No\"| H[\"Apply New Vote\" ]\n  G -->|\"Yes\"| I{\"Same Direction?\"}\n  I -->|\"Yes\"| J[\"Retract Vote\" ]\n  I -->|\"No\"| K[\"Update Vote Direction\" ]\n  H --> L[\"Update Tally\" ]\n  J --> L\n  K --> L\n  L --> M[\"Acknowledge & Notify (Optional)\" ]\n```\n\n### EARS-Formatted Requirements\n- THE voting service SHALL restrict each user to a single active vote per item at any time.\n- WHEN a user submits the same vote twice, THE voting service SHALL interpret it as a retraction and update the tally accordingly.\n- WHEN a user changes vote direction, THE voting service SHALL decrement the prior tally and increment the new tally atomically.\n- WHERE the target content is locked, THE voting service SHALL reject voting with a lock reason.\n- THE reactions service SHALL allow multiple reaction types per item but limit one per type per user.\n- IF a user is sanctioned from participatory actions, THEN THE voting and reactions services SHALL deny the attempt with sanction details.\n\n### Error Handling and Performance\n- WHEN a valid vote/reaction request succeeds, THE system SHALL acknowledge within 1 second under normal load.\n- IF the content reference is invalid, THEN THE system SHALL return a clear “not found or not visible” outcome without leaking private state.\n\n## Reporting Content and Triage Flow\n\n### Business Description\nUsers report content suspected of violating policy. Reports are categorized, prioritized, and routed to moderation queues. FactCheckers can attach annotations citing sources and propose corrections. Moderators triage reports according to SLAs.\n\n### Preconditions\n- Reporter is authenticated (member or above) and not sanctioned from reporting.\n- Target content exists and is visible to the reporter at the time of reporting.\n\n### Mermaid Flow Diagram (Reporting & Triage)\n```mermaid\ngraph LR\n  A[\"Start (Reporter Authenticated)\" ] --> B[\"Select Content & Category\" ]\n  B --> C[\"Validate Inputs & Duplicate Report Check\" ]\n  C --> D{\"Valid?\"}\n  D -->|\"No\"| E[\"Reject with Errors\" ]\n  D -->|\"Yes\"| F[\"Create Report Record\" ]\n  F --> G[\"Priority Scoring (Severity, Volume, Role)\" ]\n  G --> H[\"Route to Queue (Policy/Topic)\" ]\n  H --> I{\"Auto-Action Threshold Met?\"}\n  I -->|\"Yes\"| J[\"Apply Temporary Hide\" ]\n  I -->|\"No\"| K[\"Await Moderator Review\" ]\n  J --> K\n```\n\n### EARS-Formatted Requirements\n- THE reporting service SHALL require a category selection from the defined policy taxonomy for every report.\n- THE reporting service SHALL deduplicate substantially identical reports within a defined time window to prevent spam.\n- WHERE severity or report volume crosses thresholds, THE reporting service SHALL temporarily hide the content pending review.\n- WHEN a factChecker adds an annotation, THE system SHALL link the annotation to the reported content and make it available to moderators.\n- WHEN a report is submitted, THE system SHALL confirm receipt to the reporter within 2 seconds and provide a reference ID.\n\n### Error Handling and SLAs\n- THE reporting service SHALL prevent reports on content the reporter cannot see.\n- THE moderation triage process SHALL surface high-priority items to moderators within 1 minute of report submission.\n\n## Moderation Review and Enforcement Flow\n\n### Business Description\nModerators review reported or queued content, assess against policy, and choose outcomes: approve, edit with transparency note, remove, warn, mute, suspend, or escalate to admin. All actions create audit logs and user notifications with clear reasons.\n\n### Preconditions\n- Moderator or admin is authenticated with appropriate privileges.\n- Evidence (reports, prior history, annotations) is accessible.\n\n### Mermaid Flow Diagram (Moderation)\n```mermaid\ngraph LR\n  A[\"Start (Moderator Assigned)\" ] --> B[\"Open Case & Review Evidence\" ]\n  B --> C{\"Policy Violation?\"}\n  C -->|\"No\"| D[\"Approve/Restore Content\" ]\n  C -->|\"Yes\"| E{\"Severity Level\"}\n  E --> F[\"Edit with Transparency Note\" ]\n  E --> G[\"Remove Content\" ]\n  E --> H[\"Issue Warning\" ]\n  E --> I[\"Apply Mute/Suspension\" ]\n  E --> J[\"Escalate to Admin\" ]\n  D --> K[\"Notify Reporter & Author\" ]\n  F --> K\n  G --> K\n  H --> K\n  I --> K\n  J --> L[\"Admin Decision\" ] --> K\n  K --> M[\"Close Case & Log Audit\" ]\n```\n\n### EARS-Formatted Requirements\n- THE moderation service SHALL present consolidated evidence including reports, prior violations, and factChecker annotations.\n- WHEN no violation is found, THE moderation service SHALL approve or restore the content and notify involved parties.\n- WHERE a minor violation is identified, THE moderation service SHALL allow corrective edits with a transparency note.\n- WHERE policy prohibits the content, THE moderation service SHALL remove the content and preserve an evidence snapshot.\n- WHERE behavior warrants sanctions, THE moderation service SHALL apply warnings, mutes, or suspensions per configured policy tiers.\n- WHEN a case requires higher authority, THE moderation service SHALL support escalation to admin with case context.\n- THE moderation service SHALL create immutable audit logs for every action, including actor, timestamp, and rationale category.\n\n### Error Handling and SLAs\n- WHEN a moderation action is taken, THE system SHALL notify affected users within 1 minute with clear reason categories and appeal instructions.\n- WHERE automatic actions temporarily hid content, THE system SHALL reconcile visibility within 1 minute after final decision.\n\n## Appeals and Reinstatement Flow\n\n### Business Description\nUsers may appeal moderation actions within a defined window. Appeals are queued, reviewed by a different moderator or an admin depending on severity, and result in uphold, partial modification, or full reversal.\n\n### Preconditions\n- Appellant is authenticated and is the subject of the action or the content author.\n- Appeal is within allowed time window and includes a reason.\n\n### Mermaid Flow Diagram (Appeals)\n```mermaid\ngraph LR\n  A[\"Start (User Files Appeal)\" ] --> B[\"Validate Eligibility & Window\" ]\n  B --> C{\"Eligible?\"}\n  C -->|\"No\"| D[\"Reject Appeal with Reason\" ]\n  C -->|\"Yes\"| E[\"Create Appeal Case\" ]\n  E --> F[\"Assign Reviewer (Independence Rule)\" ]\n  F --> G[\"Review Evidence & Rationale\" ]\n  G --> H{\"Outcome\"}\n  H --> I[\"Uphold\" ]\n  H --> J[\"Modify (Partial)\" ]\n  H --> K[\"Reverse\" ]\n  I --> L[\"Notify Parties & Close\" ]\n  J --> L\n  K --> L\n```\n\n### EARS-Formatted Requirements\n- THE appeals service SHALL require appellants to provide a reason tied to predefined categories.\n- THE appeals service SHALL enforce an independence rule such that the original moderator does not decide the appeal.\n- WHEN an appeal is filed, THE system SHALL acknowledge receipt within 2 seconds and provide a tracking ID.\n- WHEN an appeal decision is recorded, THE system SHALL notify all relevant parties and update content visibility and sanctions accordingly.\n- WHERE reversal occurs, THE appeals service SHALL restore content and remove or annotate sanctions as appropriate.\n\n### Error Handling and SLAs\n- IF the appeal is out of window or lacks required information, THEN THE system SHALL reject with guidance on eligibility and timing.\n- THE appeals queue SHALL present new appeals to eligible reviewers within 5 minutes of submission.\n\n## Onboarding and Verification Flow\n\n### Business Description\nNew users register, verify email, and complete basic profile steps. Users may request elevated status as verifiedMember by submitting identity or expertise evidence. Admins or designated verifiers adjudicate requests.\n\n### Preconditions\n- For registration: unauthenticated visitor.\n- For verification: authenticated user in good standing.\n\n### Mermaid Flow Diagram (Onboarding & Verification)\n```mermaid\ngraph LR\n  A[\"Start Registration\" ] --> B[\"Provide Email & Password\" ]\n  B --> C[\"Create Account (Pending Verification)\" ]\n  C --> D[\"Send Verification Email\" ]\n  D --> E{\"Email Verified?\"}\n  E -->|\"No\"| F[\"Limit Access (Grace Period)\" ]\n  E -->|\"Yes\"| G[\"Activate Member Role\" ]\n  G --> H[\"Optional: Complete Profile\" ]\n  H --> I{\"Apply for Verification?\"}\n  I -->|\"No\"| J[\"End (Member)\" ]\n  I -->|\"Yes\"| K[\"Submit Evidence & Rationale\" ]\n  K --> L[\"Queue for Verifier Review\" ]\n  L --> M{\"Approved?\"}\n  M -->|\"Yes\"| N[\"Elevate to verifiedMember\" ]\n  M -->|\"No\"| O[\"Deny with Reason & Cooldown\" ]\n```\n\n### EARS-Formatted Requirements\n- THE onboarding service SHALL require email verification before granting full member privileges.\n- WHILE the email is unverified within the grace period, THE onboarding service SHALL restrict posting and interaction capabilities per policy.\n- WHEN verification succeeds, THE onboarding service SHALL activate the member role and record the verification timestamp.\n- WHEN a user applies for verifiedMember, THE verification service SHALL require evidence and a rationale.\n- THE verification service SHALL maintain an auditable decision with reviewer identity and decision reason.\n- IF a verification request is denied, THEN THE verification service SHALL impose a cooldown period before re-application.\n\n### Error Handling and Performance\n- WHEN verification links are followed, THE system SHALL process activation within 2 seconds and provide clear status.\n- IF the verification link is expired or already used, THEN THE system SHALL present a safe re-issue path.\n\n## Notification Delivery Flow\n\n### Business Description\nNotifications inform users about relevant events (e.g., new comments, moderation outcomes, appeal updates). Users set preferences for delivery types (instant or digest) and categories. The system batches and rate limits notifications to prevent overload.\n\n### Preconditions\n- Trigger event occurs from another process.\n- Recipient has not muted the category and is eligible under policy.\n\n### Mermaid Flow Diagram (Notifications)\n```mermaid\ngraph LR\n  A[\"Event Triggered\" ] --> B[\"Resolve Recipients & Preferences\" ]\n  B --> C[\"Apply Eligibility & Mute Rules\" ]\n  C --> D{\"Any Recipients?\"}\n  D -->|\"No\"| E[\"End (No Delivery)\" ]\n  D -->|\"Yes\"| F{\"Delivery Mode\"}\n  F --> G[\"Instant Queue\" ]\n  F --> H[\"Digest Queue\" ]\n  G --> I[\"Send Notification\" ]\n  H --> J[\"Aggregate & Schedule\" ]\n  I --> K[\"Acknowledge\" ]\n  J --> K\n```\n\n### EARS-Formatted Requirements\n- THE notification service SHALL respect per-user category preferences for instant or digest delivery modes.\n- WHERE recipients exceed batching thresholds, THE notification service SHALL aggregate events into a digest according to schedule rules.\n- WHEN a moderation or appeal decision occurs, THE notification service SHALL deliver outcome notifications within 1 minute.\n- IF a user has muted a category, THEN THE notification service SHALL suppress those notifications except for mandatory compliance notices.\n- THE notification service SHALL mark notifications as read/unread based on user interactions recorded by other flows.\n\n### Error Handling and Performance\n- WHEN an instant notification is enqueued, THE system SHALL attempt delivery within 1 minute under normal operating conditions.\n- IF a delivery attempt fails, THEN THE system SHALL retry based on a backoff schedule and record a delivery status for audit.\n\n## Cross-Role Considerations and Guardrails\n- WHERE a user’s account state changes (mute, suspension, reinstatement), THE system SHALL enforce the new state consistently across all flows without delay.\n- THE system SHALL ensure that factChecker annotations do not directly impose sanctions but are highly visible to moderators in related cases.\n- THE system SHALL ensure that admin can perform all moderator actions and manage role elevations and policy configurations.\n\n## Scope Reminder\nThis document contains business requirements only. It intentionally avoids technical implementation details such as APIs, database schemas, or system architecture. Developers have full autonomy to choose the appropriate technical solutions that satisfy these requirements.\n"},"plan":"User-flow document for civicDebateBoard targeting the development team.\n- Purpose: Describe end-to-end business workflows so developers implement processes consistently.\n- Outline: (1) Posting and Editing Content Flow; (2) Commenting and Replying Flow; (3) Voting and Reactions Flow; (4) Reporting Content and Triage Flow; (5) Moderation Review and Enforcement Flow; (6) Appeals and Reinstatement Flow; (7) Onboarding and Verification Flow; (8) Notification Delivery Flow.\n- Audience: Development team.\n- Key questions: Step-by-step business flows; how reporting, moderation, appeals progress; key decision points and outcomes.\n- Detail level: Detailed specification using EARS.\n- Constraints: Include at least one Mermaid diagram per complex flow with strict syntax; business logic only.\n- Roles: member, verifiedMember, factChecker, moderator, admin.\n- Integration: Reference [User Personas and Scenarios], [Functional Requirements Specification], [Content Moderation and Safety Policies] with descriptive links.\n","review":"Enhance to production-ready quality with these criteria:\n- Length: 5,000–30,000+ characters; fully complete with no placeholders.\n- EARS compliance: Convert all applicable statements into EARS (WHEN, WHILE, IF, THEN, WHERE, THE, SHALL in English; descriptions in en-US).\n- Specificity: Business requirements must be precise, measurable, and testable from the user perspective; avoid technical implementation details (no APIs, DB schemas, or architecture).\n- Mermaid: All diagrams must use proper syntax — every label wrapped in double quotes; no spaces between brackets/braces and quotes; no nested quotes; correct arrows (`-->`, `-.->`, `==>`). Prefer `graph LR`. Subgraph labels must be double-quoted.\n- Structure: Follow the provided outline exactly; expand each section with step-by-step workflows, decision points, business rules, error handling, and performance expectations.\n- Roles & Permissions: Apply role gates (member, verifiedMember, factChecker, moderator, admin) in business terms within each flow.\n- Error handling: Include user-facing error and recovery scenarios for each process.\n- Performance: Provide response-time expectations and SLAs in user terms.\n- Links: Use descriptive alt text for internal links only where they exist.\n- Prohibited: Do not include developer notes (except allowed only in 00-toc). Do not include API/database specs or UI design.\n- Language: en-US, professional tone. Avoid meta phrases like “This document…”.\n- Business-only scope: State WHAT the system must do; developers own HOW.\n","content":"# User Flows and Processes — civicDebateBoard\n\nBusiness workflows for civicDebateBoard enable consistent behavior across all core processes in clear business terms (WHAT to do). Technical implementations (architecture, APIs, database design, UI) remain at the discretion of the development team.\n\nRelated context for deeper background:\n- See narrative personas and examples in the [User Personas and Scenarios](./04-user-personas-and-scenarios.md).\n- Full capability rules are captured in the [Functional Requirements Specification](./06-functional-requirements.md).\n- Policy definitions and enforcement guardrails are established in the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## Conventions and Roles Context\n- Roles: member, verifiedMember, factChecker, moderator, admin.\n- Content types: post, comment, reply, reaction, vote, report, annotation (fact-check), sanction, appeal, notification.\n- Time and localization: Interpret deadlines and timestamps in the user’s configured timezone; maintain canonical timestamps per business rules in the [Functional Requirements Specification](./06-functional-requirements.md).\n- EARS syntax: Applicable requirements use EARS keywords (WHEN, WHILE, IF, THEN, WHERE, THE, SHALL) in English; all descriptions in en-US.\n\n## Global Preconditions and Shared Behaviors\n\n### Authentication, Authorization, and State Gates\n- THE platform SHALL require authentication for actions that modify state (posting, commenting, voting, reporting, annotating, moderating, appealing).\n- THE platform SHALL evaluate role-based permissions and account state (active, muted, suspended, banned) before any mutating action.\n- WHERE ownership is required, THE platform SHALL verify the actor is the content owner within allowed windows.\n- WHEN a rate limit applies, THE platform SHALL calculate remaining quota and the next reset time and SHALL enforce the limit consistently across flows.\n\n### Idempotency, Concurrency, and Conflict Handling\n- WHEN repeated identical user actions occur within a short window (e.g., double-submit), THE platform SHALL process them idempotently so that only one effect is applied.\n- WHEN a concurrent update would create a conflict (e.g., editing content that changed since fetch), THE platform SHALL deny the action with a conflict reason and SHALL preserve the user’s latest attempt as a new draft when applicable.\n\n### Visibility States and Evidence\n- THE platform SHALL treat visibility states as: public, limited (e.g., pending review), hidden (author and staff only), removed (tombstoned), and restored; transitions follow policy.\n- THE platform SHALL capture immutable evidence snapshots for policy-relevant transitions (e.g., removal, label application, sanction issuance).\n\n### Audit and Notifications\n- THE platform SHALL record an immutable audit entry for actions affecting safety, visibility, roles, or account state.\n- WHEN user-impacting outcomes occur (publish, reject, label, sanction, appeal decision), THE notification service SHALL send outcomes consistent with user preferences and mandatory policy notices.\n\n## Posting and Editing Content Flow\n\n### Business Description\nMembers publish civic discussion posts with titles, body text, tags, and topics. Certain content routes to pre-moderation based on trust signals and policy flags. Authors may edit their own posts subject to time-bound and policy constraints. Verified members may mark content as expert when permitted.\n\n### Preconditions\n- Authenticated as member or above.\n- Account in good standing (not muted or suspended).\n- Sufficient rate-limit budget.\n\n### Primary Flow (Posting)\n1. Author creates a draft with required fields.\n2. System validates inputs and checks rate limits.\n3. System evaluates pre-moderation requirement.\n4. If pre-moderation is required, route to review queue; otherwise publish.\n5. On publish, schedule notifications to followers/subscribers per preferences.\n\n### Editing Flow\n1. Author requests to edit own post.\n2. System validates edit window, sanctions, and lock status.\n3. Apply edit and record an immutable edit trail.\n4. If the edit materially changes policy-sensitive content, temporarily hide and queue for re-review.\n\n### Key Decisions\n- Pre-moderation requirement.\n- Edit window and re-review triggers.\n- Sanctions and rate-limit status.\n\n### Mermaid Flow Diagram (Posting + Editing)\n```mermaid\ngraph LR\n  A[\"Start(Author Authenticated)\"] --> B[\"Create Draft(Post)\"]\n  B --> C[\"Validate Input & Rate Limits\"]\n  C --> D{\"Valid & Within Limits?\"}\n  D -->|\"No\"| E[\"Reject with Errors\"]\n  D -->|\"Yes\"| F{\"Pre-Moderation Needed?\"}\n  F -->|\"Yes\"| G[\"Queue for Review\"]\n  F -->|\"No\"| H[\"Publish Immediately\"]\n  G --> I{\"Approved?\"}\n  I -->|\"Yes\"| H\n  I -->|\"No\"| J[\"Reject with Policy Reason\"]\n  H --> K[\"Notify Subscribers/Followers\"]\n  K --> L[\"End(Post Visible)\"]\n\n  %% Editing sub-flow\n  M[\"Author Requests Edit\"] --> N[\"Check Edit Window & Sanctions\"]\n  N --> O{\"Allowed?\"}\n  O -->|\"No\"| P[\"Deny Edit with Reason\"]\n  O -->|\"Yes\"| Q[\"Apply Edit & Record Trail\"]\n  Q --> R{\"Triggers Re-Review?\"}\n  R -->|\"Yes\"| S[\"Temporarily Hide & Queue\"]\n  R -->|\"No\"| T[\"Keep Visible\"]\n  S --> U{\"Approved?\"}\n  U -->|\"Yes\"| T\n  U -->|\"No\"| V[\"Revert/Reject Edit\"]\n```\n\n### EARS-Formatted Requirements\n- THE posting service SHALL require authentication as member or higher to create posts.\n- THE posting service SHALL validate required fields: title (non-empty, max length per policy), body (non-empty), and at least one tag/topic where required by policy.\n- WHERE the author is newly registered or under low-trust conditions, THE posting service SHALL route new posts to pre-moderation.\n- WHEN input validation fails, THE posting service SHALL return a structured error containing field-level reasons.\n- WHEN a post is published, THE notification service SHALL enqueue notifications to eligible subscribers within 1 minute.\n- WHILE the post is in review, THE content visibility service SHALL set visibility to non-public and visible to moderators and the author.\n- IF the review is rejected for policy reasons, THEN THE posting service SHALL notify the author with categorical reasons and next-step guidance.\n- WHERE the edit occurs within the allowed self-edit window (e.g., 24 hours) and no sanctions apply, THE posting service SHALL allow edits and record an edit trail accessible to moderators.\n- IF the edit materially changes sensitive content categories, THEN THE posting service SHALL temporarily hide the post and submit for re-review.\n- WHEN rate limits are exhausted, THE posting service SHALL deny the action with a reset time.\n- WHEN a verifiedMember marks a post as expert-tagged, THE posting service SHALL display an expert badge subject to verification policy.\n\n### Error Handling and Recovery\n- IF required fields are missing, THEN THE system SHALL provide explicit field names and constraints in the response message.\n- IF the user is muted or suspended, THEN THE system SHALL block posting and include sanction type and end time.\n- IF duplicate content is detected within a short window, THEN THE system SHALL reject with a duplicate warning.\n\n### Performance and Rate Limiting Expectations\n- WHEN a valid post is submitted without pre-moderation, THE system SHALL complete publication within 2 seconds under normal load.\n- WHEN posts enter pre-moderation, THE system SHALL place the item in the review queue within 1 second and confirm receipt to the author.\n- WHERE rate limits apply, THE system SHALL present remaining quota and next reset time in natural language.\n\n## Commenting and Replying Flow\n\n### Business Description\nUsers add comments to posts and replies to comments to facilitate threaded discussion. Comment visibility and edit rules mirror those of posts, but with shorter edit windows and stricter anti-spam controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Account not under comment-restrictive sanctions.\n- Target post or parent comment is visible and open for comments.\n\n### Mermaid Flow Diagram (Commenting)\n```mermaid\ngraph LR\n  A[\"Start(Authenticated)\"] --> B[\"Select Target(Post/Comment)\"]\n  B --> C[\"Validate Target Visibility & Open State\"]\n  C --> D{\"Allowed to Comment?\"}\n  D -->|\"No\"| E[\"Deny with Reason\"]\n  D -->|\"Yes\"| F[\"Create Draft(Comment)\"]\n  F --> G[\"Validate Content & Rate Limits\"]\n  G --> H{\"Valid?\"}\n  H -->|\"No\"| I[\"Reject with Errors\"]\n  H -->|\"Yes\"| J{\"Pre-Moderation Needed?\"}\n  J -->|\"Yes\"| K[\"Queue for Review\"]\n  J -->|\"No\"| L[\"Publish Comment\"]\n  K --> M{\"Approved?\"}\n  M -->|\"Yes\"| L\n  M -->|\"No\"| N[\"Reject with Policy Reason\"]\n  L --> O[\"Update Counts & Notify Participants\"]\n```\n\n### EARS-Formatted Requirements\n- THE commenting service SHALL allow only authenticated users in good standing to submit comments.\n- THE commenting service SHALL validate that the target is visible and open for comments before accepting content.\n- WHERE anti-spam heuristics trigger, THE commenting service SHALL require pre-moderation for the comment.\n- WHEN a comment is published, THE system SHALL notify the post author and recent participants subject to notification preferences.\n- WHERE an edit occurs within a 30-minute window and no replies exist, THE commenting service SHALL allow self-edit with edit trail.\n- IF the parent content is removed, THEN THE commenting service SHALL mark the comment’s visibility per policy (e.g., hidden with placeholder).\n\n### Error Handling and Performance\n- WHEN validation fails, THE system SHALL return field-specific messages within 2 seconds.\n- WHEN a user exceeds comment rate limits, THE system SHALL block the action and provide reset time.\n\n## Voting and Reactions Flow\n\n### Business Description\nUsers express sentiment through votes (e.g., up/down) and reactions (e.g., agree, insightful). Each user may cast at most one vote per item and may update or retract it. Tallying is transparent and subject to anti-abuse controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Target content is visible and not locked.\n\n### Mermaid Flow Diagram (Voting)\n```mermaid\ngraph LR\n  A[\"Start(Authenticated)\"] --> B[\"Select Target Content\"]\n  B --> C[\"Check Visibility & Lock State\"]\n  C --> D{\"Eligible?\"}\n  D -->|\"No\"| E[\"Deny(Not Eligible)\"]\n  D -->|\"Yes\"| F[\"Check Existing Vote\"]\n  F --> G{\"Has Existing Vote?\"}\n  G -->|\"No\"| H[\"Apply New Vote\"]\n  G -->|\"Yes\"| I{\"Same Direction?\"}\n  I -->|\"Yes\"| J[\"Retract Vote\"]\n  I -->|\"No\"| K[\"Update Vote Direction\"]\n  H --> L[\"Update Tally\"]\n  J --> L\n  K --> L\n  L --> M[\"Acknowledge & Notify(Optional)\"]\n```\n\n### EARS-Formatted Requirements\n- THE voting service SHALL restrict each user to a single active vote per item at any time.\n- WHEN a user submits the same vote twice, THE voting service SHALL interpret it as a retraction and update the tally accordingly.\n- WHEN a user changes vote direction, THE voting service SHALL decrement the prior tally and increment the new tally atomically.\n- WHERE the target content is locked, THE voting service SHALL reject voting with a lock reason.\n- THE reactions service SHALL allow multiple reaction types per item but limit one per type per user.\n- IF a user is sanctioned from participatory actions, THEN THE voting and reactions services SHALL deny the attempt with sanction details.\n\n### Error Handling and Performance\n- WHEN a valid vote/reaction request succeeds, THE system SHALL acknowledge within 1 second under normal load.\n- IF the content reference is invalid, THEN THE system SHALL return a clear “not found or not visible” outcome without leaking private state.\n\n## Reporting Content and Triage Flow\n\n### Business Description\nUsers report content suspected of violating policy. Reports are categorized, prioritized, and routed to moderation queues. factChecker can attach annotations with sources and propose corrections. Moderators triage reports according to SLAs.\n\n### Preconditions\n- Reporter is authenticated (member or above) and not sanctioned from reporting.\n- Target content exists and is visible to the reporter at the time of reporting.\n\n### Mermaid Flow Diagram (Reporting & Triage)\n```mermaid\ngraph LR\n  A[\"Start(Reporter Authenticated)\"] --> B[\"Select Content & Category\"]\n  B --> C[\"Validate Inputs & Duplicate Report Check\"]\n  C --> D{\"Valid?\"]\n  D -->|\"No\"| E[\"Reject with Errors\"]\n  D -->|\"Yes\"| F[\"Create Report Record\"]\n  F --> G[\"Priority Scoring(Severity, Volume, Role)\"]\n  G --> H[\"Route to Queue(Policy/Topic)\"]\n  H --> I{\"Auto-Action Threshold Met?\"}\n  I -->|\"Yes\"| J[\"Apply Temporary Hide\"]\n  I -->|\"No\"| K[\"Await Moderator Review\"]\n  J --> K\n```\n\n### Fact-Check Annotation Sub-flow\n```mermaid\ngraph LR\n  A[\"Identify Claim in Content\"] --> B[\"Create Annotation(Claim Excerpt)\"]\n  B --> C[\"Attach Sources(URLs) & Rating\"]\n  C --> D{\"Complete & Within Limits?\"}\n  D -->|\"No\"| E[\"Reject with Field Errors\"]\n  D -->|\"Yes\"| F[\"Publish Annotation\"]\n  F --> G[\"Notify Moderators & Author\"]\n  G --> H{\"Label/Action Needed?\"}\n  H -->|\"Yes\"| I[\"Queue for Moderator Review\"]\n  H -->|\"No\"| J[\"Visible Without Enforcement\"]\n```\n\n### EARS-Formatted Requirements\n- THE reporting service SHALL require a category selection from the defined policy taxonomy for every report.\n- THE reporting service SHALL deduplicate substantially identical reports within a defined time window to prevent spam.\n- WHERE severity or report volume crosses thresholds, THE reporting service SHALL temporarily hide the content pending review.\n- WHEN a factChecker adds an annotation, THE system SHALL link the annotation to the reported content and make it available to moderators.\n- WHEN a report is submitted, THE system SHALL confirm receipt to the reporter within 2 seconds and provide a reference ID.\n- THE annotation workflow SHALL require at least one valid source URL, a rating, and an explanation to publish an annotation by a factChecker.\n- WHEN an annotation is published, THE system SHALL display an annotation badge and SHALL notify the content author and relevant subscribers.\n\n### Error Handling and SLAs\n- THE reporting service SHALL prevent reports on content the reporter cannot see.\n- THE moderation triage process SHALL surface high-priority items to moderators within 1 minute of report submission.\n\n## Moderation Review and Enforcement Flow\n\n### Business Description\nModerators review reported or queued content, assess against policy, and choose outcomes: approve, edit with transparency note, remove, warn, mute, suspend, or escalate to admin. All actions create audit logs and user notifications with clear reasons.\n\n### Preconditions\n- Moderator or admin authenticated with appropriate privileges.\n- Evidence (reports, prior history, annotations) accessible.\n\n### Mermaid Flow Diagram (Moderation)\n```mermaid\ngraph LR\n  A[\"Start(Moderator Assigned)\"] --> B[\"Open Case & Review Evidence\"]\n  B --> C{\"Policy Violation?\"}\n  C -->|\"No\"| D[\"Approve/Restore Content\"]\n  C -->|\"Yes\"| E{\"Severity Level\"]\n  E --> F[\"Edit with Transparency Note\"]\n  E --> G[\"Remove Content\"]\n  E --> H[\"Issue Warning\"]\n  E --> I[\"Apply Mute/Suspension\"]\n  E --> J[\"Escalate to Admin\"]\n  D --> K[\"Notify Reporter & Author\"]\n  F --> K\n  G --> K\n  H --> K\n  I --> K\n  J --> L[\"Admin Decision\"] --> K\n  K --> M[\"Close Case & Log Audit\"]\n```\n\n### EARS-Formatted Requirements\n- THE moderation service SHALL present consolidated evidence including reports, prior violations, and factChecker annotations.\n- WHEN no violation is found, THE moderation service SHALL approve or restore the content and notify involved parties.\n- WHERE a minor violation is identified, THE moderation service SHALL allow corrective edits with a transparency note.\n- WHERE policy prohibits the content, THE moderation service SHALL remove the content and preserve an evidence snapshot.\n- WHERE behavior warrants sanctions, THE moderation service SHALL apply warnings, mutes, or suspensions per configured policy tiers.\n- WHEN a case requires higher authority, THE moderation service SHALL support escalation to admin with case context.\n- THE moderation service SHALL create immutable audit logs for every action, including actor, timestamp, and rationale category.\n\n### Error Handling and SLAs\n- WHEN a moderation action is taken, THE system SHALL notify affected users within 1 minute with clear reason categories and appeal instructions.\n- WHERE automatic actions temporarily hid content, THE system SHALL reconcile visibility within 1 minute after final decision.\n\n## Appeals and Reinstatement Flow\n\n### Business Description\nUsers may appeal moderation actions within a defined window. Appeals are reviewed by a different moderator or an admin depending on severity and result in uphold, partial modification, or reversal.\n\n### Preconditions\n- Appellant authenticated and is the subject of the action or the content author.\n- Appeal within allowed time window and includes a reason.\n\n### Mermaid Flow Diagram (Appeals)\n```mermaid\ngraph LR\n  A[\"Start(User Files Appeal)\"] --> B[\"Validate Eligibility & Window\"]\n  B --> C{\"Eligible?\"}\n  C -->|\"No\"| D[\"Reject Appeal with Reason\"]\n  C -->|\"Yes\"| E[\"Create Appeal Case\"]\n  E --> F[\"Assign Reviewer(Independence Rule)\"]\n  F --> G[\"Review Evidence & Rationale\"]\n  G --> H{\"Outcome\"}\n  H --> I[\"Uphold\"]\n  H --> J[\"Modify(Partial)\"]\n  H --> K[\"Reverse\"]\n  I --> L[\"Notify Parties & Close\"]\n  J --> L\n  K --> L\n```\n\n### EARS-Formatted Requirements\n- THE appeals service SHALL require appellants to provide a reason tied to predefined categories.\n- THE appeals service SHALL enforce an independence rule such that the original moderator does not decide the appeal.\n- WHEN an appeal is filed, THE system SHALL acknowledge receipt within 2 seconds and provide a tracking ID.\n- WHEN an appeal decision is recorded, THE system SHALL notify all relevant parties and update content visibility and sanctions accordingly.\n- WHERE reversal occurs, THE appeals service SHALL restore content and remove or annotate sanctions as appropriate.\n\n### Error Handling and SLAs\n- IF the appeal is out of window or lacks required information, THEN THE system SHALL reject with guidance on eligibility and timing.\n- THE appeals queue SHALL present new appeals to eligible reviewers within 5 minutes of submission.\n\n## Onboarding and Verification Flow\n\n### Business Description\nVisitors register, verify email, and complete basic profile steps. Users may request elevation to verifiedMember by submitting identity or expertise evidence. Admins or designated verifiers adjudicate requests.\n\n### Preconditions\n- For registration: unauthenticated visitor.\n- For verification: authenticated user in good standing.\n\n### Mermaid Flow Diagram (Onboarding & Verification)\n```mermaid\ngraph LR\n  A[\"Start Registration\"] --> B[\"Provide Email & Password\"]\n  B --> C[\"Create Account(Pending Verification)\"]\n  C --> D[\"Send Verification Email\"]\n  D --> E{\"Email Verified?\"}\n  E -->|\"No\"| F[\"Limit Access(Grace Period)\"]\n  E -->|\"Yes\"| G[\"Activate Member Role\"]\n  G --> H[\"Optional: Complete Profile\"]\n  H --> I{\"Apply for Verification?\"]\n  I -->|\"No\"| J[\"End(Member)\"]\n  I -->|\"Yes\"| K[\"Submit Evidence & Rationale\"]\n  K --> L[\"Queue for Verifier Review\"]\n  L --> M{\"Approved?\"}\n  M -->|\"Yes\"| N[\"Elevate to verifiedMember\"]\n  M -->|\"No\"| O[\"Deny with Reason & Cooldown\"]\n```\n\n### EARS-Formatted Requirements\n- THE onboarding service SHALL require email verification before granting full member privileges.\n- WHILE the email is unverified within the grace period, THE onboarding service SHALL restrict posting and interaction capabilities per policy.\n- WHEN verification succeeds, THE onboarding service SHALL activate the member role and record the verification timestamp.\n- WHEN a user applies for verifiedMember, THE verification service SHALL require evidence and a rationale.\n- THE verification service SHALL maintain an auditable decision with reviewer identity and decision reason.\n- IF a verification request is denied, THEN THE verification service SHALL impose a cooldown period before re-application.\n\n### Error Handling and Performance\n- WHEN verification links are followed, THE system SHALL process activation within 2 seconds and provide clear status.\n- IF the verification link is expired or already used, THEN THE system SHALL present a safe re-issue path.\n\n## Notification Delivery Flow\n\n### Business Description\nNotifications inform users about relevant events (e.g., new comments, moderation outcomes, appeal updates). Users set preferences for delivery types (instant or digest) and categories. The system batches and rate limits notifications to prevent overload.\n\n### Preconditions\n- Trigger event occurs from another process.\n- Recipient has not muted the category and is eligible under policy.\n\n### Mermaid Flow Diagram (Notifications)\n```mermaid\ngraph LR\n  A[\"Event Triggered\"] --> B[\"Resolve Recipients & Preferences\"]\n  B --> C[\"Apply Eligibility & Mute Rules\"]\n  C --> D{\"Any Recipients?\"}\n  D -->|\"No\"| E[\"End(No Delivery)\"]\n  D -->|\"Yes\"| F{\"Delivery Mode\"}\n  F --> G[\"Instant Queue\"]\n  F --> H[\"Digest Queue\"]\n  G --> I[\"Send Notification\"]\n  H --> J[\"Aggregate & Schedule\"]\n  I --> K[\"Acknowledge\"]\n  J --> K\n```\n\n### EARS-Formatted Requirements\n- THE notification service SHALL respect per-user category preferences for instant or digest delivery modes.\n- WHERE recipients exceed batching thresholds, THE notification service SHALL aggregate events into a digest according to schedule rules.\n- WHEN a moderation or appeal decision occurs, THE notification service SHALL deliver outcome notifications within 1 minute.\n- IF a user has muted a category, THEN THE notification service SHALL suppress those notifications except for mandatory compliance notices.\n- THE notification service SHALL mark notifications as read/unread based on user interactions recorded by other flows.\n\n### Error Handling and Performance\n- WHEN an instant notification is enqueued, THE system SHALL attempt delivery within 1 minute under normal operating conditions.\n- IF a delivery attempt fails, THEN THE system SHALL retry based on a backoff schedule and record a delivery status for audit.\n\n## Cross-Role Considerations and Guardrails\n- WHERE a user’s account state changes (mute, suspension, reinstatement), THE system SHALL enforce the new state consistently across all flows without delay.\n- THE system SHALL ensure that factChecker annotations do not directly impose sanctions but are highly visible to moderators in related cases.\n- THE system SHALL ensure that admin can perform all moderator actions and manage role elevations and policy configurations.\n\n## Additional Global EARS Requirements\n- THE platform SHALL ensure idempotent processing for publish, edit, vote, react, report, annotate, and appeal submission actions within a 60-second window.\n- WHEN a content item transitions visibility state, THE platform SHALL update search/discovery eligibility within 60 seconds.\n- WHEN a thread is locked by a moderator, THE platform SHALL deny new comments and edits by non-staff immediately, with a lock reason.\n- IF a mention targets a user who has blocked the author, THEN THE platform SHALL prevent the mention and SHALL not notify the blocked user.\n- WHERE a sanction expires, THE platform SHALL restore previously restricted capabilities automatically without user action.\n- WHEN content is restored after appeal, THE platform SHALL notify the author and SHALL re-enable discovery within 60 seconds.\n\n## Performance Summary (User-Observable Targets)\n- Publish (no pre-mod): ≤ 2 s; Pre-mod queueing: ≤ 1 s; Notification enqueue: ≤ 1 min.\n- Comment publish: ≤ 2 s; Validation error response: ≤ 2 s.\n- Vote/Reaction acknowledgement: ≤ 1 s; Cross-session reflection: ≤ 2–5 s.\n- Report submission acknowledgement: ≤ 2 s; Triage surfacing (high-priority): ≤ 1 min.\n- Moderation decision propagation: ≤ 1 min to affected users; Visibility reconciliation: ≤ 1 min.\n- Appeal receipt acknowledgement: ≤ 2 s; Assignment to reviewer: ≤ 5 min; Decision notifications: immediate on decision.\n- Email verification processing: ≤ 2 s; Verification re-issue path available for expired/used links.\n- Notification delivery for instant events: ≤ 1 min; Digest aggregation per schedule.\n\nAll content is expressed as business requirements only; developers retain full autonomy over architecture, APIs, and database design, and are responsible for selecting fit-for-purpose technical solutions that satisfy these requirements.\n","tokenUsage":{"total":78566,"input":{"total":69482,"cached":0},"output":{"total":9084,"reasoning":2688,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":11,"step":0,"created_at":"2025-08-15T02:44:06.879Z"},"tokenUsage":{"aggregate":{"total":1097461,"input":{"total":939408,"cached":19328},"output":{"total":158053,"reasoning":49344,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":1094639,"input":{"total":937101,"cached":19328},"output":{"total":157538,"reasoning":48960,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeComplete","roles":[{"name":"member","description":"Authenticated community participant who can create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules."},{"name":"verifiedMember","description":"Identity- or expertise-verified participant with elevated trust level; may create expert-tagged posts, host AMAs, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while remaining subject to all policies."},{"name":"factChecker","description":"Trusted role allowed to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes; cannot apply sanctions directly."},{"name":"moderator","description":"Role responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, handling appeals within scope, and maintaining community health."},{"name":"admin","description":"Top-level role managing platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions plus administrative operations."}],"prefix":"civicDebateBoard","files":[{"reason":"To provide a navigable overview of all documents with clear links and reading order for stakeholders.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","Document List and Descriptions","Reading Order and Dependencies"],"audience":"general","keyQuestions":["What documents exist and in what order should they be read?","How are documents related?"],"detailLevel":"high-level overview","constraints":["Must list every document with descriptive link text","Must include developer autonomy note at the very end as a blockquote per guidelines"],"content":"# civicDebateBoard Documentation Index and Reading Guide\n\n## Document Purpose\nAuthoritative table of contents for the civicDebateBoard documentation set with concise descriptions, intended audiences, and purposes for every file. Provides a recommended reading order and dependency view so stakeholders can navigate efficiently and understand how each document contributes to the overall system definition.\n\n## Document List and Descriptions\n- [Table of Contents and Reading Guide](./00-toc.md) — Overview of all documents, their purposes, recommended reading order, and cross-dependencies.\n- [Service Vision and Overview](./01-service-vision-and-overview.md) — Vision, scope, objectives, success criteria, and the Business Model (Why the service exists, revenue strategy, growth plan, and success metrics). Audience: business stakeholders.\n- [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Target user pains, market context, competitive landscape, differentiators, risks, and mitigations. Audience: business stakeholders.\n- [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Authenticated roles (member, verifiedMember, factChecker, moderator, admin), role permissions, JWT-based session and token policies, permission matrix, and account lifecycle rules using EARS. Audience: development team.\n- [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Representative personas and end-to-end scenarios (happy paths, edge cases, abuse/misuse) with acceptance criteria in EARS. Audience: product managers.\n- [User Flows and Business Processes](./05-user-flows-and-processes.md) — Step-by-step workflows for posting, commenting, voting, reporting, moderation, appeals, onboarding/verification, and notifications, with Mermaid flow diagrams. Audience: development team.\n- [Functional Requirements Specification](./06-functional-requirements.md) — Functional capabilities, rules, and validations for the discussion board: content relationships, threading, tagging, search/discovery, notifications, bookmarks/follows, localization/timezone handling, and accessibility expectations. Uses EARS extensively with measurable acceptance criteria. Audience: development team.\n- [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Policy principles, prohibited/restricted content, civic discourse safeguards, report intake and prioritization, review SLAs, sanctions, transparency, evidence handling, audit trails, and appeals using EARS. Audience: development team.\n- [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Performance, availability, reliability, capacity/scalability, rate limiting and fair use, observability expectations, backup/DR objectives (RTO/RPO), and internationalization/timezone considerations, using EARS where applicable. Audience: development team.\n- [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Privacy principles and consent, user rights, security expectations, audit and accountability, incident response, breach notification, regulatory compliance, and third-party risk, with EARS-formatted obligations. Audience: development team.\n- [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Revenue strategy options (ads, sponsorships, subscriptions) with ethical guardrails, analytics KPIs and cadence, content quality and community health metrics, moderation/safety metrics, governance for data use, and success review processes. Audience: business stakeholders.\n\n## Reading Order and Dependencies\n\nRecommended sequence builds context progressively and reduces rework:\n\n1. [Service Vision and Overview](./01-service-vision-and-overview.md) — Foundation: vision, scope, and success metrics set direction.\n2. [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md) — Validates problem-solution fit and differentiators.\n3. [User Personas and Scenarios](./04-user-personas-and-scenarios.md) — Grounds requirements in real user needs and representative scenarios.\n4. [User Flows and Business Processes](./05-user-flows-and-processes.md) — Converts scenarios into end-to-end business workflows.\n5. [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) — Defines role models and account lifecycle rules underpinning authorization across flows.\n6. [Functional Requirements Specification](./06-functional-requirements.md) — Consolidates complete functional rules, validations, and acceptance criteria informed by flows and roles.\n7. [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md) — Formalizes community safety policies and enforcement that constrain and inform functional behaviors.\n8. [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md) — Establishes performance, availability, scalability, and operability expectations informed by scope and safety.\n9. [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) — Defines cross-cutting obligations shaping authentication, data handling, and operational practices.\n10. [Business Model and Analytics Strategy](./10-business-model-and-analytics.md) — Aligns measurement and monetization with the defined product scope and operating constraints.\n\nHigh-level dependencies among documents:\n\n```mermaid\ngraph LR\n  A[\"01 Service Vision and Overview\"] --> B[\"02 Market Problem and Value Proposition\"]\n  A --> C[\"06 Functional Requirements\"]\n  B --> C\n  D[\"04 User Personas and Scenarios\"] --> E[\"05 User Flows and Processes\"]\n  C --> E\n  F[\"03 User Roles and Authentication\"] --> C\n  F --> G[\"07 Content Moderation and Safety Policies\"]\n  G --> E\n  C --> H[\"08 Non-Functional Requirements and SLAs\"]\n  F --> H\n  I[\"09 Security, Privacy, and Compliance\"] --> F\n  I --> H\n  C --> J[\"10 Business Model and Analytics\"]\n  A --> J\n```\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*"},{"reason":"Establish the vision, scope, and business model to align all stakeholders before detailing requirements.","filename":"01-service-vision-and-overview.md","documentType":"service-overview","outline":["Executive Summary","Objectives and Success Criteria","Target Users and Use Cases","Service Scope and Boundaries","Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)","Assumptions and Constraints","Out of Scope"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who are the users and what are the core goals?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","02-market-problem-and-value-proposition.md","06-functional-requirements.md","10-business-model-and-analytics.md"],"constraints":["Must include Business Model section with Why/How/What","Use natural language only; avoid technical implementation details"],"content":"# Service Vision and Overview — civicDebateBoard\n\n## Executive Summary\ncivicDebateBoard is a mission-driven discussion platform purpose-built for high-quality civic discourse. It combines open participation with verifiable expertise, structured fact-checking, and transparent, policy-led moderation. Members of the public can raise civic questions and debate policy topics; identity- or expertise-verified contributors add qualified analysis; fact checkers annotate claims with sources; moderators enforce policy with documented rationales; and administrators govern platform-wide policies and safeguards.\n\nThe platform addresses three persistent gaps in online civic discussion: (1) low signal-to-noise that impedes constructive debate, (2) weak pathways for in-thread evidence and expertise, and (3) opaque or inconsistent moderation that undermines trust. By introducing role-based trust layers, claim-level fact-check annotations, explicit enforcement rationales, and measurable service-level expectations, civicDebateBoard aims to become a trusted venue for citizens, journalists, researchers, and policymakers to engage responsibly and learn from each other.\n\nContext and complementary materials are available in the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md), the [Functional Requirements Specification](./06-functional-requirements.md), and the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md). A navigable index is provided in the [Documentation Index and Reading Guide](./00-toc.md).\n\n## Objectives and Success Criteria\nStrategic objectives translate into measurable outcomes. Requirements below are expressed with EARS syntax where applicable for clarity and testability.\n\n### Strategic Objectives\n- Establish a trusted environment for evidence-centered civic debate that welcomes diverse participation while elevating verifiable information.\n- Provide clear, consistent, and transparent moderation and fact-check processes, including rationales and appeal mechanisms.\n- Achieve sustainable operations through ethical monetization aligned with civic mission and safety guardrails.\n\n### Key Results and Targets (12–18 months)\n- Community Health and Quality\n  - At least 70% of active discussions contain a sourced claim or a fact-check annotation within 24 hours of first reply.\n  - Median moderation first-action times: ≤ 30 minutes for P1 (safety) during active hours; ≤ 4 hours for standard P2/P3.\n  - Correction adoption rate ≥ 60% for content found materially inaccurate by accepted fact checks.\n- Engagement and Reach\n  - Monthly Active Users (MAU) ≥ 100,000; 90-day retention for new members ≥ 35%.\n  - Verified expert participation in ≥ 20% of high-visibility threads (top decile by engagement).\n  - Average time-to-first-meaningful-response on public-interest threads ≤ 10 minutes during peak hours.\n- Trust and Transparency\n  - ≥ 95% of enforcement actions provide machine-readable and human-readable rationales visible to impacted users.\n  - ≥ 95% of appeals include written outcomes with policy references and are delivered within published SLAs.\n\n### EARS-Formatted Success Requirements\n- THE platform SHALL support roles \"member\", \"verifiedMember\", \"factChecker\", \"moderator\", and \"admin\" as the basis for participation and accountability.\n- WHEN a user submits a P1 (safety) report, THE platform SHALL place the item in the moderation queue within 1 minute and SHALL present a receipt with a reference ID to the reporter.\n- WHEN a fact-check annotation with at least one citation is submitted by a factChecker, THE platform SHALL attach it to the referenced claim and SHALL present the annotation status as \"proposed\", \"accepted\", or \"contested\" to readers.\n- IF content is sanctioned with a warning, mute, or suspension, THEN THE platform SHALL notify the content owner with the policy basis, duration, and appeal options within 1 minute of action.\n- WHERE a thread is labeled as public-interest or time-sensitive (e.g., election-related), THE platform SHALL elevate review priority and SHALL target first-action within 15 minutes during active periods.\n- THE platform SHALL present timestamps, quotas, and durations in the user’s locale and timezone for clarity of notices and sanctions.\n\n## Target Users and Use Cases\nRoles define how users participate and are held accountable in business terms.\n\n- Member (member)\n  - Authenticated participant who can create and manage own posts and comments; react and vote; follow topics; bookmark; report content; and manage account settings under rate limits and policies.\n  - Primary outcomes: raise civic questions; contribute experiences; signal interest via voting; report misconduct with reasoned categories.\n\n- Verified Member (verifiedMember)\n  - Identity- or expertise-verified participant with elevated trust and accountability; can create expert-tagged posts and host structured Q&A sessions.\n  - Primary outcomes: provide qualified analysis; clarify complex topics; cite credible sources; lead high-signal events such as AMAs.\n\n- Fact Checker (factChecker)\n  - Trusted role focused on integrity; can add claim-level annotations with sources, propose corrective labels, and collaborate with moderators; cannot sanction directly.\n  - Primary outcomes: annotate claims; surface evidence; propose corrections; increase information quality.\n\n- Moderator (moderator)\n  - Responsible for triaging reports, reviewing content, applying policy decisions, issuing warnings and sanctions, handling appeals at first level, and maintaining audit trails.\n  - Primary outcomes: enforce policy consistently; meet review SLAs; communicate decisions with policy references.\n\n- Administrator (admin)\n  - Governs policies, categories, tags, role assignments, sanctions configuration, and compliance reviews; performs all moderator actions plus administrative operations.\n  - Primary outcomes: maintain governance; calibrate policies; ensure compliance; approve sensitive operations (e.g., data exports) in line with policy.\n\n### Representative Use Cases\n- Public-interest debate: A member starts a thread on election policy; verifiedMembers provide expert context; factCheckers annotate claims; moderators enforce civility and rules with transparent outcomes.\n- Fast misinformation response: A viral claim is reported; factCheckers propose annotations; moderators apply interim labels and review within accelerated SLAs.\n- Expert Q&A (AMA): A verifiedMember hosts a scheduled session; members submit questions; evidence-backed answers are curated; summaries remain accessible for public reference.\n- Policy transparency in enforcement: A sanctioned user receives a rationale with policy references and appeal windows; rationales are visible to the impacted user and auditable by authorized roles.\n\n## Service Scope and Boundaries\n\n### In Scope (Business Capabilities)\n- Role-based participation aligned to the roles above with calibrated privileges and accountability.\n- Threaded discussions (posts, comments, replies) with reactions and voting; organization by tags, topics, and categories.\n- Reporting and moderation workflows with prioritization, interim actions, rationales, and appeal mechanisms.\n- Fact-check lifecycle: submission, review, acceptance/rejection, and visible annotations on referenced claims.\n- Transparency and audit: policy references with sanctions, appeals outcomes, and role-appropriate audit views.\n- Notifications for replies, mentions, moderation decisions, and fact-check updates, respecting user preferences.\n- Ethical growth and monetization features (e.g., sponsorships, subscriptions) governed by guardrails that protect civic integrity.\n\n### Boundaries and Operating Principles\n- Civic mission first: quality and safety precede raw engagement or virality.\n- Evidence-centered dialogue: claims encouraged to reference credible sources; expert contributions are labeled.\n- Transparent enforcement: actions include rationale, duration, and appeal paths; outcomes follow documented SLAs.\n- Inclusivity and accessibility: participation is encouraged across backgrounds, languages, and abilities, within community norms and policies.\n\n### High-Level Interaction Flow\n```mermaid\ngraph LR\n  subgraph \"Public Participation\"\n    U[\"Members & Verified Members\"] --> P[\"Posts & Comments\"]\n    P --> R[\"Report Content Action\"]\n    P --> N[\"Notifications to Followers\"]\n    P --> T[\"Topic & Category Organization\"]\n  end\n  subgraph \"Quality & Integrity\"\n    V[\"Fact Checkers\"] --> F[\"Fact-Check Annotations\"]\n    F --> P\n    R --> M[\"Moderation Review Queue\"]\n    M --> E[\"Enforcement & Appeals\"]\n  end\n  subgraph \"Governance\"\n    A[\"Administrators\"] --> S[\"Policies, Roles, Settings\"]\n    S -.-> M\n    S -.-> T\n  end\n```\n\n## Business Model (Why, Revenue Strategy, Growth Plan, Success Metrics)\n\n### Why This Service Exists\n- Problem: Civic discussion spaces often degrade into low-signal debate, misinformation, and harassment, discouraging participation and expert input.\n- Opportunity: Combining open dialogue with verifiable expertise and structured fact-checking can materially improve discourse quality and civic literacy.\n- Differentiation: Role-based trust layers (verified experts and fact checkers), transparent enforcement with measurable SLAs, and annotation-first handling of claims distinguish civicDebateBoard from generic forums and social feeds.\n\n### Revenue Strategy (How)\n- Primary: Ethical sponsorships of civic topics with strict conflict-of-interest guardrails and clear disclosure labels.\n- Secondary: Organizational subscriptions for curated debates, AMAs, and research initiatives with enhanced moderation support.\n- Tertiary: Community memberships providing perks (topic curation, early access, recognition badges) without pay-to-speak or pay-to-amplify mechanics.\n- Guardrails: No targeted political ads; no pay-for-reach; mandatory sponsorship disclosures; strong separation between editorial independence and sponsorship.\n\n### What This Service Delivers (Business Operations)\n- Evidence-centered civic debate with role accountability and annotated claims.\n- Structured policy and enforcement workflows that provide consistent, explainable outcomes with auditable rationales.\n- Transparent public-interest programming (e.g., expert Q&A series) that remains accessible as a knowledge resource.\n- Ethical monetization that supports the mission without compromising discourse integrity or safety.\n\n### Growth Plan\n- Acquisition: Partnerships with universities, think tanks, public libraries, NGOs, journalist networks, and local governments; organic growth from high-quality public-interest threads and expert programming.\n- Activation and Retention: Onboarding that encourages citation-backed contributions; scheduled expert sessions; recognition programs for constructive participation and verified expertise.\n- Network Effects: Topic following and notifications; recurring event series; durable knowledge artifacts (accepted fact checks, AMA summaries) that drive inbound interest.\n\n### Success Metrics and KPIs\n- Reach and Engagement: MAU/DAU, session frequency, and time-to-first-meaningful-response on public-interest threads.\n- Quality and Integrity: Share of posts with citations; fact-check turnaround; accepted vs. contested annotations; rate of corrected or retracted claims.\n- Safety and Trust: SLA adherence in moderation and appeals; user satisfaction with enforcement communications; reduction in repeat violations.\n- Sustainability: Sponsorship revenue by topic (with disclosures), institutional subscription retention, membership conversion and churn.\n\n## Assumptions and Constraints\n\n### Assumptions\n- Roles and Identity: Users authenticate and can be associated with one or more of the defined roles with auditable transitions (e.g., member → verifiedMember).\n- Policy Governance: Content rules, sanctions, priorities, and appeals are governed by documented policies that can be updated with oversight.\n- Time Sensitivity: Certain threads (e.g., election or emergency-related) require elevated review priority and faster turnaround than standard discussions.\n- International Participation: Users participate across time zones; timestamps and notices align to user locale for clarity.\n\n### Constraints\n- Safety Over Virality: Business processes privilege community safety and integrity over growth tactics that increase harm risk.\n- Transparency Obligation: Enforcement communications must include rationales with policy references; appeals must produce documented outcomes.\n- Ethical Monetization: Revenue activities cannot bias discourse or undermine safety and independence.\n- Privacy and Compliance: Data rights and legal obligations are honored per applicable jurisdictions; security expectations are treated as business obligations.\n\n### EARS-Formatted Operating Constraints\n- THE service SHALL include policy references and human-readable rationales with all sanctions visible to the impacted user.\n- WHERE sponsorship is present, THE service SHALL label sponsored sessions and SHALL disclose sponsor identity to participants in all related surfaces.\n- IF an expert-tagged post by a verifiedMember is found materially inaccurate, THEN THE service SHALL require correction or visible annotation prior to further amplification.\n- WHILE a discussion is under active appeal, THE service SHALL preserve evidence and SHALL restrict irreversible enforcement until appeal resolution except where safety risk requires immediate action.\n- THE service SHALL reserve high-priority triage for public-interest and time-sensitive topics during defined civic windows (e.g., election periods) with accelerated response targets.\n- WHEN notifications are generated for policy decisions or annotations, THE service SHALL deliver them within the published timeframe and SHALL honor user preferences except where notices are mandatory.\n\n## Out of Scope\nTo keep the vision coherent and delivery focused, the following are out of scope in the current planning horizon:\n- Frontend UI/UX specifications, visual design systems, and screen layouts.\n- Technical implementation details such as APIs, database schemas, infrastructure choices, or deployment topologies.\n- Paid amplification mechanisms (pay-for-reach, targeted political ads) or monetization that could bias civic discourse.\n- Real-time voice or video townhalls; the focus is asynchronous and near-synchronous text with notifications.\n- Third-party data brokerage or resale of user data.\n\n---\n\nAll content in this overview expresses business requirements and expectations only; technical implementation decisions (including architecture, APIs, and data models) remain at the discretion of the development team. For deeper market context, consult the [Market Problem and Value Proposition](./02-market-problem-and-value-proposition.md). For detailed capability rules and validations, consult the [Functional Requirements Specification](./06-functional-requirements.md). For sustainability and measurement details, consult the [Business Model and Analytics Strategy](./10-business-model-and-analytics.md)."},{"reason":"Clarify the specific market gap, user pains, and differentiators to justify product direction and positioning.","filename":"02-market-problem-and-value-proposition.md","documentType":"service-overview","outline":["Problem Statement","Market Context and Trends","Competitive Landscape","Differentiators and Core Value Proposition","Risks and Mitigations","Success Metrics Alignment"],"audience":"business stakeholders","keyQuestions":["What pains do target users face today?","Who are the competitors and how do we differentiate?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md"],"constraints":["Focus on user pains and value; avoid implementation details"],"content":"# Market Problem and Value Proposition — civicDebateBoard\n\n## Problem Statement\nCivic discourse online is undermined by low signal-to-noise ratios, persistent misinformation, harassment, and fragmented conversations that fail to converge on clarity. Mainstream social feeds optimize for virality and novelty, not deliberative quality. Generic forums depend on inconsistent volunteer moderation without evidence workflows. Stakeholders lack shared accountability mechanisms that elevate expertise and protect participants.\n\nRole-based pains observed across civic communities:\n\n- Members (general participants)\n  - Encounter hostility, brigading, and low-trust environments that deter participation and reduce willingness to share nuanced perspectives.\n  - Lack reliable tools to follow civic topics, bookmark complex threads, and surface credible sources amid noise.\n  - Experience inconsistent enforcement, leading to perceptions of unfairness and disengagement.\n\n- Verified Members (identity- or expertise-verified participants)\n  - Struggle to make qualified contributions visible without being drowned out by engagement-biased ranking or low-quality replies.\n  - Face higher scrutiny with limited affordances to demonstrate expertise (e.g., expert tags with context and accountability).\n\n- Fact Checkers (trusted integrity role)\n  - Lack in-platform tools to attach claim-level annotations with citations and transparent ratings (e.g., true, needs context, misleading, false).\n  - Experience friction collaborating with moderators; proposed corrections are slow to propagate or hard to discover.\n\n- Moderators (community safety role)\n  - Overwhelmed by report volumes without standardized evidence intake, triage SLAs, or audit trails for consistent decisions and appeals.\n  - Encounter accusations of bias without transparent policy scaffolding or publishable enforcement metrics.\n\n- Admins (governance role)\n  - Need configurable policies, categories, and sanctions with clear oversight for compliance and election-related protections.\n  - Require partner-ready governance artifacts and transparency logs to maintain institutional trust.\n\nUnderlying structural causes:\n- Engagement-first incentives that amplify outrage and novelty rather than verifiable substance.\n- Insufficient role differentiation that fails to elevate credible expertise or structure integrity work.\n- Missing claim-level evidence mechanisms making corrections adversarial and hard to track.\n- Opaque moderation without consistent rationales, timelines, or appeal visibility.\n\ncivicDebateBoard addresses these pains by centering deliberation quality, role-based accountability, and transparent governance so that open participation can coexist with trust, safety, and evidence.\n\n## Market Context and Trends\nPersistent and accelerating trends intensify demand for a purpose-built civic debate platform:\n\n- Trust & Safety Maturation: Movement from reactive takedowns to policy-led enforcement with auditable rationale, SLAs, and appeal processes demanded by regulators and civil society.\n- Election Integrity Focus: Recurring election cycles elevate risks of misinformation, voter suppression narratives, and coordinated manipulation; stakeholders require rapid, auditable responses.\n- Role-Based Communities: Professional networks and QA platforms demonstrate the value of role differentiation (experts, moderators, reviewers) to improve signal quality and accountability.\n- Evidence-Seeking Behavior: Audiences increasingly look for citations and context, favoring spaces that reward substantiated claims over performative engagement.\n- Ethical Monetization: Preference for models that do not rely on polarization or sensitive microtargeting; institutions seek credible venues for public-interest dialogues.\n- Compliance & Platform Accountability: Privacy and platform rules (e.g., GDPR-like regimes and election-related guidelines) drive expectations for auditability, transparency logs, and rights-respecting processes.\n\nOpportunity emerges where open participation meets evidence-backed, role-accountable debate with measurable transparency.\n\n## Competitive Landscape\nAdjacent categories offer partial solutions but do not integrate deliberation depth, trust mechanisms, and scalable safety operations in one cohesive service.\n\n| Category | Strengths | Gaps vs civicDebateBoard | Implication |\n|---------|-----------|--------------------------|-------------|\n| Mainstream Social Networks | Reach, real-time updates | Engagement-first ranking, weak role differentiation, opaque moderation, externalized fact-checks | Poor fit for sustained, evidence-led debate |\n| Traditional Forums/Subforums | Topic organization, community ownership | Inconsistent moderation, minimal evidence workflows, fragmented appeals | Quality variance; low auditability |\n| Q&A/Knowledge Platforms | Reputation systems, focus on accuracy | Not optimized for multi-perspective civic debate or time-bounded events; limited misinformation surge handling | Insufficient for dynamic civic contexts |\n| News Comments & Publisher Communities | Article context | Fragmented across sites, minimal transparency for enforcement, weak cross-thread continuity | Limited network effects for civic discourse |\n| Specialized Fact-Checking Sites | High-quality fact checks | Not interactive platforms; limited integration into ongoing debates; no role-based community | Lacks participatory debate mechanics |\n\nPositioning summary:\n- Competes on deliberation quality, role accountability, and integrated evidence workflows, not on raw audience size or entertainment value.\n- Designed for public-interest partners (NGOs, universities, media, local governments) seeking credible civic dialogues with transparent governance.\n\n## Differentiators and Core Value Proposition\ncivicDebateBoard differentiates through a role-enabled, evidence-forward, transparency-first model tailored to civic conversations.\n\n- Role Differentiation as a First-Class Concept\n  - Members: Clear accountability with rate limits and self-moderation tools to support healthy dialogue.\n  - Verified Members: Expert-tagged content, structured AMAs, calibrated trust signals, and heightened accountability standards.\n  - Fact Checkers: Claim-level annotations with citations, ratings, and transparency notes; collaborative pathways to moderators.\n  - Moderators: Policy-backed triage queues, evidence handling, sanctions catalog, and audit trails for explainable decisions.\n  - Admins: Governance configuration, policy/sanction management, role assignments, and compliance oversight suitable for civic contexts.\n\n- Evidence-Centric Conversation Mechanics\n  - Claim-level annotation lifecycle (proposal, review, accepted/contested), citation surfacing, and contextual transparency to reduce misinformation persistence.\n  - Topic/category structures aligned to public-interest themes for sustained discovery and coherent debate continuity.\n\n- Transparency and Accountability by Design\n  - Visible policy references accompanying enforcement outcomes, auditable appeals, and publishable transparency logs for aggregated moderation metrics.\n  - Clear conflict-of-interest handling for reviewers and fact checkers to reinforce perceived fairness.\n\n- Safety Without Engagement Maximization\n  - Healthy discourse outcomes prioritized over raw engagement: resolved debates, consensus markers, correction adoption.\n  - Configurable rate limits and thresholds designed to reduce harassment and brigading while preserving legitimate participation.\n\n- Institutional Value\n  - Safe, auditable venue for civic partners to host debates, AMAs, and educational series with measurable integrity signals and trust-building transparency.\n\nValue proposition statement:\n- Enable high-trust, evidence-backed civic discussions that are transparent, role-accountable, and operationally sustainable—improving discourse quality and community legitimacy for members, institutions, and the broader public.\n\nMermaid mapping of pains to differentiators:\n\n```mermaid\ngraph LR\n  subgraph \"User Pains\"\n    P1[\"Low Signal-to-Noise\"]\n    P2[\"Misinformation Persistence\"]\n    P3[\"Hostility & Brigading\"]\n    P4[\"Opaque Moderation\"]\n    P5[\"Expert Voices Drowned Out\"]\n  end\n  subgraph \"civicDebateBoard Differentiators\"\n    D1[\"Role Differentiation\"]\n    D2[\"Claim-Level Annotations\"]\n    D3[\"Transparent Enforcement\"]\n    D4[\"Safety & Rate Limits\"]\n    D5[\"Expert Affordances(AMAs,Tags)\"]\n  end\n  P1 --> D1\n  P1 --> D5\n  P2 --> D2\n  P2 --> D3\n  P3 --> D4\n  P4 --> D3\n  P5 --> D1\n  P5 --> D5\n```\n\n## Risks and Mitigations\nThe civic debate domain includes operational, reputational, legal, and growth risks. Mitigations emphasize governance, standard operating procedures, and role clarity.\n\n- Cold Start and Network Effects\n  - Risk: Difficulty seeding quality discussions without initial critical mass.\n  - Mitigations: Partner-led topic launches (universities, NGOs, councils), scheduled expert AMAs, early emphasis on fact-check visibility and topic curation.\n\n- Abuse, Harassment, and Coordinated Manipulation\n  - Risk: Targeted brigading during sensitive events leading to participant attrition.\n  - Mitigations: Configurable rate limits, graduated sanctions, severity-based triage, conflict-of-interest rules, and transparent enforcement communication.\n\n- Misinformation and Defamation\n  - Risk: Legal and reputational exposure from persistent false claims.\n  - Mitigations: Claim-level annotations, corrections workflow, visibility labels, and verifiable sources coupled with auditable review outcomes.\n\n- Perception of Bias\n  - Risk: Allegations that moderation or fact-checking favors particular viewpoints.\n  - Mitigations: Public policy documentation, consistent SLAs, independence in appeals, conflict-of-interest disclosures, and aggregate transparency reporting.\n\n- Compliance Exposure\n  - Risk: Failure to meet privacy, election-related, or platform accountability obligations.\n  - Mitigations: Governance reviews, consent/rights management, auditability, incident response readiness, and policy updates aligned to civic timelines.\n\n- Monetization Misalignment\n  - Risk: Revenue mechanisms incentivizing polarizing content or undermining trust.\n  - Mitigations: Ethics-aligned sponsorships/subscriptions, bans on sensitive microtargeting, and guardrails tying revenue to quality outcomes.\n\n- Resource Constraints for Moderation and Fact-Checking\n  - Risk: Queues outpace reviewer capacity during peak civic events.\n  - Mitigations: Priority-tier routing, partner escalations for P0/P1 civic topics, scheduled volunteer fact-checker rotations, and temporary amplification dampening until review.\n\n- Community Capture by Factions\n  - Risk: Dominant groups discourage diverse participation and suppress minority voices.\n  - Mitigations: Topic diversity goals, proactive outreach to underrepresented experts, fair-use rate limits, and anti-manipulation rules.\n\nEARS-formatted governance guardrails:\n- THE governance model SHALL require conflict-of-interest disclosures for moderators and factCheckers on assigned cases.\n- WHEN a civic event enters a designated election window, THE enforcement process SHALL apply elevated SLAs and SHALL prioritize election-integrity categories over standard items.\n- IF monetization experiments degrade civic quality metrics beyond thresholds, THEN THE business operations SHALL pause or terminate the experiment and document remediation steps.\n- WHERE partner-hosted dialogues occur, THE community operations team SHALL display sponsorship labels and SHALL preserve editorial independence.\n- WHILE appeal review is pending, THE enforcement process SHALL preserve evidence and SHALL avoid irreversible actions unless safety requires immediate measures.\n\n## Success Metrics Alignment\nSuccess is defined by outcomes that reflect high-quality, trusted civic discourse and durable institutional credibility. Metrics emphasize quality, trust, safety, and mission-aligned growth rather than raw engagement volume.\n\nQuality of Discourse\n- Percentage of posts/comments in designated civic topics that include at least one cited source for material claims.\n- Ratio of resolved threads (consensus markers, accepted corrections) to total active debates.\n\nTrust and Accountability\n- Time to first fact-check annotation on high-velocity claims in priority topics.\n- Appeals resolution time and satisfaction rate measured by post-decision survey where applicable.\n- Transparency log cadence and completeness (share of enforcement actions with visible policy references).\n\nSafety and Moderation Efficiency\n- Triage SLA attainment by severity tier (critical, high, medium, low).\n- Recidivism rate after warnings or sanctions.\n- Share of proactive vs reactive enforcement actions.\n\nCommunity Health and Growth Quality\n- Monthly participation rate of verified members and expert AMA cadence.\n- New member onboarding completion rate with policy acknowledgment.\n- Ratio of constructive participation to removals within sensitive topics during civic events.\n\nPartner and Institutional Adoption\n- Number of hosted civic dialogues by NGOs, universities, or media partners per quarter.\n- Partner retention and satisfaction scores linked to transparency and quality outcomes.\n\nEARS-formatted success commitments (business-level, testable):\n- THE civicDebateBoard SHALL achieve ≥ 90% triage SLA attainment for critical severity reports during designated election windows.\n- THE civicDebateBoard SHALL reach ≥ 80% coverage of flagged high-velocity claims with at least one fact-check annotation within 24 hours.\n- THE civicDebateBoard SHALL keep the recidivism rate for sanctioned users ≤ 10% within 60 days of sanction.\n- THE civicDebateBoard SHALL publish aggregated transparency metrics at least monthly, including counts by category and average time to first action.\n- WHEN an appeal is submitted within the allowed window, THE civicDebateBoard SHALL deliver a decision within 72 hours and SHALL notify the appellant with rationale.\n- WHERE a partner-hosted AMA is sponsored, THE civicDebateBoard SHALL label the session clearly and SHALL retain the label for the archived record.\n\nAlignment and traceability:\n- Strategic framing and business model context are established in the [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Capability-level rules that operationalize these outcomes are specified in the [Functional Requirements Specification](./06-functional-requirements.md).\n\nBusiness requirements only. All technical implementation decisions (architecture, APIs, database design, and related mechanisms) remain at the full discretion of the development team.\n"},{"reason":"Define authenticated roles, permissions, session behavior, and the business rules of authentication and authorization.","filename":"03-user-roles-and-authentication.md","documentType":"requirement","outline":["Authentication Requirements (Registration, Login, Logout, Email Verification, Password Reset, Session Management, Device Revocation)","Role Hierarchy and Permissions (member, verifiedMember, factChecker, moderator, admin)","Token Management (JWT) and Session Expiration Policies","Permission Matrix (Actions vs Roles)","Account Lifecycle (Creation, Verification, Suspension, Deletion, Appeals)","Auditability and Transparency Requirements"],"audience":"development team","keyQuestions":["What are the authenticated roles and what can each do or not do?","What business rules govern authentication, sessions, and token lifecycles?","How are account states handled across the lifecycle?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","07-content-moderation-and-safety-policies.md","09-security-privacy-and-compliance.md"],"constraints":["Must specify JWT-based token management requirements in business terms (access and refresh lifetimes, revocation expectations)","Must include a clear permission matrix","Use EARS for all applicable requirements","Avoid API or database specifications"],"content":"# User Roles and Authentication Requirements for civicDebateBoard\n\nBusiness requirements for authentication, authorization, user roles and permissions, token/session behavior, account lifecycle, and auditability for the civicDebateBoard service. Business scope only; all technical implementation decisions (architecture, APIs, database design, cryptography choices, storage mechanisms) belong to the development team. Describes WHAT the system must do in business terms, not HOW to build it.\n\nTerminology\n- “the system”: the civicDebateBoard service\n- “user”: a human end-user operating an account\n- “session”: a login state tied to a device and a token pair\n\nRelated context\n- Functional capabilities: [Functional Requirements Specification](./06-functional-requirements.md)\n- Safety policies: [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md)\n- Security and privacy: [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md)\n\n## 1) Definitions and Role Overview\n\n- member: Authenticated community participant who can create and manage own posts and comments, react and vote, follow topics, bookmark, report content, and manage account settings under rate limits and community rules.\n- verifiedMember: Identity- or expertise-verified participant with elevated trust level; may create expert-tagged posts, host AMAs, face higher content accountability, enjoy fewer rate limits, and bypass certain pre-moderation queues while remaining subject to all policies.\n- factChecker: Trusted role allowed to add fact-check annotations, cite sources, flag misleading claims for review, propose corrections, and generate transparency notes; cannot apply sanctions directly.\n- moderator: Role responsible for triaging reports, reviewing content, applying policy decisions, editing/removing violating content, issuing warnings and sanctions, handling appeals within scope, and maintaining community health.\n- admin: Top-level role managing platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions plus administrative operations.\n\nEARS global principle\n- THE civicDebateBoard service SHALL protect accounts, content integrity, and community safety through role-based access control, tokenized sessions, and auditable decision-making.\n\n## 2) Authentication Requirements\n\n### 2.1 Registration\n- WHEN a visitor provides required registration attributes (email and password), THE system SHALL create a pending account and send a verification message.\n- THE system SHALL require email uniqueness per account.\n- THE system SHALL enforce password policy at creation (see 2.5 Password Policy and Reset).\n- IF the email is already in use, THEN THE system SHALL reject registration with a clear, non-enumerating message.\n- WHERE legal age or jurisdictional constraints apply, THE system SHALL require age attestation and reject accounts that fail attestation.\n- THE system SHALL limit registration attempts to a maximum of 5 per IP within 1 hour and 2 per email within 24 hours.\n- IF registration throttling thresholds are exceeded, THEN THE system SHALL delay or block further attempts for the applicable cool-down period (minimum 1 hour).\n\n### 2.2 Email Verification\n- WHEN a registration completes, THE system SHALL send a verification link with a validity of 24 hours.\n- WHEN a user requests re-send, THE system SHALL allow up to 3 re-sends within 24 hours.\n- IF the verification link is expired or invalid, THEN THE system SHALL deny verification and provide a re-send path.\n- WHILE the account is unverified, THE system SHALL restrict posting and interaction capabilities to read-only and profile completion functions.\n- WHEN email verification succeeds, THE system SHALL mark the account as verified and lift unverified restrictions.\n\n### 2.3 Login\n- WHEN a user submits email and password, THE system SHALL validate credentials and respond within 2 seconds under normal load.\n- IF the credentials are invalid, THEN THE system SHALL reject login and increment a failed-attempt counter.\n- IF there are 10 failed login attempts for the same account within 15 minutes, THEN THE system SHALL lock login attempts for that account for 15 minutes and notify the user via the primary email.\n- WHERE multi-factor verification is required by policy or risk, THE system SHALL challenge with a secondary factor before establishing a session (see 2.8 Multi-Factor Authentication).\n- WHEN login succeeds, THE system SHALL establish a session associated with a specific device context and issue tokens per Section 4.\n\n### 2.4 Logout\n- WHEN a user invokes logout on a device, THE system SHALL immediately invalidate the corresponding session for that device.\n- WHEN a user invokes “logout from all devices”, THE system SHALL invalidate all sessions and tokens for that user within 60 seconds.\n\n### 2.5 Password Policy and Reset\n- THE system SHALL enforce password complexity at creation and change: minimum 10 characters; must include at least 3 of the following: uppercase letters, lowercase letters, digits, symbols; shall not contain the email local-part; shall not be one of the last 5 used passwords.\n- WHEN a user requests password reset, THE system SHALL send a reset link valid for 60 minutes.\n- IF a reset token is expired, revoked, or invalid, THEN THE system SHALL deny the reset and allow issuing a new token subject to rate limits (max 3 per 24 hours per account).\n- WHEN a password is successfully reset, THE system SHALL revoke all existing sessions and require re-login on all devices.\n- WHEN a user changes password while authenticated, THE system SHALL enforce the same complexity and reuse rules and SHALL revoke all other device sessions within 60 seconds.\n\n### 2.6 Session Management\n- THE system SHALL associate each session with a user, a device context, and a token pair with independent lifetimes (see Section 4).\n- THE system SHALL allow up to 10 concurrent active sessions per user by default.\n- WHERE an organization or policy sets a lower limit, THE system SHALL enforce the configured maximum sessions per user.\n- WHEN a session exceeds its refresh lifetime, THE system SHALL require full login to re-establish a session.\n- WHILE a session is valid, THE system SHALL honor access tokens for authorization checks within their lifetime.\n\n### 2.7 Device Management and Revocation\n- THE system SHALL maintain a list of active sessions and device contexts visible to the account owner (device name, last activity time, approximate location, and creation time) without exposing sensitive identifiers.\n- WHEN the account owner revokes a device session, THE system SHALL invalidate that session’s tokens within 60 seconds and block further refresh for that session.\n- WHEN suspicious activity is detected (e.g., impossible travel, many failed refresh attempts), THE system SHALL flag the session for review and may require re-authentication on next action.\n\n### 2.8 Multi-Factor Authentication (MFA)\n- WHERE policy, risk scoring, or user preference requires MFA, THE system SHALL require a second factor in addition to password before session establishment.\n- THE system SHALL support recovery options appropriate to policy (e.g., backup codes) without prescribing mechanisms; recovery use SHALL be logged in audit trails.\n- WHERE a device is marked as trusted, THE system SHALL allow skipping MFA for that device for up to 30 days, after which MFA SHALL be required again.\n- IF MFA verification fails 5 times within 15 minutes, THEN THE system SHALL require a cool-down of 15 minutes before another attempt and SHALL notify the account email.\n\n### 2.9 Email Change and Account Recovery\n- WHEN a user requests to change the primary email, THE system SHALL verify current authentication, send confirmation to both old and new emails, and require confirmation within 24 hours to complete the change.\n- IF email change is not confirmed within 24 hours, THEN THE system SHALL cancel the change and retain the old email.\n- WHEN email is changed successfully, THE system SHALL require re-verification of the new email and SHALL revoke all active sessions except the current device session used to complete the change.\n- WHEN an account recovery is initiated due to lost email access, THE system SHALL require additional verification steps defined by policy and SHALL limit account functionality until recovery completes.\n\n### 2.10 Session Idle Timeout and Remember Device\n- WHILE a session is idle, THE system SHALL expire the interactive session after 30 minutes of inactivity and require re-authentication for further actions, without affecting the refresh token lifetime.\n- WHERE a “remember this device” preference is set, THE system SHALL maintain session refresh eligibility for up to 30 days from last credentialed login per Section 4, subject to revocation.\n- IF a high-risk action is initiated (e.g., role change, password change), THEN THE system SHALL require recent re-authentication regardless of idle time or remember-device status.\n\n## 3) Role Hierarchy and Permissions\n\nRole scope and escalation model\n- THE system SHALL implement a hierarchical permission model where admin encompasses moderator permissions; moderator does not encompass admin; factChecker, verifiedMember, and member are orthogonal in scope except where explicitly extended.\n- WHERE a user holds multiple roles, THE system SHALL grant the union of permissions and enforce the strictest accountability and transparency rules that apply to any held role.\n\nRole capabilities (business-level)\n- member\n  - Create, edit, and delete own posts and comments within edit windows and policy.\n  - React, vote, follow topics, bookmark items, and report content.\n  - Manage own account and sessions within limits.\n- verifiedMember\n  - All member capabilities.\n  - Create expert-tagged posts; host AMAs; enjoy reduced pre-moderation and rate limits as defined by policy.\n  - Elevated accountability: content may require more detailed disclosures where applicable.\n- factChecker\n  - Add fact-check annotations tied to specific claims; attach sources and confidence levels.\n  - Flag misleading claims for review; propose corrections; generate transparency notes.\n  - No sanction powers; cannot edit or delete others’ content.\n- moderator\n  - Review reports and queues; apply policy decisions; edit/remove violating content.\n  - Issue warnings, mutes, suspensions within scope; handle appeals at first level.\n  - Access limited audit views necessary for case handling.\n- admin\n  - All moderator capabilities.\n  - Manage platform-wide policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews.\n\nEARS role controls\n- WHEN a member attempts to apply a sanction, THE system SHALL deny the action and display insufficient permission.\n- WHEN a factChecker submits a fact-check note, THE system SHALL record it with attribution and route for visibility according to policy.\n- WHEN a moderator removes content, THE system SHALL record the reason, policy reference, and notify the content owner.\n- WHEN an admin changes a user’s role, THE system SHALL record the actor, old role(s), new role(s), timestamp, and justification and SHALL notify the affected user.\n\n## 4) Token Management (JWT) and Session Expiration Policies\n\nBusiness requirements for tokenized sessions\n- THE system SHALL use JWT for access and refresh tokens.\n- THE access token lifetime SHALL be 15 minutes.\n- THE refresh token lifetime SHALL be 14 days, with sliding renewal on successful refresh (rotation) up to a maximum of 30 days from last credentialed login.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and invalidate the previous refresh token.\n- IF a previously used refresh token is presented again (reuse), THEN THE system SHALL revoke the corresponding session and require full re-authentication.\n- WHEN a user logs out, THE system SHALL invalidate the associated refresh token(s) and disallow further refresh for that session.\n- THE JWT payload SHALL include at minimum: userId, role, permissions array suitable for authorization checks, issued-at time, expiry time, and a session identifier.\n- WHERE additional security context is configured (e.g., device identifier, risk score), THE system SHALL include business-relevant claims without exposing sensitive personal data.\n- THE system SHALL support immediate revocation within 60 seconds for logout-all and device revocation actions.\n- WHERE clock skew between clients and the system exists, THE system SHALL allow a tolerance of up to 60 seconds for token validation decisions without extending token lifetimes.\n\nBusiness obligations for signing key management (non-technical)\n- THE system SHALL protect token-signing secrets as confidential business assets with access limited to personnel with a defined business need.\n- THE system SHALL rotate token-signing secrets on a regular cadence not to exceed 90 days and upon suspected exposure.\n- WHEN a key rotation occurs, THE system SHALL honor active sessions signed by prior keys for a limited overlap window consistent with security policy while ensuring new tokens use the new key.\n\n## 5) Permission Matrix (Actions vs Roles)\n\nBaseline permissions. Rate limits and policy rules still apply. A check mark means “allowed by default,” a cross means “not allowed”; some actions are “Conditional” as noted.\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|---|---|---|---|---|---|\n| Register account | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Login / Logout | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View public content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Create post | ✅ (rate-limited) | ✅ (reduced limits) | ✅ (within policy) | ✅ | ✅ |\n| Create expert-tagged post | ❌ | ✅ | ❌ | ❌ | ✅ (for official posts) |\n| Edit own post (within window) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Delete own post (within window/policy) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Comment on posts | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Vote/React | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Follow topics / Bookmark | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Report content | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Add fact-check annotation | ❌ | ❌ | ✅ | ✅ (with tag) | ✅ |\n| Flag misleading claims for review | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Propose corrections | ❌ | ❌ | ✅ | ✅ | ✅ |\n| Edit/remove others’ content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue warnings | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue mutes/suspensions | ❌ | ❌ | ❌ | ✅ (within scope) | ✅ |\n| Handle appeals (first level) | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Overturn moderator decision | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage roles and verifications | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Manage policies/categories/tags | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Approve data exports | ❌ | ❌ | ❌ | ❌ | ✅ |\n| Access audit logs (case-limited) | ❌ | ❌ | ❌ | ✅ (need-to-know) | ✅ (full) |\n| Host AMAs | ❌ | ✅ | ❌ | ✅ (official) | ✅ |\n\nClarifications\n- “within window” means within the edit/delete grace windows in the [Functional Requirements Specification](./06-functional-requirements.md).\n- “within scope” means within sanction ranges and SLAs in the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## 6) Authorization Rules and Validation (Business Terms)\n\nGeneral authorization checks\n- WHEN an action requires a specific role, THE system SHALL validate that the role is present in the current session’s permissions.\n- WHEN content ownership is required (e.g., edit own post), THE system SHALL validate the actor is the content owner and the action is within permitted time windows.\n- WHERE actions are rate-limited, THE system SHALL enforce limits per user and per device to prevent abuse.\n\nConflict-of-interest and sensitive actions\n- WHERE an action materially affects another user’s account state (e.g., permanent ban), THE system SHALL require the appropriate role and SHALL capture policy basis and rationale.\n- WHERE sanctions beyond 14 days are considered, THE system SHALL require admin review per safety policy documents.\n\nError-handling\n- IF authorization fails, THEN THE system SHALL deny the action with an explanation appropriate to the user’s role and context without revealing sensitive internal details.\n- IF ownership validation fails, THEN THE system SHALL deny the action and indicate that only the owner may perform it within the permitted window.\n\n## 7) Account Lifecycle\n\nStates (business-level)\n- Registered(Unverified)\n- Email Verified\n- Active\n- Verified Member (overlay role state)\n- Muted (temporary, limited interactions)\n- Suspended (temporary, login allowed only to view notices and appeal)\n- Banned (permanent or long-term; login allowed only for appeals if policy allows)\n- Deleted (pending grace period) / Hard Deleted\n- Appeal Pending (overlay state)\n- Dormant (overlay state for inactivity beyond policy threshold)\n\nTransitions and rules\n- WHEN registration completes, THE system SHALL place the account in Registered(Unverified).\n- WHEN email is verified within 24 hours, THE system SHALL transition to Email Verified.\n- WHEN profile minimums are met (if required), THE system SHALL mark the account Active.\n- WHERE identity or expertise verification is approved by admins, THE system SHALL grant verifiedMember.\n- WHEN a mute sanction is applied, THE system SHALL restrict posting and commenting for the mute duration while allowing read access.\n- WHEN a suspension is applied, THE system SHALL restrict all posting and commenting; login is allowed for reviewing notices and filing appeals.\n- WHEN a ban is applied, THE system SHALL disable access except appeal functions as policy dictates.\n- WHEN a user requests deletion, THE system SHALL place the account in Deleted (pending) with a 30-day grace period for reversal.\n- IF the deletion grace period elapses without reversal, THEN THE system SHALL hard delete the account and irreversibly remove personal data subject to legal and audit obligations.\n- WHEN an appeal is filed, THE system SHALL mark the case Appeal Pending and pause escalation timelines until a decision is issued.\n- WHEN an appeal is granted, THE system SHALL restore the prior permissible state and record the justification.\n- WHEN an appeal is denied, THE system SHALL maintain the sanction state and record the justification.\n- WHERE an account shows no activity for 12 months, THE system SHALL mark it Dormant and SHALL require re-verification on next login.\n\nNotifications\n- THE system SHALL notify users of state changes (verification, sanctions, appeals decisions, deletion, dormancy) using preferred channels per the [Functional Requirements Specification](./06-functional-requirements.md).\n\n## 8) Auditability and Transparency Requirements\n\n- THE system SHALL produce an immutable audit trail for security- and policy-relevant events: registrations, logins, logouts, token refreshes and revocations, password changes/resets, role assignments, sanctions, appeals decisions, email changes, MFA events, and recovery actions.\n- THE system SHALL capture for each audited event: actor (user or system), target (user/content), action, timestamp, outcome (success/failure), and justification where applicable.\n- WHERE personal data minimization is required, THE system SHALL record only the minimum necessary identifiers.\n- WHEN moderators or admins take actions affecting user content or state, THE system SHALL require entering a policy reference and rationale.\n- THE system SHALL provide role-appropriate audit access: moderators see case-relevant records; admins can run compliance reviews.\n- IF evidence (e.g., screenshots, links) is attached to a moderation action, THEN THE system SHALL preserve references consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n\n## 9) Non-Functional Expectations for Authentication\n\n- THE system SHALL respond to successful login within 2 seconds under normal load (p95) and 4 seconds under peak load (p95).\n- THE system SHALL deliver verification and reset emails within 2 minutes under normal conditions; retries SHALL occur for transient failures for up to 30 minutes.\n- THE system SHALL support immediate logout-all and device revocation propagation within 60 seconds p95.\n- THE system SHALL enforce rate limits for registration, login, reset, MFA, and recovery flows as defined in Sections 2.1, 2.3, 2.5, and 2.8–2.9.\n- WHERE service degradation occurs, THE system SHALL provide clear user-facing messages and safe fallback behaviors without exposing internal details.\n\n## 10) Detailed EARS Acceptance Criteria by Flow\n\n### 10.1 Registration and Verification\n- WHEN a user completes the sign-up form with a unique email and compliant password, THE system SHALL create an unverified account and send a verification email within 2 minutes.\n- IF the email is already registered, THEN THE system SHALL prevent account creation and present a non-enumerating message.\n- IF the verification link is invalid or expired, THEN THE system SHALL refuse verification and allow requesting a new link subject to rate limits.\n- WHEN verification is successful, THE system SHALL elevate the account to verified state and unlock standard interactions.\n\n### 10.2 Login, Logout, and Lockout\n- WHEN valid credentials are submitted, THE system SHALL issue tokens and create a session in less than 2 seconds.\n- IF invalid credentials are submitted, THEN THE system SHALL increment a failure counter and return an error without indicating which field is incorrect.\n- IF the account reaches 10 failed attempts in 15 minutes, THEN THE system SHALL impose a 15-minute lockout and notify the user’s email.\n- WHEN logout is requested, THE system SHALL invalidate the associated session’s refresh token within 60 seconds.\n- WHEN logout-all is requested, THE system SHALL invalidate all sessions for that user within 60 seconds.\n\n### 10.3 Password Reset and Change\n- WHEN a reset is requested, THE system SHALL send a reset link valid for 60 minutes and rate-limit to 3 per day per account.\n- WHEN a password is reset successfully, THE system SHALL revoke all sessions and require fresh login everywhere.\n- IF the new password fails complexity or reuse checks, THEN THE system SHALL reject the change with specific, actionable messages.\n- WHEN a password is changed by an authenticated user, THE system SHALL revoke all other device sessions within 60 seconds.\n\n### 10.4 Token Refresh and Reuse Detection\n- WHEN an access token expires, THE system SHALL allow refresh using a valid refresh token within its lifetime.\n- WHEN a refresh occurs, THE system SHALL rotate the refresh token and issue a new access token.\n- IF a refresh token is detected as reused, THEN THE system SHALL revoke the session and require full login.\n- WHERE clock skew is present, THE system SHALL tolerate up to 60 seconds skew without extending token lifetime.\n\n### 10.5 Multi-Factor Authentication\n- WHEN MFA is required, THE system SHALL prompt for a second factor before completing login.\n- IF MFA attempts fail 5 times within 15 minutes, THEN THE system SHALL apply a 15-minute cool-down and notify the account email.\n- WHERE a device is marked trusted, THE system SHALL bypass MFA on that device for up to 30 days unless risk signals require re-prompt.\n\n### 10.6 Email Change and Account Recovery\n- WHEN a user requests to change the email, THE system SHALL send confirmations to old and new emails and SHALL require confirmation within 24 hours to complete.\n- IF the email change is not confirmed within 24 hours, THEN THE system SHALL cancel the change and retain the old email.\n- WHEN account recovery is initiated, THE system SHALL restrict sensitive actions until recovery completes and SHALL record recovery steps in the audit trail.\n\n### 10.7 Session Idle Timeout and Re-Authentication for Sensitive Actions\n- WHILE a session is idle for 30 minutes, THE system SHALL expire interactive access and require re-authentication for further actions.\n- WHEN a sensitive action is attempted (e.g., password change, role change), THE system SHALL require recent re-authentication even if within the idle window.\n\n### 10.8 Authorization by Role\n- WHEN an action requires moderator privileges, THE system SHALL permit the action only if the session includes moderator or admin roles.\n- WHEN a fact-check annotation is submitted, THE system SHALL record the annotation and attribute it to the factChecker role user.\n- IF a user without verifiedMember status attempts to create an expert-tagged post, THEN THE system SHALL deny the action and indicate the verification requirement.\n\n## 11) Diagrams\n\n### 11.1 Authentication and Token Refresh Flow\n```mermaid\ngraph LR\n  subgraph \"User Device\"\n    A[\"Submit Login(Email,Password)\"] --> B[\"Wait For Response\"]\n    H[\"Use Access Token For Requests\"] --> I{\"Access Token Expired?\"}\n    I -->|\"Yes\"| J[\"Send Refresh Token\"]\n    I -->|\"No\"| H\n  end\n  subgraph \"civicDebateBoard Service\"\n    C[\"Validate Credentials\"] --> D{\"Account State OK?\"}\n    D -->|\"Yes\"| E[\"Issue Access & Refresh Tokens\"]\n    D -->|\"No\"| F[\"Deny With Reason\"]\n    K[\"Validate Refresh Token\"] --> L{\"Refresh Valid?\"}\n    L -->|\"Yes\"| M[\"Rotate Refresh & Issue New Access\"]\n    L -->|\"No\"| F\n  end\n  A --> C\n  E --> B\n  B --> H\n  J --> K\n  M --> H\n```\n\n### 11.2 Account Lifecycle Overview\n```mermaid\ngraph LR\n  A[\"Registered(Unverified)\"] -->|\"Verify Email(<24h)\"| B[\"Email Verified\"]\n  B -->|\"Profile Minimums Met\"| C[\"Active\"]\n  C -->|\"Admin Grants Verification\"| D[\"Verified Member\"]\n  C -->|\"Issue Mute(<=7d)\"| E[\"Muted\"]\n  C -->|\"Issue Suspension(<=30d)\"| F[\"Suspended\"]\n  C -->|\"Ban\"| G[\"Banned\"]\n  E -->|\"Mute Ends\"| C\n  F -->|\"Suspension Ends\"| C\n  G -->|\"Appeal Filed\"| H[\"Appeal Pending\"]\n  H -->|\"Appeal Upheld\"| C\n  H -->|\"Appeal Denied\"| G\n  C -->|\"User Requests Deletion\"| I[\"Deleted(Pending)\"]\n  I -->|\"Grace Ends(30d)\"| J[\"Hard Deleted\"]\n  I -->|\"User Cancels Deletion\"| C\n  C -->|\"No Activity(12mo)\"| K[\"Dormant\"]\n  K -->|\"Login Attempt\"| B\n```\n\n## 12) Data and Privacy Alignment (Business Terms)\n\n- THE system SHALL minimize personal data exposure in session and audit records consistent with the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md).\n- WHERE legal hold or regulatory retention applies, THE system SHALL retain essential audit records without restoring interactive access for deleted or banned accounts.\n\n## 13) Success Criteria\n\n- Complete and correct enforcement of role-based permissions per matrix.\n- Reliable session handling with timely revocation and token rotation.\n- Clear, testable EARS requirements for all major flows, including MFA, email change, idle timeout, and recovery.\n- Alignment with safety policies and compliance documents without prescribing implementation.\n"},{"reason":"Capture representative users and their end-to-end scenarios to ground requirements in real-world needs.","filename":"04-user-personas-and-scenarios.md","documentType":"user-story","outline":["Personas (Member, Verified Member, Fact Checker, Moderator, Admin)","Primary Scenarios (Happy Paths)","Secondary and Special Scenarios (Edge Cases)","Abuse and Misuse Scenarios","Acceptance Criteria (EARS)"],"audience":"product managers","keyQuestions":["Who are the primary personas and what are their motivations?","What are the main scenarios that define success?","What edge cases and abuse scenarios must be supported or mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","05-user-flows-and-processes.md","06-functional-requirements.md"],"constraints":["Use narrative language; include EARS acceptance criteria where applicable","Avoid UI design or technical details"],"content":"# civicDebateBoard — User Personas and Scenarios (Requirement Analysis)\n\nBusiness requirements only for civicDebateBoard. All technical implementation decisions (architecture, APIs, data models, and infrastructure) belong to the development team. Content defines WHAT outcomes and behaviors are required in business terms.\n\n## Document Scope and Context\n- Purpose: Represent real users, their motivations, and end-to-end scenarios that drive unambiguous business requirements for civic discourse.\n- Alignment: Complements strategic framing in the [Service Vision and Overview](./01-service-vision-and-overview.md); feeds procedural detail in the [User Flows and Processes](./05-user-flows-and-processes.md); anchors validation rules in the [Functional Requirements](./06-functional-requirements.md).\n- Service Prefix: civicDebateBoard\n- Roles in Scope: member, verifiedMember, factChecker, moderator, admin\n- Tone: Formal, outcome-oriented, policy-aware; excludes UI and technical specifications.\n\n## Personas\n\n### Member\n- Summary: Authenticated participant who starts and joins discussions, reacts and votes, follows topics, bookmarks content, reports issues, and manages account settings under rate limits and policy.\n- Motivations:\n  - Participate in good-faith civic debate to learn and contribute constructively.\n  - Find trustworthy, timely information and see quality signals.\n  - Receive relevant updates about followed topics, authors, and threads.\n- Goals:\n  - Publish compliant posts and comments that remain visible.\n  - Get meaningful responses and see consensus signals (votes, helpful reactions).\n  - Curate a personalized feed via follows and bookmarks.\n- Behaviors:\n  - Creates drafts, edits shortly after posting, and reports harmful or off-policy content.\n  - Subscribes to notifications; manages preferences; returns to long threads via bookmarks.\n- Constraints:\n  - Must verify email to publish or report; subject to role-based rate limits and sanctions when applicable.\n- Pain Points and Anti-Goals:\n  - Pain: Low-signal replies and brigading drown out substance; uncertainty about moderation outcomes.\n  - Anti-Goals: Does not want to manage complex settings; does not want to lose drafts or be rate-limited without clear timing.\n- Information Needs:\n  - Clear status of posts/comments (published, pending, held); transparent moderation decisions; visible cooldown timers.\n- Definition of Success:\n  - Content publish completes within seconds; replies trigger timely notifications; reports produce visible outcomes; preferences persist and apply consistently.\n\n### Verified Member\n- Summary: Identity- or expertise-verified participant with elevated trust and accountability; can publish expert-tagged content and host structured Q&A sessions.\n- Motivations:\n  - Share qualified expertise with accountability; reduce friction from pre-moderation; build public credibility.\n- Goals:\n  - Publish expert posts discoverable as authoritative; host AMAs with structured Q&A; cite credible sources.\n- Behaviors:\n  - Provides sources with claims; maintains higher accuracy standards; engages respectfully across threads.\n- Constraints:\n  - Elevated accountability; some actions subject to audit; relaxed rate limits relative to members but full policy compliance.\n- Pain Points and Anti-Goals:\n  - Pain: Expertise drowned by low-signal responses; unnecessary pre-moderation holds during urgent civic events.\n  - Anti-Goals: Avoids forced editorial control by sponsors or admins.\n- Information Needs:\n  - Expert-tag visibility; AMA scheduling status; annotation or label status on their content.\n- Definition of Success:\n  - Expert posts and AMAs achieve high-quality engagement with minimal false-positive holds; annotations and corrections are visible and discoverable.\n\n### Fact Checker\n- Summary: Trusted role adding fact-check annotations with citations, flagging misleading claims for review, proposing corrections, and creating transparency notes; cannot sanction.\n- Motivations:\n  - Improve information quality, context, and verifiability; reduce misinformation persistence.\n- Goals:\n  - Attach annotations with sources; elevate critical misleading claims quickly to moderation.\n- Behaviors:\n  - Adds structured notes including claim excerpts, rating, sources, and explanation; proposes labels that can affect distribution once confirmed by moderation.\n- Constraints:\n  - No direct sanctions; requires moderator/admin confirmation for enforcement-affecting labels; recusal on conflicts.\n- Pain Points and Anti-Goals:\n  - Pain: Limited visibility or delayed review of annotations on fast-moving threads; unclear status of proposed labels.\n  - Anti-Goals: Being perceived as partisan; losing transparency into annotation outcomes.\n- Information Needs:\n  - Annotation visibility state; review status; acceptance/rejection reasons; conflict-of-interest routing confirmations.\n- Definition of Success:\n  - Annotations surface contextually; proposals reviewed within SLAs; authors and readers see clear evidence and status.\n\n### Moderator\n- Summary: Triage reports, review content, apply policy decisions, edit/remove violations, issue warnings and sanctions, handle appeals within scope, and maintain community health.\n- Motivations:\n  - Fair, consistent, transparent enforcement; meet review SLAs; reduce repeat violations.\n- Goals:\n  - Process queues efficiently; apply proportionate actions with rationale; escalate correctly; minimize overturned decisions.\n- Behaviors:\n  - Triage by severity; consult policy references; notify affected parties with concise reasons; maintain audit trails.\n- Constraints:\n  - Must follow escalation rules; avoid conflicts of interest; respect auditability and evidence handling.\n- Pain Points and Anti-Goals:\n  - Pain: Report floods and mass-report brigading; incomplete evidence; unclear precedence.\n  - Anti-Goals: Silent enforcement without rationale; inconsistent decisions across reviewers.\n- Information Needs:\n  - Consolidated case evidence; prior history; annotation context; SLA timers; conflict-of-interest alerts.\n- Definition of Success:\n  - Queue latency within SLA; low appeal reversal rate; clear communications with policy references.\n\n### Admin\n- Summary: Manages platform policies, categories, tags, feature toggles, role assignments, sanctions configuration, data export approvals, and compliance reviews; can perform all moderator actions.\n- Motivations:\n  - Ensure governance, safety, compliance, and sustainable growth.\n- Goals:\n  - Configure policies and taxonomies; manage roles; approve sensitive exports; oversee compliance and audits.\n- Behaviors:\n  - Assigns roles; updates sanctions and policies; reviews audits; activates elevated-protection windows (election/crisis).\n- Constraints:\n  - Operates under legal and governance obligations; high accountability in audit logs; separation from editorial influence.\n- Pain Points and Anti-Goals:\n  - Pain: Policy drift across teams; emergency protections not activating quickly enough; perception of bias.\n  - Anti-Goals: Monetization that compromises discourse integrity; opaque policy changes.\n- Information Needs:\n  - Change impact summaries; compliance status; transparency reports; live SLA adherence.\n- Definition of Success:\n  - Policies and roles reflect current needs; community health metrics improve; compliance reviews pass with minimal exceptions.\n\n## Primary Scenarios (Happy Paths)\n\n### 1) Member publishes and engages\n- Narrative: A member drafts a substantive discussion within rate limits, selects relevant topics and tags, and publishes. If no pre-moderation is required, the post appears instantly. The member follows the thread, receives notifications for replies, and responds. The thread remains discoverable via topics and search.\n- Business Rules: Email verification is required to publish; content must conform to policy; rate limits apply; edits allowed in a short window (e.g., 15 minutes) without review; material changes after the window may require review.\n- Success Indicators: Publication ≤ 3 seconds; notifications ≤ 1 minute for direct replies; discoverability by selected topics.\n\n### 2) Verified Member hosts an expert Q&A (AMA)\n- Narrative: A verifiedMember schedules and posts an expert session tagged as \"expert\". Questions from members are collected; the host answers and cites sources. A summary note closes the session; the thread remains archived.\n- Business Rules: Expert tagging restricted to verifiedMember and above; standard policies and rate limits apply; tagging may increase prominence but never exempts policy.\n- Success Indicators: On-time start; proper question routing; visible summary; high-quality engagement with minimal intervention.\n\n### 3) Fact Checker annotates a claim\n- Narrative: A factChecker identifies a claim in a popular post, attaches an annotation with citations, and proposes a label such as \"unsupported\". Readers see the contextual note and sources. A moderator reviews and confirms the label; the author is notified and may revise.\n- Business Rules: Annotations are non-destructive; proposed enforcement-affecting labels require moderator confirmation.\n- Success Indicators: Annotation visible in ≤ 3 seconds; review completed within SLA; readers engage with sources.\n\n### 4) Member reports content; Moderator triages and enforces\n- Narrative: A member reports content for misinformation or harassment. The system assigns severity and routes to queues. A moderator reviews context and history, applies a proportionate action (dismiss, edit with note, warning, temporary mute, suspension), and logs rationale. Reporter and author are notified.\n- Business Rules: Reporter identity remains confidential to the author; sanctions follow configured ladders; appeals are available within a defined window.\n- Success Indicators: High-severity acknowledgement in minutes; decisions communicated clearly; low reversal rate on appeal.\n\n### 5) Admin manages categories and roles\n- Narrative: An admin creates categories for civic events, updates taxonomies, and assigns factChecker status to a qualified user. Changes take effect quickly and are audited. Affected users are notified.\n- Business Rules: Role changes require justification; taxonomy changes propagate to discovery and subscriptions; audits capture who, what, when, and why.\n- Success Indicators: No disruption to existing content; new categories visible; role changes reflect instantly in permissions.\n\n### 6) Member follows topics and receives updates\n- Narrative: A member follows civic topics. New posts in those topics trigger notifications and update a personalized feed. The member can unfollow at any time with immediate effect.\n- Business Rules: Follow capacity and rate limits apply; notification preferences are user-configurable.\n- Success Indicators: Timely, relevant notifications; accurate feed reflecting follow/unfollow.\n\n### 7) Author adopts a fact-check correction\n- Narrative: An author receives a notification that a claim in their post has an accepted annotation rated \"misleading\". The author revises the content with sources and submits. The revision is accepted; the label is updated to \"corrected\" and the post remains visible with a transparency note.\n- Business Rules: Correction path available to authors; material edits may require review; transparency note persists.\n- Success Indicators: Correction acknowledged within minutes; label updated; readers can see correction context.\n\n### 8) Digest notifications for busy topics\n- Narrative: A member opts into daily digests for a category. The system aggregates updates and sends a digest. The member can switch back to instant notifications.\n- Business Rules: Respect category preferences and quiet hours; deduplicate events; configurable cadence.\n- Success Indicators: Digest contains relevant items; opt-in/out takes effect within 1 minute.\n\n### 9) Moderator conflict-of-interest recusal\n- Narrative: A case assignment engine detects a potential conflict (recent sanctioning of the same author by the same moderator). The case is reassigned; the system records recusal.\n- Business Rules: Independence rule enforced for assignments and appeals.\n- Success Indicators: Reassignment within minutes; audit contains recusal reason and timestamp.\n\n### 10) Election window activation\n- Narrative: Admin activates an elevated-protection window for an upcoming election. Reports in relevant categories are prioritized with faster SLAs; political-content labels are enabled; transparency logs note the activation window.\n- Business Rules: Election windows elevate certain categories; labels and prioritization apply during activation period.\n- Success Indicators: Priority routing verified; SLA compliance improved on election-related items; visibility of labels.\n\n## Flow Illustrations\n\n### Report Intake and Triage (Happy Path)\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"Member Report Content(Select reason)\"] --> B[\"Submit Report\"]\n  end\n  subgraph \"System Classification\"\n    C[\"Classify Severity\"] --> D{\"High Severity?\"}\n  end\n  subgraph \"Moderation\"\n    E[\"Queue Moderator\"] --> F[\"Review Context and History\"] --> G{\"Policy Violation?\"}\n    H[\"Apply Sanction(Warning/Mute/Suspension)\"] --> I[\"Notify Author and Reporter\"]\n    J[\"Dismiss Report\"] --> I\n  end\n  B --> C\n  D -->|\"Yes\"| E\n  D -->|\"No\"| E\n  E --> F\n  G -->|\"Yes\"| H\n  G -->|\"No\"| J\n```\n\n### Fact-Check Annotation Lifecycle\n```mermaid\ngraph LR\n  subgraph \"Annotation\"\n    A[\"Select Claim Excerpt\"] --> B[\"Add Sources(Valid URLs)\"] --> C[\"Propose Rating(True/Needs Context/Misleading/False)\"]\n  end\n  subgraph \"Visibility & Review\"\n    D[\"Display Annotation Contextually\"] --> E{\"Enforcement-Affecting Label?\"}\n    E -->|\"Yes\"| F[\"Require Moderator Confirmation\"]\n    E -->|\"No\"| G[\"Visible Without Enforcement Change\"]\n  end\n  subgraph \"Outcomes\"\n    H[\"Accepted\"]\n    I[\"Contested\"]\n    J[\"Rejected\"]\n  end\n  C --> D\n  F --> H\n  G --> H\n  F -.-> I\n  D -.-> I\n  I --> K[\"Notify Author & FactChecker\"]\n  H --> K\n  J --> K\n```\n\n## Secondary and Special Scenarios (Edge Cases)\n\n### Editing window exceeded\n- Narrative: A member attempts to edit after the self-edit window. A revision request path is offered; material changes queue for review.\n- Expected Outcome: Immediate denial with rationale; optional revision request tracked; visibility preserved until decision.\n\n### Rate limit reached during surge\n- Narrative: A member hits post or comment limits during high-traffic events.\n- Expected Outcome: Clear cooldown timing; draft preserved; automatic re-attempt guidance where applicable.\n\n### Email not verified but attempting to publish\n- Narrative: An authenticated but unverified user tries to publish or report.\n- Expected Outcome: Action blocked with instructions to verify; draft and selections preserved for completion post-verification.\n\n### Suspended user content visibility\n- Narrative: Past content of a suspended user is accessed.\n- Expected Outcome: Labels or limited visibility applied per policy; audit trail intact.\n\n### Fact-checker conflict of interest\n- Narrative: A factChecker attempts to annotate a close collaborator’s content.\n- Expected Outcome: Disclosure required; annotation held; routed to independent reviewer.\n\n### Moderator conflict-of-interest recusal\n- Narrative: A moderator is assigned a report involving a recently sanctioned author.\n- Expected Outcome: Automatic reassignment; recusal captured in audit.\n\n### Appeals window and reinstatement\n- Narrative: A sanctioned user appeals within the allowed window.\n- Expected Outcome: Acknowledgement with tracking ID; independent review within SLA; clear outcome notification with rationale.\n\n### Multi-device session revocation\n- Narrative: A member revokes all device sessions due to suspected account sharing.\n- Expected Outcome: Active sessions terminate within a minute; re-authentication required across devices.\n\n### Timezone and localization handling\n- Narrative: A traveling user views timestamps across timezones.\n- Expected Outcome: Timestamps reflect preference with clear offsets; original post time remains interpretable.\n\n### Duplicate reports and stale links\n- Narrative: Multiple users report the same content; a link in the content is stale.\n- Expected Outcome: Reports merged; stale link warning provided to author; prioritization considers deduplication.\n\n### Long thread management\n- Narrative: A thread exceeds typical length and depth.\n- Expected Outcome: Participants can navigate with summaries and structured context in business terms; moderation tools highlight hotspots.\n\n### Cross-posting and archived topics\n- Narrative: Content cross-posted between related categories; topic later archived.\n- Expected Outcome: Cross-post references remain consistent; archived topics retain read access; posting disabled in archived topics.\n\n## Abuse and Misuse Scenarios\n\n### Coordinated brigading and vote manipulation\n- Behavior: New or low-trust accounts mass-upvote or downvote to distort consensus.\n- Mitigations: Weighted voting by trust signals; burst-limiting; correlation detection; moderator review flags.\n- Expected Outcomes: Reduced manipulative impact; investigation trails available.\n\n### Misinformation campaigns in civic contexts\n- Behavior: Misleading claims surge during elections or emergencies.\n- Mitigations: Priority routing to factChecker and moderator; interstitial context; reduced amplification pending review.\n- Expected Outcomes: Timely labels and context; preserved legitimate debate.\n\n### Harassment and doxxing\n- Behavior: Targeted harassment, threats, or non-consensual personal data sharing.\n- Mitigations: Immediate removal of personal data; protective actions (mutes/suspensions); targeted reporting paths.\n- Expected Outcomes: Rapid protection; proportionate sanctions; comprehensive audit.\n\n### Spam and link farming\n- Behavior: Low-quality promotional links at scale; link shorteners with tracking.\n- Mitigations: Strict rate limits; link reputation checks; auto-collapsing repetitive posts; escalating sanctions.\n- Expected Outcomes: Reduced spam visibility; legitimate links unaffected.\n\n### Sockpuppetry and duplicate accounts\n- Behavior: Multiple accounts used to evade sanctions or fake consensus.\n- Mitigations: Behavioral analytics; stricter new-account limits; consolidated enforcement across linked accounts per policy.\n- Expected Outcomes: Evasion curtailed; sanctions applied across linked accounts.\n\n### Malicious or bad-faith reporting\n- Behavior: Repeatedly reporting compliant content to burden moderation.\n- Mitigations: Reporter reputation factoring; cooldowns for false reporting; sanctions for abuse.\n- Expected Outcomes: Lower false-positive load; preserved reporter functionality for good-faith users.\n\n### Sanction evasion attempts\n- Behavior: Editing to obscure violations; deleting evidence; obfuscation.\n- Mitigations: Immutable audit snapshots; pre-removal capture; post-edit re-checks; pattern detection.\n- Expected Outcomes: Evasion ineffective; accountability preserved.\n\n### Deepfake or synthetic media\n- Behavior: AI-generated media used to mislead.\n- Mitigations: Labeling workflows; request for provenance; fact-check affinity routing; temporary deamplification pending review.\n- Expected Outcomes: Harm reduced; clear labels; source transparency.\n\n### Mass-report brigading\n- Behavior: Coordinated campaigns to mass-report targeted users to silence them.\n- Mitigations: Deduplication, reputation weighting, and anomaly detection; independence rules for reviewers.\n- Expected Outcomes: Minimized abuse; protected speech for compliant content; auditability of report patterns.\n\n### Astroturfing by coordinated organizations\n- Behavior: Coordinated accounts simulate grassroots support.\n- Mitigations: Trust scoring, disclosure requirements, and distribution controls when applicable.\n- Expected Outcomes: Reduced misleading amplification; transparency labels when disclosures apply.\n\n## Acceptance Criteria (EARS)\n\nAll requirements use EARS with descriptions in en-US and keywords in English.\n\n### Core Participation and Posting\n- WHEN a verified email member publishes compliant content, THE civicDebateBoard SHALL make the content visible to the community within 3 seconds.\n- IF a member attempts to publish without verified email, THEN THE civicDebateBoard SHALL block the action and provide a clear verification path without content loss.\n- WHERE a post is newly created by its author, THE civicDebateBoard SHALL allow self-editing for up to 15 minutes from initial publication.\n- IF an edit is attempted after the self-edit window and the change is material, THEN THE civicDebateBoard SHALL route the edit for review and retain the original until a decision is made.\n- WHILE a post is under pre-moderation due to policy or trust signals, THE civicDebateBoard SHALL keep the post non-public and display pending status to the author.\n- WHEN a member follows a topic, THE civicDebateBoard SHALL include relevant new posts in the member’s personalized feed within 1 minute of publication.\n\n### AMA Sessions (Verified Expertise)\n- WHERE a session is tagged as \"expert\", THE civicDebateBoard SHALL restrict creation to verifiedMember and above.\n- WHEN an AMA is scheduled, THE civicDebateBoard SHALL publish the session post at the scheduled time in the host’s configured timezone.\n- WHEN questions are submitted to an active AMA, THE civicDebateBoard SHALL queue them for the host and reflect accepted questions to readers within 1 minute.\n- IF an AMA session ends, THEN THE civicDebateBoard SHALL present a summary section and archive the session for read access.\n\n### Reactions, Voting, and Anti-Manipulation\n- WHERE an account is newly created or low-trust, THE civicDebateBoard SHALL apply stricter voting and reaction rate limits than for established members.\n- WHEN a member casts a vote, THE civicDebateBoard SHALL reflect the vote effect in aggregates within 2 seconds.\n- IF correlated voting patterns exceed manipulation thresholds, THEN THE civicDebateBoard SHALL dampen aggregated impact and flag the activity for moderator review.\n- WHEN a member withdraws a vote within 10 minutes, THE civicDebateBoard SHALL reverse the aggregation accordingly.\n\n### Reporting and Moderation\n- WHEN a member submits a content report, THE civicDebateBoard SHALL acknowledge receipt instantly and assign a severity.\n- WHERE a report is high severity (e.g., doxxing, threats), THE civicDebateBoard SHALL notify a moderator queue within 2 minutes.\n- WHEN a moderator decides an outcome, THE civicDebateBoard SHALL notify the reporter and the author with the decision rationale within 1 minute of decision.\n- IF a report is dismissed, THEN THE civicDebateBoard SHALL record the dismissal rationale in the audit log and mark the report resolved.\n- WHEN a sanction is applied, THE civicDebateBoard SHALL enforce the sanction immediately across all user actions and persist its duration.\n- WHERE a conflict-of-interest is detected for a reviewer, THE civicDebateBoard SHALL reassign the case and record the recusal with rationale.\n\n### Fact-Checking and Annotations\n- WHEN a factChecker adds an annotation with sources, THE civicDebateBoard SHALL display the annotation contextually on the referenced claim within 3 seconds to all readers.\n- IF a factChecker proposes an enforcement-affecting label (e.g., reduced amplification), THEN THE civicDebateBoard SHALL require moderator confirmation before the label affects visibility.\n- WHERE a conflict of interest is declared, THE civicDebateBoard SHALL route the annotation to an independent reviewer and pause enforcement changes until review completes.\n- WHEN an author submits a correction addressing an accepted annotation, THE civicDebateBoard SHALL update the label to reflect the correction and display a transparency note.\n\n### Appeals and Restorative Processes\n- WHEN an author appeals a sanction within the allowed window, THE civicDebateBoard SHALL confirm receipt immediately and assign the appeal to a reviewer distinct from the original decision-maker.\n- WHILE an appeal is pending, THE civicDebateBoard SHALL maintain the current enforcement unless policy specifies otherwise.\n- WHEN an appeal is upheld, THE civicDebateBoard SHALL restore content visibility and notify affected parties within 1 minute.\n- IF an appeal results in modified sanctions, THEN THE civicDebateBoard SHALL update enforcement and communicate changes with rationale.\n\n### Notifications and Subscriptions (Instant and Digest)\n- WHEN a followed thread receives a direct reply to the member’s content, THE civicDebateBoard SHALL send a notification within 1 minute.\n- WHERE a member disables a notification category, THE civicDebateBoard SHALL cease notifications for that category within 1 minute.\n- IF a notification cannot be delivered, THEN THE civicDebateBoard SHALL record a delivery failure and retry according to policy without duplicating user-visible messages.\n- WHEN a member opts into daily digests for a category, THE civicDebateBoard SHALL include top items and deliver the digest according to the configured schedule.\n\n### Account Lifecycle and Sessions\n- WHEN a member revokes all sessions, THE civicDebateBoard SHALL terminate active sessions within 1 minute and require re-authentication.\n- WHERE an account is suspended, THE civicDebateBoard SHALL restrict all posting, voting, and reporting actions for the suspension duration and label historical content per policy.\n- IF a suspended account attempts a restricted action, THEN THE civicDebateBoard SHALL deny the action and display the remaining suspension duration.\n\n### Accessibility, Inclusivity, and Localization\n- THE civicDebateBoard SHALL present timestamps according to the user’s timezone preference with clear offset indicators.\n- WHERE content includes sensitive topics, THE civicDebateBoard SHALL allow readers to access contextual safety and policy information within 2 clicks from the content.\n- THE civicDebateBoard SHALL ensure that all user-facing messages are concise, unambiguous, and free of technical jargon.\n\n### Transparency and Auditability\n- WHEN any moderation or fact-check event occurs, THE civicDebateBoard SHALL record who initiated it, the reason category, the decision, and the time, in an immutable audit trail.\n- IF a moderator is reassigned due to conflict of interest, THEN THE civicDebateBoard SHALL record the reassignment with rationale and timestamps.\n- WHERE a role change is performed by an admin, THE civicDebateBoard SHALL notify the affected user and list the effective permissions change.\n- WHEN an election window is activated, THE civicDebateBoard SHALL display an activation notice in transparency logs and apply elevated SLAs to relevant categories.\n\n### Performance and Experience Expectations\n- THE civicDebateBoard SHALL render user-triggered state changes (publish, vote, follow, report) as complete within 3 seconds in typical conditions.\n- WHERE system load is elevated, THE civicDebateBoard SHALL continue to acknowledge user actions instantly and complete processing within published SLAs.\n\n## Traceability and References\n- Strategic and business model context: [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Stepwise business workflows and diagrams: [User Flows and Processes](./05-user-flows-and-processes.md).\n- Formal capabilities, validations, and rules: [Functional Requirements](./06-functional-requirements.md).\n\nEnd of document."},{"reason":"Describe end-to-end business workflows so developers can implement processes consistently.","filename":"05-user-flows-and-processes.md","documentType":"user-flow","outline":["Posting and Editing Content Flow","Commenting and Replying Flow","Voting and Reactions Flow","Reporting Content and Triage Flow","Moderation Review and Enforcement Flow","Appeals and Reinstatement Flow","Onboarding and Verification Flow","Notification Delivery Flow"],"audience":"development team","keyQuestions":["What are the step-by-step business flows for core actions?","How do reporting, moderation, and appeals progress from start to finish?","What are the key decision points and outcomes?"],"detailLevel":"detailed specification","relatedDocuments":["04-user-personas-and-scenarios.md","06-functional-requirements.md","07-content-moderation-and-safety-policies.md"],"constraints":["Include at least one Mermaid flow diagram per complex flow using strict syntax rules","Describe business logic only; avoid technical implementation details"],"content":"# User Flows and Processes — civicDebateBoard\n\nBusiness workflows for civicDebateBoard enable consistent behavior across all core processes in clear business terms (WHAT to do). Technical implementations (architecture, APIs, database design, UI) remain at the discretion of the development team.\n\nRelated context for deeper background:\n- See narrative personas and examples in the [User Personas and Scenarios](./04-user-personas-and-scenarios.md).\n- Full capability rules are captured in the [Functional Requirements Specification](./06-functional-requirements.md).\n- Policy definitions and enforcement guardrails are established in the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n\n## Conventions and Roles Context\n- Roles: member, verifiedMember, factChecker, moderator, admin.\n- Content types: post, comment, reply, reaction, vote, report, annotation (fact-check), sanction, appeal, notification.\n- Time and localization: Interpret deadlines and timestamps in the user’s configured timezone; maintain canonical timestamps per business rules in the [Functional Requirements Specification](./06-functional-requirements.md).\n- EARS syntax: Applicable requirements use EARS keywords (WHEN, WHILE, IF, THEN, WHERE, THE, SHALL) in English; all descriptions in en-US.\n\n## Global Preconditions and Shared Behaviors\n\n### Authentication, Authorization, and State Gates\n- THE platform SHALL require authentication for actions that modify state (posting, commenting, voting, reporting, annotating, moderating, appealing).\n- THE platform SHALL evaluate role-based permissions and account state (active, muted, suspended, banned) before any mutating action.\n- WHERE ownership is required, THE platform SHALL verify the actor is the content owner within allowed windows.\n- WHEN a rate limit applies, THE platform SHALL calculate remaining quota and the next reset time and SHALL enforce the limit consistently across flows.\n\n### Idempotency, Concurrency, and Conflict Handling\n- WHEN repeated identical user actions occur within a short window (e.g., double-submit), THE platform SHALL process them idempotently so that only one effect is applied.\n- WHEN a concurrent update would create a conflict (e.g., editing content that changed since fetch), THE platform SHALL deny the action with a conflict reason and SHALL preserve the user’s latest attempt as a new draft when applicable.\n\n### Visibility States and Evidence\n- THE platform SHALL treat visibility states as: public, limited (e.g., pending review), hidden (author and staff only), removed (tombstoned), and restored; transitions follow policy.\n- THE platform SHALL capture immutable evidence snapshots for policy-relevant transitions (e.g., removal, label application, sanction issuance).\n\n### Audit and Notifications\n- THE platform SHALL record an immutable audit entry for actions affecting safety, visibility, roles, or account state.\n- WHEN user-impacting outcomes occur (publish, reject, label, sanction, appeal decision), THE notification service SHALL send outcomes consistent with user preferences and mandatory policy notices.\n\n## Posting and Editing Content Flow\n\n### Business Description\nMembers publish civic discussion posts with titles, body text, tags, and topics. Certain content routes to pre-moderation based on trust signals and policy flags. Authors may edit their own posts subject to time-bound and policy constraints. Verified members may mark content as expert when permitted.\n\n### Preconditions\n- Authenticated as member or above.\n- Account in good standing (not muted or suspended).\n- Sufficient rate-limit budget.\n\n### Primary Flow (Posting)\n1. Author creates a draft with required fields.\n2. System validates inputs and checks rate limits.\n3. System evaluates pre-moderation requirement.\n4. If pre-moderation is required, route to review queue; otherwise publish.\n5. On publish, schedule notifications to followers/subscribers per preferences.\n\n### Editing Flow\n1. Author requests to edit own post.\n2. System validates edit window, sanctions, and lock status.\n3. Apply edit and record an immutable edit trail.\n4. If the edit materially changes policy-sensitive content, temporarily hide and queue for re-review.\n\n### Key Decisions\n- Pre-moderation requirement.\n- Edit window and re-review triggers.\n- Sanctions and rate-limit status.\n\n### Mermaid Flow Diagram (Posting + Editing)\n```mermaid\ngraph LR\n  A[\"Start(Author Authenticated)\"] --> B[\"Create Draft(Post)\"]\n  B --> C[\"Validate Input & Rate Limits\"]\n  C --> D{\"Valid & Within Limits?\"}\n  D -->|\"No\"| E[\"Reject with Errors\"]\n  D -->|\"Yes\"| F{\"Pre-Moderation Needed?\"}\n  F -->|\"Yes\"| G[\"Queue for Review\"]\n  F -->|\"No\"| H[\"Publish Immediately\"]\n  G --> I{\"Approved?\"}\n  I -->|\"Yes\"| H\n  I -->|\"No\"| J[\"Reject with Policy Reason\"]\n  H --> K[\"Notify Subscribers/Followers\"]\n  K --> L[\"End(Post Visible)\"]\n\n  %% Editing sub-flow\n  M[\"Author Requests Edit\"] --> N[\"Check Edit Window & Sanctions\"]\n  N --> O{\"Allowed?\"}\n  O -->|\"No\"| P[\"Deny Edit with Reason\"]\n  O -->|\"Yes\"| Q[\"Apply Edit & Record Trail\"]\n  Q --> R{\"Triggers Re-Review?\"}\n  R -->|\"Yes\"| S[\"Temporarily Hide & Queue\"]\n  R -->|\"No\"| T[\"Keep Visible\"]\n  S --> U{\"Approved?\"}\n  U -->|\"Yes\"| T\n  U -->|\"No\"| V[\"Revert/Reject Edit\"]\n```\n\n### EARS-Formatted Requirements\n- THE posting service SHALL require authentication as member or higher to create posts.\n- THE posting service SHALL validate required fields: title (non-empty, max length per policy), body (non-empty), and at least one tag/topic where required by policy.\n- WHERE the author is newly registered or under low-trust conditions, THE posting service SHALL route new posts to pre-moderation.\n- WHEN input validation fails, THE posting service SHALL return a structured error containing field-level reasons.\n- WHEN a post is published, THE notification service SHALL enqueue notifications to eligible subscribers within 1 minute.\n- WHILE the post is in review, THE content visibility service SHALL set visibility to non-public and visible to moderators and the author.\n- IF the review is rejected for policy reasons, THEN THE posting service SHALL notify the author with categorical reasons and next-step guidance.\n- WHERE the edit occurs within the allowed self-edit window (e.g., 24 hours) and no sanctions apply, THE posting service SHALL allow edits and record an edit trail accessible to moderators.\n- IF the edit materially changes sensitive content categories, THEN THE posting service SHALL temporarily hide the post and submit for re-review.\n- WHEN rate limits are exhausted, THE posting service SHALL deny the action with a reset time.\n- WHEN a verifiedMember marks a post as expert-tagged, THE posting service SHALL display an expert badge subject to verification policy.\n\n### Error Handling and Recovery\n- IF required fields are missing, THEN THE system SHALL provide explicit field names and constraints in the response message.\n- IF the user is muted or suspended, THEN THE system SHALL block posting and include sanction type and end time.\n- IF duplicate content is detected within a short window, THEN THE system SHALL reject with a duplicate warning.\n\n### Performance and Rate Limiting Expectations\n- WHEN a valid post is submitted without pre-moderation, THE system SHALL complete publication within 2 seconds under normal load.\n- WHEN posts enter pre-moderation, THE system SHALL place the item in the review queue within 1 second and confirm receipt to the author.\n- WHERE rate limits apply, THE system SHALL present remaining quota and next reset time in natural language.\n\n## Commenting and Replying Flow\n\n### Business Description\nUsers add comments to posts and replies to comments to facilitate threaded discussion. Comment visibility and edit rules mirror those of posts, but with shorter edit windows and stricter anti-spam controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Account not under comment-restrictive sanctions.\n- Target post or parent comment is visible and open for comments.\n\n### Mermaid Flow Diagram (Commenting)\n```mermaid\ngraph LR\n  A[\"Start(Authenticated)\"] --> B[\"Select Target(Post/Comment)\"]\n  B --> C[\"Validate Target Visibility & Open State\"]\n  C --> D{\"Allowed to Comment?\"}\n  D -->|\"No\"| E[\"Deny with Reason\"]\n  D -->|\"Yes\"| F[\"Create Draft(Comment)\"]\n  F --> G[\"Validate Content & Rate Limits\"]\n  G --> H{\"Valid?\"}\n  H -->|\"No\"| I[\"Reject with Errors\"]\n  H -->|\"Yes\"| J{\"Pre-Moderation Needed?\"}\n  J -->|\"Yes\"| K[\"Queue for Review\"]\n  J -->|\"No\"| L[\"Publish Comment\"]\n  K --> M{\"Approved?\"}\n  M -->|\"Yes\"| L\n  M -->|\"No\"| N[\"Reject with Policy Reason\"]\n  L --> O[\"Update Counts & Notify Participants\"]\n```\n\n### EARS-Formatted Requirements\n- THE commenting service SHALL allow only authenticated users in good standing to submit comments.\n- THE commenting service SHALL validate that the target is visible and open for comments before accepting content.\n- WHERE anti-spam heuristics trigger, THE commenting service SHALL require pre-moderation for the comment.\n- WHEN a comment is published, THE system SHALL notify the post author and recent participants subject to notification preferences.\n- WHERE an edit occurs within a 30-minute window and no replies exist, THE commenting service SHALL allow self-edit with edit trail.\n- IF the parent content is removed, THEN THE commenting service SHALL mark the comment’s visibility per policy (e.g., hidden with placeholder).\n\n### Error Handling and Performance\n- WHEN validation fails, THE system SHALL return field-specific messages within 2 seconds.\n- WHEN a user exceeds comment rate limits, THE system SHALL block the action and provide reset time.\n\n## Voting and Reactions Flow\n\n### Business Description\nUsers express sentiment through votes (e.g., up/down) and reactions (e.g., agree, insightful). Each user may cast at most one vote per item and may update or retract it. Tallying is transparent and subject to anti-abuse controls.\n\n### Preconditions\n- Authenticated as member or above.\n- Target content is visible and not locked.\n\n### Mermaid Flow Diagram (Voting)\n```mermaid\ngraph LR\n  A[\"Start(Authenticated)\"] --> B[\"Select Target Content\"]\n  B --> C[\"Check Visibility & Lock State\"]\n  C --> D{\"Eligible?\"}\n  D -->|\"No\"| E[\"Deny(Not Eligible)\"]\n  D -->|\"Yes\"| F[\"Check Existing Vote\"]\n  F --> G{\"Has Existing Vote?\"}\n  G -->|\"No\"| H[\"Apply New Vote\"]\n  G -->|\"Yes\"| I{\"Same Direction?\"}\n  I -->|\"Yes\"| J[\"Retract Vote\"]\n  I -->|\"No\"| K[\"Update Vote Direction\"]\n  H --> L[\"Update Tally\"]\n  J --> L\n  K --> L\n  L --> M[\"Acknowledge & Notify(Optional)\"]\n```\n\n### EARS-Formatted Requirements\n- THE voting service SHALL restrict each user to a single active vote per item at any time.\n- WHEN a user submits the same vote twice, THE voting service SHALL interpret it as a retraction and update the tally accordingly.\n- WHEN a user changes vote direction, THE voting service SHALL decrement the prior tally and increment the new tally atomically.\n- WHERE the target content is locked, THE voting service SHALL reject voting with a lock reason.\n- THE reactions service SHALL allow multiple reaction types per item but limit one per type per user.\n- IF a user is sanctioned from participatory actions, THEN THE voting and reactions services SHALL deny the attempt with sanction details.\n\n### Error Handling and Performance\n- WHEN a valid vote/reaction request succeeds, THE system SHALL acknowledge within 1 second under normal load.\n- IF the content reference is invalid, THEN THE system SHALL return a clear “not found or not visible” outcome without leaking private state.\n\n## Reporting Content and Triage Flow\n\n### Business Description\nUsers report content suspected of violating policy. Reports are categorized, prioritized, and routed to moderation queues. factChecker can attach annotations with sources and propose corrections. Moderators triage reports according to SLAs.\n\n### Preconditions\n- Reporter is authenticated (member or above) and not sanctioned from reporting.\n- Target content exists and is visible to the reporter at the time of reporting.\n\n### Mermaid Flow Diagram (Reporting & Triage)\n```mermaid\ngraph LR\n  A[\"Start(Reporter Authenticated)\"] --> B[\"Select Content & Category\"]\n  B --> C[\"Validate Inputs & Duplicate Report Check\"]\n  C --> D{\"Valid?\"]\n  D -->|\"No\"| E[\"Reject with Errors\"]\n  D -->|\"Yes\"| F[\"Create Report Record\"]\n  F --> G[\"Priority Scoring(Severity, Volume, Role)\"]\n  G --> H[\"Route to Queue(Policy/Topic)\"]\n  H --> I{\"Auto-Action Threshold Met?\"}\n  I -->|\"Yes\"| J[\"Apply Temporary Hide\"]\n  I -->|\"No\"| K[\"Await Moderator Review\"]\n  J --> K\n```\n\n### Fact-Check Annotation Sub-flow\n```mermaid\ngraph LR\n  A[\"Identify Claim in Content\"] --> B[\"Create Annotation(Claim Excerpt)\"]\n  B --> C[\"Attach Sources(URLs) & Rating\"]\n  C --> D{\"Complete & Within Limits?\"}\n  D -->|\"No\"| E[\"Reject with Field Errors\"]\n  D -->|\"Yes\"| F[\"Publish Annotation\"]\n  F --> G[\"Notify Moderators & Author\"]\n  G --> H{\"Label/Action Needed?\"}\n  H -->|\"Yes\"| I[\"Queue for Moderator Review\"]\n  H -->|\"No\"| J[\"Visible Without Enforcement\"]\n```\n\n### EARS-Formatted Requirements\n- THE reporting service SHALL require a category selection from the defined policy taxonomy for every report.\n- THE reporting service SHALL deduplicate substantially identical reports within a defined time window to prevent spam.\n- WHERE severity or report volume crosses thresholds, THE reporting service SHALL temporarily hide the content pending review.\n- WHEN a factChecker adds an annotation, THE system SHALL link the annotation to the reported content and make it available to moderators.\n- WHEN a report is submitted, THE system SHALL confirm receipt to the reporter within 2 seconds and provide a reference ID.\n- THE annotation workflow SHALL require at least one valid source URL, a rating, and an explanation to publish an annotation by a factChecker.\n- WHEN an annotation is published, THE system SHALL display an annotation badge and SHALL notify the content author and relevant subscribers.\n\n### Error Handling and SLAs\n- THE reporting service SHALL prevent reports on content the reporter cannot see.\n- THE moderation triage process SHALL surface high-priority items to moderators within 1 minute of report submission.\n\n## Moderation Review and Enforcement Flow\n\n### Business Description\nModerators review reported or queued content, assess against policy, and choose outcomes: approve, edit with transparency note, remove, warn, mute, suspend, or escalate to admin. All actions create audit logs and user notifications with clear reasons.\n\n### Preconditions\n- Moderator or admin authenticated with appropriate privileges.\n- Evidence (reports, prior history, annotations) accessible.\n\n### Mermaid Flow Diagram (Moderation)\n```mermaid\ngraph LR\n  A[\"Start(Moderator Assigned)\"] --> B[\"Open Case & Review Evidence\"]\n  B --> C{\"Policy Violation?\"}\n  C -->|\"No\"| D[\"Approve/Restore Content\"]\n  C -->|\"Yes\"| E{\"Severity Level\"]\n  E --> F[\"Edit with Transparency Note\"]\n  E --> G[\"Remove Content\"]\n  E --> H[\"Issue Warning\"]\n  E --> I[\"Apply Mute/Suspension\"]\n  E --> J[\"Escalate to Admin\"]\n  D --> K[\"Notify Reporter & Author\"]\n  F --> K\n  G --> K\n  H --> K\n  I --> K\n  J --> L[\"Admin Decision\"] --> K\n  K --> M[\"Close Case & Log Audit\"]\n```\n\n### EARS-Formatted Requirements\n- THE moderation service SHALL present consolidated evidence including reports, prior violations, and factChecker annotations.\n- WHEN no violation is found, THE moderation service SHALL approve or restore the content and notify involved parties.\n- WHERE a minor violation is identified, THE moderation service SHALL allow corrective edits with a transparency note.\n- WHERE policy prohibits the content, THE moderation service SHALL remove the content and preserve an evidence snapshot.\n- WHERE behavior warrants sanctions, THE moderation service SHALL apply warnings, mutes, or suspensions per configured policy tiers.\n- WHEN a case requires higher authority, THE moderation service SHALL support escalation to admin with case context.\n- THE moderation service SHALL create immutable audit logs for every action, including actor, timestamp, and rationale category.\n\n### Error Handling and SLAs\n- WHEN a moderation action is taken, THE system SHALL notify affected users within 1 minute with clear reason categories and appeal instructions.\n- WHERE automatic actions temporarily hid content, THE system SHALL reconcile visibility within 1 minute after final decision.\n\n## Appeals and Reinstatement Flow\n\n### Business Description\nUsers may appeal moderation actions within a defined window. Appeals are reviewed by a different moderator or an admin depending on severity and result in uphold, partial modification, or reversal.\n\n### Preconditions\n- Appellant authenticated and is the subject of the action or the content author.\n- Appeal within allowed time window and includes a reason.\n\n### Mermaid Flow Diagram (Appeals)\n```mermaid\ngraph LR\n  A[\"Start(User Files Appeal)\"] --> B[\"Validate Eligibility & Window\"]\n  B --> C{\"Eligible?\"}\n  C -->|\"No\"| D[\"Reject Appeal with Reason\"]\n  C -->|\"Yes\"| E[\"Create Appeal Case\"]\n  E --> F[\"Assign Reviewer(Independence Rule)\"]\n  F --> G[\"Review Evidence & Rationale\"]\n  G --> H{\"Outcome\"}\n  H --> I[\"Uphold\"]\n  H --> J[\"Modify(Partial)\"]\n  H --> K[\"Reverse\"]\n  I --> L[\"Notify Parties & Close\"]\n  J --> L\n  K --> L\n```\n\n### EARS-Formatted Requirements\n- THE appeals service SHALL require appellants to provide a reason tied to predefined categories.\n- THE appeals service SHALL enforce an independence rule such that the original moderator does not decide the appeal.\n- WHEN an appeal is filed, THE system SHALL acknowledge receipt within 2 seconds and provide a tracking ID.\n- WHEN an appeal decision is recorded, THE system SHALL notify all relevant parties and update content visibility and sanctions accordingly.\n- WHERE reversal occurs, THE appeals service SHALL restore content and remove or annotate sanctions as appropriate.\n\n### Error Handling and SLAs\n- IF the appeal is out of window or lacks required information, THEN THE system SHALL reject with guidance on eligibility and timing.\n- THE appeals queue SHALL present new appeals to eligible reviewers within 5 minutes of submission.\n\n## Onboarding and Verification Flow\n\n### Business Description\nVisitors register, verify email, and complete basic profile steps. Users may request elevation to verifiedMember by submitting identity or expertise evidence. Admins or designated verifiers adjudicate requests.\n\n### Preconditions\n- For registration: unauthenticated visitor.\n- For verification: authenticated user in good standing.\n\n### Mermaid Flow Diagram (Onboarding & Verification)\n```mermaid\ngraph LR\n  A[\"Start Registration\"] --> B[\"Provide Email & Password\"]\n  B --> C[\"Create Account(Pending Verification)\"]\n  C --> D[\"Send Verification Email\"]\n  D --> E{\"Email Verified?\"}\n  E -->|\"No\"| F[\"Limit Access(Grace Period)\"]\n  E -->|\"Yes\"| G[\"Activate Member Role\"]\n  G --> H[\"Optional: Complete Profile\"]\n  H --> I{\"Apply for Verification?\"]\n  I -->|\"No\"| J[\"End(Member)\"]\n  I -->|\"Yes\"| K[\"Submit Evidence & Rationale\"]\n  K --> L[\"Queue for Verifier Review\"]\n  L --> M{\"Approved?\"}\n  M -->|\"Yes\"| N[\"Elevate to verifiedMember\"]\n  M -->|\"No\"| O[\"Deny with Reason & Cooldown\"]\n```\n\n### EARS-Formatted Requirements\n- THE onboarding service SHALL require email verification before granting full member privileges.\n- WHILE the email is unverified within the grace period, THE onboarding service SHALL restrict posting and interaction capabilities per policy.\n- WHEN verification succeeds, THE onboarding service SHALL activate the member role and record the verification timestamp.\n- WHEN a user applies for verifiedMember, THE verification service SHALL require evidence and a rationale.\n- THE verification service SHALL maintain an auditable decision with reviewer identity and decision reason.\n- IF a verification request is denied, THEN THE verification service SHALL impose a cooldown period before re-application.\n\n### Error Handling and Performance\n- WHEN verification links are followed, THE system SHALL process activation within 2 seconds and provide clear status.\n- IF the verification link is expired or already used, THEN THE system SHALL present a safe re-issue path.\n\n## Notification Delivery Flow\n\n### Business Description\nNotifications inform users about relevant events (e.g., new comments, moderation outcomes, appeal updates). Users set preferences for delivery types (instant or digest) and categories. The system batches and rate limits notifications to prevent overload.\n\n### Preconditions\n- Trigger event occurs from another process.\n- Recipient has not muted the category and is eligible under policy.\n\n### Mermaid Flow Diagram (Notifications)\n```mermaid\ngraph LR\n  A[\"Event Triggered\"] --> B[\"Resolve Recipients & Preferences\"]\n  B --> C[\"Apply Eligibility & Mute Rules\"]\n  C --> D{\"Any Recipients?\"}\n  D -->|\"No\"| E[\"End(No Delivery)\"]\n  D -->|\"Yes\"| F{\"Delivery Mode\"}\n  F --> G[\"Instant Queue\"]\n  F --> H[\"Digest Queue\"]\n  G --> I[\"Send Notification\"]\n  H --> J[\"Aggregate & Schedule\"]\n  I --> K[\"Acknowledge\"]\n  J --> K\n```\n\n### EARS-Formatted Requirements\n- THE notification service SHALL respect per-user category preferences for instant or digest delivery modes.\n- WHERE recipients exceed batching thresholds, THE notification service SHALL aggregate events into a digest according to schedule rules.\n- WHEN a moderation or appeal decision occurs, THE notification service SHALL deliver outcome notifications within 1 minute.\n- IF a user has muted a category, THEN THE notification service SHALL suppress those notifications except for mandatory compliance notices.\n- THE notification service SHALL mark notifications as read/unread based on user interactions recorded by other flows.\n\n### Error Handling and Performance\n- WHEN an instant notification is enqueued, THE system SHALL attempt delivery within 1 minute under normal operating conditions.\n- IF a delivery attempt fails, THEN THE system SHALL retry based on a backoff schedule and record a delivery status for audit.\n\n## Cross-Role Considerations and Guardrails\n- WHERE a user’s account state changes (mute, suspension, reinstatement), THE system SHALL enforce the new state consistently across all flows without delay.\n- THE system SHALL ensure that factChecker annotations do not directly impose sanctions but are highly visible to moderators in related cases.\n- THE system SHALL ensure that admin can perform all moderator actions and manage role elevations and policy configurations.\n\n## Additional Global EARS Requirements\n- THE platform SHALL ensure idempotent processing for publish, edit, vote, react, report, annotate, and appeal submission actions within a 60-second window.\n- WHEN a content item transitions visibility state, THE platform SHALL update search/discovery eligibility within 60 seconds.\n- WHEN a thread is locked by a moderator, THE platform SHALL deny new comments and edits by non-staff immediately, with a lock reason.\n- IF a mention targets a user who has blocked the author, THEN THE platform SHALL prevent the mention and SHALL not notify the blocked user.\n- WHERE a sanction expires, THE platform SHALL restore previously restricted capabilities automatically without user action.\n- WHEN content is restored after appeal, THE platform SHALL notify the author and SHALL re-enable discovery within 60 seconds.\n\n## Performance Summary (User-Observable Targets)\n- Publish (no pre-mod): ≤ 2 s; Pre-mod queueing: ≤ 1 s; Notification enqueue: ≤ 1 min.\n- Comment publish: ≤ 2 s; Validation error response: ≤ 2 s.\n- Vote/Reaction acknowledgement: ≤ 1 s; Cross-session reflection: ≤ 2–5 s.\n- Report submission acknowledgement: ≤ 2 s; Triage surfacing (high-priority): ≤ 1 min.\n- Moderation decision propagation: ≤ 1 min to affected users; Visibility reconciliation: ≤ 1 min.\n- Appeal receipt acknowledgement: ≤ 2 s; Assignment to reviewer: ≤ 5 min; Decision notifications: immediate on decision.\n- Email verification processing: ≤ 2 s; Verification re-issue path available for expired/used links.\n- Notification delivery for instant events: ≤ 1 min; Digest aggregation per schedule.\n\nAll content is expressed as business requirements only; developers retain full autonomy over architecture, APIs, and database design, and are responsible for selecting fit-for-purpose technical solutions that satisfy these requirements.\n"},{"reason":"Define all functional capabilities, rules, and validations for the discussion board in unambiguous terms.","filename":"06-functional-requirements.md","documentType":"requirement","outline":["Content Model and Relationships (conceptual, non-technical)","Threading and Discussion Rules","Tagging, Topics, and Categories","Search and Discovery (filters, sorting)","Notifications and Subscriptions","Bookmarks and Follows","Localization and Timezone Handling (business perspective)","Accessibility and Inclusivity Expectations","Acceptance Criteria (EARS for all applicable requirements)"],"audience":"development team","keyQuestions":["What can users do and under what business rules?","What validations and constraints apply to actions?","How should content be organized and discovered?"],"detailLevel":"detailed specification","relatedDocuments":["05-user-flows-and-processes.md","07-content-moderation-and-safety-policies.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS format extensively","Specify measurable, testable business requirements","Avoid technical specifications (no APIs, schemas, or code)"],"content":"# Functional Requirements for civicDebateBoard\n\nBusiness-functional rules define WHAT civicDebateBoard must do for users without prescribing technical implementations. All enforceable requirements use EARS to ensure clarity and testability. Developers have full autonomy over architecture, APIs, and data models; the statements below express business behavior only.\n\n## 1) Introduction and Scope\n- Purpose: Provide unambiguous, testable rules governing content creation, discussion, organization, discovery, subscriptions, notifications, personalization, localization, accessibility, and cross-cutting policies.\n- In Scope: Posts, comments/replies, threads, reactions/votes, fact-check annotations, tags/topics/categories, search and discovery, notifications and subscriptions, bookmarks and follows, localization/timezone, accessibility and inclusivity, content states and visibility, error handling, rate limits, ownership and accountability.\n- Out of Scope: Technical mechanisms (APIs, DB schemas, infra), UI layout/visual design, low-level implementation details.\n- Roles: member, verifiedMember, factChecker, moderator, admin.\n\n## 2) Content Model and Relationships (conceptual, non-technical)\nConceptual entities and relationships (business meaning):\n- Post: Root item of a discussion with title, body, optional attachments/links, tags, topics, exactly one category.\n- Comment: Reply to a Post or another Comment with exactly one parent; forms hierarchical chains with a defined maximum depth.\n- Thread: A Post and all its descendant Comments.\n- Reaction/Vote: Per-user expression on an item; one per user per item per reaction type.\n- Fact-Check Annotation: Structured note by factChecker attached to a specific Post or Comment with citations.\n- Report: User-initiated flag for policy or quality issues.\n- Topic: Thematic grouping that users can follow.\n- Tag: Keyword label; may be controlled (curated) or free-form (normalized).\n- Category: Curated taxonomy node; each Post selects exactly one active Category.\n- Subscription: User preference to receive updates about authors, threads, topics, or category digests.\n- Bookmark: User’s saved reference to content.\n\nConceptual relationship overview:\n```mermaid\ngraph LR\n  U[\"User\"] --> P[\"Post\"]\n  P --> C[\"Comment\"]\n  C --> C2[\"Comment(Reply)\"]\n  P --> R1[\"Reaction/Vote\"]\n  C --> R2[\"Reaction/Vote\"]\n  P --> FC1[\"Fact-Check Annotation\"]\n  C --> FC2[\"Fact-Check Annotation\"]\n  P --> REP1[\"Report\"]\n  C --> REP2[\"Report\"]\n  P --> TG[\"Tag\"]\n  P --> TP[\"Topic\"]\n  P --> CAT[\"Category\"]\n  U --> SUB[\"Subscription\"]\n  U --> BM[\"Bookmark\"]\n```\n\nEARS requirements (core):\n- THE civicDebateBoard SHALL treat a Post as the root item of a thread with a title and body.\n- THE civicDebateBoard SHALL treat a Comment as a reply to a Post or another Comment with exactly one parent.\n- THE civicDebateBoard SHALL allow one Reaction/Vote per user per item per reaction type and allow removal at any time.\n- THE civicDebateBoard SHALL associate zero or more Tags and zero or more Topics to a Post.\n- THE civicDebateBoard SHALL require exactly one Category for each Post selected from the active taxonomy.\n- THE civicDebateBoard SHALL allow factChecker to attach Fact-Check Annotations to Posts and Comments.\n- THE civicDebateBoard SHALL allow any authenticated user to create a Report on Posts and Comments within rate limits.\n- THE civicDebateBoard SHALL allow any authenticated user to create Bookmarks on Posts and Comments.\n\n## 3) Threading and Discussion Rules\n### 3.1 Participation and Permissions\n- WHERE role is \"member\" or \"verifiedMember\", THE civicDebateBoard SHALL permit creating Posts and Comments subject to policy and rate limits.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL permit creating Posts and Comments and SHALL permit adding Fact-Check Annotations.\n- WHERE role is \"moderator\" or \"admin\", THE civicDebateBoard SHALL permit all posting/commenting and SHALL permit enforcement actions per policy.\n- IF user is unauthenticated, THEN THE civicDebateBoard SHALL deny creating Posts or Comments and SHALL present an appropriate error.\n- WHERE account is muted or suspended, THE civicDebateBoard SHALL deny posting/commenting and SHALL show remaining sanction duration.\n\n### 3.2 Validation Rules for Posts\n- THE civicDebateBoard SHALL require Post titles with length 10–150 characters.\n- THE civicDebateBoard SHALL require Post bodies with length 20–50,000 characters.\n- WHERE Post includes attachments, THE civicDebateBoard SHALL allow up to 5 attachments per Post with cumulative size up to 25 MB.\n- WHERE Post includes external links, THE civicDebateBoard SHALL require each link to use http or https and include a resolvable hostname.\n- WHERE role is \"verifiedMember\" and the post is marked as expert-tagged, THE civicDebateBoard SHALL require a topic area selection and an expertise declaration note up to 500 characters.\n- WHERE content warnings are used, THE civicDebateBoard SHALL allow authors to select one or more warning categories (e.g., graphic, sensitive, adult) and SHALL gate visibility accordingly.\n\n### 3.3 Validation Rules for Comments\n- THE civicDebateBoard SHALL require Comment bodies with length 1–20,000 characters.\n- THE civicDebateBoard SHALL allow up to 3 attachments per Comment with cumulative size up to 10 MB.\n- THE civicDebateBoard SHALL allow a maximum reply depth of 5 levels including the root Post.\n\n### 3.4 Mentions and Handle Rules\n- THE civicDebateBoard SHALL allow mentions using a handle format 3–30 characters, alphanumeric plus underscores and hyphens, starting with a letter.\n- IF a mentioned user has blocked the author, THEN THE civicDebateBoard SHALL prevent the mention and SHALL inform the author without notifying the blocked user.\n- IF a handle does not match the allowed format, THEN THE civicDebateBoard SHALL reject the content with a field-specific message.\n\n### 3.5 Edits, Deletions, and Locking\n- WHEN a user edits their own Post, THE civicDebateBoard SHALL allow edits for 24 hours from creation unless the Post is locked or sanctioned.\n- WHEN a user edits their own Comment, THE civicDebateBoard SHALL allow edits for 60 minutes from creation unless the thread is locked or sanctioned.\n- WHEN content is edited, THE civicDebateBoard SHALL preserve prior versions for audit visibility to moderators and admins.\n- IF a thread is locked by a moderator, THEN THE civicDebateBoard SHALL prohibit new Comments and further edits by non-moderators.\n- IF a Post is deleted by its author within 24 hours and has no Comments, THEN THE civicDebateBoard SHALL remove it from public discovery and SHALL retain a soft-deleted record for 30 days for audit.\n- IF a Comment is deleted by its author within 60 minutes, THEN THE civicDebateBoard SHALL replace it with a tombstone indicating deletion by author.\n- WHERE content is removed by policy, THE civicDebateBoard SHALL show a standardized placeholder indicating removal reason to users permitted to see the placeholder.\n\n### 3.6 Reactions and Voting\n- THE civicDebateBoard SHALL support one upvote per user per item and allow removal (toggle behavior on duplicate).\n- WHERE reaction types include \"upvote\" and \"respectful\" reactions, THE civicDebateBoard SHALL limit to one per user per item per type.\n- IF a user attempts to react to their own content, THEN THE civicDebateBoard SHALL deny the action with an explanatory message.\n\n### 3.7 Fact-Check Annotations\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL allow an annotation with: claim excerpt (1–1,000), rating (e.g., accurate, needs context, misleading, false), at least one source (valid http/https URL), and explanation (1–2,000).\n- WHEN an annotation is published, THE civicDebateBoard SHALL display an annotation badge and a link to the note within 1 minute.\n- IF an annotation is flagged for policy issues, THEN THE civicDebateBoard SHALL queue it for moderator review and SHALL withhold visibility until resolved for enforcement-affecting labels.\n\n### 3.8 Content States and Visibility\nStates (business-level): Draft, Published, Pending Review, Locked, Soft-Deleted, Removed by Policy, Under Moderation Hold.\n- THE civicDebateBoard SHALL maintain a state for each content item among the defined states.\n- WHEN content is Pending Review or Under Moderation Hold, THE civicDebateBoard SHALL restrict visibility to the author, moderators, and admins.\n- WHEN content is Locked, THE civicDebateBoard SHALL allow reads and SHALL deny new comments/edits by non-moderators.\n- WHEN content is Soft-Deleted by the author, THE civicDebateBoard SHALL remove it from public discovery and SHALL allow moderators to view for 30 days.\n- WHEN content is Removed by Policy, THE civicDebateBoard SHALL keep an audit reference accessible to moderators and admins and SHALL present a removal placeholder to eligible viewers.\n\n## 4) Tagging, Topics, and Categories\n### 4.1 Tags\n- THE civicDebateBoard SHALL allow 0–10 tags per Post, each 1–30 characters, alphanumeric plus hyphens.\n- WHERE tags are controlled, THE civicDebateBoard SHALL restrict selection to approved tags; WHERE tags are free-form, THE civicDebateBoard SHALL normalize case and trim whitespace.\n- IF any tag violates length or character rules, THEN THE civicDebateBoard SHALL reject the submission with tag-specific messages.\n\n### 4.2 Topics\n- THE civicDebateBoard SHALL allow Post authors to associate 0–5 Topics with each Post.\n- THE civicDebateBoard SHALL allow users to follow Topics to receive notifications and discovery prioritization.\n- IF a Topic is deprecated by admins, THEN THE civicDebateBoard SHALL prevent new associations and SHALL preserve existing associations on historical content.\n\n### 4.3 Categories\n- THE civicDebateBoard SHALL require exactly one Category per Post chosen from the active taxonomy.\n- WHERE a Category is changed by a moderator for policy reasons, THE civicDebateBoard SHALL update the Post categorization and SHALL record a moderation note.\n\n## 5) Search and Discovery (filters, sorting)\n### 5.1 Search Inputs and Validation\n- THE civicDebateBoard SHALL accept keyword queries 1–100 characters and SHALL ignore stopwords.\n- THE civicDebateBoard SHALL support filtering by Category, Topic, Tag, author, role (author type), time range, and content type (Post or Comment).\n- THE civicDebateBoard SHALL support exclusion filters for Tags and Topics.\n- WHERE illegal or dangerous query patterns are detected (e.g., CSAM indicators), THE civicDebateBoard SHALL deny search and SHALL log a safety event.\n\n### 5.2 Sorting Rules and Tie-Breakers\n- THE civicDebateBoard SHALL support sorting by newest, oldest, most upvoted (24h, 7d, 30d, all-time), most commented (24h, 7d, 30d, all-time), and relevance for keyword queries.\n- WHERE no sort is specified, THE civicDebateBoard SHALL default to newest for non-search results and relevance for search results.\n- WHERE multiple items tie on a primary sort key, THE civicDebateBoard SHALL break ties using recency (newer first) and THEN by stable identifier.\n\n### 5.3 Pagination and Limits\n- THE civicDebateBoard SHALL return results in pages of 20 items by default with options of 10, 20, or 50 per page.\n- THE civicDebateBoard SHALL cap total retrievable pages at 100 per query to ensure fair use.\n- THE civicDebateBoard SHALL prevent requesting negative pages, zero page size, or sizes exceeding 50.\n\n### 5.4 Safety and Quality in Discovery\n- IF a Post is under active moderation hold, THEN THE civicDebateBoard SHALL exclude it from public discovery until resolved.\n- WHERE fact-check annotations exist, THE civicDebateBoard SHALL surface an annotation indicator in listings and SHALL allow filtering by annotation rating.\n- WHERE content warnings are present, THE civicDebateBoard SHALL display warning indicators in discovery and SHALL respect user preferences for gating.\n\nSearch flow (business-level):\n```mermaid\ngraph LR\n  Q[\"Receive Query(Keyword/Filters)\"] --> V[\"Validate Inputs\"]\n  V --> D{\"Valid?\"}\n  D -->|\"No\"| E[\"Reject with Messages\"]\n  D -->|\"Yes\"| F[\"Apply Safety Exclusions\"]\n  F --> S[\"Apply Sort & Pagination\"]\n  S --> R[\"Return Results Page\"]\n```\n\n## 6) Notifications and Subscriptions\n### 6.1 Subscription Types and Preferences\n- THE civicDebateBoard SHALL allow users to subscribe to author updates, thread updates, Topic updates, and Category digests.\n- THE civicDebateBoard SHALL allow users to configure instant vs digest delivery and to mute categories (except mandatory compliance notices).\n- WHERE quiet hours are set, THE civicDebateBoard SHALL defer non-urgent notifications to outside the quiet window.\n\n### 6.2 Triggering Events and Latency Expectations\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL notify subscribers within 1 minute.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify the mentioned user within 1 minute.\n- WHEN a factChecker publishes an annotation on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n- WHERE Category digests are enabled, THE civicDebateBoard SHALL send a daily summary including top items by votes and comments.\n\n### 6.3 Frequency, Bundling, and Opt-Outs\n- THE civicDebateBoard SHALL bundle notifications for the same thread within a 10-minute window.\n- IF a user disables notifications for a specific thread, THEN THE civicDebateBoard SHALL cease further notifications for that thread until re-enabled.\n- THE civicDebateBoard SHALL provide per-category opt-out that takes effect within 1 minute of change.\n\nNotification flow (business-level):\n```mermaid\ngraph LR\n  E[\"Event Occurs(Reply/Mention/Annotation)\"] --> RCV[\"Resolve Recipients & Preferences\"]\n  RCV --> FIL[\"Apply Mutes & Quiet Hours\"]\n  FIL --> BND{\"Bundle Window?\"}\n  BND -->|\"Yes\"| AGG[\"Aggregate into Bundle\"]\n  BND -->|\"No\"| QN[\"Queue Instant Delivery\"]\n  AGG --> SND[\"Schedule Send\"]\n  QN --> SND\n  SND --> ACK[\"Mark Delivered/Failed\"]\n```\n\n## 7) Bookmarks and Follows\n- THE civicDebateBoard SHALL allow users to bookmark Posts and Comments for later reference.\n- THE civicDebateBoard SHALL allow users to follow authors and Topics to personalize discovery and notifications.\n- IF a user unfollows an author or Topic, THEN THE civicDebateBoard SHALL immediately stop related notifications and SHALL de-prioritize content from those sources in personalized lists.\n- WHERE limits are required for system health, THE civicDebateBoard SHALL cap bookmarks at 2,000 per user and follows at 1,000 authors and 1,000 topics per user.\n- IF a user attempts to exceed bookmark or follow limits, THEN THE civicDebateBoard SHALL deny the action and SHALL present the applicable limit.\n\n## 8) Localization and Timezone Handling (business perspective)\n- THE civicDebateBoard SHALL store and present timestamps relative to the user’s preferred timezone while preserving canonical audit time.\n- WHERE a preferred timezone is not set, THE civicDebateBoard SHALL default to a reasonable timezone based on locale or device signals.\n- WHERE scheduled publication is used, THE civicDebateBoard SHALL interpret schedule times in the author’s selected timezone and SHALL display both local and canonical times in metadata.\n- THE civicDebateBoard SHALL allow language preferences for interface text and filters while preserving original content language for authored items.\n\n## 9) Accessibility and Inclusivity Expectations\n- THE civicDebateBoard SHALL require alt text for image attachments with length 5–500 characters.\n- THE civicDebateBoard SHALL support content warnings for sensitive topics and SHALL allow users to proceed or skip as per preferences.\n- WHERE audio or video attachments are allowed, THE civicDebateBoard SHALL require caption files or transcripts to be provided by the uploader before public discovery.\n- THE civicDebateBoard SHALL support respectful discourse by disallowing harassment and hate content per policy and by enabling reporting and moderation flows.\n\n## 10) Cross-Cutting Business Rules\n### 10.1 Rate Limiting and Fairness\n- WHERE role is \"member\", THE civicDebateBoard SHALL limit to 10 Posts per 24 hours and 100 Comments per 24 hours.\n- WHERE role is \"verifiedMember\", THE civicDebateBoard SHALL limit to 20 Posts per 24 hours and 200 Comments per 24 hours.\n- WHERE role is \"factChecker\", THE civicDebateBoard SHALL limit annotations to 100 per 24 hours and otherwise follow verifiedMember limits.\n- THE civicDebateBoard SHALL limit reactions to 500 per 24 hours per user and reports to 50 per 24 hours per user.\n- IF a rate limit is exceeded, THEN THE civicDebateBoard SHALL deny the action with a message indicating the limit and reset time.\n\n### 10.2 Attachments and Links\n- THE civicDebateBoard SHALL allow attachment types permitted by policy (e.g., images, documents) and SHALL disallow executable formats.\n- IF an attachment or link is detected as malicious or policy-violating, THEN THE civicDebateBoard SHALL block it and SHALL record a safety event.\n- WHERE images are uploaded, THE civicDebateBoard SHALL require reasonable dimension limits (e.g., up to 10,000×10,000 pixels) and SHALL enforce total size limits per item.\n\n### 10.3 Mentions, Blocks, and Mutes\n- THE civicDebateBoard SHALL allow users to block others which prevents mentions and direct notifications.\n- IF a blocked user attempts to interact (mention, follow) with the blocker’s content, THEN THE civicDebateBoard SHALL deny the action and SHALL avoid notifying the blocker.\n- THE civicDebateBoard SHALL allow users to mute topics or authors to reduce visibility and notifications from those sources.\n\n### 10.4 Ownership and Accountability\n- THE civicDebateBoard SHALL attribute all content to a single author account and SHALL record role attributes at time of posting for accountability.\n- WHERE a user changes role (e.g., becomes verifiedMember), THE civicDebateBoard SHALL not retroactively alter role labels on existing content.\n\n## 11) Role-Based Capabilities Summary (business perspective)\n\n| Action | member | verifiedMember | factChecker | moderator | admin |\n|--------|--------|----------------|------------|-----------|-------|\n| Create Post | ✅ | ✅ (can mark expert) | ✅ | ✅ | ✅ |\n| Create Comment | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Post (24h) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Comment (60m) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| React/Vote | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Fact-Check Annotation | ❌ | ❌ | ✅ | ✅ (review/approve) | ✅ |\n| Lock/Unlock Thread | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Change Category | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Remove Violating Content | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Issue Sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n\nNotes: Moderators and admins inherit content capabilities and add enforcement controls per policies.\n\n## 12) Acceptance Criteria (EARS for all applicable requirements)\nConsolidated, testable criteria complement the rules above.\n\n### 12.1 Posting and Commenting\n- WHEN a Post with title length 10–150 and body length 20–50,000 is submitted by a permitted role, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Post title is outside 10–150 characters, THEN THE civicDebateBoard SHALL reject the Post with a title-length message.\n- IF a Post body is outside 20–50,000 characters, THEN THE civicDebateBoard SHALL reject the Post with a body-length message.\n- WHEN a Comment with body length 1–20,000 at a depth ≤ 5 is submitted, THE civicDebateBoard SHALL accept and publish it within 2 seconds.\n- IF a Comment would exceed depth 5, THEN THE civicDebateBoard SHALL reject it with a depth-limit message.\n- IF the author is muted or suspended, THEN THE civicDebateBoard SHALL deny posting and SHALL present remaining sanction duration.\n\n### 12.2 Edits, Deletions, and States\n- WHEN an author edits a Post within 24 hours and the thread is not locked, THE civicDebateBoard SHALL save the new version and SHALL maintain immutable history for moderators.\n- IF a user attempts to edit a Post after 24 hours, THEN THE civicDebateBoard SHALL deny the edit and SHALL indicate the elapsed window.\n- WHEN an author deletes a Post within 24 hours that has no Comments, THE civicDebateBoard SHALL remove it from discovery and SHALL retain a soft-deleted record for 30 days.\n- WHEN an author deletes a Comment within 60 minutes, THE civicDebateBoard SHALL replace it with a tombstone label.\n- WHEN content is placed Under Moderation Hold, THE civicDebateBoard SHALL hide it from public discovery and SHALL show status to the author.\n\n### 12.3 Reactions and Voting\n- WHEN a user upvotes an item they did not author and has not previously upvoted, THE civicDebateBoard SHALL record the upvote and SHALL increase the count immediately.\n- WHEN a user repeats an upvote on the same item, THE civicDebateBoard SHALL remove their upvote (toggle behavior).\n- IF a user attempts to upvote their own content, THEN THE civicDebateBoard SHALL deny the action with an explanatory message.\n\n### 12.4 Mentions and Blocks\n- WHEN a handle matches the allowed format, THE civicDebateBoard SHALL resolve the mention and SHALL notify the mentioned user unless they have blocked the author.\n- IF a handle fails format validation, THEN THE civicDebateBoard SHALL reject the submission with a handle-format message.\n- IF a mentioned user has blocked the author, THEN THE civicDebateBoard SHALL prevent the mention and SHALL inform the author.\n\n### 12.5 Fact-Check Annotations\n- WHEN a factChecker submits an annotation with required fields and at least one valid URL, THE civicDebateBoard SHALL publish the annotation and SHALL display a badge within 1 minute.\n- IF required fields are missing or URLs are invalid, THEN THE civicDebateBoard SHALL reject the annotation with field-specific messages.\n\n### 12.6 Tags, Topics, Categories\n- WHEN a Post includes 0–10 valid tags, THE civicDebateBoard SHALL accept and store them; IF any tag violates rules, THEN THE civicDebateBoard SHALL reject the Post with tag-specific messages.\n- WHEN a Post includes a Category from the active taxonomy, THE civicDebateBoard SHALL accept it; IF missing or invalid, THEN THE civicDebateBoard SHALL reject the submission.\n- WHEN a deprecated Topic is selected, THE civicDebateBoard SHALL prevent association and SHALL report the deprecation to the author.\n\n### 12.7 Search and Discovery\n- WHEN a keyword query 1–100 characters is submitted, THE civicDebateBoard SHALL return results sorted by relevance unless another sort is chosen, with default page size 20.\n- WHERE filters (Category, Topic, Tag, author, role, time range, content type) are applied, THE civicDebateBoard SHALL restrict results accordingly.\n- IF a content item is Under Moderation Hold, THEN THE civicDebateBoard SHALL exclude it from public discovery results.\n- IF a query matches illegal or dangerous patterns, THEN THE civicDebateBoard SHALL deny the search and SHALL log a safety event.\n\n### 12.8 Notifications and Subscriptions\n- WHEN a subscribed thread receives a new Comment, THE civicDebateBoard SHALL deliver a notification within 1 minute and SHALL bundle events within 10 minutes.\n- WHEN a user is mentioned, THE civicDebateBoard SHALL notify within 1 minute unless the mentioned user has blocked the author or muted the category.\n- WHEN a fact-check is published on a Post, THE civicDebateBoard SHALL notify the Post author and thread subscribers within 5 minutes.\n- WHEN a user sets quiet hours, THE civicDebateBoard SHALL defer non-urgent notifications until quiet hours end.\n\n### 12.9 Bookmarks and Follows\n- WHEN a user bookmarks content and is under the 2,000-bookmark cap, THE civicDebateBoard SHALL record it and SHALL make it retrievable in saved items.\n- WHEN a user follows an author/topic and is under cap, THE civicDebateBoard SHALL include related content in personalized discovery and SHALL generate notifications per settings.\n- IF a user exceeds bookmark or follow caps, THEN THE civicDebateBoard SHALL deny the action and SHALL present the applicable cap.\n- IF a user unfollows, THEN THE civicDebateBoard SHALL cease related notifications immediately and SHALL de-prioritize related content in personalized lists.\n\n### 12.10 Localization and Timezones\n- WHEN a user sets a preferred timezone, THE civicDebateBoard SHALL display timestamps in that timezone and SHALL retain canonical timestamps for audit.\n- WHEN a Post is scheduled for publication at a local time, THE civicDebateBoard SHALL publish according to the author’s timezone and SHALL display local and canonical times.\n\n### 12.11 Accessibility and Inclusivity\n- WHEN an image is uploaded, THE civicDebateBoard SHALL require alt text 5–500 characters.\n- WHERE sensitive content warnings are set, THE civicDebateBoard SHALL gate content behind a warning until the user opts to proceed.\n- WHEN audio/video is uploaded, THE civicDebateBoard SHALL require captions or transcripts before public discovery.\n\n### 12.12 Rate Limits and Abuse Prevention\n- WHEN a user reaches a rate limit for Posts, Comments, reactions, or reports, THE civicDebateBoard SHALL return a clear error including remaining cooldown time.\n- IF repeated violation attempts occur after rate-limit errors, THEN THE civicDebateBoard SHALL extend cooldown and SHALL log a potential abuse event for moderation review.\n\n## 13) Error Handling and Recovery — User-Facing Expectations\n- WHEN validation fails, THE civicDebateBoard SHALL present field-specific reasons and SHALL preserve unsaved user input for resubmission.\n- WHEN a referenced target is not visible (e.g., parent removed), THE civicDebateBoard SHALL return a non-disclosing not-available message.\n- WHEN background processing delays discovery (e.g., indexing), THE civicDebateBoard SHALL present the item in direct thread views while it propagates to search.\n\n## 14) References to Related Documents\n- For end-to-end workflows, see the [User Flows and Processes](./05-user-flows-and-processes.md).\n- For content safety, sanctions, and enforcement specifics, see the [Content Moderation and Safety Policies](./07-content-moderation-and-safety-policies.md).\n- For performance, availability, and operability targets, see the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n"},{"reason":"Establish policy definitions and enforcement processes to protect community safety and discourse quality.","filename":"07-content-moderation-and-safety-policies.md","documentType":"requirement","outline":["Policy Principles and Scope","Prohibited and Restricted Content Categories","Civic Discourse Safeguards (election integrity, misinformation handling)","Report Intake and Prioritization","Review SLAs and Escalation Paths","Sanctions (warnings, mutes, suspensions) and Transparency","Evidence Handling and Audit Trails","Appeals and Restorative Processes","EARS-Formatted Enforcement Requirements"],"audience":"development team","keyQuestions":["What content is allowed, restricted, or prohibited?","How are reports prioritized and reviewed?","What sanctions and transparency obligations exist?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","05-user-flows-and-processes.md","09-security-privacy-and-compliance.md"],"constraints":["Define measurable SLAs and sanctions in business terms","Use EARS for enforceable requirements","Avoid technical details; focus on policy and process"],"content":"# Content Moderation and Safety Policies for civicDebateBoard\n\n## Policy Principles and Scope\n\n### Guiding Principles\n- Safety First: Protect users from harm, harassment, exploitation, and illegal activity.\n- Civility and Civic Value: Promote constructive, well-sourced debate and discourage manipulation.\n- Fairness and Consistency: Apply policies uniformly with documented rationales.\n- Transparency and Accountability: Provide clear reasons for actions and maintain auditability.\n- Due Process: Offer notice, the ability to appeal, and restorative options where appropriate.\n- Proportionality: Match enforcement severity to violation severity and user history.\n- Context Sensitivity: Consider intent, context, public-interest value, educational or newsworthiness exceptions.\n- Legal Compliance: Respect applicable laws and regulatory obligations across jurisdictions.\n\n### Scope of Application\n- Applies to all user-generated content (UGC): posts, comments, profile fields, attachments, links, tags, reactions, and account metadata disclosures.\n- Applies to all roles: member, verifiedMember, factChecker, moderator, admin.\n- Covers policy enforcement, user reporting, labeling and annotations, sanctions, transparency notices, appeals, audit trails, and emergency escalations.\n- Includes both proactive enforcement (e.g., automated pre-flagging) and reactive enforcement (e.g., user and partner reports).\n\n### Moderator Conduct and Recusal\n- Conflict of Interest: Moderators must recuse themselves from cases where impartiality may be compromised (e.g., personal relationships, prior disputes, organizational affiliations).\n- Professional Conduct: Decisions must reference policy categories, document rationales, and avoid personal or ideological commentary.\n- Independence of Appeals: Appeals must be reviewed by a different moderator or an admin for permanent bans.\n\n## Prohibited and Restricted Content Categories\n\nRestricted content requires labels, contextualization, age-gating, or limited distribution. Prohibited content requires removal and potential account sanctions. Context exceptions may apply for news reporting, educational materials, or public-interest documentation where clearly labeled and accompanied by context.\n\n| Category | Definition (business-level) | Status | Notes and Handling |\n|---------|------------------------------|--------|--------------------|\n| Illegal Content | Content that violates applicable laws (e.g., CSAM, explicit criminal facilitation) | Prohibited | Immediate removal and admin escalation; emergency escalation for child safety |\n| Child Exploitation | Any sexualization of minors, grooming, endangerment | Prohibited | Immediate removal; immediate emergency workflow activation and evidence preservation |\n| Terrorism and Extremism | Praise/support of designated extremist orgs or operational content | Prohibited | Removal; account sanctions; preserve evidence; consider law-enforcement referral |\n| Hate Speech | Direct attacks on protected classes (race, religion, gender identity, etc.) | Prohibited | Removal; strikes and sanctions calibrated by severity and context |\n| Harassment & Threats | Targeted harassment, credible threats, stalking, doxxing | Prohibited | Removal; urgent threat assessment and escalations |\n| Graphic Violence | Gratuitous gore or celebration of violence | Prohibited | Removal; limited exceptions for news or human-rights documentation with labels |\n| Non-Consensual Intimate Imagery | Sexual/explicit imagery shared without consent | Prohibited | Removal; immediate account suspension pending review |\n| Privacy Violations (Doxxing) | Publishing private identifying information without consent | Prohibited | Removal; evaluate imminent harm; rapid action |\n| Self-Harm and Suicide Promotion | Encouraging self-harm or suicide | Prohibited | Removal; provide crisis resources; supportive discussion allowed with guardrails |\n| Misinformation with Imminent Harm | False claims likely to cause real-world harm (health, safety, civic process) | Restricted/Prohibited | Label/reduce distribution or remove depending on harm/risk assessment |\n| Election Integrity Violations | Coordinated voter suppression, false voting logistics | Prohibited | Removal; high-priority escalation during election windows |\n| Medical Misinformation | Provably false medical claims contradicting leading public health bodies | Restricted | Label and reduce distribution; removal if imminently harmful |\n| Spam and Scams | Mass unsolicited content, phishing, financial scams | Prohibited | Removal; apply automated cool-down and strikes |\n| Platform Manipulation | Coordinated inauthentic behavior, astroturfing, vote brigading | Prohibited | Removal; deamplify; investigate related accounts |\n| Impersonation and Deceptive Identity | Misrepresenting identity or affiliation, deepfake impersonations | Restricted/Prohibited | Label or remove; require disclosure; sanction repeat abuse |\n| Copyright and Plagiarism | Unauthorized reproduction of copyrighted material | Restricted/Prohibited | Remove upon valid notice; repeat infringement may trigger suspension |\n| Adult Sexual Content | Explicit adult content | Restricted | Age-gate, label, and limit distribution; follow jurisdictional rules |\n| Sensitive Media | Disturbing but newsworthy content (e.g., war reporting) | Restricted | Allow with strong labels and click-through warnings |\n| Profanity and Rude Behavior | Non-targeted profanity | Allowed/Restricted | Allowed unless targeted; repeated abuse may trigger actions |\n| Off-Topic/Low-Quality | Content misaligned with civicDebateBoard’s civic discourse goals | Restricted | Downrank or move; removal after repeated abuse |\n| Synthetic/Manipulated Media | Materially deceptive edits without disclosure | Restricted/Prohibited | Require disclosure labels; remove where it causes imminent harm |\n\n### Category-Specific Handling Examples (Business)\n- Non-consensual intimate imagery: Fast-track to P0 with immediate content removal and temporary account disable pending review.\n- Election-related false logistics (e.g., wrong voting date): P0 during election windows; remove and apply strikes; add corrective banner when appropriate.\n- Newsworthy graphic content (e.g., war crimes documentation): Allow with strong interstitial labels and age-gating; limit distribution.\n\n## Civic Discourse Safeguards (Election Integrity and Misinformation Handling)\n\n### Core Safeguards\n- Election Windows: Elevated protections start 90 days before and end 14 days after scheduled elections relevant to the user’s locale.\n- Claim Typology: Distinguish factual claims from opinion/analysis; apply annotations only on factual claims.\n- Source Citation: Encourage references to credible sources for significant civic claims and expert-tagged posts.\n- Distribution Controls: Reduce distribution of labeled misinformation, prevent trending and recommendations, and consider comment limits for high-risk items.\n- Entity Disclosure: Label accounts that disclose affiliations to campaigns, governments, or NGOs; require disclosure for official spokespeople.\n\n### Fact-Checking and Annotations\n- factChecker Role: Add claim-level annotations, ratings (true/misleading/unfounded/needs context), and citations; cannot sanction directly.\n- Moderator Review: Apply labels, reduce distribution, or remove content based on harm assessment and policy fit; require citation alignment.\n- Author and Reader Notice: Notify authors upon annotation/labeling; show concise summaries with links to sources for readers.\n\n## Report Intake and Prioritization\n\n### Intake Channels and Metadata\n- In-line Content Reports: Reporting from content context with category selection and optional notes.\n- Out-of-Content Reports: Reports on profiles/messages via dedicated reporting entry.\n- System Flags: Automated signals (burst activity, new-account patterns) that generate reports.\n- Trusted Partner Reports: Pre-vetted organizations submitting high-priority notices for categories such as election integrity and child safety.\n\n### False-Report and Reporter Abuse Handling\n- Bad-Faith Reporting: Repeated inaccurate or harassing reports are a form of abuse.\n- Reporter Reputation: Reporter accuracy is tracked to weight prioritization; chronic abusers may face limits.\n\n### Prioritization Rubric\n- Severity Tiers:\n  - Critical (P0): Child safety, credible violent threats, voter suppression, non-consensual intimate imagery.\n  - High (P1): Hate speech, doxxing, terrorism support, imminent-harm misinformation.\n  - Medium (P2): Harassment, platform manipulation, medical misinformation without imminent harm, copyright notices.\n  - Low (P3): Spam, off-topic, profanity, low-quality content.\n- Reporter Trust Weighting: Reports by verifiedMember, factChecker, moderator, and trusted partners receive elevated priority.\n- Recency/Velocity: Recent posts with high engagement escalate within tier.\n- Duplicate Report Merging: Multiple reports for the same item are aggregated; unique reporter count influences priority.\n\n### Triage Workflow (Business-Level)\n```mermaid\ngraph LR\n  subgraph \"Report Intake\"\n    A[\"User/System Submits Report\"] --> B[\"Capture Metadata(Category, Notes, Reporter Role)\"]\n    B --> C[\"Assign Severity Tier(P0-P3)\"]\n  end\n  subgraph \"Queueing\"\n    C --> D[\"Merge Duplicates\"]\n    D --> E[\"Apply Priority Weighting\"]\n  end\n  subgraph \"Review\"\n    E --> F{\"Harm Likely?\"}\n    F -->|\"Yes\"| G[\"Fast-Track to Moderator\"]\n    F -->|\"No\"| H[\"Standard Queue\"]\n  end\n  G --> I[\"Immediate Interim Action(Label/Hide)\"]\n  H --> I\n  I --> J[\"Assignment to Reviewer\"]\n```\n\n## Review SLAs and Escalation Paths\n\n### Service-Level Objectives (business expectations)\n- Continuous review operations with enhanced responsiveness during civic or emergency periods.\n\n| Severity | First Action Deadline (from report) | Final Decision Deadline | Escalation Trigger |\n|----------|-------------------------------------|-------------------------|--------------------|\n| P0 Critical | 15 minutes | 2 hours | Immediate escalation to senior moderator; admin if legal risk or ongoing harm |\n| P1 High | 1 hour | 12 hours | Escalate if backlog > 1 hour or repeat violations |\n| P2 Medium | 6 hours | 48 hours | Escalate if trending or duplicates exceed 10 |\n| P3 Low | 24 hours | 5 days | Escalate if duplicates exceed 25 or author has 3+ recent strikes |\n| Election Window P0 | 10 minutes | 1 hour | Auto-notify admin and factChecker group |\n\n### Escalation Paths (business logic)\n- Moderator → Senior Moderator: Triggered by severity thresholds, legal sensitivity, repeated violations, or conflict of interest.\n- Senior Moderator → Admin: Triggered by legal obligations, public-interest exceptions, government requests, or platform-wide risk.\n- Emergency Referral: Child safety or credible threats to life follow emergency process with immediate action and post-facto review.\n- Legal Requests: Potential law-enforcement requests are logged and handled by admins consistent with compliance requirements.\n\n## Sanctions and Transparency\n\n### Sanction Types and Durations\n\n| Sanction | Description | Default Duration | Applicability |\n|----------|-------------|------------------|---------------|\n| Content Removal | Remove violating content | Permanent | All prohibited categories |\n| Warning | Formal notice for minor or first-time violations | N/A | P2–P3 violations |\n| Labeling | Add context labels or fact-check notes | Until resolved/updated | Misinformation, sensitive media |\n| Limited Participation | Reduce posting/comment cadence (cool-down) | 24–72 hours | Harassment, spam, low-quality |\n| Temporary Mute | Block posting/commenting | 24 hours to 14 days | Repeated harassment, hate speech |\n| Shadow Deamplification | Reduce distribution without blocking access | 7–30 days | Manipulation, low-quality |\n| Temporary Suspension | Disable account access | 7–30 days | Severe or repeated violations |\n| Permanent Ban | Terminate account | Permanent | CSAM, extremism, chronic abuse |\n\n### Sanction Ladder by Category (Default Calibration)\n\n| Category Group | First Confirmed Violation | Second Within 90 Days | Third Within 90 Days |\n|----------------|---------------------------|-----------------------|----------------------|\n| P3 Minor (spam, low-quality, profanity) | Warning or limited participation(24h) | Limited participation(72h) | Temporary mute(24–72h) |\n| P2 Moderate (harassment non-targeted, copyright on notice) | Content removal + warning | Temporary mute(24–72h) | Temporary suspension(7d) |\n| P1 Severe (hate speech, doxxing, extremism support non-operational) | Content removal + temporary suspension(7–14d) | Suspension(14–30d) + strike | Suspension(30d) + ban review |\n| P0 Critical (child safety, non-consensual intimate imagery, credible threats, voter suppression) | Immediate disable + ban review | Permanent ban | Permanent ban |\n\nStrike Policy\n- Three-strike escalation: Three P1 violations within 90 days lead to 30-day suspension; any confirmed P0 triggers immediate permanent ban review.\n- Strike Decay: Strikes older than 180 days are excluded from automatic escalations.\n\n### Role-Based Authority\n- moderator: Remove content, issue warnings, apply labels, impose limited participation, apply temporary mutes/suspensions up to 14 days, and escalate to admin.\n- admin: All moderator actions plus suspensions up to permanent ban, policy configuration, and exception approvals.\n- factChecker: Add annotations and propose labels; cannot apply sanctions.\n- verifiedMember and member: Report content and appeal sanctions on their own content.\n\n### Transparency and User Notice\n- Action Notices: Clear reason, policy category, evidence summary, and appeal option with deadlines.\n- Public Transparency Log: Anonymized aggregate statistics published periodically (counts by category, sanction type, resolution time) without exposing personal data.\n- Remediation Guidance: Provide corrective steps where appropriate (e.g., edit with context, cite sources).\n\n## Evidence Handling and Audit Trails\n\n- Evidence Capture: Preserve exact content, timestamps, author identifiers, reporter role, and context pointers at report and enforcement times.\n- Chain of Custody: Record each handling step with actor role, action type, timestamp, and rationale.\n- Retention: Keep evidence for at least 365 days from final resolution, or longer if required by law or active appeal.\n- Access Control: Restrict evidence access to moderators and admins; factCheckers may view content context for annotations but not sensitive personal data.\n- Redaction: Redact personal identifiers from case summaries shared beyond the moderation team.\n\n## Appeals and Restorative Processes\n\n- Appeal Window: 14 days for most sanctions; 7 days for election-related actions.\n- Independent Review: By a reviewer different from the original decision-maker; admins review permanent-ban appeals.\n- Restorative Options: Educational prompts, edits, or contextualization to reinstate visibility when policy allows.\n- Outcome Notifications: Clear decisions with updated rationales and references to policy categories.\n- Rate Limits: One appeal per decision unless new evidence emerges.\n\n### Appeals Workflow (Business-Level)\n```mermaid\ngraph LR\n  subgraph \"Appeal Submission\"\n    A[\"User Submits Appeal\"] --> B[\"Validate Eligibility(Window, Single Appeal)\"]\n  end\n  subgraph \"Review and Decision\"\n    B --> C[\"Assign Different Reviewer\"]\n    C --> D{\"Uphold or Overturn?\"}\n  end\n  D -->|\"Uphold\"| E[\"Notify User and Maintain Sanction\"]\n  D -->|\"Overturn\"| F[\"Reinstate Content/Access and Clear Strike\"]\n  E --> G[\"Log Outcome in Audit Trail\"]\n  F --> G\n```\n\n## EARS-Formatted Enforcement Requirements\n\n### General Policy Application\n- THE moderation system SHALL apply the most severe applicable policy category when multiple categories are triggered by the same content.\n- THE moderation system SHALL preserve a snapshot of content and metadata at the time of report and at the time of enforcement.\n- THE moderation system SHALL record actor role, action, timestamp, and rationale for every enforcement action.\n\n### Reporting and Intake\n- WHEN a user submits a report with a selected category, THE moderation system SHALL capture category, free-text notes up to 1,000 characters, reporter role, and timestamp.\n- WHEN duplicate reports target the same content, THE moderation system SHALL merge them into a single case while preserving reporter counts and roles.\n- WHERE the reporter is a trusted partner or factChecker, THE moderation system SHALL assign at least P1 priority unless the content already has P0 triggers.\n- WHILE content is under review for P0 or P1, THE moderation system SHALL prevent the content from appearing in recommendations and trending lists.\n- WHERE a reporter’s recent accuracy rate falls below 20% over 30 days, THE moderation system SHALL downgrade the reporter’s prioritization weight and may apply reporting cooldowns.\n- IF a reporter submits harassing or fraudulent reports repeatedly (≥ 5 invalid reports within 7 days), THEN THE moderation system SHALL impose a reporting cooldown of at least 72 hours and SHALL record a strike against reporter abuse.\n\n### Prioritization and SLAs\n- WHEN a report is categorized as P0, THE moderation system SHALL present it to a moderator within 15 minutes and record the presentation timestamp.\n- WHEN a report is categorized as P1, THE moderation system SHALL present it to a moderator within 1 hour.\n- WHEN a report is categorized as P2, THE moderation system SHALL present it to a moderator within 6 hours.\n- WHEN a report is categorized as P3, THE moderation system SHALL present it to a moderator within 24 hours.\n- WHILE under an election window, THE moderation system SHALL apply the Election Window SLA table to P0 items.\n\n### Interim Actions and Labels\n- WHEN harm assessment is pending for P0 or P1, THE moderation system SHALL allow moderators to apply interim actions: temporary hide, label, or limit distribution, with rationale capture.\n- WHERE content is labeled as misinformation, THE moderation system SHALL show fact-check annotations and reduce distribution for the labeled item until updated or removed.\n- WHERE synthetic/manipulated media lacks disclosure, THE moderation system SHALL apply a disclosure label and limit distribution pending author correction or moderator decision.\n\n### Sanctions and Strikes\n- WHEN content is removed for a Prohibited category, THE moderation system SHALL add one strike to the author’s account with category and date.\n- WHERE a user accrues three P1 strikes within 90 days, THE moderation system SHALL apply a 30-day suspension.\n- IF a P0 violation is confirmed, THEN THE moderation system SHALL disable the account pending admin review for permanent ban.\n- WHERE a strike becomes older than 180 days, THE moderation system SHALL exclude it from automatic escalation calculations.\n- WHEN a warning is issued, THE moderation system SHALL record it without adding a strike.\n- WHERE violation category maps to the sanction ladder, THE moderation system SHALL apply the default sanction unless an admin-approved exception is recorded with rationale.\n\n### Role-Based Permissions and Recusal\n- WHERE the actor role is moderator, THE moderation system SHALL permit content removal, warnings, labels, limited participation, mutes up to 14 days, and suspensions up to 14 days.\n- WHERE the actor role is admin, THE moderation system SHALL permit permanent bans and configuration of sanction durations and policies.\n- WHERE the actor role is factChecker, THE moderation system SHALL permit creating annotations and proposing labels but SHALL prohibit sanctions.\n- WHEN a moderator is assigned a case that presents a conflict of interest, THE moderation system SHALL allow and record recusal and SHALL reassign the case automatically.\n\n### Transparency and Notices\n- WHEN an enforcement action is applied, THE moderation system SHALL notify the author with the policy category, a concise explanation up to 500 characters, evidence summary reference, and appeal deadline.\n- WHEN a label is applied to content, THE moderation system SHALL notify the author and provide sources used for labeling.\n- WHERE a public transparency report is generated, THE moderation system SHALL include counts by category, average time to first action, and appeal outcomes by month.\n- WHERE a decision is reversed on appeal, THE moderation system SHALL remove associated strikes and update the transparency metrics within 24 hours.\n\n### Evidence and Audit\n- WHEN evidence is captured, THE moderation system SHALL store the snapshot alongside case identifiers and prevent edits.\n- WHERE a case is accessed by a reviewer, THE moderation system SHALL log the access with role and purpose.\n- IF an appeal overturns a decision, THEN THE moderation system SHALL link the new decision to the original case and mark the original rationale as superseded.\n- WHERE a legal hold is established, THE moderation system SHALL suspend routine deletion of relevant evidence until the hold is lifted.\n\n### Appeals and Restorative Processes\n- WHEN a user appeals within the allowed window, THE moderation system SHALL route the case to a different reviewer.\n- WHERE a decision is upheld, THE moderation system SHALL allow exactly one appeal per decision unless new evidence is attached.\n- WHERE a restorative option is offered, THE moderation system SHALL reinstate content visibility upon completion or compliant edits.\n- WHEN a permanent ban appeal is granted, THE moderation system SHALL downgrade sanctions to suspension and SHALL define a probation period of 30–90 days with enhanced monitoring.\n\n### Civic Safeguards\n- WHEN election-related misinformation is detected, THE moderation system SHALL apply the election SLA and prioritize review over non-election P1 items.\n- WHERE an account self-identifies as part of a political campaign, THE moderation system SHALL display affiliation labels on posts and profile per disclosure data.\n- WHEN a factChecker publishes an annotation on a claim, THE moderation system SHALL notify moderators and reduce distribution for the annotated item until reviewed.\n- WHERE a coordinated manipulation cluster is detected during election windows, THE moderation system SHALL deamplify implicated content, freeze related accounts for review, and notify admins.\n\n## Special Procedures (Business-Level)\n\n### Child Safety and Credible Threats\n- Immediate Action: P0 fast-track; temporary disable of content and implicated accounts pending review; evidence capture prioritized.\n- Lawful Referral: Admin evaluates and coordinates any legally required referrals.\n\n### Moderator Conflict-of-Interest Handling\n- Automatic prompts for recusal on signals like prior direct interactions or declared affiliations; reassignment recorded in audit.\n\n## User-Facing Error and Recovery Scenarios (Business)\n- Misfiled Report: Reporter selects wrong category. Outcome: Case remains valid; category can be corrected by reviewer; reporter receives outcome summary regardless.\n- Sanctioned While Posting: User starts writing before sanction and attempts to publish during sanction. Outcome: Publish denied with remaining sanction duration; draft preserved.\n- Label Dispute: Author disagrees with misinformation label. Outcome: Appeal path available; upon successful appeal, label removed and strike cleared.\n\n## Policy Versioning and Change Management\n- Versioned Policies: Each enforcement references a policy version identifier.\n- Change Notices: Material policy changes communicated to users; moderators briefed prior to enforcement; transparency report notes effective dates.\n\n## Related Documents\n- Refer to the [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md) for role definitions and session behaviors.\n- Refer to the [User Flows and Processes Guide](./05-user-flows-and-processes.md) for end-to-end business workflows.\n- Refer to the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for privacy, security, and legal obligations.\n"},{"reason":"Set measurable expectations for performance, availability, scalability, and operability from a user-experience perspective.","filename":"08-non-functional-requirements-and-slas.md","documentType":"requirement","outline":["Performance Targets (response time by scenario)","Availability and Reliability Objectives","Capacity and Scalability Goals","Rate Limiting and Fair-Use Policies","Observability Expectations (logging, metrics, alerting in business terms)","Backup and Disaster Recovery Objectives (RTO/RPO)","Internationalization and Timezone Considerations","EARS-Formatted Non-Functional Requirements"],"audience":"development team","keyQuestions":["What performance should users experience in common and peak scenarios?","What availability and recovery objectives are required?","How should fair use be enforced?"],"detailLevel":"detailed specification","relatedDocuments":["06-functional-requirements.md","09-security-privacy-and-compliance.md"],"constraints":["All targets must be specific and measurable","Use EARS where applicable","Avoid architecture or technology prescriptions"],"content":"# Non-Functional Requirements and SLAs — civicDebateBoard\n\n## Performance Targets (response time by scenario)\n\nPerformance targets use percentile-based latency measured at the service boundary from user request receipt to first byte of server response. Targets exclude end-user network variability and device rendering but include all server-side processing and coordinated async acknowledgements documented as user-observable outcomes. Baseline, peak, and surge windows are defined to reflect civic-event dynamics.\n\n### Core Read Scenarios\n- Thread view (initial load of a discussion with first page of comments)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Subsequent page loads in same thread: p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Topic/Category feed listing (first page)\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n  - Pagination/“next” fetches: p95 ≤ 0.7 s; p99 ≤ 1.4 s\n- Notifications list fetch (latest 50 items)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- User profile read (public view)\n  - p95 ≤ 0.7 s; p99 ≤ 1.2 s\n\n### Write and Interaction Scenarios\n- Create post (including server-side validations and topic/tag processing)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n- Edit post within allowed policy window\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Create comment or reply\n  - p95 ≤ 0.9 s; p99 ≤ 1.8 s\n- Add reaction (like/support) or cast vote\n  - p95 ≤ 0.5 s; p99 ≤ 1.0 s\n  - Cross-device reflection (eventual consistency): visible to the same user’s other sessions within 2.0 s (p95) and 5.0 s (p99)\n- Report content (submit report with category and notes)\n  - p95 ≤ 0.8 s; p99 ≤ 1.5 s\n- Fact-check annotation submission (by factChecker)\n  - p95 ≤ 1.2 s; p99 ≤ 2.5 s\n\n### Search and Discovery\n- Simple search (keyword over titles/content, default filters)\n  - p95 ≤ 1.5 s; p99 ≤ 3.0 s\n- Advanced search (multiple filters such as date range, tags, author)\n  - p95 ≤ 2.5 s; p99 ≤ 5.0 s\n- Autocomplete suggestions (typeahead)\n  - p95 ≤ 0.3 s; p99 ≤ 0.6 s\n\n### Authentication and Account Management (business perspective)\n- Login with valid credentials\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n- Email verification link consumption\n  - p95 ≤ 1.0 s; p99 ≤ 2.0 s\n- Password reset flow (token validation and new password set)\n  - p95 ≤ 2.0 s; p99 ≤ 4.0 s\n\n### Background and Asynchronous Outcomes (user-observable)\n- Notification delivery for direct mentions and replies\n  - p95 ≤ 10 s; p99 ≤ 30 s from event occurrence\n- Moderation decision visibility after decision recorded\n  - p95 ≤ 10 s; p99 ≤ 60 s to all relevant views\n- Indexing latency for search after new content\n  - p95 ≤ 30 s; p99 ≤ 120 s\n\n### Concurrency and Throughput Assumptions (business-facing)\n- Baseline steady state: 10,000 concurrent authenticated users, 2,000 read requests/s, 500 write requests/s\n- Peak predictable events (e.g., election nights): up to 50,000 concurrent users, 10,000 read requests/s, 2,000 write requests/s\n- Short surge (≤ 10 minutes) due to breaking news: up to 2× peak for reads and 1.5× peak for writes\n- Targets SHALL hold under baseline; during peak/surge windows, p95 and p99 targets may degrade by at most +30% latency while maintaining availability objectives\n\n### Cold-Start and Cache Warm-Up Behavior\n- First access after cache cold start for any high-volume listing (topic feed, home feed) may incur up to +20% additional latency at p95 for ≤ 5 minutes after deployment or failover; p99 must remain within +30% of baseline.\n- Warm cache steady-state must regain baseline targets within 5 minutes of stabilization.\n\n### Payload and Pagination Consistency Expectations\n- Result pages for feeds and search SHALL contain 20 items by default with stable sorting and no duplicates across contiguous pages under the same query parameters.\n- Aggregated counters (reactions, votes) may be eventually consistent across sessions but MUST converge within 5 seconds at p99 for the acting user’s view.\n\n## Availability and Reliability Objectives\n\nAvailability targets are measured monthly unless specified. Availability is the proportion of successful user operations over total attempted operations for the capability, excluding client-originated failures outside the service boundary and scheduled maintenance within the announced window.\n\n### Service-Level Objectives (SLOs)\n- Core read operations (view thread, list feeds): 99.95% monthly availability\n- Core write operations (create/edit posts/comments, vote/reaction): 99.90% monthly availability\n- Authentication and session operations: 99.90% monthly availability\n- Search services: 99.90% monthly availability\n\n### Error Budgets and Release Governance\n- 99.95% monthly leaves 21.6 minutes unavailability budget; 99.90% leaves 43.8 minutes.\n- At 50% budget consumption: restrict non-critical changes and require explicit approval for risk-elevating deployments.\n- At 100% consumption: freeze non-emergency changes until budget resets.\n\n#### Change Freeze Trigger Flow\n```mermaid\ngraph LR\n  A[\"Track Error Budget Consumption\"] --> B{\"Reached 50%?\"}\n  B -->|\"Yes\"| C[\"Restrict Non-Critical Changes\"]\n  B -->|\"No\"| D[\"Continue Normal Changes\"]\n  C --> E{\"Reached 100%?\"}\n  D --> E\n  E -->|\"Yes\"| F[\"Freeze Non-Emergency Changes\"]\n  E -->|\"No\"| G[\"Monitor & Reassess Daily\"]\n```\n\n### Maintenance Windows\n- Planned maintenance up to 60 minutes per month, scheduled at low-traffic times and announced at least 72 hours in advance with local-time communication for impacted regions.\n- Prefer degraded-mode maintenance (read-only) over full downtime with clear user notices.\n\n### Graceful Degradation Expectations\n- Prioritize read availability over non-critical write operations and background tasks during impairments.\n- Temporarily disable heavy, non-essential features (e.g., bulk data exports) to protect core SLOs.\n\n### SLA Measurement and Reporting\n- Measurement window: monthly calendar period with daily rollups.\n- Inclusion criteria: successful operations are those completed within published latency and functional correctness; degraded but retried within the same interaction counts as success if within user-visible SLA.\n- Exclusions: client-side network errors, third-party outages beyond control with documented supplier incident references, and scheduled maintenance communicated ≥ 72 hours in advance.\n- Reporting: publish monthly availability summaries per capability with error budget status and top contributing incidents.\n\n### User-Facing Status Communications\n- Incident status pages and in-product banners must reflect current impact, affected capabilities, start time, and next update ETA.\n- Update cadence: every 30 minutes for active major incidents; every 60 minutes for minor incidents until resolved.\n\n## Capacity and Scalability Goals\n\n- Planning horizon: 12 months rolling with quarterly review.\n- Headroom policy: maintain ≥ 30% spare capacity over the 95th percentile observed demand; ≥ 50% during known high-impact civic events.\n- Elasticity: scale-out actions commence within 2 minutes of sustained (≥ 5 minutes) demand beyond headroom; scale-in after 30 minutes of sub-70% utilization to avoid thrashing.\n- Data growth assumptions: 1–2 million new posts/month, 10–20 million new comments/month; proportional growth in reactions and votes.\n- Multi-tenant fairness: per-topic or per-region spikes must not starve other topics/regions; apply isolation and quotas to protect fairness.\n\n### Data Consistency and Backlog Management\n- Async backlogs (notifications, indexing) must drain to within normal operating thresholds within 15 minutes after surge subsides.\n- Search indexing lag must meet p95 ≤ 30 s; p99 ≤ 120 s under steady-state and return to targets within 10 minutes post-surge.\n\n## Rate Limiting and Fair-Use Policies\n\nRate limits protect platform health and fairness. Limits are enforced per authenticated user and, where applicable, per-IP to mitigate abuse. Role-specific limits reflect trust and responsibility. Administrative and moderation functions necessary for safety are exempt from general content-creation caps but remain subject to platform protection.\n\n### Action-Based Daily Quotas by Role\n\n| Action (per 24h rolling window) | member | verifiedMember | factChecker | moderator | admin |\n|---------------------------------|--------|----------------|-------------|-----------|-------|\n| Create posts                    | 30     | 60             | 60          | 120       | 240   |\n| Comments/replies                | 300    | 600            | 600         | 1,200     | 2,400 |\n| Reactions (likes/support)       | 3,000  | 5,000          | 5,000       | 10,000    | 20,000|\n| Votes (polls/ballots)           | 1,000  | 2,000          | 2,000       | 5,000     | 10,000|\n| Reports submitted               | 100    | 200            | 300         | 5,000     | 5,000 |\n| Fact-check annotations          | —      | —              | 100         | 300       | 300   |\n| Data exports (on-demand)        | 2      | 2              | 4           | 10        | 20    |\n\nNotes:\n- “—” denotes action not available to that role.\n- High-volume administrative operations affecting many items may require additional confirmations and audit entries per safety and compliance policies.\n\n### Per-User and Per-IP Request Shaping\n- Sustained per-user request rate: 60 requests/minute with burst up to 3× for 10 seconds; cooldown applies if exceeded.\n- Per-IP guideline: 120 requests/minute with burst up to 3× for 10 seconds; stricter thresholds may apply for shared networks with abusive patterns.\n- Search-specific limit per minute/hour: 20/100 (member), 40/200 (verifiedMember), 60/300 (factChecker), 120/600 (moderator/admin).\n\n### Abuse Response and Recovery\n- Progressive throttling: soft warnings → temporary slowdowns → temporary blocks within the same 24h window; resets after the rolling window elapses.\n- Human verification may be required when automated abuse signals exceed thresholds.\n- Accuracy-weighted reporting: frequent inaccurate reporters may see reduced report quotas until accuracy improves per moderation policies.\n\n## Observability Expectations (business terms)\n\nObservability enables rapid detection, triage, and resolution of issues to protect user experience and SLAs. Expectations are stated as outcomes and signal categories, not tooling.\n\n### Business Event Logging\n- Authentication events: registration, login success/failure, logout, email verification, password reset, device/session revocation.\n- Content lifecycle: post/comment creation, edits, deletions, restores, visibility changes (e.g., moderation actions), tagging/topic updates.\n- User safety: reports, triage outcomes, sanctions applied, appeals and outcomes.\n- Configuration and policy changes: role assignments, feature toggles, category/tag configuration, sanctions configuration.\n- Elevated data access: exports and policy audits.\n\nLogs include sufficient context to trace who acted, what changed, and when, with privacy compliance consistent with security and compliance requirements.\n\n### Metrics and Health Indicators\n- Latency distributions: p50/p95/p99 for key flows defined in Performance Targets.\n- Availability: success rate per capability excluding client/network errors.\n- Saturation: high-level indicators (queue depth, worker utilization) of constrained capacity.\n- Workload: request rates, concurrency, job backlogs.\n- Operability KPIs: report backlog age, moderation decision latency, notification delivery latency.\n\n### Alerting and Operational Response\n- Thresholds mapped to SLOs and user impact:\n  - Critical: page immediately when projected to breach SLO within 30 minutes or user-visible errors exceed 2% for 5 minutes.\n  - High: page when p99 latency exceeds target by 50% for 10 minutes under baseline.\n  - Moderate: ticket for chronic degradations without immediate user impact.\n- On-call availability: 24/7 coverage with acknowledgement within 5 minutes (critical) and 15 minutes (high); mitigation or rollback initiated within 15 minutes (critical) and 30 minutes (high).\n- Post-incident review: completed within 5 business days with action items tracked to completion.\n\n#### Incident Alerting and Escalation Flow\n```mermaid\nsequenceDiagram\n  participant U as \"User Experience\"\n  participant M as \"Metrics/Alerts\"\n  participant OC as \"On-Call Engineer\"\n  participant IM as \"Incident Manager\"\n  participant ST as \"Service Team\"\n  U->>M: \"User-visible degradation detected\"\n  M-->>OC: \"Page (critical/high)\"\n  OC->>U: \"Mitigation actions(traffic shaping, feature gating)\"\n  OC->>IM: \"Declare incident and severity\"\n  IM->>ST: \"Coordinate response and updates\"\n  ST->>U: \"Restore service and confirm SLO compliance\"\n```\n\n### Change Management and Release Governance\n- Release windows: prefer low-traffic times aligned to major user regions; avoid scheduled releases during published election windows.\n- Canary/gradual rollout expectations: progressive exposure with rollback criteria tied to SLO deltas and error budget consumption.\n- Rollback targets: decision within 15 minutes of critical alert if regression persists.\n\n## Backup and Disaster Recovery Objectives (RTO/RPO)\n\n- Backup coverage: user-generated content, policy configurations, and audit records required for legal and operational accountability.\n- Backup frequency: at least every 15 minutes for critical transactional data; daily immutable snapshots for full datasets.\n- Retention: minimum 30 days online; 180 days in archive for compliance-relevant records, subject to privacy obligations.\n- Recovery Point Objective (RPO): ≤ 15 minutes for critical data; ≤ 60 minutes for non-critical indexes and caches.\n- Recovery Time Objective (RTO): ≤ 60 minutes for single-region outages affecting core operations; ≤ 4 hours for full regional failover.\n- Restore testing: quarterly restore drills for critical datasets with evidence of success and measured RTO/RPO compliance.\n\n#### Disaster Recovery Decision Flow\n```mermaid\ngraph LR\n  A[\"Degradation or Outage Detected\"] --> B{\"Within Error Budget?\"}\n  B -->|\"Yes\"| C[\"Mitigate and Monitor\"]\n  B -->|\"No\"| D[\"Initiate Failover Runbook\"]\n  C --> E{\"Resolved < 30 min?\"}\n  E -->|\"Yes\"| F[\"Close Incident\"]\n  E -->|\"No\"| D\n  D --> G[\"Restore Data to RPO Targets\"]\n  G --> H[\"Validate Core Capabilities\"]\n  H --> I{\"Meets RTO?\"}\n  I -->|\"Yes\"| F\n  I -->|\"No\"| J[\"Escalate and Communicate Extended ETA\"]\n```\n\n## Internationalization and Timezone Considerations\n\n- Timestamps are displayed in the user’s configured timezone and locale formats, with an option to view in UTC.\n- Relative time phrasing is acceptable when unambiguous and accompanied by absolute time upon request.\n- Daylight saving and regional calendar differences are respected for date ranges and limits.\n- Rolling windows for rate limits are anchored to UTC for fairness and predictability; user interfaces communicate remaining quotas in the user’s timezone.\n- Notifications and scheduled communications respect the recipient’s local quiet hours where configured.\n- Regional incident communications are localized to impacted regions’ local time with clear conversion to UTC for audit.\n\n## EARS-Formatted Non-Functional Requirements\n\n### Performance\n- THE civicDebateBoard SHALL deliver thread view responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL deliver topic feed responses within 1.0 s at p95 and 2.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process post creation within 1.2 s at p95 and 2.5 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process comment creation within 0.9 s at p95 and 1.8 s at p99 under baseline load.\n- THE civicDebateBoard SHALL process reactions and votes within 0.5 s at p95 and 1.0 s at p99 under baseline load.\n- THE civicDebateBoard SHALL make user actions visible across the user’s sessions within 2.0 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver simple search results within 1.5 s at p95 and 3.0 s at p99; advanced search within 2.5 s at p95 and 5.0 s at p99.\n- THE civicDebateBoard SHALL deliver login responses within 2.0 s at p95 and 4.0 s at p99.\n- THE civicDebateBoard SHALL deliver notifications within 10 s at p95 and 30 s at p99 from the triggering event.\n- WHERE peak or surge conditions occur, THE civicDebateBoard SHALL keep latency targets within +30% of baseline p95/p99 values.\n- WHERE cache cold-start occurs after deployment or failover, THE civicDebateBoard SHALL restore baseline p95 latency within 5 minutes of stabilization.\n\n### Availability and Reliability\n- THE civicDebateBoard SHALL maintain 99.95% monthly availability for core read operations.\n- THE civicDebateBoard SHALL maintain 99.90% monthly availability for core write operations, authentication, and search.\n- THE civicDebateBoard SHALL enforce error budgets aligned to SLOs and apply change freezes upon 100% budget consumption.\n- WHEN planned maintenance is required, THE civicDebateBoard SHALL announce at least 72 hours in advance and prefer read-only modes over downtime.\n- IF service impairment occurs, THEN THE civicDebateBoard SHALL degrade non-critical features to preserve read availability.\n- THE civicDebateBoard SHALL publish monthly availability summaries per capability with error budget status and top contributing incidents.\n- WHEN a major incident is active, THE civicDebateBoard SHALL update the user-facing status at least every 30 minutes until resolution.\n\n### Capacity and Scalability\n- THE civicDebateBoard SHALL sustain baseline concurrency of 10,000 authenticated users, 2,000 read requests/s, and 500 write requests/s.\n- WHERE predictable civic events occur, THE civicDebateBoard SHALL sustain 50,000 concurrent users, 10,000 read requests/s, and 2,000 write requests/s.\n- WHILE demand exceeds headroom for ≥ 5 minutes, THE civicDebateBoard SHALL initiate scale-out to keep performance targets in compliance.\n- THE civicDebateBoard SHALL maintain ≥ 30% spare capacity over 95th percentile load and ≥ 50% during scheduled high-impact events.\n- WHEN async backlogs exceed normal thresholds during surge, THE civicDebateBoard SHALL recover to steady-state within 15 minutes after surge subsides.\n\n### Rate Limiting and Fair Use\n- THE civicDebateBoard SHALL enforce daily action quotas per role as specified in the Rate Limiting and Fair-Use Policies table.\n- THE civicDebateBoard SHALL enforce sustained per-user request rate of 60 requests/min with 3× burst for 10 seconds and apply cooldowns after exceedance.\n- THE civicDebateBoard SHALL enforce per-IP guidelines of 120 requests/min with 3× burst, with stricter controls for abusive patterns.\n- IF a user exceeds fair-use thresholds, THEN THE civicDebateBoard SHALL apply progressive throttling culminating in temporary blocks within the same 24h rolling window.\n- WHERE a user’s report accuracy score declines materially, THE civicDebateBoard SHALL proportionally reduce report quotas until accuracy improves.\n\n### Observability and Operations\n- THE civicDebateBoard SHALL record business events for authentication, content lifecycle, user safety, configuration changes, and elevated data access with sufficient context for accountability.\n- THE civicDebateBoard SHALL publish latency distributions (p50/p95/p99), availability rates, saturation, workload, and operability KPIs for real-time alerting and weekly reviews.\n- WHEN indicators project an SLO breach within 30 minutes, THE civicDebateBoard SHALL trigger critical alerts to on-call.\n- THE civicDebateBoard SHALL ensure on-call acknowledgement within 5 minutes for critical alerts and 15 minutes for high alerts.\n- THE civicDebateBoard SHALL initiate mitigation or rollback within 15 minutes for critical incidents and 30 minutes for high incidents.\n- THE civicDebateBoard SHALL complete post-incident reviews within 5 business days with tracked actions.\n- WHERE release risk is elevated, THE civicDebateBoard SHALL use progressive rollout and SHALL define rollback criteria tied to SLO deltas.\n\n### Backup and Disaster Recovery\n- THE civicDebateBoard SHALL create backups of critical transactional data at least every 15 minutes and daily immutable full snapshots.\n- THE civicDebateBoard SHALL meet RPO ≤ 15 minutes for critical data and ≤ 60 minutes for non-critical indexes and caches.\n- THE civicDebateBoard SHALL meet RTO ≤ 60 minutes for single-region core outages and ≤ 4 hours for full regional failover.\n- THE civicDebateBoard SHALL conduct quarterly restore drills and document evidence of success.\n- WHEN error budget thresholds are exceeded during an outage, THE civicDebateBoard SHALL initiate failover per the DR decision flow.\n\n### Internationalization and Timezone\n- THE civicDebateBoard SHALL display timestamps in the user’s configured timezone and locale, with an option to view in UTC.\n- THE civicDebateBoard SHALL anchor rolling-rate-limit windows to UTC while communicating remaining quotas in the user’s local time.\n- THE civicDebateBoard SHALL respect daylight saving rules and regional calendar differences when presenting ranges and limits.\n- WHERE user preferences specify quiet hours, THE civicDebateBoard SHALL align notification delivery windows accordingly.\n- WHEN incidents impact specific regions, THE civicDebateBoard SHALL localize communications to affected timezones and include UTC references.\n\n## References\n- Refer to the [Functional Requirements Specification](./06-functional-requirements.md) for capabilities and rules related to content, discussions, and workflows.\n- Refer to the [Security, Privacy, and Compliance Requirements](./09-security-privacy-and-compliance.md) for obligations intersecting with observability, audit logging, data retention, and user rights.\n"},{"reason":"Document privacy, security, and legal obligations to ensure trust and compliance without prescribing implementation.","filename":"09-security-privacy-and-compliance.md","documentType":"requirement","outline":["Data Privacy Principles and Consent Management","User Rights (access, correction, deletion)","Security Expectations (access control, data protection in business terms)","Audit Logging and Accountability Requirements","Incident Response and Breach Notification","Regulatory Compliance (GDPR, CCPA, election-related policies where applicable)","Third-Party and Integration Risk Management","EARS-Formatted Compliance Requirements"],"audience":"development team","keyQuestions":["What privacy rights and obligations apply?","What security controls are required in business terms?","How are incidents handled and reported?"],"detailLevel":"detailed specification","relatedDocuments":["03-user-roles-and-authentication.md","08-non-functional-requirements-and-slas.md"],"constraints":["Use EARS where applicable","Do not specify technical mechanisms; describe obligations and outcomes"],"content":"# civicDebateBoard Security, Privacy, and Compliance Requirements\n\nThis document defines the business requirements for security, privacy, and compliance for the civicDebateBoard service. It specifies WHAT the system must do from a compliance and safety perspective in clear, testable terms, without prescribing HOW to implement it. All technical implementation decisions (architecture, APIs, database design, cryptographic choices, tooling) are at the discretion of the development team.\n\n## Introduction and Scope\ncivicDebateBoard facilitates civic discourse with roles [member, verifiedMember, factChecker, moderator, admin]. This document governs how user data is handled, how access is controlled, how activities are audited, and how incidents are managed to meet legal and ethical obligations across jurisdictions in which the service operates. Requirements herein are expressed in business terms and must be treated as mandatory acceptance criteria.\n\n- In-Scope: Data privacy obligations, consent management, user rights, business-level security expectations, audit logging, incident response, regulatory conformance, third-party risk.\n- Out-of-Scope: UI/UX specifications, API endpoints, database schemas, cryptographic algorithms, network or infrastructure choices.\n\nFor role definitions and session behaviors, see the User Roles and Authentication Requirements in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). For performance, availability, and disaster recovery expectations, see [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## Data Privacy Principles and Consent Management\ncivicDebateBoard adheres to the following privacy principles: purpose limitation, data minimization, transparency, integrity and confidentiality, storage limitation, and accountability. Consent is one lawful basis among others (e.g., contract, legitimate interest) and must be handled explicitly when required.\n\n### Data Categories and Classification (Business View)\n| Category | Examples | Sensitivity | Default Collection | Default Sharing |\n|---------|----------|-------------|--------------------|-----------------|\n| Account Data | email, display name, role, verification status | Personal | Required for account | Not shared externally |\n| Content Data | posts, comments, reactions, bookmarks | Varies (may include personal) | Optional per user action | Public if posted publicly |\n| Behavioral Data | follows, subscriptions, notification preferences, rate-limit counters | Personal | Limited to service operation | Not shared externally |\n| Security Data | login events, device sessions, password reset requests, sanctions | Personal | Required for security | Not shared externally |\n| Moderation Data | reports, review decisions, sanctions, appeals | Personal | Required for policy enforcement | Not shared externally |\n| Analytics Data | aggregated usage metrics | Aggregated/De-identified | Optional per consent where required | Shared only in aggregate |\n\n### Privacy Disclosures and Consent\n- Transparency: Users must receive clear disclosures about purposes of processing, categories of data collected, retention periods, and sharing practices at or before the point of collection.\n- Consent: Explicit consent must be obtained before processing categories that require consent by law (e.g., certain analytics, marketing communications, location-based personalization where applicable). Consent must be granular, freely given, informed, unambiguous, and revocable at any time without detriment.\n- Legitimate Interest: Where legitimate interest is used as a lawful basis, a documented balancing test must be maintained and users must be offered an easy opt-out when required.\n\n### Cookie/Identifier Preferences and \"Do Not Sell/Share\"\n- Cookie and identifier preferences must be honored, including Global Privacy Control (GPC) or similar browser-level signals where applicable.\n- Marketing communications and cross-context behavioral advertising must be opt-in where required and opt-out at minimum elsewhere; non-discrimination rules apply.\n\n### EARS Requirements — Privacy and Consent\n- THE civicDebateBoard SHALL present purpose-specific privacy disclosures prior to any data collection that is not strictly necessary for core service operation.\n- THE civicDebateBoard SHALL record the timestamp, scope, and version of the disclosure accepted by the user for any consent-based processing.\n- WHEN a user withdraws consent for a processing purpose, THE civicDebateBoard SHALL cease that processing within 24 hours and ensure no new data is collected for that purpose thereafter.\n- WHEN consent is required for analytics beyond strictly necessary operations, THE civicDebateBoard SHALL default to opt-out and SHALL enable opt-in only after explicit user action.\n- IF a processing purpose changes materially, THEN THE civicDebateBoard SHALL obtain fresh consent before continuing consent-based processing under the new purpose.\n- WHERE legal bases other than consent are relied upon, THE civicDebateBoard SHALL expose a clear explanation of the applicable legal basis within the privacy notice.\n- WHERE a GPC or equivalent signal is received, THE civicDebateBoard SHALL treat it as a valid opt-out of sale/share for applicable jurisdictions and SHALL persist that preference.\n\n### Consent Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Collect Purpose-Specific Disclosure\"] --> B[\"Capture Consent State(Opt-in/Opt-out)\"]\n  B --> C{\"Consent Required?\"}\n  C -->|\"Yes\"| D[\"Enforce Purpose Access Controls\"]\n  C -->|\"No\"| E[\"Proceed Under Other Legal Basis\"]\n  D --> F{\"Withdrawal Requested?\"}\n  F -->|\"Yes\"| G[\"Stop Processing(<24h) & Log Withdrawal\"]\n  F -->|\"No\"| H[\"Continue Processing\"]\n  E --> H\n```\n\n## User Rights (Access, Correction, Deletion)\nUser rights procedures must ensure timely, secure, and verifiable fulfillment of requests.\n\n### Identity Verification for Requests\n- Requests to access, correct, or delete data must be verified using reasonable methods proportionate to the sensitivity of the data and the risk of harm from unauthorized access. The verification method must not require excessive data.\n\n### DSAR Intake and Fulfillment Timelines\n- GDPR: Respond to access, correction, and deletion requests without undue delay and within 30 calendar days of receipt; a single extension up to 60 additional days is allowed when justified by complexity, with notification to the requester within the original 30 days.\n- CCPA/CPRA: Respond to access and deletion requests within 45 days; a 45-day extension is allowed when reasonably necessary with notice to the consumer.\n\n### Packaging of Responses\n- Access responses must include a human-readable summary and a machine-readable portable format commonly used in the industry, limited to the requestor’s personal data and clearly excluding other users’ data.\n\n### Deletion Scope and Exceptions\n- Deletion removes personal data that is not required for legal, security, or integrity obligations. Content removals may leave a publicly visible tombstone where necessary to preserve discussion coherence without revealing personal data.\n\n### Portability, Restriction, and Opt-Outs\n- Portability: Provide a structured, commonly used, machine-readable export of personal data the user provided and, where applicable, data observed through their use of the service.\n- Restriction: Temporarily limit processing where legally required while preserving data integrity for the restriction period.\n- Opt-Outs: Honor user opt-outs of sale/share, targeted advertising, and profiling where required by law without degrading core functionality.\n\n### Non-Discrimination\n- Users exercising rights shall not be charged different prices or receive a different level or quality of goods or services unless permitted by law and disclosed.\n\n### Retention and Storage Limitation\n| Data Type | Default Retention | Extensions and Holds | Final Disposition |\n|----------|-------------------|----------------------|-------------------|\n| Account Data | Lifetime of account + 30 days after deletion | Extended for legal holds | Permanent deletion |\n| Content Data | Lifetime of content; user-initiated deletion immediate | Retained in backups per backup window | Removal from active service; anonymized references where necessary |\n| Security Logs | 12 months | Extended for investigations/legal holds | Secure deletion |\n| Moderation Records | 24 months | Extended through appeal window and legal holds | Secure deletion or anonymization |\n| Incident Records | 5 years | As required by regulation | Secure deletion |\n| Backups | Up to 30 days | No extension absent legal holds | Rolling overwrite |\n\n### EARS Requirements — User Rights\n- WHEN a user submits a verified access request, THE civicDebateBoard SHALL provide a complete copy of the user’s personal data within the applicable legal timeframe and SHALL log the fulfillment event for audit.\n- WHEN a user submits a verified correction request, THE civicDebateBoard SHALL update inaccurate personal data within 30 days and SHALL notify the user upon completion.\n- WHEN a user submits a verified deletion request, THE civicDebateBoard SHALL delete personal data not required for legal or security obligations within 30 days and SHALL document exceptions with reasons.\n- IF identity verification for a rights request fails, THEN THE civicDebateBoard SHALL reject the request and SHALL provide a reason and a path to re-verify without revealing sensitive information.\n- WHERE the law permits timeline extensions, THE civicDebateBoard SHALL notify the requester of the extension and the justification before the original deadline expires.\n- WHILE a legal hold is active, THE civicDebateBoard SHALL suspend deletion for data subject to the hold and SHALL resume deletion once the hold is lifted.\n- WHEN a portability request is verified, THE civicDebateBoard SHALL provide a structured, commonly used, machine-readable export within legal timelines.\n- WHEN a restriction request is verified, THE civicDebateBoard SHALL mark affected data as restricted and SHALL prevent processing except for storage and legal obligations for the restriction duration.\n- WHEN a user opts out of targeted advertising or sale/share, THE civicDebateBoard SHALL cease such processing within 15 days and SHALL confirm the opt-out state to the user.\n\n### DSAR Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Receive DSAR(Request Type)\"] --> B[\"Verify Identity(Reasonable Method)\"]\n  B --> C{\"Verified?\"}\n  C -->|\"No\"| D[\"Deny & Provide Re-verify Path\"]\n  C -->|\"Yes\"| E[\"Locate Data & Assess Scope\"]\n  E --> F{\"Extension Needed?\"}\n  F -->|\"Yes\"| G[\"Notify Extension & Justification\"]\n  F -->|\"No\"| H[\"Prepare Response(Package Type)\"]\n  G --> H\n  H --> I[\"Deliver Response & Log Audit\"]\n```\n\n## Security Expectations (Access Control, Data Protection in Business Terms)\nSecurity requirements are expressed as business obligations that protect users and the integrity of discourse while respecting role-based access.\n\n### Role-Based Access Expectations\n| Data/Action | member | verifiedMember | factChecker | moderator | admin |\n|------------|--------|----------------|------------|----------|-------|\n| View own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Edit own Account Data | ✅ | ✅ | ✅ | ✅ | ✅ |\n| View other users’ Account Data | ❌ | ❌ | ❌ | Limited to enforcement need | Limited to administrative need |\n| Access Content Data (public) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Access flagged Moderation Data | ❌ | ❌ | Propose annotations only | ✅ | ✅ |\n| Issue sanctions | ❌ | ❌ | ❌ | ✅ | ✅ |\n| Manage roles and platform policies | ❌ | ❌ | ❌ | ❌ | ✅ |\n\nNote: Detailed role semantics are defined in [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This table expresses high-level business permissions only.\n\n### Protection of Data in Transit and at Rest (Business Level)\n- Communications and stored data containing personal information must be protected against unauthorized access. Protection mechanisms must align with industry standards and regulatory expectations without specifying exact technologies here.\n\n### Secrets and Key Material Handling (Business Level)\n- Secrets must be treated as confidential assets, access must be strictly limited to those with a business need, and rotation must occur on a regular cadence and upon suspected exposure.\n\n### Account and Session Protections (Business Level)\n- Authentication, session duration, revocation, and device management are governed by [User Roles and Authentication Requirements](./03-user-roles-and-authentication.md). This document requires outcomes: resistant to brute-force attempts, rapid revocation on logout-all events, and safe handling of password resets and email verification.\n\n### Workforce Training and Access Reviews\n- Personnel with access to personal data must complete annual privacy and security training with role-appropriate modules.\n- Access to systems containing personal data must be reviewed at least quarterly and upon role changes.\n\n### Vulnerability Disclosure and Security Testing (Business Level)\n- A public channel for responsible vulnerability disclosure must exist with commitments to timely triage and remediation.\n- Periodic security testing (e.g., third-party assessments) must be conducted on a risk-based cadence without prescribing tools.\n\n### EARS Requirements — Security Expectations\n- THE civicDebateBoard SHALL enforce least-privilege access aligned with user roles for all data categories listed in this document.\n- WHEN a user’s role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate any access inconsistent with the new role.\n- WHEN a user logs out of all devices, THE civicDebateBoard SHALL ensure that no previously issued session remains valid beyond 60 seconds after the action.\n- IF repeated failed authentication attempts indicate brute-force behavior, THEN THE civicDebateBoard SHALL temporarily block further attempts from the source and SHALL preserve relevant Security Data for investigation.\n- WHERE personal data is stored, THE civicDebateBoard SHALL ensure that unauthorized access is prevented using industry-standard protection mechanisms both in transit and at rest.\n- WHEN secrets exposure is suspected, THE civicDebateBoard SHALL rotate affected secrets within 24 hours and SHALL invalidate dependent credentials promptly.\n- THE civicDebateBoard SHALL require annual privacy and security training for personnel with access to personal data and SHALL record completion.\n- THE civicDebateBoard SHALL conduct quarterly access reviews for privileged roles and SHALL remove access that is no longer required.\n- WHEN a vulnerability report is received through the responsible disclosure channel, THE civicDebateBoard SHALL acknowledge receipt within 7 days and SHALL provide status updates until resolution.\n\n## Audit Logging and Accountability Requirements\nAuditability ensures traceability of significant actions while respecting privacy.\n\n### Scope of Auditable Events (Business View)\n- Authentication lifecycle events (registration, login, logout, password reset, email verification)\n- Role and permission changes\n- Content lifecycle events (create, edit, delete, restore)\n- Moderation lifecycle events (report intake, triage, decision, sanction, appeal, reinstatement)\n- Privacy events (consent grant/withdrawal, DSAR intake/fulfillment)\n- Security events (failed logins spikes, admin access, configuration changes)\n\n### Required Audit Record Elements (Semantic Fields)\n- Actor identity and role at time of action\n- Action type and target object category\n- Timestamp in a standardized, consistent time basis\n- Outcome (success/denied/error) and reason code if denied\n- High-level origin context (e.g., device type or general location as permitted by law)\n- Correlation identifier for multi-step processes\n\n### Access and Integrity of Audit Logs\n- Access to audit logs must be restricted to admin and authorized moderator functions used for investigations.\n- Logs must be tamper-evident and retained per schedule without exposing personal data beyond necessity.\n\n### EARS Requirements — Audit and Accountability\n- THE civicDebateBoard SHALL record audit entries for all events listed in the Scope of Auditable Events.\n- WHEN an auditable event is recorded, THE civicDebateBoard SHALL include actor identity, role, action type, target category, timestamp, outcome, and correlation identifier.\n- WHERE an action is denied due to insufficient permissions, THE civicDebateBoard SHALL record the denial reason without exposing sensitive data.\n- IF audit log access is requested by an unauthorized role, THEN THE civicDebateBoard SHALL deny access and SHALL record the attempt.\n- WHILE an investigation is active, THE civicDebateBoard SHALL protect relevant logs from alteration or deletion and SHALL lift protection once the investigation concludes.\n\n## Incident Response and Breach Notification\nIncident management ensures rapid detection, containment, and communication proportionate to severity.\n\n### Severity Levels and SLAs\n| Severity | Description | Initial Triage | Containment | User/Authority Notification |\n|---------|-------------|----------------|-------------|-----------------------------|\n| Sev 1 | Confirmed breach of personal data with high risk | Within 1 hour | Within 4 hours | Authorities within 72 hours where required; affected users without undue delay and within 7 days |\n| Sev 2 | Suspected breach or material service abuse | Within 4 hours | Within 24 hours | Notify affected users if risk is nontrivial; authority notification per law |\n| Sev 3 | Security weakness or limited exposure with low risk | Within 1 business day | Within 3 business days | No notification unless legally required |\n\n### Incident Lifecycle (Business Flow)\n```mermaid\ngraph LR\n  A[\"Detect Event\"] --> B{\"Severity Assessed\"}\n  B -->|\"Sev 1\"| C[\"Containment Actions\"]\n  B -->|\"Sev 2/3\"| C\n  C --> D[\"Forensics & Impact Determination\"]\n  D --> E{\"Personal Data Involved?\"}\n  E -->|\"Yes\"| F[\"Regulatory Notification Prep\"]\n  E -->|\"No\"| G[\"Remediation Plan\"]\n  F --> H[\"Notify Authorities\"]\n  F --> I[\"Notify Affected Users\"]\n  G --> J[\"Execute Remediation\"]\n  H --> K[\"Postmortem & Lessons\"]\n  I --> K\n  J --> K\n```\n\n### Breach Notification Content (Business Expectations)\n- Nature of the incident, categories and approximate number of data subjects and records involved (where known), likely consequences, measures taken or proposed to address the breach, and guidance for affected users to mitigate harm.\n\n### EARS Requirements — Incident Response\n- WHEN a potential incident is detected, THE civicDebateBoard SHALL initiate severity assessment within the timeframes specified in the Severity Levels and SLAs table.\n- WHEN an incident reaches Sev 1, THE civicDebateBoard SHALL complete initial containment within 4 hours and SHALL prepare regulatory notifications as required.\n- IF personal data is likely exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where applicable and SHALL notify affected users without undue delay using clear guidance on protective steps.\n- WHERE a legal hold is established as part of an incident, THE civicDebateBoard SHALL suspend routine deletions of affected data until the hold is lifted.\n- THE civicDebateBoard SHALL conduct a post-incident review within 10 business days of containment, including root cause, impact, and remediation actions.\n\n## Regulatory Compliance (GDPR, CCPA, Election-Related Policies)\nThe service must operate in compliance with applicable privacy laws and content-related obligations where it is offered.\n\n### Lawful Bases and Transparency\n- Identify and document lawful bases per processing purpose (e.g., contract for account operation; legitimate interest for safety; consent for marketing where applicable). Privacy notices must reflect these bases in clear language.\n\n### Cross-Border Data Transfers\n- Where personal data is transferred across borders, use valid transfer mechanisms recognized by the destination and origin jurisdictions and maintain records of such transfers and safeguards.\n\n### DPIA and Records of Processing\n- Conduct Data Protection Impact Assessments (DPIAs) for high-risk processing and maintain Records of Processing Activities (RoPA) at a level sufficient for regulatory inspection.\n\n### Minors and Age-Gating\n- The service is designed for civic discourse and may be restricted for minors based on jurisdictional requirements. Where participation by minors is permitted, verifiable parental consent must be in place if required by local law.\n\n### Election-Related Integrity and Transparency\n- For features involving political content classifications or labels, ensure transparency notices and access to corrective pathways (e.g., appeals, fact-check annotations) consistent with policy documents and applicable regulations.\n\n### EARS Requirements — Regulatory Compliance\n- THE civicDebateBoard SHALL maintain a privacy notice that lists processing purposes, lawful bases, categories of data, retention periods, and data sharing practices.\n- WHERE cross-border transfers occur, THE civicDebateBoard SHALL document the transfer mechanism and SHALL make a summary available upon request.\n- WHEN operating in jurisdictions requiring age-gating, THE civicDebateBoard SHALL restrict access by minors unless verifiable consent requirements are satisfied.\n- WHEN processing political or election-related content categories, THE civicDebateBoard SHALL present transparency labels and SHALL preserve a record of labeling and review actions.\n- WHERE processing presents high risk to individuals, THE civicDebateBoard SHALL conduct a DPIA before launch and SHALL document mitigations and residual risk.\n- THE civicDebateBoard SHALL maintain Records of Processing Activities sufficient to describe purposes, categories, recipients, transfers, and retention for each processing activity.\n\n## Third-Party and Integration Risk Management\nThird parties include analytics providers, email delivery services, identity verification services, and content safety partners. The service remains accountable for data shared with subprocessors.\n\n### Third-Party Onboarding and Oversight\n- Due diligence must evaluate data protection posture, contractual commitments, breach history, and data locality. Data processing agreements must be in place when personal data is processed on behalf of civicDebateBoard.\n\n### Data Sharing Minimization and Controls\n- Share only the minimum personal data necessary for the stated purpose. Prohibit third parties from selling, reusing, or combining personal data for unrelated purposes.\n\n### Subprocessor Registry and Notifications\n- Maintain a public-facing list of subprocessors that handle personal data and provide advance notice of material changes where legally required.\n\n### Reassessment Cadence and Termination\n- Reassess critical subprocessors at least annually and upon material change; ensure secure data return or deletion upon termination.\n\n### EARS Requirements — Third-Party Risk\n- WHEN engaging a new third party that processes personal data, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document a due diligence assessment prior to activation.\n- WHERE a third party is no longer necessary, THE civicDebateBoard SHALL terminate data flows and SHALL ensure data return or deletion as contractually required within 30 days.\n- IF a third party reports a breach impacting civicDebateBoard data, THEN THE civicDebateBoard SHALL trigger the incident response process and SHALL assess notification obligations.\n- THE civicDebateBoard SHALL maintain and publish a current subprocessor list that includes categories of services and data types processed.\n- THE civicDebateBoard SHALL reassess critical subprocessors at least annually and SHALL record reassessment outcomes and follow-ups.\n\n## Governance and Privacy-by-Design\nGovernance embeds privacy and security into the lifecycle of features and operations.\n\n### Privacy-by-Design Checkpoints\n- Kickoff: Define purposes, lawful bases, data minimization strategies, and retention for new features.\n- Pre-Launch: Complete DPIA where required, finalize disclosures and consent flows, confirm role-based access, validate audit events.\n- Post-Launch: Monitor KPIs and incidents, review data retention alignment, and adjust controls as needed.\n\n### Training and Awareness\n- Annual training for all staff; enhanced training for moderators, admins, and engineers who handle personal data.\n\n### Access Governance\n- Joiner-Mover-Leaver process to ensure timely provisioning and deprovisioning of access based on role changes.\n\n### De-Identification and Re-Identification Prohibition\n- De-identified data must be managed to prevent re-identification, and any attempt to re-identify de-identified data is prohibited.\n\n### EARS Requirements — Governance\n- THE civicDebateBoard SHALL require privacy-by-design reviews at kickoff, pre-launch, and post-launch for features involving personal data.\n- WHEN a high-risk feature is proposed, THE civicDebateBoard SHALL mandate a DPIA and SHALL approve mitigations before launch.\n- THE civicDebateBoard SHALL require annual privacy training for all staff and enhanced training for roles with elevated data access.\n- WHEN an employee changes roles or leaves, THE civicDebateBoard SHALL adjust or revoke access within 24 hours and SHALL log the change.\n- THE civicDebateBoard SHALL prohibit re-identification of de-identified data and SHALL treat any detected attempt as a policy violation subject to sanction.\n\n## EARS-Formatted Compliance Requirements (Consolidated)\nThis section consolidates key testable requirements for verification. All descriptions use business language and keep EARS keywords in English.\n\n### Privacy and Consent\n- THE civicDebateBoard SHALL display purpose-specific privacy disclosures before any optional data collection.\n- WHEN consent is withdrawn, THE civicDebateBoard SHALL stop consent-based processing within 24 hours and SHALL record the withdrawal.\n- IF processing purposes change, THEN THE civicDebateBoard SHALL obtain renewed consent where consent is the legal basis.\n- WHERE a GPC signal is received, THE civicDebateBoard SHALL honor it as an opt-out of sale/share in applicable jurisdictions.\n\n### User Rights\n- WHEN a verified access request is received, THE civicDebateBoard SHALL fulfill it within legal timelines and SHALL log the fulfillment.\n- WHEN a verified deletion request is received, THE civicDebateBoard SHALL delete eligible data within 30 days and SHALL document exceptions.\n- IF verification fails for a rights request, THEN THE civicDebateBoard SHALL deny the request with a non-sensitive reason.\n- WHEN a portability request is verified, THE civicDebateBoard SHALL provide a structured export within legal timelines.\n- WHEN a restriction request is verified, THE civicDebateBoard SHALL prevent processing for the restriction duration except storage and legal obligations.\n- WHEN a user opts out of targeted advertising or sale/share, THE civicDebateBoard SHALL cease such processing within 15 days.\n\n### Security and Access Control\n- THE civicDebateBoard SHALL enforce least-privilege access for all roles and data categories.\n- WHEN a role changes, THE civicDebateBoard SHALL apply the new permissions immediately and SHALL invalidate inconsistent sessions.\n- IF brute-force indicators are detected, THEN THE civicDebateBoard SHALL throttle attempts and SHALL retain evidence for 12 months.\n- THE civicDebateBoard SHALL require annual training for personnel with access to personal data and SHALL record completion.\n- THE civicDebateBoard SHALL conduct quarterly privileged-access reviews and SHALL remove unnecessary access.\n\n### Audit and Accountability\n- THE civicDebateBoard SHALL record audit events with actor, role, action type, target category, timestamp, outcome, and correlation identifier.\n- IF unauthorized access to audit logs is attempted, THEN THE civicDebateBoard SHALL deny it and SHALL record the attempt.\n- WHILE an investigation is active, THE civicDebateBoard SHALL protect relevant logs from alteration or deletion.\n\n### Incident Response\n- WHEN an incident is detected, THE civicDebateBoard SHALL assess severity within defined SLAs and SHALL contain confirmed Sev 1 incidents within 4 hours.\n- IF personal data is exposed, THEN THE civicDebateBoard SHALL notify authorities within 72 hours where required and SHALL notify affected users without undue delay.\n- THE civicDebateBoard SHALL complete a post-incident review within 10 business days of containment.\n\n### Regulatory and Third-Party\n- WHERE data crosses borders, THE civicDebateBoard SHALL document transfer mechanisms and SHALL provide summaries upon request.\n- WHEN onboarding a personal-data processor, THE civicDebateBoard SHALL execute a data processing agreement and SHALL document due diligence.\n- IF a subprocessor incident impacts civicDebateBoard data, THEN THE civicDebateBoard SHALL activate incident response and SHALL evaluate notification duties.\n- THE civicDebateBoard SHALL reassess critical subprocessors at least annually and SHALL record outcomes.\n- WHERE processing is high-risk, THE civicDebateBoard SHALL conduct a DPIA before launch and SHALL document mitigations.\n\n## Appendices\n\n### Appendix A — Glossary (Business Terms)\n- Personal Data: Information relating to an identified or identifiable individual.\n- Consent: Freely given, specific, informed, and unambiguous indication of wishes by which the data subject signifies agreement to processing.\n- DSAR: Data Subject Access Request; includes access, correction, deletion, portability where applicable.\n- Legal Hold: A process that suspends routine deletion due to litigation, investigations, or regulatory obligations.\n- Subprocessor: A third party engaged to process personal data on behalf of the service.\n- GPC: Global Privacy Control; a browser-level signal indicating user opt-out of sale/share of personal data where applicable.\n- DPIA: Data Protection Impact Assessment; process to evaluate high-risk processing.\n- RoPA: Records of Processing Activities; a register of processing purposes, categories, and other required details.\n\n### Appendix B — Data Categories (Detailed Examples)\n- Account Data: email, display name, avatar reference, role, verification flags.\n- Content Data: posts, comments, reactions, bookmarks, follows, topics.\n- Security Data: login attempts, session metadata, password reset events, device revocations.\n- Moderation Data: reports, review decisions, sanctions, appeals, reinstatement status.\n- Analytics Data: aggregated usage metrics and de-identified trend summaries subject to consent where required.\n\n### Appendix C — Severity Matrix (Quick Reference)\n| Severity | Impact | Notification Expectation |\n|---------|--------|--------------------------|\n| Sev 1 | High risk to personal data | Authorities within 72 hours; users within 7 days |\n| Sev 2 | Medium risk or uncertain breach | Conditional per risk and law |\n| Sev 3 | Low risk or contained weakness | None unless required |\n\n---\nThis document provides business requirements only. All technical implementation decisions belong to the development team. Developers have full autonomy over architecture, APIs, and database design; this document describes WHAT the system must do, not HOW to build it."},{"reason":"Align revenue strategy, ethical analytics, and measurement with platform goals to guide ongoing optimization.","filename":"10-business-model-and-analytics.md","documentType":"business-model","outline":["Why This Service Exists (recap)","Revenue Strategy Options (ads, sponsorships, subscriptions) and Guardrails","User Acquisition and Growth Strategy","Analytics KPIs and Reporting Cadence","Content Quality and Community Health Metrics","Moderation and Safety Metrics","Governance for Data Use and Ethics","Success Metrics and Review Process"],"audience":"business stakeholders","keyQuestions":["How will the service sustain itself financially?","What KPIs define growth, engagement, and quality?","What governance ensures ethical data use?"],"detailLevel":"moderate detail","relatedDocuments":["01-service-vision-and-overview.md","06-functional-requirements.md","08-non-functional-requirements-and-slas.md"],"constraints":["Must define measurable KPIs and review cadence","Avoid technical analytics tooling specifications","Ensure alignment with privacy obligations"],"content":"# civicDebateBoard — Business Model and Analytics\n\nBusiness requirements only; all technical implementation decisions (architecture, APIs, data pipelines, analytics tooling, storage, dashboards) remain at the discretion of the development team. Describes WHAT outcomes must be achieved in business terms, not HOW to implement them.\n\n## 1) Why This Service Exists (recap)\n\ncivicDebateBoard improves the quality, transparency, and civility of online civic discourse. Structured discussions, fact-checking roles, and policy-aligned moderation workflows enable responsible debate on complex topics.\n\nDifferentiators\n- Role design that includes verifiedMember and factChecker to elevate credibility and timely corrections.\n- Measurable safety and transparency requirements that prioritize community health over raw engagement.\n- Governance for data use and analytics that protects privacy and democratic processes.\n\nAlignment with related documents\n- Strategic vision and scope: [Service Vision and Overview](./01-service-vision-and-overview.md).\n- Capabilities and constraints for user actions: [Functional Requirements](./06-functional-requirements.md).\n- Performance and availability expectations: [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md).\n\n## 2) Revenue Strategy Options and Guardrails\n\nSustainable monetization must never compromise civic integrity or user trust. Approaches may be combined under strict guardrails.\n\n### 2.1 Advertising (Contextual, Non-Microtargeted)\n- Contextual placements adjacent to topics; never embedded within arguments to avoid misattribution.\n- No behavioral microtargeting based on sensitive attributes or political beliefs.\n- Frequency caps and clear, persistent disclosures for paid placements.\n\nEARS Requirements — Advertising\n- THE civicDebateBoard SHALL label paid placements with an unambiguous disclosure visible wherever the placement appears.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL apply a per-user daily impression cap of 3 impressions per unique campaign.\n- WHERE advertising is enabled, THE civicDebateBoard SHALL prohibit targeting based on sensitive attributes including political affiliation, religion, health status, or inferred beliefs.\n- IF a paid placement conflicts with safety policies (misinformation, hate speech, election manipulation), THEN THE civicDebateBoard SHALL reject the placement and provide a categorical reason to the advertiser.\n- WHEN a user opts out of personalized ads, THE civicDebateBoard SHALL restrict ad selection to contextual signals and record the consent state for compliance reporting.\n- WHILE a political event moratorium (election blackout) is active, THE civicDebateBoard SHALL disable new political ad activations and freeze existing political campaigns.\n- WHERE an ad appears near user-generated content, THE civicDebateBoard SHALL ensure adjacency rules avoid implying endorsement by the adjacent author.\n\n### 2.2 Sponsorships (Topic, Series, or Event-Based)\n- Brand sponsorship of topic hubs, expert AMAs, or fact-checking series with guardrails to prevent editorial interference.\n- Sponsors may fund public-interest fact-checking efforts without control over outcomes.\n\nEARS Requirements — Sponsorships\n- THE civicDebateBoard SHALL disclose sponsor identity on all sponsored surfaces associated with the sponsor.\n- WHERE a content area is sponsored, THE civicDebateBoard SHALL prevent sponsor accounts from editing or removing user content or fact-check annotations.\n- IF a sponsor attempts to influence moderation or fact-check outcomes, THEN THE civicDebateBoard SHALL document the attempt and escalate to policy governance for review.\n- WHEN a sponsored AMA is scheduled, THE civicDebateBoard SHALL present sponsorship disclosure on the announcement and session surfaces throughout the campaign.\n- WHERE a sponsor has a direct stake in a topic (e.g., active lobbying), THE civicDebateBoard SHALL display a conflict-of-interest label on sponsored surfaces for that topic.\n\n### 2.3 Subscriptions (Member-Supported)\n- Optional subscriptions for power users and institutions: reduced ads, advanced topic insights, and support for fact-checking capacity.\n- No paywalling of core civic participation (reading, posting, voting) to preserve accessibility.\n\nEARS Requirements — Subscriptions\n- THE civicDebateBoard SHALL keep core participation features (reading, posting, voting, reporting) accessible without payment.\n- WHERE subscriptions are active, THE civicDebateBoard SHALL present a clear list of benefits before purchase and on the account page thereafter.\n- IF payment fails or a subscription lapses, THEN THE civicDebateBoard SHALL revert benefits within 24 hours and retain access to core participation features.\n- WHEN a user cancels a subscription, THE civicDebateBoard SHALL stop future billing immediately and retain benefits until the end of the current paid period.\n- WHERE institutional subscriptions are active, THE civicDebateBoard SHALL allow assignment and revocation of seats without affecting user data ownership or posting history.\n- WHERE subscription benefits include reduced ad load, THE civicDebateBoard SHALL cap ad frequency at 0–1 per day per user under the plan.\n\n### 2.4 Grants and Public-Interest Funding\n- Eligibility for grants from foundations and civic institutions to support fact-checking, moderation research, or community education.\n\nEARS Requirements — Grants\n- WHEN grant funding is received for a public-interest initiative, THE civicDebateBoard SHALL separate editorial decision-making from grant reporting structures.\n- WHERE a grant imposes transparency obligations, THE civicDebateBoard SHALL publish required acknowledgments on relevant program pages.\n\n### 2.5 General Monetization Guardrails\n- No sale or licensing of personal data; revenue must not depend on data brokerage.\n- Monetization experiments must pass policy, privacy, and ethics review before launch.\n- No pay-for-reach or pay-to-amplify mechanics in civic discourse.\n\nEARS Requirements — Monetization Guardrails\n- THE civicDebateBoard SHALL refrain from selling or licensing personal data to third parties for unrelated purposes.\n- WHEN launching a monetization experiment, THE civicDebateBoard SHALL require prior governance approval with documented objectives, metrics, and guardrails.\n- IF revenue objectives conflict with safety or integrity metrics, THEN THE civicDebateBoard SHALL prioritize safety and integrity and pause the conflicting initiative.\n- WHERE revenue content intersects with political topics, THE civicDebateBoard SHALL apply election-period restrictions and conflict-of-interest disclosures.\n\n## 3) User Acquisition and Growth Strategy\n\nGrowth emphasizes trust, transparency, and utility over vanity metrics.\n\nTactics\n- Partnerships with civic organizations, universities, and local newsrooms to onboard verifiedMember contributors and host educational threads.\n- Invitation flows and topic follows that return participants to relevant debates without spam or dark patterns.\n- Recognition for high-quality contributions over quantity (e.g., helpfulness signals, accepted corrections).\n\nEARS Requirements — Growth\n- THE civicDebateBoard SHALL prohibit dark patterns (confusing consent, disguised ads, forced continuity) in acquisition or retention flows.\n- WHEN a user invites a contact, THE civicDebateBoard SHALL send a single, clearly labeled invitation and SHALL not re-message the contact without explicit consent.\n- WHERE growth notifications are enabled, THE civicDebateBoard SHALL limit notification sends to a maximum of 2 per user per day and SHALL include a one-click opt-out per category.\n- IF a partner’s onboarding content violates safety policies, THEN THE civicDebateBoard SHALL remove the content and notify the partner with policy references.\n- WHEN a verifiedMember application is approved per policy criteria, THE civicDebateBoard SHALL elevate the account and adjust rate limits within 1 hour.\n- WHERE referral programs operate, THE civicDebateBoard SHALL cap referral benefits to prevent spam incentives and SHALL revoke benefits for abuse.\n\nFunnel Metrics (targets; monitor monthly)\n- Visitor-to-registration conversion: ≥ 15% (Amber: 10–14%; Red: < 10%).\n- Registration-to-activation (first post or comment within 7 days): ≥ 60% (Amber: 45–59%; Red: < 45%).\n- Activation-to-30d retention: ≥ 20% (Amber: 15–19%; Red: < 15%).\n\n## 4) Analytics KPIs and Reporting Cadence\n\nKPI definitions measure growth, engagement, quality, safety, and revenue while honoring privacy and consent. Metrics are aggregated with data minimization; sensitive data is excluded or aggregated as required.\n\nEARS Requirements — Analytics and Reporting\n- THE civicDebateBoard SHALL maintain a weekly operational report covering growth, engagement, quality, safety, and monetization KPIs with owner accountability.\n- WHEN a KPI crosses an alert threshold, THE civicDebateBoard SHALL create an incident entry in the business review log within 24 hours and assign a responsible owner.\n- WHERE consent is required for analytics, THE civicDebateBoard SHALL exclude non-consenting users from analytics cohorts and annotate reports accordingly.\n- IF a metric requires sensitive data to compute, THEN THE civicDebateBoard SHALL use a privacy-preserving aggregate or omit the metric and document the omission.\n- WHERE a KPI definition changes, THE civicDebateBoard SHALL version the definition and annotate trend breaks in the next report.\n\nKPI Catalog and Targets (formulas and targets)\n\n| KPI | Business Definition | Formula (business-level) | Target (Green) | Alert Threshold (Amber/Red) | Required Breakdowns | Owner | Cadence |\n|-----|---------------------|---------------------------|----------------|------------------------------|---------------------|-------|---------|\n| Monthly Active Users (MAU) | Unique authenticated users active in a calendar month | Count of unique users with ≥1 session | ≥ 100,000 | Amber: < 80,000; Red: < 60,000 | Role, region, acquisition source | Growth Lead | Monthly |\n| Daily Active Users (DAU) | Unique authenticated users active on a given day | Count of unique users with ≥1 session | DAU/MAU ≥ 40% | Amber: 30–39%; Red: < 30% | Role, topic category | Growth Lead | Daily |\n| New Registrations | Accounts created | Count of new accounts | ≥ 15,000/mo | Amber: < 10,000; Red: < 7,000 | Source, region | Growth Lead | Weekly |\n| Activation Rate | New users who complete first post or comment within 7 days | Activated users / new registrations | ≥ 60% | Amber: 45–59%; Red: < 45% | Role, source | Product Lead | Weekly |\n| 7-Day Retention | New users active 7 days after registration | Returners day 7 / new registrations | ≥ 35% | Amber: 25–34%; Red: < 25% | Role, source | Product Analytics | Weekly |\n| 30-Day Retention | New users active 30 days after registration | Returners day 30 / new registrations | ≥ 20% | Amber: 15–19%; Red: < 15% | Role, source | Product Analytics | Monthly |\n| Posts per Active Member | Average posts per DAU | Posts / DAU | 0.20–0.35 | Amber: < 0.15; Red: < 0.10 | Role, topic | Community Ops | Weekly |\n| Comments per Post | Average comments per post within 7 days | Comments within 7d / posts | ≥ 3.0 | Amber: 2.0–2.9; Red: < 2.0 | Topic, author role | Community Ops | Weekly |\n| Net Helpfulness Score | Net helpfulness per post over 7 days | Helpful minus unhelpful reactions | ≥ +1.0 | Amber: 0.0–0.9; Red: < 0 | Topic, role, verification | Community Ops | Weekly |\n| Fact-Check Coverage | Flagged claims annotated within 24h | Annotated claims / flagged claims | ≥ 90% | Amber: 80–89%; Red: < 80% | Topic, severity | Policy Lead | Weekly |\n| Correction Adoption Rate | Accepted corrections visible within 24h | Corrected content / content requiring correction | ≥ 85% | Amber: 70–84%; Red: < 70% | Topic, role | Policy Lead | Weekly |\n| Time to First Moderator View (Critical) | Minutes from critical report to first moderator view | Minutes elapsed from report creation | ≤ 30 min | Amber: 31–60; Red: > 60 | Severity, time of day | Safety Lead | Daily |\n| Report Review SLA (Standard) | Hours to decision for standard reports | Hours elapsed from report creation | ≤ 24 h | Amber: 25–48; Red: > 48 | Category, team | Safety Lead | Daily |\n| False Positive Rate (Moderation) | Sanctions overturned on appeal | Overturned / total sanctions | ≤ 5% | Amber: 5.1–8%; Red: > 8% | Category, team | Safety QA | Monthly |\n| Re-offense Rate | Sanctioned users who re-offend within 60 days | Re-offenders / sanctioned users | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Category, sanction | Safety QA | Monthly |\n| Subscription Conversion | Eligible users starting paid plan within 30 days | New subscribers / eligible users | ≥ 2.5% | Amber: 1.5–2.4%; Red: < 1.5% | Role, region | Monetization Lead | Monthly |\n| ARPPU | Average revenue per paying user per month | Revenue from paid users / count of paid users | ≥ $8.00 | Amber: $6.00–7.99; Red: < $6.00 | Plan type, region | Finance | Monthly |\n| Ad Fill Rate | Served ad impressions / eligible ad opportunities | Impressions served / eligible opportunities | ≥ 85% | Amber: 70–84%; Red: < 70% | Context, region | Monetization Lead | Weekly |\n| Ad Frequency (per user/day) | Average ads per eligible user per day | Ads / eligible user-days | ≤ 2.0 | Amber: 2.1–3.0; Red: > 3.0 | Role, region | Monetization Lead | Weekly |\n| Opt-out Rate (Personalized Ads) | Users opting out of personalized ads | Opt-outs / active users | ≤ 10% | Amber: 10.1–15%; Red: > 15% | Region | Privacy Lead | Monthly |\n| Consent Coverage | Active users with recorded analytics consent state | Users with consent state / active users | 100% | Amber: 98–99.9%; Red: < 98% | Region | Privacy Lead | Monthly |\n\nReporting Cadence\n- Weekly Ops Review: Growth, engagement, quality, safety, revenue highlights; action items with owners and due dates.\n- Monthly Business Review: Trend analysis, budget vs. actuals, experiment outcomes, compliance review notes.\n- Quarterly Strategy Review: Deep-dive on mission metrics, risks, policy landscape, and roadmap adjustments.\n\nKPI Governance\n- THE civicDebateBoard SHALL maintain a metric registry with owner, purpose, definition, lawful basis/consent status, retention period, and version history.\n- WHEN a KPI definition changes, THE civicDebateBoard SHALL mark a trend break and attach the new definition version to subsequent reports.\n- WHERE a metric is deprecated, THE civicDebateBoard SHALL archive its definition and rationale in the registry.\n\n## 5) Content Quality and Community Health Metrics\n\nQuality and health take precedence over volume. Metrics emphasize constructive engagement and corrective transparency.\n\nEARS Requirements — Quality and Health\n- THE civicDebateBoard SHALL compute quality metrics using privacy-preserving aggregates and SHALL avoid tracking users across unrelated contexts.\n- WHEN a topic’s Net Helpfulness Score remains below 0 for seven consecutive days, THE civicDebateBoard SHALL trigger a community health review with proposed remediation actions.\n- WHERE factChecker coverage falls below the alert threshold, THE civicDebateBoard SHALL prioritize recruitment or scheduling for fact-checking resources in the affected topics.\n- IF a content area exhibits repeated misinformation patterns, THEN THE civicDebateBoard SHALL introduce friction measures (pre-post reminders, source citation prompts) consistent with policy.\n- WHEN verifiedMember posts include expert tags, THE civicDebateBoard SHALL present expert context labels to readers.\n\nAdditional Health Metrics and Definitions\n- Civility Incident Rate: ≤ 1.5% of posts flagged for civility violations per week. Definition: number of posts flagged for civility divided by total posts that week.\n- Repeat Correction Visibility: ≥ 95% of accepted corrections remain visible on original content indefinitely. Definition: corrected items with visible corrections / total corrected items.\n- Topic Diversity Index: ≥ 0.65 across top 20 topics by volume each quarter. Definition: normalized Shannon diversity index on topic distribution.\n- Constructive Participation Ratio: ≥ 85% of comments pass civility and relevance checks in monitored threads (Amber: 75–84%; Red: < 75%).\n\n## 6) Moderation and Safety Metrics\n\nSafety protects discourse quality and user well-being.\n\nEARS Requirements — Moderation and Safety\n- THE civicDebateBoard SHALL prioritize critical severity reports to the front of the queue and SHALL meet the Time to First Moderator View target.\n- WHEN a sanction is issued, THE civicDebateBoard SHALL present the policy citation and evidence links to the user at enforcement time.\n- WHERE sanctions include temporary restrictions, THE civicDebateBoard SHALL automatically restore privileges upon expiry without further user action.\n- IF an appeal is submitted within the allowed window, THEN THE civicDebateBoard SHALL review and decide within 72 hours and SHALL notify the appellant of the outcome and rationale.\n- WHEN a moderator action is overturned, THE civicDebateBoard SHALL update the audit trail and recalculate related metrics within 24 hours.\n\nSafety SLA Targets\n- Critical Harms (doxxing, threats): First view ≤ 30 minutes; decision ≤ 2 hours.\n- Standard Reports: Decision ≤ 24 hours.\n- Appeals: Decision ≤ 72 hours; overturn rate ≤ 5%.\n- Harm Escalation Rate: ≤ 2% of unresolved P1 items escalate to P0 within 12 hours.\n\n## 7) Governance for Data Use and Ethics\n\nGovernance ensures analytics and monetization respect privacy, comply with policy, and preserve civic integrity. Applies to product, monetization, policy, and research uses of data.\n\nPrinciples\n- Data minimization and purpose limitation for analytics and monetization.\n- Transparency in user disclosures for ads, sponsorships, and data use.\n- No sale of personal data; no political microtargeting based on sensitive attributes.\n\nEARS Requirements — Governance\n- THE civicDebateBoard SHALL maintain a register of analytics metrics with documented purpose, lawful basis or consent requirement, and retention period.\n- WHEN a new metric or experiment requires additional data collection, THE civicDebateBoard SHALL conduct a privacy impact assessment and obtain governance approval before launch.\n- WHERE user consent is withdrawn, THE civicDebateBoard SHALL exclude the user’s data from future analytics and SHALL remove the user from longitudinal cohorts within 7 days where legally feasible.\n- IF an ethics or compliance breach is suspected, THEN THE civicDebateBoard SHALL initiate an incident review within 24 hours and SHALL notify relevant stakeholders per compliance requirements.\n- WHILE a government election moratorium period is active, THE civicDebateBoard SHALL disable political audience refinements and SHALL restrict political ad activations.\n- WHERE a KPI or experiment materially affects user rights or safety SLAs, THE civicDebateBoard SHALL escalate to policy governance for pre-approval.\n\nExperimentation Policy\n- Pre-registration: hypothesis, metrics (including safety guardrails), eligibility, duration, and stop criteria recorded in the experiment registry.\n- Exposure limits: per-user cap of concurrent experiments (e.g., maximum 3) and maximum duration (e.g., 6 weeks) to reduce fatigue and risk.\n- Safety guardrails: experiments must not degrade safety metrics beyond predefined bounds (e.g., no more than +10% P1 incidents vs. control).\n\nEARS Requirements — Experimentation\n- THE civicDebateBoard SHALL require experiment pre-registration including objectives, primary/secondary metrics, and safety guardrails.\n- WHEN an experiment begins, THE civicDebateBoard SHALL create a holdback/control cohort and SHALL enforce exposure caps per user.\n- IF safety guardrails breach (e.g., P1 incidents +10% vs. control), THEN THE civicDebateBoard SHALL pause the experiment within 24 hours and initiate a review.\n- WHERE experiments affect monetization exposure (ads, sponsorships), THE civicDebateBoard SHALL verify compliance with advertising and sponsorship guardrails before launch.\n- WHEN an experiment concludes, THE civicDebateBoard SHALL publish a summary with metric outcomes and decisions in the experiment registry.\n\nAccess Governance and Data Ethics\n- Role-based data access for analytics respecting least-privilege; aggregated outputs for general stakeholders.\n- Retention for analytics datasets aligned to the metric registry; avoid indefinite retention without purpose.\n\nGovernance Process Flow\n\n```mermaid\ngraph LR\n  A[\"Propose Metric/Experiment\"] --> B[\"Document Purpose & Data Needs\"]\n  B --> C[\"Privacy Impact Assessment\"]\n  C --> D{\"Approval?\"}\n  D -->|\"Yes\"| E[\"Launch with Guardrails\"]\n  D -->|\"No\"| F[\"Revise or Reject\"]\n  E --> G[\"Monitor KPIs & Thresholds\"]\n  G --> H{\"Any Breach or Threshold Crossed?\"}\n  H -->|\"Yes\"| I[\"Incident Review & Mitigation\"]\n  H -->|\"No\"| J[\"Continue & Schedule Review\"]\n```\n\nExperiment Lifecycle (illustrative)\n\n```mermaid\ngraph LR\n  X1[\"Pre-Register Hypothesis\"] --> X2[\"Define Success & Safety Bounds\"]\n  X2 --> X3[\"Governance Approval\"]\n  X3 --> X4[\"Launch & Assign Cohorts\"]\n  X4 --> X5{\"Guardrails Breached?\"}\n  X5 -->|\"Yes\"| X6[\"Pause & Review\"]\n  X5 -->|\"No\"| X7[\"Run to Completion\"]\n  X6 --> X8[\"Decide: Modify or Terminate\"]\n  X7 --> X9[\"Analyze & Publish Results\"]\n```\n\nRoles and Responsibilities\n- Policy Governance: Approvals, moratorium calendars, ethics reviews.\n- Privacy Lead: Consent frameworks, retention, cohort exclusions.\n- Product Analytics: KPI catalog integrity, reporting cadences, experiment registry.\n- Monetization Lead: Revenue experiments, guardrails, sponsorship/ads compliance.\n\n## 8) Success Metrics and Review Process\n\nSuccess spans mission impact, sustainable revenue, and community safety. Reviews drive continuous improvement with ethical guardrails.\n\nMission and Platform Success Metrics (Annual Targets)\n- Mission Integrity Index (composite of civility, correction adoption, misinformation mitigation): ≥ 75/100.\n- Community Trust (periodic survey): ≥ 70/100 with ≤ 5-point variance across major regions.\n- Sustainable Revenue Mix: ≥ 40% subscriptions/sponsorships, ≤ 60% ads.\n- Safety Assurance: Meet or exceed all safety SLAs ≥ 95% of the time.\n- Experiment Quality Index: ≥ 80/100 weighted by pre-registration, guardrail adherence, and publication completeness.\n\nEARS Requirements — Reviews and Decision-Making\n- THE civicDebateBoard SHALL conduct a Weekly Ops Review with published notes, KPI deltas, and assigned actions.\n- WHEN a KPI remains in Red for two consecutive periods, THE civicDebateBoard SHALL initiate a corrective action plan with owner, deadline, and expected impact.\n- WHERE a revenue initiative degrades the Mission Integrity Index by ≥ 3 points in a month, THE civicDebateBoard SHALL pause the initiative and present a remediation plan before resuming.\n- IF quarterly targets are not met for two consecutive quarters, THEN THE civicDebateBoard SHALL run a strategy reset workshop including policy, safety, product, and finance leadership.\n- WHILE a corrective action plan is active, THE civicDebateBoard SHALL track leading indicators weekly and SHALL escalate if no improvement is observed within 3 weeks.\n\nReview Artifacts and Cadence\n- Weekly Ops Review: Dashboard snapshot, exceptions, actions (owners, due dates).\n- Monthly Business Review: Trend narratives, budget outcomes, experiment registry updates, compliance annotations.\n- Quarterly Strategy Review: OKR scorecards, policy landscape analysis, risk/contingency updates, revenue mix assessment.\n\nRisk Triggers and Contingencies\n- WHERE MAU falls below 60,000 for two months, THE civicDebateBoard SHALL prioritize retention initiatives over acquisition experiments for the next quarter.\n- WHERE False Positive Rate exceeds 8% in a month, THE civicDebateBoard SHALL conduct a moderation QA calibration within 14 days.\n- WHERE Opt-out Rate for personalized ads exceeds 15% in any region, THE civicDebateBoard SHALL limit personalization levers and review disclosure clarity within 30 days.\n\n## Appendices\n\nA. Privacy and Non-Functional Alignment\n- Requirements align with consent expectations in the [Non-Functional Requirements and SLAs](./08-non-functional-requirements-and-slas.md). Any analytics requiring consent must honor consent state and applicable regulations without exception.\n\nB. Business-Only Scope\n- Business objectives, measurable KPIs, ethical guardrails, and review cadences are specified. Technical implementation (data models, API design, analytics tools, storage, dashboarding) remains at the development team’s discretion.\n\nC. Role Considerations for Metrics\n- member: Included in growth and engagement KPIs; standard rate limits apply.\n- verifiedMember: Segmented in quality metrics and expert-tag analyses; adjusted rate limits per policy.\n- factChecker: Tracked for fact-check coverage and correction adoption; no sanction authority.\n- moderator: Accountable for safety SLAs and appeal turnaround.\n- admin: Accountable for governance approvals, monetization guardrails, and cross-functional reviews.\n"}],"step":0,"elapsed":553110,"created_at":"2025-08-15T02:44:06.879Z"},"tokenUsage":{"aggregate":{"total":1097461,"input":{"total":939408,"cached":19328},"output":{"total":158053,"reasoning":49344,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2822,"input":{"total":2307,"cached":0},"output":{"total":515,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":1094639,"input":{"total":937101,"cached":19328},"output":{"total":157538,"reasoning":48960,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}}]