[{"event":{"type":"analyzeStart","reason":"User requested a minimal Todo list application and delegated all decisions. Generate a comprehensive requirements analysis report with minimal viable features, user roles, data model, business rules, and APIs suitable for a simple Todo app.","step":0,"created_at":"2025-08-15T03:49:52.237Z"},"tokenUsage":{"aggregate":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeScenario","prefix":"todoApp","language":"en-US","roles":[{"name":"user","description":"Authenticated end user who manages only their own todo items and account. Can create, read, update, complete, and delete personal tasks. Cannot access or modify other users’ data."},{"name":"admin","description":"Administrative user with full authority to oversee the service. Can manage any user account when necessary for support or policy enforcement, access aggregated analytics, enforce content policies, and configure service-wide settings."}],"files":[{"reason":"Provide a single entry point that lists and links all planning documents. Sets reading order and ensures navigation consistency across the project.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","How to Use This Documentation","Table of Contents (with descriptive links)","Document Maintenance Policy"],"audience":"general","keyQuestions":["What documents exist for this project?","How should readers navigate them in the correct order?"],"detailLevel":"high-level overview","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","04-todoApp-user-stories-and-personas.md","05-todoApp-user-flows.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Must include descriptive relative links to each listed document using the document title as link text","Must place the specified Developer Note blockquote at the very end exactly as provided","Must not include technical implementation details, API specs, or database schemas"]},{"reason":"Establish vision, scope, and business model for the minimal Todo service to align stakeholders before detailing requirements.","filename":"01-todoApp-service-overview.md","documentType":"service-overview","outline":["Executive Summary","Problem Definition and Market Gap","Target Users","Core Value Proposition","Service Scope and Out-of-Scope","Business Model","Why This Service Exists","Revenue Strategy","Growth Plan","Success Metrics and KPIs","Assumptions and Dependencies","Glossary of Terms"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who is the target user and what value is delivered?","What scope is included for the minimal viable Todo service?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Focus on business goals and outcomes only","Avoid technical implementation details entirely","Define clear success metrics aligned with business value"]},{"reason":"Define complete authentication behaviors, role hierarchy, and permissions so access rules are unambiguous from a business perspective.","filename":"02-todoApp-user-roles-and-authentication.md","documentType":"requirement","outline":["Purpose and Scope","Authentication Requirements","Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)","User Role Structure","Role Definitions and Capabilities","Permission Matrix (actions by role)","Session and Token Management (business rules for token lifetimes and refresh)","Access Control Rules and Examples (EARS format)","Account Lifecycle (creation, verification, suspension, deletion)","Security and Privacy Considerations","Audit and Activity Logging (business expectations)"],"audience":"development team","keyQuestions":["What roles exist and what can each do?","What authentication features are available to users?","How are sessions and tokens managed from a business standpoint?","What are the access control rules and edge cases?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Include a clear permission matrix table by role","Write all applicable requirements in EARS format","Describe token management in business terms without API-level specifications","Do not include API endpoints, database schema, or technical architecture"]},{"reason":"Capture the minimum functional scope for a Todo list and write testable business requirements for developers.","filename":"03-todoApp-functional-requirements.md","documentType":"requirement","outline":["Overview of Minimal Feature Set","Todo Item Management (Create, Read, Update, Delete)","Completion and Reopening of Items","Optional Attributes (description, due date)","Filtering and Sorting (business expectations)","Time Zone and Localization Behaviors","Data Ownership and Privacy Rules","Import/Export and Data Portability (optional)","Business Constraints and Limits","Acceptance Criteria (EARS format)"],"audience":"development team","keyQuestions":["What minimum features must the Todo service support?","What fields are required for a todo item and what validations apply?","How should filtering and sorting work from a business perspective?","What are the acceptance criteria for the MVP scope?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS format wherever applicable","Do not define any API endpoints or database schemas","Keep scope minimal while ensuring a complete, usable product"]},{"reason":"Describe who uses the system and the primary/secondary scenarios to guide requirement prioritization and testing.","filename":"04-todoApp-user-stories-and-personas.md","documentType":"user-story","outline":["Personas","Primary Scenarios (Happy Paths)","Secondary Scenarios and Edge Cases","Role-based Scenarios (user, admin)","Acceptance Tests in Natural Language (EARS where applicable)","Success Indicators per Scenario"],"audience":"product managers","keyQuestions":["Who are the typical users of this service?","What scenarios are most critical to support?","What edge cases must be considered for MVP?"],"detailLevel":"moderate detail","relatedDocuments":["03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["Avoid UI/UX design details and screen layouts","Use natural language and business logic only","Write acceptance tests in EARS where possible"]},{"reason":"Provide clear, visual business flows for key processes to reduce ambiguity and align teams.","filename":"05-todoApp-user-flows.md","documentType":"user-flow","outline":["Flow Diagram Conventions","Authentication Flow (register, login, reset)","Todo Item Lifecycle Flow (create, update, complete, delete)","Error and Recovery Flow","State Model for Todo Items","Narrative Descriptions of Each Flow"],"audience":"development team","keyQuestions":["What are the step-by-step flows for core processes?","Where do decisions occur and what are the expected outcomes?"],"detailLevel":"moderate detail","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["All diagrams must follow the Mermaid rules provided (double quotes for labels, correct arrows)","Use graph LR orientation for readability","Do not include technical architecture diagrams or API sequence diagrams"]},{"reason":"Codify validation rules, constraints, and state logic to ensure consistent handling across all features.","filename":"06-todoApp-business-rules.md","documentType":"requirement","outline":["Purpose and Scope","Terminology and States","Todo Item Validation Rules","Ownership and Access Rules","Rate Limits and Operational Constraints (business-level)","Retention and Deletion Rules","Time Zone and Date Handling Rules","Rule Conflict Resolution and Precedence","Traceability to Functional Requirements"],"audience":"development team","keyQuestions":["What validations apply to todo items and accounts?","What limits, if any, exist for operations?","How are conflicts in rules resolved?"],"detailLevel":"detailed specification","relatedDocuments":["03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md"],"constraints":["Express rules in testable, measurable terms (use EARS where applicable)","Avoid any database, API, or technical design details"]},{"reason":"Define user-facing error conditions and recovery paths to create predictable behavior under failure.","filename":"07-todoApp-error-handling-and-exception-scenarios.md","documentType":"requirement","outline":["Error Taxonomy (Authentication, Authorization, Validation, Not Found, Conflict, Rate Limit, Service Unavailable)","User-Facing Messages and Guidance","Recovery and Retry Policies","Conflict Resolution for Concurrent Updates (business perspective)","Audit and Monitoring Expectations (business-level)","EARS-Formatted Error Requirements and Acceptance Criteria"],"audience":"development team","keyQuestions":["What errors can occur and how should the system respond for the user?","How can users recover or proceed after an error?","What monitoring is expected from a business standpoint?"],"detailLevel":"detailed specification","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS for all error and exception requirements","Do not reference HTTP codes or API responses; keep user-focused","No technical implementation details"]},{"reason":"Set performance, security, privacy, reliability, and compliance expectations in user terms.","filename":"08-todoApp-non-functional-requirements.md","documentType":"requirement","outline":["Performance and Responsiveness Expectations","Security and Privacy Principles","Availability and Reliability Expectations","Scalability Expectations","Compliance and Legal Considerations","Operational Monitoring and Alerting (business expectations)","Non-Functional Acceptance Criteria (EARS)"],"audience":"development team","keyQuestions":["What performance is expected for core operations?","What security and privacy standards must be met?","What availability and reliability targets apply?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["State measurable targets in user terms (e.g., within N seconds)","Avoid technology choices or architectural prescriptions","Use EARS for acceptance criteria"]},{"reason":"Describe how information conceptually moves through its lifecycle and the related privacy requirements.","filename":"09-todoApp-data-lifecycle-and-privacy.md","documentType":"requirement","outline":["Conceptual Data Flow Overview (business-level)","Data Creation, Update, and Deletion Lifecycle","Retention and Purging Policies","User-Controlled Export/Portability (optional)","Privacy-by-Design Principles","Data Minimization and Purpose Limitation","Right to Erasure and Account Deletion Behaviors","Traceability to Business Rules and Non-Functional Requirements"],"audience":"development team","keyQuestions":["How is user data handled from creation to deletion?","What privacy safeguards are required across the lifecycle?"],"detailLevel":"moderate detail","relatedDocuments":["06-todoApp-business-rules.md","08-todoApp-non-functional-requirements.md"],"constraints":["Keep descriptions conceptual; do not define database schemas or storage technologies","Use EARS for lifecycle requirements where applicable"]},{"reason":"Define go-live readiness, measurable acceptance criteria, and success metrics to align delivery and evaluation.","filename":"10-todoApp-acceptance-criteria-and-success-metrics.md","documentType":"requirement","outline":["Release Readiness Checklist","MVP Acceptance Criteria (EARS)","Post-Launch Monitoring Plan (business-level)","User Satisfaction and Support Plan","Success Metrics and Reporting Cadence","Risks and Mitigations"],"audience":"business stakeholders","keyQuestions":["What constitutes acceptance for MVP release?","How will success be measured after launch?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md"],"constraints":["Acceptance criteria must be specific, measurable, and testable (EARS)","No technical implementation details or API specifications"]}],"tokenUsage":{"total":23520,"input":{"total":16590,"cached":0},"output":{"total":6930,"reasoning":4224,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"created_at":"2025-08-15T03:49:52.242Z"},"tokenUsage":{"aggregate":{"total":26304,"input":{"total":18927,"cached":0},"output":{"total":7377,"reasoning":4608,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":23520,"input":{"total":16590,"cached":0},"output":{"total":6930,"reasoning":4224,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Provide a single entry point that lists and links all planning documents. Sets reading order and ensures navigation consistency across the project.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","How to Use This Documentation","Table of Contents (with descriptive links)","Document Maintenance Policy"],"audience":"general","keyQuestions":["What documents exist for this project?","How should readers navigate them in the correct order?"],"detailLevel":"high-level overview","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","04-todoApp-user-stories-and-personas.md","05-todoApp-user-flows.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Must include descriptive relative links to each listed document using the document title as link text","Must place the specified Developer Note blockquote at the very end exactly as provided","Must not include technical implementation details, API specs, or database schemas"],"content":"# todoApp Planning Documentation - Table of Contents\n\nLast updated: 2025-08-15 (KST)\n\n## Document Purpose\nThis document is the single entry point for all planning artifacts of the todoApp service. It establishes the recommended reading order, provides descriptive links to each document, and aligns stakeholders on how to navigate the documentation set. These documents define business requirements, user scenarios, and process flows in natural language so that backend developers can implement with clarity while retaining full autonomy over technical decisions.\n\n## How to Use This Documentation\n- Start with the service overview to understand the vision, scope, and business model for todoApp. Then proceed to roles and authentication to ground access control concepts before reading the functional scope.\n- Follow the reading order below to reduce ambiguity and ensure terms, rules, and flows are interpreted consistently across teams.\n- Each link uses the document’s title as link text and points to a relative file in this folder for portability.\n- This documentation focuses on what the system must do from a business perspective. All architectural choices, API designs, and data modeling decisions remain with the development team.\n\n## Table of Contents (with descriptive links)\n1. [todoApp Service Overview](./01-todoApp-service-overview.md)\n   - Establishes vision, scope, and business model for the minimal Todo service; clarifies value proposition, target users, and success metrics.\n2. [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n   - Defines complete authentication behaviors, role hierarchy, and permissions in business terms; includes session and token management expectations and EARS-formatted access rules.\n3. [todoApp Functional Requirements (MVP)](./03-todoApp-functional-requirements.md)\n   - Captures the minimum functional scope for a Todo list with testable business requirements; covers CRUD for items, completion/reopening, filtering/sorting, localization, and acceptance criteria in EARS.\n4. [todoApp User Stories and Personas](./04-todoApp-user-stories-and-personas.md)\n   - Describes personas and primary/secondary scenarios to guide prioritization and testing; includes role-based scenarios and acceptance statements.\n5. [todoApp User Flows and Process Diagrams](./05-todoApp-user-flows.md)\n   - Provides visual business flows for core processes (authentication, item lifecycle, error and recovery) using Mermaid with LR orientation, plus narrative explanations.\n6. [todoApp Business Rules Specification](./06-todoApp-business-rules.md)\n   - Codifies validation rules, constraints, ownership rules, rate limits, retention, time zone handling, and rule precedence in measurable terms (EARS where applicable).\n7. [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n   - Defines user-facing error conditions, guidance, and recovery paths; covers conflicts, retries, monitoring expectations, and EARS-formatted error requirements.\n8. [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n   - Sets measurable expectations for performance, security, privacy, availability, scalability, compliance, and operational monitoring; includes EARS-based acceptance criteria.\n9. [todoApp Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md)\n   - Describes conceptual information lifecycle, retention and purging policies, portability options, privacy-by-design principles, and right-to-erasure behaviors.\n10. [todoApp Acceptance Criteria and Success Metrics](./10-todoApp-acceptance-criteria-and-success-metrics.md)\n    - Defines go-live readiness, MVP acceptance criteria (EARS), post-launch monitoring plan, user satisfaction approach, KPIs, and risk mitigations.\n\n### Recommended Reading Order and Rationale\n- Foundation: Service overview → roles and authentication → functional requirements. This sequence builds shared context, clarifies permissions, then defines scope.\n- Behavior Details: User stories/personas → user flows → business rules. These documents translate scope into concrete scenarios, visual flows, and enforceable rules.\n- Quality and Safety: Error handling → non-functional requirements. They define predictable failure behavior and measurable experience goals.\n- Lifecycle and Acceptance: Data lifecycle and privacy → acceptance criteria and success metrics. They cover responsible data handling and how delivery will be evaluated.\n\n### Role-Based Quick Paths\n- Business stakeholders: Service overview → acceptance criteria and success metrics.\n- Product managers: Service overview → functional requirements → user stories and personas → user flows.\n- Development team: Roles and authentication → functional requirements → business rules → error handling → non-functional requirements → data lifecycle and privacy.\n- QA and compliance: Business rules → error handling → non-functional requirements → data lifecycle and privacy → acceptance criteria and success metrics.\n\n## Document Maintenance Policy\n- Ownership: The product team curates business content; the development team may propose clarifications via change requests. A designated documentation owner is accountable for approvals and publication.\n- Update cadence: Update documents whenever scope, rules, or acceptance criteria change. The ToC must be updated immediately when documents are added, renamed, or deprecated.\n- Versioning and change log: Each document should maintain a change log section or commit history that describes what changed and why in business terms.\n- Link conventions: Use descriptive link text matching the document title in en-US; keep relative paths within this folder. Do not link to non-existent files.\n- Consistency and traceability: Keep terminology, states, and rule names consistent across documents. Cross-reference related sections using descriptive links where helpful.\n- Decommissioning: If a document is retired, update this ToC to remove the link and add a short note in the change log indicating the successor or reason for removal.\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*"},"tokenUsage":{"total":19657,"input":{"total":15537,"cached":7808},"output":{"total":4120,"reasoning":2496,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":1,"created_at":"2025-08-15T03:55:28.285Z"},"tokenUsage":{"aggregate":{"total":45961,"input":{"total":34464,"cached":7808},"output":{"total":11497,"reasoning":7104,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":43177,"input":{"total":32127,"cached":7808},"output":{"total":11050,"reasoning":6720,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Establish vision, scope, and business model for the minimal Todo service to align stakeholders before detailing requirements.","filename":"01-todoApp-service-overview.md","documentType":"service-overview","outline":["Executive Summary","Problem Definition and Market Gap","Target Users","Core Value Proposition","Service Scope and Out-of-Scope","Business Model","Why This Service Exists","Revenue Strategy","Growth Plan","Success Metrics and KPIs","Assumptions and Dependencies","Glossary of Terms"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who is the target user and what value is delivered?","What scope is included for the minimal viable Todo service?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Focus on business goals and outcomes only","Avoid technical implementation details entirely","Define clear success metrics aligned with business value"],"content":"# todoApp Service Overview\n\n## Executive Summary\nThe purpose of todoApp is to provide a minimal, reliable, and privacy-respecting personal task management service that enables individuals to quickly capture, organize, and complete their tasks without distraction. The MVP focuses on core value: simple todo item creation, editing, completion/reopening, and deletion for authenticated users, with clear ownership and predictable behavior across time zones.\n\nScope of this document: This document defines business goals and outcomes only; it describes what the service must achieve from a business perspective. All technical implementation decisions (architecture, APIs, database design, and infrastructure) are at the discretion of the development team.\n\nKey outcomes targeted by the MVP include faster first value (time-to-first-task within one minute of registration), habitual daily use, and a high completion ratio of created tasks. The product deliberately excludes complex project management features to avoid friction and cognitive overload.\n\nFor detailed behaviors after this overview, refer to the following complementary documents: the [Table of Contents and Navigation Guide](./00-toc.md), the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md), the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md), and the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Problem Definition and Market Gap\nMost task tools attempt to serve both simple and complex workflows, creating barriers for individuals who only need the basics. Common pain points observed in the market include:\n- Over-featured interfaces that require configuration before usefulness emerges, delaying time-to-first-value.\n- Unclear ownership rules and privacy concerns in tools primarily designed for teams.\n- Unpredictable due-date handling across time zones, leading to missed or premature deadlines.\n- Lack of reliability for core actions (create, complete, find), which undermines trust and daily habit formation.\n- Hidden costs and complex pricing that discourage early adoption.\n\ntodoApp addresses a specific gap: a minimal, high-trust personal todo service with explicit privacy guarantees, consistent date behavior, and frictionless onboarding.\n\n## Target Users\n- Individual professionals and students who need a fast, minimal personal task list to manage daily obligations.\n- Early-career knowledge workers who prefer predictable behavior over breadth of features.\n- Privacy-conscious users who want clear control and ownership of their data.\n- Secondary audience: service administrators who need limited oversight to support users and enforce policies.\n\nPrimary roles in the service:\n- User: authenticated end user who manages only their own todo items and account.\n- Admin: administrative user who may manage accounts for support and policy enforcement.\n\n## Core Value Proposition\n- Minimalism with purpose: only the features that directly support task capture and completion.\n- Predictable behavior: deterministic rules for ownership, visibility, and time handling.\n- Trust and privacy: personal data is private to each user; no default sharing or exposure.\n- Fast first value: immediate utility on first login.\n\nGuiding high-level requirements (EARS format) for the MVP value proposition:\n- THE todoApp SHALL enable an authenticated user to capture a new todo in under one minute from registration, measured by median time-to-first-task.\n- THE todoApp SHALL keep each user’s todos private to that user by default, with no sharing features in the MVP.\n- WHEN a user records or modifies a due date, THE todoApp SHALL display and process that due date consistently in the user’s preferred local time.\n- WHEN a user searches or filters their todos, THE todoApp SHALL return results within a user-perceived short duration aligned with non-functional expectations.\n\n## Service Scope and Out-of-Scope\n\n### In Scope (MVP)\n- User accounts: registration, login, logout, email verification, password reset, and session revocation from a business perspective.\n- Todo item management: create, read, update, complete, reopen, and delete personal items.\n- Optional attributes: textual description and due date.\n- Filtering and sorting: basic filtering by completion status and optional due date; sorting by creation time or due date.\n- Ownership and privacy: strict separation so users access only their data; admins can perform specific support actions according to policy.\n- Time zone behavior: all date-related operations are consistent with the user’s preferred local time.\n- Data lifecycle basics: user-initiated deletion of items; account deletion that removes personal data subject to retention policies.\n\n### Out of Scope (MVP)\n- Collaboration: sharing, assignments, comments, team workspaces, or mentions.\n- Complex task structures: subtasks, checklists, tags/labels, priorities, or recurring tasks.\n- Media attachments: file uploads or images.\n- Integrations: calendar sync, third-party automations, or external identity providers.\n- Notifications and reminders: push, SMS, or email reminders.\n- Advanced analytics dashboards and reporting for end users.\n- Public APIs or developer platforms.\n- Mobile or desktop native applications; the MVP focuses on core service behavior without specifying client platforms.\n\n## Business Model\nThe business model emphasizes a trust-first entry with a minimal product, followed by value-based monetization. The service begins as a free, fully functional personal todo list for early adoption. Monetization follows once the daily habit and core trust are validated.\n\n- Value creation: reliable, distraction-free personal task management that increases completion rate and reduces task-related anxiety.\n- Value capture: subscription plans post-MVP for power users and small teams (future), while retaining a free tier for personal use.\n- Cost structure: customer support, basic infrastructure and operations, content and onboarding materials, and minimal compliance overhead.\n- Differentiation: privacy clarity, deterministic time rules, and purposeful minimalism.\n\n## Why This Service Exists\n- Market need: Individuals require a simple, dependable system that does not force team constructs or heavyweight configuration.\n- Opportunity: Many competitors optimize for breadth and collaboration, leaving underserved users who want speed, clarity, and privacy.\n- Strategic fit: A minimal, high-trust product creates a foundation for future extensions (e.g., optional premium features) without compromising core simplicity.\n\nEARS-formulated business objectives:\n- THE todoApp SHALL minimize user time-to-first-value by guiding new users to create a first todo within 60 seconds.\n- THE todoApp SHALL maintain user trust by keeping todos private and avoiding unexpected data exposure.\n- WHERE a free tier is provided, THE todoApp SHALL retain full personal task functionality in that tier during the MVP phase.\n\n## Revenue Strategy\n- Initial phase (MVP to early traction): free tier supporting personal use to maximize adoption and learning.\n- Paid plans (post-MVP, contingent on traction):\n  - Individual Pro: premium features such as advanced filters and export options.\n  - Teams (future): multi-user oversight and policy features (added only when simplicity can be preserved).\n- Pricing principles: transparent, simple, and predictable; no hidden limits that block core personal use.\n\nEARS-formulated revenue and ethics requirements:\n- THE todoApp SHALL avoid paywalls on basic personal task creation, completion, and deletion during the MVP phase.\n- IF a user downgrades from paid to free in the future, THEN THE todoApp SHALL preserve access to existing personal tasks without data loss.\n\n## Growth Plan\n- Acquisition: content marketing around productivity fundamentals, referral incentives, and distribution via student and early-career communities.\n- Activation: frictionless onboarding focused on first task creation, with contextual tips rather than complex setup.\n- Retention: habit loops centered on completion, simple reminders inside the product scope (without external notifications in MVP), and weekly reflection prompts as content.\n- Expansion: optional premium features introduced only after retention metrics are healthy, ensuring the core remains uncluttered.\n\nEARS-formulated growth objectives:\n- THE todoApp SHALL target a median time-to-first-task of ≤60 seconds for newly registered users during the MVP.\n- THE todoApp SHALL aim for a 7-day retention (user returns and interacts with tasks) of at least 25% within 90 days of launch.\n- WHERE a referral mechanism is offered, THE todoApp SHALL allow users to invite others without introducing sharing features that compromise privacy.\n\n## Success Metrics and KPIs\nAll metrics are defined in business terms. Technical measurement methods are left to the development team.\n\nCore metrics (MVP):\n- Activation rate: percentage of newly registered users who create at least one todo within 24 hours.\n- Time-to-first-task (median): elapsed time from registration to first todo creation.\n- Weekly engaged users: users who created, updated, or completed at least one todo in a 7-day window.\n- Completion ratio: completed todos divided by created todos within a period.\n- Churn rate: percentage of active users who become inactive over a 30-day period.\n- Support ticket volume per 1,000 MAU: proxy for usability and reliability.\n\nEARS-formulated success targets:\n- THE todoApp SHALL achieve an activation rate of ≥70% within the first 90 days post-launch.\n- THE todoApp SHALL maintain a median time-to-first-task of ≤60 seconds during the MVP.\n- THE todoApp SHALL achieve a weekly completion ratio of ≥50% for active users within 90 days of launch.\n- WHERE user support is available, THE todoApp SHALL maintain a support ticket volume of ≤20 per 1,000 MAU related to core task operations.\n\n## Assumptions and Dependencies\n- Email channel availability for account verification and password resets.\n- Basic legal and privacy compliance appropriate for operating regions, including clear consent for data processing and retention policies defined at a business level.\n- Stable time zone libraries and consistent business rules for due-date handling described in the requirements.\n- English-language product framing for MVP, with localization considered in subsequent phases.\n- Reasonable baseline of user devices and connectivity; non-functional expectations will define responsiveness in user terms.\n- Administrative oversight limited to support and policy enforcement, with strict adherence to least-privilege principles at the business level.\n\nEARS-formulated constraints:\n- IF email verification is not completed within a defined grace period, THEN THE todoApp SHALL limit access to functions that depend on verified identity.\n- WHILE account deletion is in progress, THE todoApp SHALL prevent new content creation by that account to avoid data inconsistency.\n\n## Linkage to Detailed Requirements\nThis overview sets the direction for all subsequent specifications. Detailed business behavior is further defined in the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md). User-centered reliability, performance, security, and privacy expectations are defined in the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md). Release readiness and measurable acceptance criteria are captured in the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Glossary of Terms\n- Activation: the point at which a newly registered user creates their first todo.\n- Admin: administrative role authorized to perform limited oversight actions for support and policy enforcement.\n- Completion ratio: number of completed todos divided by created todos over the same period.\n- Due date: an optional date attached to a todo indicating a target completion day in the user’s local time.\n- MVP (Minimum Viable Product): the minimal set of features that delivers core value to early users and validates the product hypothesis.\n- Ownership: the principle that a user’s todos belong exclusively to that user and are not visible to others in the MVP.\n- Retention: the rate at which users return and interact with the service over time.\n- Time-to-first-task: elapsed time between account registration and creation of the first todo.\n- User: authenticated end user who manages only their own todo items and account.\n\nClosing statement: This document specifies business outcomes and constraints only. It intentionally avoids technical implementation details. Developers have full autonomy over architecture, APIs, and data design to meet these outcomes."},"tokenUsage":{"total":20750,"input":{"total":15537,"cached":0},"output":{"total":5213,"reasoning":2368,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":2,"created_at":"2025-08-15T03:55:54.829Z"},"tokenUsage":{"aggregate":{"total":66711,"input":{"total":50001,"cached":7808},"output":{"total":16710,"reasoning":9472,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":63927,"input":{"total":47664,"cached":7808},"output":{"total":16263,"reasoning":9088,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Describe who uses the system and the primary/secondary scenarios to guide requirement prioritization and testing.","filename":"04-todoApp-user-stories-and-personas.md","documentType":"user-story","outline":["Personas","Primary Scenarios (Happy Paths)","Secondary Scenarios and Edge Cases","Role-based Scenarios (user, admin)","Acceptance Tests in Natural Language (EARS where applicable)","Success Indicators per Scenario"],"audience":"product managers","keyQuestions":["Who are the typical users of this service?","What scenarios are most critical to support?","What edge cases must be considered for MVP?"],"detailLevel":"moderate detail","relatedDocuments":["03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["Avoid UI/UX design details and screen layouts","Use natural language and business logic only","Write acceptance tests in EARS where possible"],"content":"# todoApp User Stories and Personas\n\n## Personas\n\n### Persona 1: Focused Professional (User)\n- Profile: Employed knowledge worker balancing multiple projects and deadlines.\n- Goals: Capture tasks quickly, prioritize by urgency, complete tasks on schedule, review what’s done.\n- Motivations: Reduce mental load, maintain reliability, demonstrate progress.\n- Pain Points: Task sprawl across tools, forgetting deadlines, difficulty filtering by status.\n- Environment: Desktop during work hours; mobile on the go. Intermittent connectivity possible.\n- Success Measures: Can capture a task in under 10 seconds; can find any task within 5 seconds via filtering or search-like mechanisms; misses no critical due date over a week.\n\n### Persona 2: Organized Student (User)\n- Profile: University student juggling classes, assignments, and part-time work.\n- Goals: Track assignments by due dates, mark completed work, reopen items when requirements change.\n- Motivations: Stay ahead of deadlines, visualize workload by due date, avoid penalties.\n- Pain Points: Overdue tracking confusion, accidental deletions, unclear item states.\n- Environment: Mobile-first; occasional desktop sessions in labs or dorm.\n- Success Measures: Keeps assignment list current daily; can see upcoming items due this week within 2 seconds; can undo a completion or correct a mistake without data loss.\n\n### Persona 3: Casual Planner (User)\n- Profile: Non-technical individual using the app occasionally for personal reminders.\n- Goals: Add simple reminders, check off completed items, clear clutter periodically.\n- Motivations: Minimal friction, clarity of state (open vs completed), confidence items aren’t lost.\n- Pain Points: Complexity overload, needlessly required fields, confusing error messages.\n- Environment: Mobile with variable connectivity.\n- Success Measures: Zero confusion about item state; never blocked by optional fields; can delete or archive clutter quickly.\n\n### Persona 4: Support Administrator (Admin)\n- Profile: Service operator ensuring policy compliance and user support.\n- Goals: Assist users with account issues, enforce content and safety policies, monitor basic health indicators at a business level.\n- Motivations: Maintain trust and safety, minimize support burden, resolve issues quickly.\n- Pain Points: Ambiguity around user permissions, incomplete audit trails, difficulty revoking sessions when necessary.\n- Environment: Desktop in secure environment.\n- Success Measures: Can locate a user account within seconds; can revoke sessions and suspend/restore accounts swiftly with clear outcomes; minimal escalations.\n\n## Primary Scenarios (Happy Paths)\n\n### Scenario A: First-Time Registration and Email Verification (User)\n- Objective: Enable a new user to register and verify ownership of email to start using todoApp.\n- Steps (business flow):\n  1. User provides required registration information (email and password).\n  2. System records a new account in unverified state and initiates email verification.\n  3. User opens the verification link within its validity window.\n  4. System transitions account to verified state; user can sign in and use features.\n- Success Criteria: Account verified within minutes; user can sign in immediately after verification.\n\n### Scenario B: Create a New Todo (User)\n- Objective: Allow rapid creation of a minimal todo with optional enrichment.\n- Steps (business flow):\n  1. User initiates creation and supplies a title (mandatory), may add description and due date (optional).\n  2. System validates inputs and saves the item as \"open\".\n  3. System associates the item with the creator’s account and sets timestamps.\n- Success Criteria: Item appears in the user’s list immediately; optional fields remain optional without blocking.\n\n### Scenario C: Review and Filter Todos (User)\n- Objective: View own items and limit the list by status and due date expectations.\n- Steps (business flow):\n  1. User requests their todo list.\n  2. System returns items owned by the user, with default ordering (most recently updated first) and business-level filtering controls (e.g., open vs completed).\n  3. User applies filters (e.g., show open only, or items due within next 7 days).\n- Success Criteria: User finds the intended item within 5 seconds; list reflects filter choices consistently.\n\n### Scenario D: Complete and Reopen a Todo (User)\n- Objective: Mark work done, with ability to reverse if needed.\n- Steps (business flow):\n  1. User marks an open item as completed.\n  2. System records completion timestamp and sets state to \"completed\".\n  3. If the user later reopens the item, system removes the completion timestamp and returns state to \"open\".\n- Success Criteria: State changes are instant; history is consistent.\n\n### Scenario E: Edit a Todo (User)\n- Objective: Adjust details without causing confusion or loss.\n- Steps (business flow):\n  1. User updates title and/or optional fields.\n  2. System validates edits, saves changes, updates last-updated timestamp.\n- Success Criteria: Edits are reflected immediately and persist across sessions.\n\n### Scenario F: Delete a Todo (User)\n- Objective: Remove clutter intentionally and safely.\n- Steps (business flow):\n  1. User requests deletion of one of their items.\n  2. System validates ownership and removes the item from the active list.\n- Success Criteria: Item no longer appears in active lists; user cannot access deleted item through normal navigation.\n\n### Scenario G: Administrative Session Revocation (Admin)\n- Objective: End a user’s active sessions for safety or policy reasons.\n- Steps (business flow):\n  1. Admin identifies the relevant user account.\n  2. Admin initiates revoke-all-sessions for that user.\n  3. System invalidates active user sessions.\n- Success Criteria: User’s devices require re-authentication; action is auditable.\n\n```mermaid\ngraph LR\n  A[\"User Starts\"] --> B[\"Register Account\"]\n  B --> C[\"Email Verification Sent\"]\n  C --> D{\"Verification Link Opened?\"}\n  D -->|\"Yes\"| E[\"Account Verified\"]\n  D -->|\"No\"| F[\"Reminder/Resend Option\"]\n  E --> G[\"Create First Todo\"]\n  G --> H[\"Review & Filter List\"]\n  H --> I[\"Complete Item\"]\n  I --> J{\"Need To Reopen?\"}\n  J -->|\"Yes\"| K[\"Reopen Item\"]\n  J -->|\"No\"| L[\"Continue Working\"]\n```\n\n## Secondary Scenarios and Edge Cases\n\n- Duplicate Titles:\n  - Business Rule: Titles need not be unique; disambiguation is by creation time and context.\n- Due Dates in the Past:\n  - Business Rule: Acceptable, as users may record historical tasks; system should clearly reflect overdue status.\n- Optional Fields:\n  - Business Rule: Description and due date are optional at all times; absence must not block creation or editing of other fields.\n- Time Zone Handling:\n  - Business Rule: Due date interpretation is based on the user’s current local time setting; changes in time zone should not cause silent shifts of the intended calendar day.\n- Large Lists and Navigation:\n  - Business Expectation: Users can access and review their task list without undue delay; ordering defaults to last updated first; mechanisms to focus on open or upcoming tasks must be available.\n- Concurrent Edits (same item, multiple sessions/devices):\n  - Business Rule: The system must prevent silent overwrites; users must receive clear guidance to retry, merge, or refresh when conflicts occur.\n- Session Expiration During Use:\n  - Business Rule: Saved items remain unaffected; unsaved input that was not persisted is out of scope for guarantee in MVP.\n- Account Deletion:\n  - Business Rule: Deleting an account removes access to associated items according to data lifecycle rules; users must confirm intention before irreversible actions.\n- Rate Limiting and Abuse Prevention:\n  - Business Rule: The system may throttle excessively frequent operations for stability and fairness while clearly communicating limits to users.\n- Accessibility and Clarity:\n  - Business Rule: System messages and labels use unambiguous, plain language describing item state and required actions.\n\n## Role-based Scenarios (user, admin)\n\n### User Role: Owned-Data Operations\n- Create Todo: User creates items with required title and optional fields; items belong exclusively to the creator.\n- Read Own Todos: User views only their items; no leakage of other users’ data.\n- Update Own Todos: User edits only their items; state transitions are controlled (open ⇄ completed).\n- Delete Own Todos: User removes only their items.\n- Account Management: User can verify email, sign in/out, change password, and revoke own sessions.\n\n### Admin Role: Support and Policy Enforcement\n- View User Profile (Business-Level): Admin locates a user account and reviews business-level details needed for support.\n- Revoke User Sessions: Admin ends all of a user’s sessions when safety or policy requires.\n- Suspend/Restore Account: Admin changes account state to restrict or restore access when warranted.\n- Access Aggregated Health Indicators: Admin reviews aggregate-level indicators (e.g., volume trends) without exposing personal content beyond what is necessary for support.\n\n## Acceptance Tests in Natural Language (EARS where applicable)\n\n### Registration and Verification\n- WHEN a new user submits valid registration information, THE system SHALL create an unverified account and send a verification instruction within 1 minute.\n- IF a user opens a valid verification link within its validity window, THEN THE system SHALL mark the account as verified immediately.\n- IF a user attempts to sign in before verifying, THEN THE system SHALL prevent access to todo features and direct the user to verify.\n\n### Create Todo\n- WHEN a verified user provides a title and submits a new todo, THE system SHALL create the item as \"open\" and associate it with that user within 2 seconds.\n- IF the user omits description and due date, THEN THE system SHALL still create the item without error.\n- IF the title length exceeds the business-defined limit, THEN THE system SHALL reject the creation with a clear message referencing the limit.\n\n### Review and Filter\n- WHEN a user requests their todo list, THE system SHALL return only items owned by that user ordered by last updated, newest first.\n- WHERE a user applies a filter to show only \"open\" items, THE system SHALL display only items with state \"open\" consistently across navigation within the same session.\n\n### Complete and Reopen\n- WHEN a user marks an open item as completed, THE system SHALL set the item state to \"completed\" and record a completion timestamp.\n- IF a user reopens a completed item, THEN THE system SHALL remove the completion timestamp and set state to \"open\".\n\n### Edit Todo\n- WHEN a user updates the title of their own item to a valid value, THE system SHALL save the change and update the last-updated timestamp.\n- IF a user attempts to edit another user’s item, THEN THE system SHALL deny the action and inform the user they lack permission.\n\n### Delete Todo\n- WHEN a user requests deletion of their own item, THE system SHALL remove the item from active views.\n- IF a user attempts to delete an item they do not own, THEN THE system SHALL deny the action and provide a clear permission error message.\n\n### Time Zone and Due Dates\n- WHILE the user’s time zone setting differs from the time zone at item creation, THE system SHALL preserve the intended due calendar date when displaying the item.\n- IF a due date is set in the past, THEN THE system SHALL mark the item as overdue without blocking save operations.\n\n### Concurrency and Conflicts\n- IF two sessions attempt to update the same item concurrently, THEN THE system SHALL prevent silent overwrite and instruct the user to refresh or reconcile.\n\n### Administrative Controls\n- WHEN an admin executes revoke-all-sessions for a user, THE system SHALL end the user’s active sessions so that the next action requires re-authentication.\n- WHEN an admin suspends a user account, THE system SHALL block access to todo features for that account until restored.\n\n## Success Indicators per Scenario\n\n| Scenario | Primary KPI | Target for MVP | Measurement Method |\n|---------|-------------|----------------|--------------------|\n| Registration & Verification | Verification completion rate within 24 hours | ≥ 80% | Ratio of verified/registered within 24h |\n| Create Todo | Median time from intent to saved item | ≤ 10 seconds | Time from create action start to item persistence |\n| Review & Filter | Time-to-find (specific item) | ≤ 5 seconds | Time from list request to visibility of targeted item via filters |\n| Complete/Reopen | State change latency | ≤ 2 seconds | Time from user action to list reflecting new state |\n| Edit Todo | Edit persistence success rate | ≥ 99% | Successful saves / attempts |\n| Delete Todo | Erroneous deletions rate | ≤ 0.1% | Confirmed mistaken deletions / deletions |\n| Admin Session Revocation | Time to invalidate sessions | ≤ 1 minute | Time from revocation to enforced re-authentication |\n\n## References to Related Documents\n- See the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for field validations, ownership rules, and acceptance criteria.\n- Review the [User Flows for todoApp](./05-todoApp-user-flows.md) for visual flow details complementing these scenarios.\n- Consult the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md) for recovery paths and user-facing guidance.\n\n## Scope Clarification\nThis document describes business requirements, personas, and scenarios for todoApp. It focuses on what the system must do from a user and business perspective and does not prescribe technical implementation. All architecture, API design, and database decisions are at the discretion of the development team."},"tokenUsage":{"total":20790,"input":{"total":15537,"cached":0},"output":{"total":5253,"reasoning":1920,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":3,"created_at":"2025-08-15T03:56:21.467Z"},"tokenUsage":{"aggregate":{"total":87501,"input":{"total":65538,"cached":7808},"output":{"total":21963,"reasoning":11392,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":84717,"input":{"total":63201,"cached":7808},"output":{"total":21516,"reasoning":11008,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Provide clear, visual business flows for key processes to reduce ambiguity and align teams.","filename":"05-todoApp-user-flows.md","documentType":"user-flow","outline":["Flow Diagram Conventions","Authentication Flow (register, login, reset)","Todo Item Lifecycle Flow (create, update, complete, delete)","Error and Recovery Flow","State Model for Todo Items","Narrative Descriptions of Each Flow"],"audience":"development team","keyQuestions":["What are the step-by-step flows for core processes?","Where do decisions occur and what are the expected outcomes?"],"detailLevel":"moderate detail","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["All diagrams must follow the Mermaid rules provided (double quotes for labels, correct arrows)","Use graph LR orientation for readability","Do not include technical architecture diagrams or API sequence diagrams"],"content":"# todoApp User Flows and Business Process Diagrams\n\nThis document provides business requirements only. All technical implementation decisions (architecture, APIs, database design, and related choices) belong to the development team. The document describes WHAT the system should do, not HOW to build it.\n\n- Service prefix: todoApp\n- Roles referenced: user, admin\n- Related references for deeper context:\n  - See the [User Roles and Authentication Specification](./02-todoApp-user-roles-and-authentication.md) for complete role definitions and authentication behaviors.\n  - See the [Functional Requirements Specification](./03-todoApp-functional-requirements.md) for field-level validations and acceptance criteria.\n  - See the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md) for comprehensive error taxonomies and user recovery.\n\n## Flow Diagram Conventions\n\n- Orientation: Left-to-right (LR) for all flows.\n- Notation: Rectangles represent steps, diamonds represent decisions, rounded shapes represent states or outcomes.\n- Labels: All node and edge labels use double quotes; edge labels denote decision outcomes or key information.\n- Roles context:\n  - \"user\" refers to an authenticated end user managing their own todos and account.\n  - \"admin\" refers to an administrative user performing oversight or support activities.\n- Business semantics:\n  - “Create”, “Update”, “Complete”, “Reopen”, and “Delete” refer to user-visible actions and their business effects.\n  - “Verification” refers to email verification for account activation.\n- Performance expectations (user experience level):\n  - Simple actions (register, login, create todo, mark complete) should feel immediate. Where stated, response expectations are provided in seconds as testable criteria.\n\n## Authentication Flow (register, login, reset)\n\n### Diagram: Registration, Email Verification, Login, Logout, Password Reset\n\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A1[\"Open Registration\"] --> A2[\"Enter Email/Password\"]\n    A3[\"Open Login\"] --> A4[\"Enter Credentials\"]\n    A5[\"Open Password Reset\"] --> A6[\"Submit Reset Request(Email)\"]\n    A7[\"Open Logout\"] --> A8[\"Confirm Logout\"]\n    A9[\"Open Verification Link\"]\n  end\n\n  subgraph \"Business Processing\"\n    B1[\"Validate Registration Input\"] --> B2{\"Email Available?\"}\n    B2 -->|\"Yes\"| B3[\"Create Account(Pending Verification)\"]\n    B2 -->|\"No\"| E1[\"Inform Duplicate Email\"]\n    B3 --> B4[\"Send Verification Email\"]\n\n    B5[\"Validate Credentials\"] --> B6{\"Account Exists?\"}\n    B6 -->|\"No\"| E2[\"Inform Invalid Login\"]\n    B6 -->|\"Yes\"| B7{\"Email Verified?\"}\n    B7 -->|\"No\"| E3[\"Inform Verification Required\"]\n    B7 -->|\"Yes\"| B8[\"Establish Session\"]\n\n    B9[\"Validate Reset Request\"] --> B10{\"Account Exists?\"}\n    B10 -->|\"No\"| E4[\"Inform Unknown Email\"]\n    B10 -->|\"Yes\"| B11[\"Send Reset Instructions\"]\n\n    B12[\"Validate Verification Token\"] --> B13{\"Token Valid?\"}\n    B13 -->|\"Yes\"| B14[\"Activate Account(Verified)\"]\n    B13 -->|\"No\"| E5[\"Inform Invalid/Expired Link\"]\n\n    B15[\"Invalidate Session\"]\n  end\n\n  subgraph \"Outcomes\"\n    C1[\"Registration Pending\"]\n    C2[\"Registration Complete\"]\n    C3[\"Logged In\"]\n    C4[\"Password Reset Email Sent\"]\n    C5[\"Logged Out\"]\n  end\n\n  %% Flows\n  A2 --> B1\n  B1 --> B2\n  B3 --> B4 --> C1\n\n  A9 --> B12\n  B14 --> C2\n\n  A4 --> B5\n  B5 --> B6\n  B8 --> C3\n\n  A6 --> B9\n  B9 --> B10\n  B11 --> C4\n\n  A8 --> B15 --> C5\n\n  %% Errors\n  E1 -.->|\"Guidance: Use Different Email\"| A2\n  E2 -.->|\"Guidance: Retry or Reset\"| A3\n  E3 -.->|\"Guidance: Check Inbox\"| C1\n  E4 -.->|\"Guidance: Register First\"| A1\n  E5 -.->|\"Guidance: Request New Link\"| A5\n```\n\n### EARS Requirements — Authentication\n\n- WHEN a person submits valid registration details, THE authentication subsystem SHALL create an account in \"pending verification\" state and send a verification email within 60 seconds.\n- IF the registration email is already in use, THEN THE authentication subsystem SHALL reject the registration and present a message indicating the email is taken.\n- WHEN a person clicks a valid verification link, THE authentication subsystem SHALL activate the account immediately and allow login thereafter.\n- IF a verification link is invalid or expired, THEN THE authentication subsystem SHALL inform the user and provide a path to request a new link.\n- WHEN a verified account submits correct login credentials, THE authentication subsystem SHALL create an authenticated session and reflect the logged-in state within 2 seconds.\n- IF login fails due to unknown account or incorrect credentials, THEN THE authentication subsystem SHALL not reveal which field failed and SHALL encourage retry or password reset.\n- WHEN a user requests a password reset with an email of an existing account, THE authentication subsystem SHALL send reset instructions within 60 seconds.\n- IF a password reset request references a non-existent email, THEN THE authentication subsystem SHALL complete without disclosing account existence and SHALL present generic confirmation messaging.\n- WHEN a user initiates logout, THE authentication subsystem SHALL terminate the active session immediately and reflect the logged-out state.\n- WHERE the actor is an admin assisting a user, THE support process SHALL allow the admin to trigger re-verification or lock/unlock an account according to business policy defined in the role specification.\n\n## Todo Item Lifecycle Flow (create, update, complete, delete)\n\n### Diagram: Todo Item Lifecycle\n\n```mermaid\ngraph LR\n  subgraph \"User Actions\"\n    T1[\"Start Create Todo\"] --> T2[\"Enter Title(Optional: Description, Due Date)\"]\n    T3[\"Open Todo\"] --> T4[\"Edit Fields\"]\n    T5[\"Mark Complete\"]\n    T6[\"Reopen Item\"]\n    T7[\"Delete Item\"]\n  end\n\n  subgraph \"Business Rules\"\n    R1[\"Validate Title(Non-Empty, Max Length)\"]\n    R2[\"Validate Optional Fields(Description Length, Due Date Format)\"]\n    R3{\"Item Owned By User?\"}\n    R4{\"Item Editable?\"}\n    R5{\"Item In Active State?\"}\n    R6{\"Item In Completed State?\"}\n  end\n\n  subgraph \"Outcomes\"\n    O1[\"Item Created(Active)\"]\n    O2[\"Item Updated\"]\n    O3[\"Item Completed\"]\n    O4[\"Item Reopened(Active)\"]\n    O5[\"Item Deleted(Permanent)\"]\n  end\n\n  %% Creation\n  T2 --> R1 --> R2 --> O1\n\n  %% Update\n  T4 --> R3\n  R3 -->|\"Yes\"| R4\n  R3 -->|\"No\"| E1[\"Inform Access Denied\"]\n  R4 -->|\"Yes\"| O2\n  R4 -->|\"No\"| E2[\"Inform Not Editable\"]\n\n  %% Complete\n  T5 --> R3\n  R3 -->|\"Yes\"| R5\n  R5 -->|\"Yes\"| O3\n  R5 -->|\"No\"| E3[\"Inform Already Completed or Invalid State\"]\n\n  %% Reopen\n  T6 --> R3\n  R3 -->|\"Yes\"| R6\n  R6 -->|\"Yes\"| O4\n  R6 -->|\"No\"| E4[\"Inform Not Completed\"]\n\n  %% Delete\n  T7 --> R3\n  R3 -->|\"Yes\"| O5\n  R3 -->|\"No\"| E5[\"Inform Access Denied\"]\n\n  %% Guidance\n  E1 -.->|\"Guidance: Operate Only Own Items\"| T3\n  E2 -.->|\"Guidance: Check State/Fields\"| T3\n  E3 -.->|\"Guidance: No Duplicate Completion\"| T3\n  E4 -.->|\"Guidance: Reopen Only Completed\"| T3\n  E5 -.->|\"Guidance: Ownership Required\"| T3\n```\n\n### EARS Requirements — Todo Lifecycle\n\n- THE todo management subsystem SHALL require a non-empty title up to the maximum length defined in the functional specification.\n- WHERE a description is provided, THE todo management subsystem SHALL accept it up to the maximum length defined in the functional specification.\n- WHERE a due date is provided, THE todo management subsystem SHALL interpret it using the user’s locale and time zone settings as specified in the functional specification.\n- WHEN a user creates a valid todo, THE todo management subsystem SHALL place it in the \"active\" state and make it available in the user’s list immediately.\n- IF a user attempts to modify a todo they do not own, THEN THE todo management subsystem SHALL deny the action and present an authorization message without exposing other users’ data.\n- WHEN a user edits fields of an active todo, THE todo management subsystem SHALL apply the changes immediately if all validations pass.\n- WHEN a user marks an active todo as complete, THE todo management subsystem SHALL update its state to \"completed\" and display the completion timestamp according to the user’s time zone.\n- IF a user attempts to complete a todo already in \"completed\" state, THEN THE todo management subsystem SHALL inform that the item is already completed and SHALL not change state.\n- WHEN a user reopens a completed todo, THE todo management subsystem SHALL return it to the \"active\" state and clear any derived completion indicators while preserving historical metadata as defined in the business rules.\n- WHEN a user deletes their own todo, THE todo management subsystem SHALL remove it from the user’s list permanently for MVP scope.\n- WHERE an admin performs moderation, THE administrative process SHALL not alter user todo content except when enforcing policy; any such action SHALL be auditable according to the role specification.\n\n## Error and Recovery Flow\n\n### Diagram: Error Categories and Recovery Paths\n\n```mermaid\ngraph LR\n  subgraph \"Operation Context\"\n    U1[\"Attempt Operation\"] --> D1{\"Auth Error?\"}\n  end\n\n  subgraph \"Authentication/Authorization\"\n    D1 -->|\"Yes\"| A1[\"Show Auth Message\"]\n    A1 --> A2{\"User Intends to Recover?\"}\n    A2 -->|\"Yes\"| A3[\"Prompt Login or Verify Email\"]\n    A2 -->|\"No\"| A4[\"Abort Operation\"]\n  end\n\n  subgraph \"Validation\"\n    D1 -->|\"No\"| D2{\"Validation Error?\"}\n    D2 -->|\"Yes\"| V1[\"Show Field Guidance\"]\n    V1 --> V2{\"Can Retry Immediately?\"}\n    V2 -->|\"Yes\"| V3[\"Allow Correction and Resubmission\"]\n    V2 -->|\"No\"| V4[\"Provide Instructions\"]\n  end\n\n  subgraph \"Not Found / Conflict\"\n    D2 -->|\"No\"| D3{\"Not Found?\"}\n    D3 -->|\"Yes\"| N1[\"Inform Missing Resource\"]\n    D3 -->|\"No\"| D4{\"Conflict?\"}\n    D4 -->|\"Yes\"| C1[\"Inform Concurrent Update\"]\n    C1 --> C2[\"Offer Refresh or Retry\"]\n  end\n\n  subgraph \"Rate Limit / Service Unavailable\"\n    D4 -->|\"No\"| D5{\"Rate Limited?\"}\n    D5 -->|\"Yes\"| R1[\"Show Wait Guidance\"]\n    D5 -->|\"No\"| D6{\"Service Unavailable?\"}\n    D6 -->|\"Yes\"| S1[\"Show Retry Later Guidance\"]\n    D6 -->|\"No\"| S2[\"Proceed to Success\"]\n  end\n```\n\n### EARS Requirements — Error and Recovery\n\n- WHEN an action requires authentication and the user is not authenticated, THE system SHALL present a message to log in or verify and SHALL not proceed with the action.\n- IF a form submission contains invalid fields, THEN THE system SHALL highlight the specific fields and provide actionable guidance for correction.\n- WHEN a missing resource is referenced (e.g., deleted or non-existent todo), THE system SHALL inform the absence without exposing whether the resource ever existed for other users.\n- IF a concurrency conflict occurs due to simultaneous updates, THEN THE system SHALL prevent data loss by rejecting the later change and SHALL offer a path to refresh and retry.\n- WHEN a user exceeds allowed operation frequency, THE system SHALL inform that the rate limit has been reached and SHALL advise when to try again.\n- IF a transient service disruption prevents completing an action, THEN THE system SHALL inform the user and encourage retry after a short interval without blaming user input.\n\n## State Model for Todo Items\n\n### Diagram: States and Transitions (Business-Level)\n\n```mermaid\ngraph LR\n  S0[\"Nonexistent\"] -->|\"Create\"| S1[\"Active\"]\n  S1 -->|\"Update Fields\"| S1\n  S1 -->|\"Complete\"| S2[\"Completed\"]\n  S2 -->|\"Reopen\"| S1\n  S1 -->|\"Delete\"| S3[\"Deleted(Permanent)\"]\n  S2 -->|\"Delete\"| S3\n```\n\n### EARS Requirements — State Model\n\n- THE todo item lifecycle SHALL consist of \"active\", \"completed\", and \"deleted\" states for MVP.\n- WHEN a todo is created successfully, THE lifecycle SHALL enter the \"active\" state.\n- WHEN a todo is marked complete from the \"active\" state, THE lifecycle SHALL transition to \"completed\" without modifying non-edited fields.\n- WHEN a completed todo is reopened, THE lifecycle SHALL transition back to \"active\" and clear completion-specific indicators while keeping other fields intact.\n- WHEN a todo is deleted, THE lifecycle SHALL transition to \"deleted\" and SHALL not be available in the user’s list thereafter for MVP.\n\n## Narrative Descriptions of Each Flow\n\n### Authentication Flow Narrative\n\n- Registration and Verification\n  - Trigger: A person attempts to create an account with an email and password.\n  - Decision: If the email is already in use, the registration is rejected and guidance is provided to try another email. Otherwise, the account is created in a pending verification state, and a verification message is sent.\n  - Outcome: On clicking a valid verification link, the account becomes verified and eligible for login.\n  - Non-disclosure: In all flows, do not reveal whether a specific email exists to unauthorized parties.\n\n- Login and Session Establishment\n  - Trigger: A verified user enters credentials.\n  - Decision: If credentials are invalid or the account is unverified, the login is denied with appropriate guidance. Otherwise, a session is established.\n  - Outcome: The user reaches the authenticated state capable of performing todo operations.\n\n- Password Reset\n  - Trigger: A person submits a password reset request with an email.\n  - Decision: If the account exists, a reset instruction is sent. If not, a generic confirmation is presented without disclosing account existence.\n  - Outcome: The person is able to reset password via a secure link flow (details in authentication spec) and subsequently log in.\n\n- Logout\n  - Trigger: A logged-in user initiates logout.\n  - Outcome: The active session is terminated immediately.\n\n- Admin Support Notes\n  - Admins can enforce policies such as locking accounts or re-triggering verification within the constraints and audit expectations defined in the role specification.\n\n### Todo Item Lifecycle Narrative\n\n- Create\n  - Trigger: An authenticated user initiates creation.\n  - Validation: Title must be present and within allowed length; optional description and due date, when provided, must meet length and format rules.\n  - Outcome: A new todo is created in the active state and appears in the user’s list.\n\n- Read\n  - Trigger: A user views one of their todos.\n  - Authorization: Items are only visible to their owner. Admin oversight of content, when necessary for policy enforcement, is out-of-band and auditable.\n\n- Update\n  - Trigger: A user edits fields of their own todo.\n  - Decision: If the item is not owned by the user, the operation is denied. If the item is in a state that disallows the requested change (as per business rules), the operation is denied with guidance. Otherwise, the update is applied.\n\n- Complete\n  - Trigger: A user marks an active todo as complete.\n  - Decision: If already completed, the operation is rejected with guidance.\n  - Outcome: Item moves to completed state; completion timestamp is recorded for display based on the user’s time zone.\n\n- Reopen\n  - Trigger: A user reopens a completed item.\n  - Outcome: Item moves back to active state; completion-specific indicators are cleared while preserving other details.\n\n- Delete\n  - Trigger: A user deletes their own item.\n  - Outcome: Item is permanently removed from the user’s list for MVP. Business rule documents may define alternative retention in future phases.\n\n### Error and Recovery Narrative\n\n- Authentication and Authorization Errors\n  - Scenario: User attempts actions requiring authentication or proper authorization.\n  - Response: The system blocks the action and presents clear next steps: log in, verify email, or request access as appropriate. No sensitive details are disclosed.\n\n- Validation Errors\n  - Scenario: User submissions fail validations (e.g., missing title, invalid due date format, overly long text fields).\n  - Response: The system identifies specific fields and provides actionable guidance to correct and resubmit.\n\n- Not Found\n  - Scenario: A referenced todo does not exist or is no longer available.\n  - Response: The system informs that the resource is unavailable without exposing historical existence for other users.\n\n- Conflict (Concurrent Updates)\n  - Scenario: Two edits occur to the same todo in close succession.\n  - Response: The system prevents overwriting by rejecting the later change, guiding the user to refresh and retry.\n\n- Rate Limit\n  - Scenario: Excessive operations in a short period (e.g., repeated create/delete).\n  - Response: The system asks the user to slow down and to try again after a provided interval.\n\n- Service Unavailable\n  - Scenario: Temporary outage or degraded service prevents operation completion.\n  - Response: The system encourages retry after a short interval and provides reassurance without implying user error.\n\n## Additional EARS Requirements Spanning Flows\n\n- WHILE a user is authenticated, THE system SHALL maintain a valid session and reflect authorization according to the role’s business permissions.\n- WHERE the actor is \"admin\", THE system SHALL allow actions aligned with oversight and policy enforcement while maintaining auditability and minimal data exposure.\n- WHEN business limits are exceeded (such as rate limits), THE system SHALL communicate the limit and the time window for retry in user terms.\n- WHEN time-sensitive information is presented (such as due dates and completion timestamps), THE system SHALL align display and interpretation with the user’s configured time zone and locale rules defined in the functional specification.\n\n## Traceability and References\n\n- Authentication details and lifecycle expectations are defined in the [User Roles and Authentication Specification](./02-todoApp-user-roles-and-authentication.md).\n- Feature-level behaviors and validations are defined in the [Functional Requirements Specification](./03-todoApp-functional-requirements.md).\n- Error handling categories and user-facing guidance are detailed in the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md).\n\nEnd of document."},"tokenUsage":{"total":22340,"input":{"total":15537,"cached":0},"output":{"total":6803,"reasoning":1984,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":4,"created_at":"2025-08-15T03:56:31.690Z"},"tokenUsage":{"aggregate":{"total":109841,"input":{"total":81075,"cached":7808},"output":{"total":28766,"reasoning":13376,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":107057,"input":{"total":78738,"cached":7808},"output":{"total":28319,"reasoning":12992,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Define user-facing error conditions and recovery paths to create predictable behavior under failure.","filename":"07-todoApp-error-handling-and-exception-scenarios.md","documentType":"requirement","outline":["Error Taxonomy (Authentication, Authorization, Validation, Not Found, Conflict, Rate Limit, Service Unavailable)","User-Facing Messages and Guidance","Recovery and Retry Policies","Conflict Resolution for Concurrent Updates (business perspective)","Audit and Monitoring Expectations (business-level)","EARS-Formatted Error Requirements and Acceptance Criteria"],"audience":"development team","keyQuestions":["What errors can occur and how should the system respond for the user?","How can users recover or proceed after an error?","What monitoring is expected from a business standpoint?"],"detailLevel":"detailed specification","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS for all error and exception requirements","Do not reference HTTP codes or API responses; keep user-focused","No technical implementation details"],"content":"# todoApp Error Handling and Exception Scenarios\n\n## Introduction and Scope\nThis document defines business-level error handling and exception scenarios for the todoApp service. It specifies how the system responds to failures from a user’s perspective, the messages and guidance users receive, and the recovery paths that allow users to continue work safely. It also sets expectations for auditing and monitoring in business terms. This document describes WHAT the system should do in failure conditions, not HOW to implement it.\n\nThis document is consistent with and should be read alongside the following planning documents:\n- Refer to the [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md) for role definitions and session-related behaviors that trigger authentication and authorization errors.\n- Refer to the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for the accepted behavior and constraints of core features that interact with errors described here.\n- Refer to the [User Flows for todoApp](./05-todoApp-user-flows.md) for narrative and diagrammatic flows into which error branches must fit.\n- Refer to the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance and reliability expectations referenced in recovery and retry policies.\n\n## Error Taxonomy\nThe todoApp service classifies errors into the following user-facing categories. Each category defines representative scenarios, typical causes, and business rules for messaging and recovery.\n\n### 1) Authentication Errors\nDefinition: Failures related to user identity verification or session validity.\nExamples:\n- Incorrect credentials submitted during sign-in.\n- Unverified email attempting to sign in where verification is mandatory.\n- Expired or invalid session attempting to perform an action requiring authentication.\n- Revoked session due to user-initiated global logout.\n\nBusiness expectations:\n- Clear, non-technical messaging that avoids disclosing sensitive details.\n- Guided next steps (retry, verify email, or reauthenticate) without exposing system internals.\n\n### 2) Authorization Errors\nDefinition: Authenticated user lacks permission for the requested action.\nExamples:\n- A user attempting to access another user’s todo item.\n- A user attempting admin-only actions (e.g., service configuration or policy enforcement activities).\n\nBusiness expectations:\n- Clear statement that the action is not permitted, without revealing whether the resource exists.\n- Provide safe alternatives or guidance (e.g., return to list, request appropriate access through supported channels).\n\n### 3) Validation Errors\nDefinition: Input does not satisfy business rules for fields or operations.\nRepresentative rules (aligned with functional and business rules documents):\n- Title: required, 1–100 characters.\n- Description: optional, up to 1,000 characters.\n- Due date: optional; if present, must be a valid calendar date-time not earlier than the current time in the user’s configured time zone.\n- Completion actions: only allowed on existing, active items owned by the user.\n\nBusiness expectations:\n- Highlight each invalid field with a specific reason and actionable correction guidance.\n- Preserve valid portions of user input where safe.\n\n### 4) Not Found Errors\nDefinition: Requested resource does not exist or is no longer available to the requesting user.\nExamples:\n- A todo item has been deleted or does not belong to the user.\n- A link to a previously existing item after account deletion.\n\nBusiness expectations:\n- Inform the user that the item is unavailable without revealing ownership or existence details.\n- Offer to return to a safe context such as the user’s list.\n\n### 5) Conflict Errors\nDefinition: The requested change conflicts with the current state of the resource.\nExamples:\n- Concurrent update: another session or device modified the todo item between read and write.\n- State conflict: attempting to reopen an item already changed by another action.\n\nBusiness expectations:\n- Provide a safe, guided path to reconcile changes.\n- Avoid silent overwrites of user data.\n\n### 6) Rate Limit Errors\nDefinition: The frequency of actions exceeds business-defined safe thresholds for the user or system.\nExamples (example thresholds; see EARS requirements for specifics):\n- Excessive create/update/delete operations within a short period.\n- Excessive sign-in attempts.\n\nBusiness expectations:\n- Clearly communicate that limits have been reached, the duration before users may retry, and safe alternatives.\n\n### 7) Service Unavailable / Degraded Errors\nDefinition: Temporary unavailability or degraded service capability.\nExamples:\n- Maintenance windows.\n- Transient upstream issues or partial feature outage.\n\nBusiness expectations:\n- Provide a concise status message and expected retry guidance.\n- Fail gracefully and preserve user-entered data when feasible.\n\n## User-Facing Messages and Guidance\nThe system uses concise, plain-language messages written for clarity and actionability. Messages include a short title, a brief explanation, and a user-guidance sentence with the next best action. Messages avoid technical jargon and never disclose sensitive security details.\n\nMessage design principles:\n- Clarity over completeness: keep sentences short and action-oriented.\n- Specific next step: tell users exactly what to do.\n- Consistent tone: helpful, neutral, and non-blaming.\n- Localization-ready: messages are written to support translation without idioms.\n\nCanonical message examples (business-level text; actual phrasing may be localized):\n- Authentication (invalid credentials): \"We couldn’t sign you in. Check your email and password and try again.\"\n- Authentication (verification required): \"Please verify your email to continue. We’ve sent a verification message to your inbox.\"\n- Authentication (session expired): \"Your session has ended. Sign in again to continue.\"\n- Authorization: \"You don’t have permission to do that.\"\n- Validation (title missing): \"Title is required and must be between 1 and 100 characters.\"\n- Validation (due date): \"Due date must be in the future.\"\n- Not Found: \"This item is no longer available.\"\n- Conflict: \"This item was changed elsewhere. Review updates before saving.\"\n- Rate Limit: \"You’ve reached the limit for this action. Please wait a moment and try again.\"\n- Service Unavailable: \"We’re having trouble right now. Please try again shortly.\"\n\nGuidance patterns:\n- Offer safe navigation destinations (e.g., user’s list) rather than exposing internal states.\n- Preserve unsaved input where possible for local reuse after recovery.\n- Where relevant, mention expected wait times in natural language (e.g., \"about a minute\") consistent with rate-limit windows.\n\n## Recovery and Retry Policies\nThe system provides predictable recovery paths for each error class. These policies are stated from a user perspective and avoid technical implementation details.\n\nGeneral recovery principles:\n- Preserve user intent: maintain entered data locally during failures where safe.\n- Encourage minimal-effort retries: if an action can be retried safely, provide a one-step retry option.\n- Backoff expectations: spread retries to reduce repeat failures and improve success odds.\n- Idempotence from user perspective: repeated submissions during recovery should not create duplicated items or repeated side-effects.\n\nBusiness-level retry/backoff expectations by category:\n- Authentication\n  - Invalid credentials: retry immediately after correction.\n  - Unverified email: guide to verification; allow retry after verification is complete.\n  - Session expired: require sign-in; return user to previous context after success.\n- Authorization\n  - No retry until permissions change; direct user to safe context.\n- Validation\n  - Retry immediately after correcting invalid fields; do not discard valid entries.\n- Not Found\n  - No retry expected; guide to safe context. If the user reasonably expects the item to exist (e.g., recently created), suggest refreshing the list view.\n- Conflict\n  - Offer reconciliation actions described in the conflict resolution section below.\n- Rate Limit\n  - Communicate the expected minimum wait before next attempt. Provide reasonable example windows (e.g., \"about 1 minute\").\n- Service Unavailable/Degraded\n  - Suggest retry after a short interval; if a known maintenance window exists, indicate general timing (e.g., \"after maintenance ends\"). Preserve user-entered data for later submission.\n\n### Error Handling Flow (Business-Level)\n\n```mermaid\ngraph LR\n  subgraph \"User Experience\"\n    A[\"User Attempts Action\"] --> B[\"System Evaluates Request State\"]\n    B --> C{\"Is User Authenticated?\"}\n    C -->|\"No\"| D[\"Guide to Sign In or Verify Email\"]\n    C -->|\"Yes\"| E{\"Has Permission?\"}\n    E -->|\"No\"| F[\"Show Not Permitted Message\"]\n    E -->|\"Yes\"| G{\"Is Input Valid?\"}\n    G -->|\"No\"| H[\"Show Field-Specific Guidance\"]\n    G -->|\"Yes\"| I{\"Resource State OK? (Exists/Not Conflicting)\"}\n    I -->|\"No\"| J[\"Handle Not Found or Conflict with Guidance\"]\n    I -->|\"Yes\"| K{\"Service Healthy?\"}\n    K -->|\"No\"| L[\"Show Retry Guidance and Preserve Input\"]\n    K -->|\"Yes\"| M[\"Perform Action Successfully\"]\n  end\n```\n\n## Conflict Resolution for Concurrent Updates (Business Perspective)\nConcurrent edits can occur when the same todo item is open on multiple devices or sessions. The system handles such conflicts to protect user data and ensure clarity.\n\nPrinciples:\n- No silent overwrites: the system informs users when the item changed elsewhere.\n- User choice with safe defaults: provide clear options that minimize unintended data loss.\n- Visibility of differences: describe that the item has changed and that the user’s edits may conflict.\n\nBusiness-level resolution options (presented without UI design):\n- Review and Merge: users may update their draft to reflect the latest changes and reapply their edits.\n- Overwrite with My Changes: users may choose to overwrite the current item with their recent edits.\n- Discard My Edits: users may discard their edits and accept the latest item state.\n\nExpected behaviors:\n- When a conflict is detected, the system pauses the save operation and presents the above options.\n- If the user chooses to review and merge, the system provides the latest version and retains the user’s attempted changes for manual reconciliation.\n- If the user overwrites, the system records that a conflict was resolved by overwrite for audit purposes.\n- If the user discards edits, the system reverts to the latest version and confirms completion to the user.\n\n### Conflict Handling Flow (Business-Level)\n\n```mermaid\ngraph LR\n  A[\"User Submits Changes\"] --> B[\"Detect Version Mismatch\"]\n  B --> C{\"Conflict Detected?\"}\n  C -->|\"No\"| D[\"Save Changes\"]\n  C -->|\"Yes\"| E[\"Inform User and Offer Options\"]\n  E --> F{\"User Chooses Path\"}\n  F -->|\"Review and Merge\"| G[\"Load Latest and Retain User Edits\"]\n  F -->|\"Overwrite\"| H[\"Apply User Edits and Mark Overwrite\"]\n  F -->|\"Discard Edits\"| I[\"Show Latest and Discard User Attempt\"]\n  G --> J[\"User Completes Reconciliation and Saves\"]\n  H --> J\n  I --> K[\"Return to Item View\"]\n```\n\n## Audit and Monitoring Expectations (Business-Level)\nAudit and monitoring ensure accountability, security, and service quality. The following are business expectations and do not mandate specific technologies.\n\nAudit scope (business events):\n- Sign-in success and failure events (without storing sensitive secrets).\n- Email verification initiation and completion.\n- Session termination events including user-initiated global logout.\n- Authorization denials for protected actions.\n- Validation denials with categorical reasons (e.g., \"title length\").\n- Not found access attempts for protected resources.\n- Conflict detections and chosen resolution paths (merge, overwrite, discard).\n- Rate limit denials by action category.\n- Service unavailable or degraded events affecting user actions.\n\nMonitoring scope (business indicators):\n- Error rate by category and action (e.g., percentage of failed create attempts due to validation).\n- Retry success rates after guidance is provided.\n- Time-to-recovery for transient failures.\n- Distribution of conflict resolution choices.\n- Rate limit incidents per user segment.\n\nPrivacy expectations:\n- Audit entries exclude sensitive content (e.g., full passwords, private todo text). Where necessary, use categorical labels (e.g., \"validation: title length exceeded\") rather than raw content.\n- Aggregated analytics may be used to improve service quality.\n\nRetention expectations:\n- Maintain audit records for a period consistent with business and legal requirements. Summarized metrics may be retained longer than raw events when permissible.\n\n## EARS-Formatted Error Requirements and Acceptance Criteria\nAll applicable error and exception requirements are written in EARS to ensure clarity and testability. The following requirements are organized by error category.\n\n### Authentication (EARS)\n- WHEN 사용자가 잘못된 자격 증명을 제출할 때, THE todoApp SHALL 사용자에게 \"We couldn’t sign you in. Check your email and password and try again.\" 메시지와 함께 즉시 재시도를 안내한다.\n- WHEN 사용자가 이메일 미인증 상태에서 로그인을 시도할 때, THE todoApp SHALL 사용자에게 이메일 인증 필요 메시지를 제공하고 인증 완료 후 재시도를 허용한다.\n- WHEN 사용자 세션이 만료되었을 때, THE todoApp SHALL 사용자에게 다시 로그인하도록 안내하고 성공적인 로그인 후 직전 작업 컨텍스트로 복귀시킨다.\n- IF 동일 사용자가 모든 기기에서 로그아웃을 수행했을 경우, THEN THE todoApp SHALL 기존 세션을 종료하고 재인증을 요구한다.\n\nAcceptance criteria (Authentication):\n- THE todoApp SHALL 표준 메시지 문구를 제공하고, 동일 상황에서 메시지가 일관되게 노출된다.\n- THE todoApp SHALL 로그인 실패 횟수를 모니터링 가능한 이벤트로 기록하되, 민감 정보를 저장하지 않는다.\n\n### Authorization (EARS)\n- WHEN 사용자가 권한이 없는 작업을 시도할 때, THE todoApp SHALL \"You don’t have permission to do that.\" 메시지를 표시하고 안전한 대체 경로로 이동을 제안한다.\n- IF 사용자가 다른 사람의 항목에 접근을 시도할 경우, THEN THE todoApp SHALL 해당 항목의 존재 여부를 노출하지 않고 접근 거부 안내만 제공한다.\n\nAcceptance criteria (Authorization):\n- THE todoApp SHALL 모든 권한 부재 케이스에서 동일 톤의 안내 문구를 사용한다.\n- THE todoApp SHALL 권한 거부 사건을 카테고리화하여 감사 로그에 기록한다.\n\n### Validation (EARS)\n- WHEN 사용자가 제목 없이 항목 생성을 시도할 때, THE todoApp SHALL 제목이 필요하다는 메시지와 길이 기준(1–100자)을 안내한다.\n- WHEN 사용자가 설명 길이 1,000자를 초과할 때, THE todoApp SHALL 초과 길이 안내를 제공하고 입력을 수정하도록 유도한다.\n- WHEN 사용자가 현재 시간보다 과거의 기한을 설정할 때, THE todoApp SHALL 사용자 설정 시간대를 기준으로 미래 시점이어야 한다는 메시지를 제공한다.\n- WHEN 일부 필드만 유효하지 않을 때, THE todoApp SHALL 유효한 입력을 보존하고 유효하지 않은 필드만 수정하도록 안내한다.\n\nAcceptance criteria (Validation):\n- THE todoApp SHALL 각 유효성 오류에 대해 구체적이고 단일 원인을 밝히는 메시지를 제공한다.\n- THE todoApp SHALL 유효한 입력을 잃지 않도록 보존한다.\n\n### Not Found (EARS)\n- WHEN 사용자가 더 이상 존재하지 않거나 접근할 수 없는 항목을 요청할 때, THE todoApp SHALL 항목이 사용 불가하다는 메시지를 제공하고 사용자의 목록으로 돌아가도록 제안한다.\n- IF 사용자가 오래된 링크를 통해 접근할 경우, THEN THE todoApp SHALL 새로고침 또는 목록 보기로 이동하도록 안내한다.\n\nAcceptance criteria (Not Found):\n- THE todoApp SHALL 항목 존재 여부나 소유권을 유추할 수 있는 정보를 노출하지 않는다.\n- THE todoApp SHALL 안전한 탐색 경로를 항상 제공한다.\n\n### Conflict (EARS)\n- WHEN 동시 수정이 감지될 때, THE todoApp SHALL 저장을 일시 중단하고 사용자가 선택할 수 있는 \"Review and Merge\", \"Overwrite\", \"Discard My Edits\" 옵션을 제시한다.\n- WHEN 사용자가 \"Review and Merge\"를 선택할 때, THE todoApp SHALL 최신 버전을 불러오고 사용자의 시도한 변경을 보존하여 수동 병합을 지원한다.\n- WHEN 사용자가 \"Overwrite\"를 선택할 때, THE todoApp SHALL 사용자의 변경으로 현재 항목을 덮어쓰고 이 결정을 감사 용도로 기록한다.\n- WHEN 사용자가 \"Discard My Edits\"를 선택할 때, THE todoApp SHALL 최신 상태를 표시하고 사용자의 시도한 변경을 폐기한다.\n\nAcceptance criteria (Conflict):\n- THE todoApp SHALL 충돌이 발생한 저장 시도에서 사용자 데이터의 무통보 덮어쓰기를 방지한다.\n- THE todoApp SHALL 충돌 해결 옵션 중 하나를 사용자가 선택하지 않으면 항목 상태가 변경되지 않는다.\n\n### Rate Limit (EARS)\n- WHERE 단일 사용자에 대해 쓰기 동작(생성/수정/삭제)이 1분 내 60회를 초과하는 경우, THE todoApp SHALL 해당 사용자에게 \"You’ve reached the limit for this action. Please wait a moment and try again.\" 메시지로 안내하고 최소 1분 후 재시도를 허용한다.\n- WHERE 로그인 시도가 10분 내 10회를 초과하는 경우, THE todoApp SHALL 추가 시도를 일시 차단하고 사용자에게 일정 시간 후 재시도 안내 및 비밀번호 재설정 경로를 제시한다.\n- WHERE 시스템 보호가 필요한 기타 민감 동작이 단시간에 과도하게 반복되는 경우, THE todoApp SHALL 사용 빈도 및 대기 시간에 대한 명확한 안내를 제공한다.\n\nAcceptance criteria (Rate Limit):\n- THE todoApp SHALL 사용자에게 남은 대기 시간의 대략적 범위를 자연어로 안내한다.\n- THE todoApp SHALL 속도 제한 사건을 모니터링 가능한 형태로 집계한다.\n\n### Service Unavailable / Degraded (EARS)\n- WHEN 일시적인 서비스 문제로 요청을 처리할 수 없을 때, THE todoApp SHALL 사용자에게 재시도 권장 메시지와 짧은 대기 후 시도를 안내한다.\n- WHERE 계획된 점검 기간 동안, THE todoApp SHALL 제한된 가용성을 알리고 점검 종료 후 이용 가능하다는 일반적 일정을 제시한다.\n- WHILE 서비스가 부분적으로 저하된 상태일 때, THE todoApp SHALL 영향을 받는 기능을 명시하고 대체 가능한 경로가 있으면 안내한다.\n- IF 요청이 실패했지만 사용자가 입력한 데이터가 보존 가능할 경우, THEN THE todoApp SHALL 데이터를 안전하게 보존하여 사용자가 나중에 다시 제출할 수 있도록 한다.\n\nAcceptance criteria (Service Unavailable / Degraded):\n- THE todoApp SHALL 사용자 데이터 손실 없이 실패를 통지하며 재시도 경로를 제공한다.\n- THE todoApp SHALL 점검 등 예측 가능한 제한이 있는 경우 사전에 고지 가능한 메시지 형식을 지원한다.\n\n### Cross-Cutting Error Handling Principles (EARS)\n- THE todoApp SHALL 모든 오류 메시지에서 기술적 세부 정보(내부 오류 코드, 내부 식별자)를 노출하지 않는다.\n- THE todoApp SHALL 동일한 오류 상황에 대해 일관된 문구와 톤을 사용한다.\n- THE todoApp SHALL 사용자의 최근 작업 컨텍스트를 가능한 범위에서 보존하여 회복 후 작업을 이어갈 수 있도록 한다.\n- THE todoApp SHALL 오류 발생 시 사용자가 한 번의 조작으로 재시도할 수 있는 흐름을 제공한다(가능한 경우).\n- THE todoApp SHALL 모든 오류 범주에 대해 감사 및 모니터링 가능한 비식별 이벤트를 생성한다.\n\n## Acceptance Test Scenarios (EARS)\n- WHEN 사용자가 제목 없이 항목 생성을 제출할 때, THE todoApp SHALL 제목 유효성 메시지를 즉시 표시하고 다른 필드 값은 보존한다.\n- WHEN 사용자가 세션 만료 후 항목 완료를 시도할 때, THE todoApp SHALL 다시 로그인하도록 안내하고 성공 후 항목 완료 시도를 이어갈 수 있도록 한다.\n- WHEN 두 기기에서 같은 항목을 거의 동시에 수정 및 저장할 때, THE todoApp SHALL 한 저장을 성공시키고 다른 저장에는 충돌 메시지와 해결 옵션을 제공한다.\n- WHEN 사용자가 1분 내 60회를 초과하는 수정 시도를 할 때, THE todoApp SHALL 추가 시도를 제한하고 대기 안내 메시지를 제공한다.\n- WHEN 서비스가 일시적으로 가용하지 않을 때, THE todoApp SHALL 사용자 입력을 보존하고 짧은 대기 후 재시도를 유도한다.\n\n## Glossary (Business-Level)\n- Authentication: Processes ensuring a user is who they claim to be.\n- Authorization: Processes ensuring a user is allowed to perform a requested action.\n- Validation: Checking that user-provided inputs meet business rules.\n- Conflict: Differences between the user’s attempted changes and the resource’s current state.\n- Rate Limit: Business-defined bounds on action frequency to protect users and the system.\n- Service Degraded/Unavailable: Temporary reduction or loss of service capability.\n\n## Traceability\n- Authentication and Authorization sections trace to the [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md).\n- Validation and Not Found sections trace to the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md).\n- Conflict resolution traces to the [User Flows for todoApp](./05-todoApp-user-flows.md).\n- Retry and service health expectations align with the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md).\n"},"tokenUsage":{"total":22423,"input":{"total":15537,"cached":0},"output":{"total":6886,"reasoning":1600,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":5,"created_at":"2025-08-15T03:56:42.502Z"},"tokenUsage":{"aggregate":{"total":132264,"input":{"total":96612,"cached":7808},"output":{"total":35652,"reasoning":14976,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":129480,"input":{"total":94275,"cached":7808},"output":{"total":35205,"reasoning":14592,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Define complete authentication behaviors, role hierarchy, and permissions so access rules are unambiguous from a business perspective.","filename":"02-todoApp-user-roles-and-authentication.md","documentType":"requirement","outline":["Purpose and Scope","Authentication Requirements","Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)","User Role Structure","Role Definitions and Capabilities","Permission Matrix (actions by role)","Session and Token Management (business rules for token lifetimes and refresh)","Access Control Rules and Examples (EARS format)","Account Lifecycle (creation, verification, suspension, deletion)","Security and Privacy Considerations","Audit and Activity Logging (business expectations)"],"audience":"development team","keyQuestions":["What roles exist and what can each do?","What authentication features are available to users?","How are sessions and tokens managed from a business standpoint?","What are the access control rules and edge cases?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Include a clear permission matrix table by role","Write all applicable requirements in EARS format","Describe token management in business terms without API-level specifications","Do not include API endpoints, database schema, or technical architecture"],"content":"# todoApp User Roles and Authentication Requirements\n\nThis document defines business requirements only for authentication, authorization, and account lifecycle in the todoApp service. It specifies WHAT the system must do from a business perspective, not HOW to build it. All technical implementation decisions (architecture, APIs, database design, storage mechanisms) are at the discretion of the development team.\n\n## Purpose and Scope\n- Define complete authentication behaviors, role hierarchy, and permissions so access rules are unambiguous from a business perspective.\n- Establish session and token management principles, including lifetimes, rotation, and revocation.\n- Specify account lifecycle stages and business outcomes.\n- Provide EARS-formatted, testable requirements for core auth flows and access control.\n- Exclude technical implementation details such as API endpoints, database schemas, or infrastructure choices.\n\n## Authentication Requirements\n- The service must support email and password–based authentication for end users.\n- Email verification is required to establish account ownership and enable certain sensitive actions.\n- Sessions are represented by tokens issued upon successful authentication and renewed via refresh logic according to business rules defined in this document.\n- The system must prevent unauthorized access to user-owned resources (e.g., personal todo items and account settings) and ensure administrators can perform support and policy enforcement actions under strict accountability.\n\n### Visual Overview of Core Authentication Flows\n\n```mermaid\ngraph LR\n  subgraph \"Registration and Verification\"\n    A1[\"User Submits Registration(Email, Password)\"] --> A2[\"Validate Input(Format, Policy)\"]\n    A2 --> A3{\"Valid?\"}\n    A3 -->|\"Yes\"| A4[\"Create Account(Pending Verification)\"]\n    A3 -->|\"No\"| A5[\"Inform Validation Errors\"]\n    A4 --> A6[\"Send Verification Email(Link, 24h Expiry)\"]\n    A6 --> A7[\"User Clicks Verification Link\"]\n    A7 --> A8{\"Token Valid and Not Expired?\"}\n    A8 -->|\"Yes\"| A9[\"Mark Email Verified\"]\n    A8 -->|\"No\"| A10[\"Inform Link Invalid or Expired\"]\n  end\n\n  subgraph \"Login and Session Management\"\n    B1[\"User Submits Login(Email, Password)\"] --> B2[\"Validate Credentials\"]\n    B2 --> B3{\"Successful?\"}\n    B3 -->|\"Yes\"| B4[\"Issue Access Token(20m)\"]\n    B3 -->|\"Yes\"| B5[\"Issue Refresh Token(14d, Rotating)\"]\n    B3 -->|\"No\"| B6[\"Increment Failure Counter and Inform\"]\n    B4 --> B7[\"Authorized Access to Own Resources\"]\n    B5 -.-> B8[\"Refresh Flow: Rotate Refresh Token\"]\n    B8 -.-> B4\n  end\n```\n\n## Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)\nAll applicable requirements are expressed using EARS format.\n\n### Registration\n- WHEN 사용자가 등록 정보를 제출할 때(이메일, 비밀번호), THE todoApp SHALL 입력 형식을 검증하고 비밀번호 정책을 적용한다.\n- IF 입력이 정책에 부합하지 않을 때, THEN THE todoApp SHALL 구체적 검증 실패 사유를 사용자에게 알린다(민감 정보 노출 없이).\n- WHEN 등록이 유효할 때, THE todoApp SHALL 계정을 생성하고 이메일 검증 상태를 미검증으로 설정한다.\n- WHEN 계정이 생성될 때, THE todoApp SHALL 검증 링크가 포함된 이메일을 발송한다.\n- THE todoApp SHALL 검증 링크의 유효기간을 24시간으로 제한한다.\n- WHERE 검증 링크가 만료되었을 때, THE todoApp SHALL 재전송 요청을 허용하되 24시간 내 최대 3회로 제한한다.\n\n### Login\n- WHEN 사용자가 이메일과 비밀번호로 로그인할 때, THE todoApp SHALL 자격 증명을 검증하고 2초 이내에 성공 또는 실패 결과를 제공한다.\n- IF 자격 증명이 유효할 때, THEN THE todoApp SHALL 액세스 토큰(유효기간 20분)과 리프레시 토큰(유효기간 14일, 회전 방식)을 발급한다.\n- IF 자격 증명이 유효하지 않을 때, THEN THE todoApp SHALL 구체적 필드가 아닌 일반적인 실패 메시지를 제공한다.\n- WHILE 계정이 잠금 상태일 때(보안 정책에 의해), THE todoApp SHALL 로그인을 거부하고 잠금 해제 시간 또는 절차를 안내한다.\n\n### Logout\n- WHEN 사용자가 로그아웃을 요청할 때, THE todoApp SHALL 현재 세션의 액세스를 즉시 무효화한다.\n- WHERE 사용자가 모든 기기에서 로그아웃을 선택할 때, THE todoApp SHALL 해당 사용자의 모든 활성 세션과 리프레시 토큰을 즉시 폐기한다.\n\n### Email Verification\n- WHEN 사용자가 검증 링크를 클릭할 때, THE todoApp SHALL 링크의 유효성 및 만료 여부를 확인한다.\n- IF 링크가 유효하고 만료 전일 때, THEN THE todoApp SHALL 이메일을 검증 상태로 갱신한다.\n- IF 링크가 유효하지 않거나 만료되었을 때, THEN THE todoApp SHALL 검증 실패 사실과 재전송 절차를 안내한다.\n\n### Reset Password\n- WHEN 사용자가 비밀번호 재설정을 요청할 때(이메일 제공), THE todoApp SHALL 존재 여부를 노출하지 않는 표준 응답을 제공한다.\n- WHEN 재설정 링크를 발송할 때, THE todoApp SHALL 60초 이내에 이메일 전송을 시도한다.\n- THE todoApp SHALL 재설정 링크의 유효기간을 1시간으로 제한한다.\n- IF 재설정 토큰이 유효하고 만료 전일 때, THEN THE todoApp SHALL 새 비밀번호 정책을 검증하고 성공 시 모든 기존 세션을 폐기한다(현재 기기 유지 옵션 제공).\n\n### Change Password (Authenticated)\n- WHEN 인증된 사용자가 비밀번호 변경을 요청할 때, THE todoApp SHALL 현재 비밀번호와 새 비밀번호 정책을 검증한다.\n- IF 검증이 성공할 때, THEN THE todoApp SHALL 새 비밀번호로 갱신하고 기존 기기들의 세션을 모두 폐기하되 현재 기기는 유지할 수 있는 옵션을 제공한다.\n\n### Revoke Sessions\n- WHEN 사용자가 \"모든 세션 해지\"를 수행할 때, THE todoApp SHALL 해당 사용자의 모든 활성 액세스 토큰과 리프레시 토큰을 즉시 무효화한다.\n- WHEN 관리자가 특정 사용자의 세션 해지를 수행할 때, THE todoApp SHALL 즉시 모든 세션을 폐기하고 사용자에게 보안 알림을 제공한다(알림 수단은 환경에 따라 선택된다).\n\n## User Role Structure\n- Roles in scope: user, admin.\n- Role hierarchy: admin supersedes user in privilege but remains bound by accountability, privacy, and least-privilege business rules.\n- Non-authenticated state: unauthenticated user (guest) is not a role but a state with no access to protected resources.\n\n## Role Definitions and Capabilities\n\n### user\n- Primary audience: authenticated end user who manages only their own todo items and account.\n- Can: create, read, update, complete, and delete personal tasks; manage own account; view and revoke own sessions; export own data; delete own account subject to retention policy; request password reset; change password; verify email.\n- Cannot: access or modify any other user’s data or sessions; view audit logs; view aggregated analytics; change service-wide settings; assign roles.\n- JWT payload (business-level claims): userId, role=\"user\", permissions=[\"todo:own:read\",\"todo:own:write\",\"account:own:manage\",\"session:own:manage\",\"export:own\"].\n\n### admin\n- Primary audience: administrative user with authority to oversee the service for support and policy enforcement.\n- Can: suspend/reactivate user accounts with reason; reset user sessions; assist with account recovery through approved flows; access aggregated analytics; access audit trails; configure service-wide settings within policy; perform data export for a user upon verified lawful request.\n- Cannot: view or retrieve user passwords; access user content beyond what is necessary for support/policy enforcement and only under explicit justification; impersonate users without approved process.\n- JWT payload (business-level claims): userId, role=\"admin\", permissions=[\"user:any:manage\",\"session:any:manage\",\"analytics:aggregate:view\",\"audit:trail:view\",\"settings:service:manage\"].\n\n## Permission Matrix (actions by role)\nNote: \"Unauthenticated\" represents a state, not a role.\n\n| Action | Unauthenticated | user | admin |\n|-------|------------------|------|-------|\n| Register account | ✅ | ❌ | ❌ |\n| Login | ✅ | ❌ | ❌ |\n| Verify email | ✅ (via link) | ✅ | ✅ (support resend) |\n| View own todos | ❌ | ✅ | ✅ (only for support with justification) |\n| Create/update/delete own todos | ❌ | ✅ | ✅ (only for support with justification) |\n| View another user’s todos | ❌ | ❌ | ❌ (unless authorized support action) |\n| View own profile/account | ❌ | ✅ | ✅ |\n| Update own profile/account | ❌ | ✅ | ✅ (only for support with authorization) |\n| Change own password | ❌ | ✅ | ✅ |\n| Request password reset | ✅ | ✅ | ✅ (on behalf of user) |\n| List own sessions | ❌ | ✅ | ✅ |\n| Revoke own sessions | ❌ | ✅ | ✅ |\n| Revoke another user’s sessions | ❌ | ❌ | ✅ |\n| Suspend/reactivate user account | ❌ | ❌ | ✅ |\n| Delete own account | ❌ | ✅ | ✅ (upon lawful request) |\n| Access aggregated analytics | ❌ | ❌ | ✅ |\n| Access audit logs | ❌ | ❌ | ✅ |\n| Configure service-wide settings | ❌ | ❌ | ✅ |\n\n## Session and Token Management (business rules for token lifetimes and refresh)\n- THE todoApp SHALL use JWT for access and refresh tokens.\n- THE todoApp SHALL issue access tokens with a validity of 20 minutes.\n- THE todoApp SHALL issue refresh tokens with a validity of 14 days.\n- THE todoApp SHALL rotate refresh tokens upon each successful refresh and immediately invalidate the prior refresh token.\n- THE todoApp SHALL bind each session to a logical device/session identifier to enable session listing and revocation.\n- WHERE a user changes password, THE todoApp SHALL revoke all existing sessions and refresh tokens, with an option to preserve the current device session only when explicitly chosen by the user.\n- WHERE an administrator forces a password reset or security hold, THE todoApp SHALL revoke all sessions for that user without exception.\n- THE todoApp SHALL limit concurrent active sessions per user to 10; attempts to create the 11th session SHALL require the user to revoke at least one existing session or accept automatic revocation of the oldest idle session.\n- THE todoApp SHALL provide session metadata to the user for each session: creation time, last activity time, device label where available, and approximate location derived from coarse signals where permitted by policy.\n- THE todoApp SHALL treat token storage location as a technical decision of the development team and require that storage be secure and resistant to common attacks appropriate to the platform; preference for httpOnly cookies on the web is recommended at the policy level.\n- THE todoApp SHALL include in JWT payload at minimum: userId, role, and permissions array necessary for authorization decisions.\n\n## Access Control Rules and Examples (EARS format)\n- THE todoApp SHALL enforce least privilege so that users access only resources they own unless an administrative support action is justified and recorded.\n- WHEN 인증되지 않은 주체가 보호된 리소스에 접근하려 할 때, THE todoApp SHALL 접근을 거부하고 인증 절차를 안내한다.\n- WHEN 사용자가 다른 사용자의 리소스를 조회, 변경, 삭제하려 할 때, THE todoApp SHALL 접근을 거부한다.\n- WHEN 관리자가 사용자 계정 정지(또는 재활성화)를 수행할 때, THE todoApp SHALL 사유와 근거를 기록하고 해당 사용자에게 알림을 제공한다.\n- WHEN 관리자가 사용자 데이터를 열람해야 하는 지원 상황일 때, THE todoApp SHALL 승인된 프로세스 내에서 최소한의 범위로 접근을 허용하고 모든 활동을 감사 로그에 기록한다.\n- IF 이메일이 미검증 상태일 때, THEN THE todoApp SHALL 민감 기능(예: 데이터 내보내기, 계정 삭제)을 제한하고 검증 절차를 우선 안내한다.\n- WHERE 정책상 비정상 활동이 감지될 때(예: 다수 실패 로그인), THE todoApp SHALL 추가 인증 절차 또는 일시적 제한을 적용한다.\n\n## Account Lifecycle (creation, verification, suspension, deletion)\n\n### Creation\n- WHEN 계정을 생성할 때, THE todoApp SHALL 이메일을 유일 식별자로 사용하고 비밀번호 정책을 강제한다.\n- THE todoApp SHALL 허용 가능한 등록 시도 빈도를 제한하여 자동화된 남용을 방지한다(예: 동일 IP 또는 이메일 도메인 기준의 정책적 제한).\n\n### Verification\n- THE todoApp SHALL 요구되는 경우에 한해 검증 링크 재전송을 허용하되 24시간 내 3회로 제한한다.\n- IF 검증이 7일 내 완료되지 않을 때, THEN THE todoApp SHALL 다음 로그인 시 검증을 우선 수행하도록 요구한다.\n\n### Suspension\n- WHEN 사용자가 자발적 비활성화를 요청할 때, THE todoApp SHALL 로그인을 제한하고 데이터 보존 정책에 따라 복귀 가능 상태로 전환한다.\n- WHEN 관리자가 정책 위반으로 계정을 정지할 때, THE todoApp SHALL 모든 세션을 즉시 종료하고 정지 사유, 시작 시각, 재검토 일정을 기록한다.\n\n### Deletion\n- WHEN 사용자가 계정 삭제를 확인할 때, THE todoApp SHALL 30일 유예 기간(철회 가능)을 적용하고 이후 영구 삭제한다.\n- WHILE 유예 기간 동안, THE todoApp SHALL 로그인 시 삭제 철회 옵션을 제공한다.\n- IF 법적 보존 의무가 있는 데이터가 존재할 때, THEN THE todoApp SHALL 해당 데이터의 삭제를 보류하고 사유를 사용자에게 고지한다(허용 범위 내).\n\n## Security and Privacy Considerations\n\n### Password Policy\n- THE todoApp SHALL require minimum password length of 12 characters.\n- THE todoApp SHALL require at least three of the following: uppercase letters, lowercase letters, numbers, special characters.\n- THE todoApp SHALL prevent use of commonly compromised passwords using a banned list.\n- THE todoApp SHALL prevent reuse of the previous 5 passwords.\n\n### Rate Limiting and Lockouts\n- THE todoApp SHALL allow up to 5 consecutive failed login attempts before imposing a 5-minute cooldown.\n- IF 10 consecutive failures occur within 30 minutes, THEN THE todoApp SHALL temporarily lock the account for 15 minutes and notify the user of unusual activity.\n- THE todoApp SHALL throttle password reset requests to a maximum of 5 per 24 hours per account.\n\n### Privacy by Design\n- THE todoApp SHALL avoid revealing whether an email is registered in responses to registration and password reset requests.\n- THE todoApp SHALL record audit events without storing sensitive secrets (e.g., no plaintext passwords, no full tokens in logs).\n- THE todoApp SHALL store audit timestamps in UTC while displaying times to users in their locale settings where applicable.\n\n### Notifications and Messaging\n- THE todoApp SHALL send verification and reset emails within 60 seconds under normal operating conditions.\n- THE todoApp SHALL ensure messages avoid including sensitive data and provide clear next steps for recovery.\n\n### Administrative Safeguards\n- THE todoApp SHALL require admins to provide a reason when performing user-impacting actions (suspension, session revocation, role modification).\n- THE todoApp SHALL restrict access to aggregated analytics to admins only and ensure data is de-identified at the individual level.\n\n## Audit and Activity Logging (business expectations)\n- THE todoApp SHALL record the following event categories at minimum: registration, email verification, login success/failure, logout, password reset request, password reset completion, password change, session creation, session refresh, session revocation, account suspension/reactivation, account deletion request, account deletion completion, admin configuration changes, elevated data access by admin.\n- WHEN 감사 이벤트가 기록될 때, THE todoApp SHALL 포함 정보로 이벤트 유형, 주체(사용자 또는 관리자), 타임스탬프(UTC), 대상(해당 시), 결과(성공/실패), 사유(해당 시)를 저장한다.\n- WHERE 관리자가 사용자 데이터에 접근하는 경우, THE todoApp SHALL 해당 이벤트를 고위험으로 분류하고 별도 검토 큐에 포함한다.\n- THE todoApp SHALL provide users with access to their own audit history for security-relevant actions (e.g., logins, password changes, session revocations).\n\n## Related Documents\n- For service vision and business model, see the [Service Overview for todoApp](./01-todoApp-service-overview.md).\n- For end-to-end feature behaviors, see the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md).\n- For detailed failure behaviors and recovery, see the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md).\n- For performance, availability, and privacy expectations, see the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md).\n\n---\n\n## Appendix: Additional EARS Examples for Edge Cases\n- IF 비밀번호 재설정 토큰이 이미 사용되었을 때, THEN THE todoApp SHALL 해당 토큰을 무효로 처리하고 재요청 절차를 안내한다.\n- IF 동일한 기기에서 비정상적인 세션 갱신 빈도가 관찰될 때, THEN THE todoApp SHALL 세션을 강제로 종료하고 재인증을 요구한다.\n- WHERE 사용자가 장치 라벨을 제공하는 기능을 사용 중일 때, THE todoApp SHALL 세션 목록에 라벨을 함께 표시한다.\n- WHEN 삭제 유예 기간이 종료될 때, THE todoApp SHALL 영구 삭제를 수행하고 사용자에게 결과를 통지한다.\n- WHILE 계정이 정지 상태일 때, THE todoApp SHALL 로그인 및 데이터 접근을 차단하고 정지 사유와 재검토 일정을 안내한다.\n"},"tokenUsage":{"total":22997,"input":{"total":15537,"cached":3840},"output":{"total":7460,"reasoning":3008,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":6,"created_at":"2025-08-15T03:56:45.092Z"},"tokenUsage":{"aggregate":{"total":155261,"input":{"total":112149,"cached":11648},"output":{"total":43112,"reasoning":17984,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":152477,"input":{"total":109812,"cached":11648},"output":{"total":42665,"reasoning":17600,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Capture the minimum functional scope for a Todo list and write testable business requirements for developers.","filename":"03-todoApp-functional-requirements.md","documentType":"requirement","outline":["Overview of Minimal Feature Set","Todo Item Management (Create, Read, Update, Delete)","Completion and Reopening of Items","Optional Attributes (description, due date)","Filtering and Sorting (business expectations)","Time Zone and Localization Behaviors","Data Ownership and Privacy Rules","Import/Export and Data Portability (optional)","Business Constraints and Limits","Acceptance Criteria (EARS format)"],"audience":"development team","keyQuestions":["What minimum features must the Todo service support?","What fields are required for a todo item and what validations apply?","How should filtering and sorting work from a business perspective?","What are the acceptance criteria for the MVP scope?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS format wherever applicable","Do not define any API endpoints or database schemas","Keep scope minimal while ensuring a complete, usable product"],"content":"# todoApp Functional Requirements (MVP)\n\nThis document defines the complete, testable business requirements for the minimal viable todoApp. It specifies WHAT the system must do in business terms so developers can implement with autonomy. This document provides business requirements only. All technical implementation decisions (architecture, APIs, data storage, indexing, libraries) are at the full discretion of the development team.\n\n## Overview of Minimal Feature Set\n\n- Personal Todo Lists for authenticated users (\"user\" role) with item ownership and privacy by default.\n- Core CRUD operations on todo items: create, read (list and detail), update, delete.\n- Completion and reopening of items with clear state transitions.\n- Optional attributes: description and due date.\n- Business-level filtering and sorting for lists.\n- Business rules for time zone handling and localization of dates.\n- Role-aware access control at the business level, consistent with the authentication document.\n- Optional export of a user’s todos for portability.\n- Measurable constraints and limits to bound MVP scope.\n\nWHEN reading this document, refer to the following related specifications for context and deeper coverage of adjacent topics:\n- See the [todoApp Service Overview](./01-todoApp-service-overview.md) for problem context, scope, and KPIs.\n- See the [User Roles and Authentication for todoApp](./02-todoApp-user-roles-and-authentication.md) for role definitions, permissions, and authentication behaviors.\n- See the [Business Rules for todoApp](./06-todoApp-business-rules.md) for cross-cutting validation and state logic details.\n- See the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md) for user-facing error behaviors and recovery.\n- See the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance, security, reliability, and compliance expectations.\n\n## Principles and Scope Notes\n\n- Minimal Scope: Focus on a single, personal Todo list per user with item-level operations. No sharing, collaboration, tags, subtasks, or reminders in MVP.\n- Business Only: Requirements use natural language and EARS formatting, avoiding any API, database schema, or architecture prescriptions.\n- Role Context: Two roles exist and influence business behavior: \"user\" (personal ownership) and \"admin\" (support and policy enforcement).\n\n## User Roles and Access Context (Business perspective)\n\n- \"user\": Authenticated end user managing only their own todo items and account. Cannot access or modify other users’ data.\n- \"admin\": Administrative user with authority to access any user’s account when necessary for support or policy enforcement; may view aggregated analytics and configure service-wide settings.\n\nEARS Requirements:\n- THE todoApp SHALL restrict access to todo items by ownership, allowing the creator (\"user\") to manage only their own items.\n- WHERE administrative oversight is required for support or policy enforcement, THE todoApp SHALL allow \"admin\" role to access necessary user items in a controlled manner aligned with privacy rules.\n\n## Todo Item Management (Create, Read, Update, Delete)\n\n### Data Elements (Business-Level)\n- Title (required): Short text identifying the item.\n- Description (optional): Extended text elaborating the task.\n- Due Date (optional): The date by which the task is intended to be completed, interpreted in the user’s time zone.\n- Status (system-managed): \"open\" or \"completed\".\n- Created Time / Updated Time (system-managed): Timestamps recorded in business terms and displayed in the user’s time zone.\n- Owner (system-managed): The user who created the item.\n\n### Validation Rules (Business-Level)\n- Title length: 1 to 120 characters (printable characters; leading/trailing whitespace ignored for validation).\n- Description length: 0 to 1,000 characters.\n- Due Date range: Not earlier than the calendar date of item creation; not more than 5 years in the future, based on user’s time zone.\n\nEARS Requirements:\n- WHEN a \"user\" submits a new todo with a title, THE todoApp SHALL create the item and set status to \"open\".\n- IF a title is missing or its trimmed length is 0, THEN THE todoApp SHALL reject creation and instruct the user to provide a valid title of 1–120 characters.\n- IF a title exceeds 120 characters, THEN THE todoApp SHALL reject creation and instruct the user to shorten the title to 120 characters or fewer.\n- IF a description exceeds 1,000 characters, THEN THE todoApp SHALL reject creation and instruct the user to reduce the description to 1,000 characters or fewer.\n- IF a due date is provided earlier than the item’s creation date in the user’s time zone, THEN THE todoApp SHALL reject the due date and prompt the user to choose a valid date.\n- IF a due date is provided more than 5 years in the future, THEN THE todoApp SHALL reject the due date and prompt the user to choose a date within 5 years.\n- THE todoApp SHALL set Created Time at creation and Updated Time whenever any editable field changes.\n- THE todoApp SHALL allow a \"user\" to read (list and detail) only items that they own.\n- WHERE an \"admin\" views a user’s items for support, THE todoApp SHALL display the items with clear indication of the acting role and subject user.\n- WHEN a \"user\" updates an item’s title, description, or due date, THE todoApp SHALL validate all fields using the same rules as creation and update Updated Time upon success.\n- WHEN a \"user\" deletes an item, THE todoApp SHALL remove the item from their list immediately and irreversibly within MVP scope.\n- IF a \"user\" attempts to access, update, or delete an item not owned by them, THEN THE todoApp SHALL deny the operation and inform the user that access is not permitted.\n\n### Pagination and List Size (Business Expectations)\n- THE todoApp SHALL present lists in pages of up to 20 items by default, ordered by default sorting (see Filtering and Sorting).\n- WHERE a user prefers different page sizes, THE todoApp SHALL allow selection of 10, 20, 50, or 100 items per page, remembered per user.\n\n## Completion and Reopening of Items\n\nDefinitions:\n- Complete: Transition an item’s status from \"open\" to \"completed\" and record a Completion Time.\n- Reopen: Transition an item’s status from \"completed\" to \"open\" and clear Completion Time.\n\nEARS Requirements:\n- WHEN a \"user\" marks an \"open\" item as completed, THE todoApp SHALL set status to \"completed\" and record Completion Time.\n- IF an item is already \"completed\" and the user attempts to complete it again, THEN THE todoApp SHALL keep the status unchanged and inform the user that the item is already completed.\n- WHEN a \"user\" reopens a \"completed\" item, THE todoApp SHALL set status to \"open\" and clear Completion Time.\n- IF a \"user\" completes an item with a due date in the past, THEN THE todoApp SHALL still allow completion and retain the past due date for historical accuracy.\n- THE todoApp SHALL allow editing of title, description, and due date regardless of status, unless restricted by policy.\n\n## Optional Attributes (description, due date)\n\nEARS Requirements:\n- WHERE a description is provided, THE todoApp SHALL store and display it with the item.\n- WHERE a due date is provided, THE todoApp SHALL interpret it in the user’s current time zone and treat it as due by the end of that calendar day.\n- IF a due date is removed by the user, THEN THE todoApp SHALL persist the item without a due date and update Updated Time.\n- WHERE no due date is provided, THE todoApp SHALL treat the item as having no scheduling constraint.\n\n## Filtering and Sorting (business expectations)\n\nSupported Filters (combinable):\n- Status: open, completed.\n- Due Date Window: today, tomorrow, this week (Mon–Sun in user’s locale), next week, overdue (due date earlier than today), no due date.\n- Text Match: case-insensitive contains match over title and description.\n- Created/Updated Date ranges: calendar-based, using user’s time zone.\n\nSupported Sorting:\n- Default: due date ascending, with items without due date ordered last; ties by created time descending.\n- Alternative orders: due date descending; created time descending; updated time descending; title ascending.\n\nEARS Requirements:\n- THE todoApp SHALL allow a \"user\" to filter their list by status, due date window, and text match simultaneously.\n- THE todoApp SHALL apply the default sorting when no explicit sort is chosen: due date ascending, items without due date last, ties by created time descending.\n- WHERE a user selects a different sort order, THE todoApp SHALL apply the selected order consistently across pages.\n- IF filters yield zero results, THEN THE todoApp SHALL present an empty result with guidance to adjust filters.\n- WHILE filters are active, THE todoApp SHALL maintain the filter set when the user navigates between pages of results.\n\n## Time Zone and Localization Behaviors\n\nBusiness Baseline for MVP:\n- Default Service Time Zone: Asia/Seoul (KST, UTC+9) for users who have not set a profile time zone.\n- User Time Zone Preference: Each user may have a profile time zone; all date evaluations and displays use the user’s profile time zone if set.\n- Calendar Day Semantics: Due date represents obligation by the end of the calendar day in the user’s time zone.\n\nEARS Requirements:\n- THE todoApp SHALL store and display Created Time, Updated Time, and Completion Time in the user’s profile time zone where available, otherwise in Asia/Seoul (KST, UTC+9).\n- WHEN evaluating whether an item is overdue, THE todoApp SHALL compare the due date’s end-of-day boundary against the current date in the user’s time zone.\n- WHERE a user changes their profile time zone, THE todoApp SHALL re-interpret and display existing due dates and timestamps in the new time zone without altering the original calendar date values.\n- IF a due date falls on a day affected by daylight saving time in the chosen time zone, THEN THE todoApp SHALL still treat the due by end-of-day semantics consistently.\n\n## Data Ownership and Privacy Rules\n\nEARS Requirements:\n- THE todoApp SHALL associate each item with exactly one owner (the creating user) and treat it as private by default.\n- IF a \"user\" attempts to view or modify another user’s items, THEN THE todoApp SHALL deny access and communicate that the content is private.\n- WHERE an \"admin\" performs support actions on a user’s items, THE todoApp SHALL record the acting role context and restrict visibility to the minimum necessary data for the task.\n- THE todoApp SHALL permanently remove a deleted item from the owner’s list in MVP, with no recovery workflow.\n\n## Import/Export and Data Portability (optional)\n\nScope: Export is in scope for MVP; Import is out of scope for MVP.\n\nEARS Requirements:\n- WHERE a \"user\" requests an export of their items, THE todoApp SHALL provide a file containing all of the user’s items and their attributes (title, description, due date if present, status, Created/Updated/Completion Times) in a commonly portable format.\n- IF an export is requested while no items exist, THEN THE todoApp SHALL produce a valid export file containing zero items and an indication that the list is empty.\n- WHERE an export is in progress, THE todoApp SHALL notify the user upon completion using available communication channels defined in the authentication and notification policies.\n\n## Business Constraints and Limits\n\nEARS Requirements:\n- THE todoApp SHALL limit title length to 120 characters and description length to 1,000 characters.\n- THE todoApp SHALL limit due dates to within 5 years from the creation date and not earlier than the creation date in the user’s time zone.\n- THE todoApp SHALL limit the number of items returned per page to one of the supported sizes: 10, 20, 50, or 100.\n- WHERE operational stability requires, THE todoApp SHALL limit item creation to no more than 60 new items per user per minute.\n- WHERE operational stability requires, THE todoApp SHALL limit update and delete actions to no more than 120 operations per user per minute in aggregate.\n- THE todoApp SHALL allow each user to maintain up to 10,000 items concurrently in MVP; beyond this threshold, creation is denied with guidance to archive or delete items.\n\n## Process Flows (Business-Level)\n\nThe following diagrams illustrate end-to-end business flows. They do not prescribe any technical implementation.\n\n### Create Todo Item\n```mermaid\ngraph LR\n  A[\"User Initiates Create\"] --> B[\"Enter Title/Optional Fields\"]\n  B --> C[\"Validate Business Rules\"]\n  C --> D{\"Valid?\"}\n  D -->|\"Yes\"| E[\"Create Item(Status=open)\"]\n  E --> F[\"Set Created/Updated Times\"]\n  F --> G[\"Show Item in List\"]\n  D -->|\"No\"| H[\"Show Validation Guidance\"]\n```\n\n### Complete and Reopen Flow\n```mermaid\ngraph LR\n  A[\"User Selects Item\"] --> B{\"Current Status?\"}\n  B -->|\"open\"| C[\"Mark Completed\"]\n  C --> D[\"Record Completion Time\"]\n  D --> E[\"Reflect Status=completed\"]\n  B -->|\"completed\"| F[\"Reopen Item\"]\n  F --> G[\"Clear Completion Time\"]\n  G --> H[\"Reflect Status=open\"]\n```\n\n### Filtering and Sorting Flow\n```mermaid\ngraph LR\n  A[\"User Opens List\"] --> B[\"Apply Default Sort\"]\n  B --> C[\"User Sets Filters\"]\n  C --> D[\"Combine Filters\"]\n  D --> E[\"Fetch Page(Size per Preference)\"]\n  E --> F{\"Any Results?\"}\n  F -->|\"Yes\"| G[\"Display Items\"]\n  F -->|\"No\"| H[\"Display Empty State Guidance\"]\n```\n\n## Acceptance Criteria (EARS format)\n\nCreation\n- WHEN a \"user\" submits a new item with a valid title (1–120 chars), THE todoApp SHALL create the item with status \"open\" and show it at the appropriate position according to current sorting.\n- IF the title is invalid (missing or >120 chars), THEN THE todoApp SHALL block creation and present guidance to correct the title without losing entered data.\n- WHERE a description up to 1,000 chars is provided, THE todoApp SHALL save it verbatim.\n- IF a due date is provided and is earlier than the creation date or beyond 5 years, THEN THE todoApp SHALL reject the due date with clear guidance.\n\nReading\n- THE todoApp SHALL present items in pages using the user’s preferred page size (default 20), sorted per the active sort rule.\n- WHEN a \"user\" filters by status=\"open\" and due date window=\"today\", THE todoApp SHALL return only the user’s open items due today in their time zone.\n- IF a filter combination results in no matches, THEN THE todoApp SHALL display an empty state with guidance to adjust filters.\n\nUpdating\n- WHEN a \"user\" edits the title, THE todoApp SHALL validate the new title against the same rules as creation and update Updated Time upon success.\n- WHEN a \"user\" edits the description or due date, THE todoApp SHALL validate lengths and date ranges and update Updated Time upon success.\n- IF validation fails on update, THEN THE todoApp SHALL preserve existing data and present guidance to correct inputs.\n\nDeletion\n- WHEN a \"user\" deletes an item they own, THE todoApp SHALL remove it from their list immediately and it SHALL no longer appear in any filter or search.\n- IF a \"user\" attempts to delete an item they do not own, THEN THE todoApp SHALL deny the request and inform the user that access is not permitted.\n\nCompletion/Reopen\n- WHEN a \"user\" completes an open item, THE todoApp SHALL set status to \"completed\" and record Completion Time; the item SHALL still appear according to filters and sorting.\n- WHEN a \"user\" reopens a completed item, THE todoApp SHALL set status to \"open\" and clear Completion Time; the item SHALL re-enter lists according to filters and sorting.\n\nFiltering and Sorting\n- THE todoApp SHALL support filters: status (open/completed), due date windows (today/tomorrow/this week/next week/overdue/no due date), text match, and created/updated date ranges.\n- THE todoApp SHALL support sorts: due date ascending (default, none last; tie by created time desc), due date descending, created time desc, updated time desc, title asc.\n\nTime Zone\n- THE todoApp SHALL treat due dates as end-of-day obligations in the user’s time zone and compute \"overdue\" accordingly.\n- WHERE no profile time zone is set, THE todoApp SHALL default to Asia/Seoul (KST, UTC+9) for all date/time calculations and displays.\n\nOwnership & Privacy\n- THE todoApp SHALL ensure a user can access only their own items; admin may access items for support per policy.\n- IF cross-user access is attempted by a non-admin, THEN THE todoApp SHALL deny and present a privacy message.\n\nExport\n- WHERE a user requests export, THE todoApp SHALL produce a portable file containing all owned items and attributes, including timestamps and status, consistent with current time zone display rules.\n- IF no items exist, THEN THE todoApp SHALL produce a valid export file with zero items and a clear indication of emptiness.\n\nLimits\n- THE todoApp SHALL enforce per-user maximum of 10,000 concurrent items and SHALL present a guidance message when the limit is reached.\n- THE todoApp SHALL enforce per-minute operation limits for creation and update/delete as stated, presenting user-friendly guidance upon reaching limits.\n\n## Traceability and Related Documents\n\n- Business vision and KPIs: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Roles, permissions, and authentication: [User Roles and Authentication for todoApp](./02-todoApp-user-roles-and-authentication.md)\n- Cross-cutting rules and validations: [Business Rules for todoApp](./06-todoApp-business-rules.md)\n- Error responses and recovery: [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance, availability, and security targets: [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md)\n\nEnd of document."},"tokenUsage":{"total":22053,"input":{"total":15537,"cached":0},"output":{"total":6516,"reasoning":2048,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":7,"created_at":"2025-08-15T03:56:52.717Z"},"tokenUsage":{"aggregate":{"total":177314,"input":{"total":127686,"cached":11648},"output":{"total":49628,"reasoning":20032,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":174530,"input":{"total":125349,"cached":11648},"output":{"total":49181,"reasoning":19648,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Describe how information conceptually moves through its lifecycle and the related privacy requirements.","filename":"09-todoApp-data-lifecycle-and-privacy.md","documentType":"requirement","outline":["Conceptual Data Flow Overview (business-level)","Data Creation, Update, and Deletion Lifecycle","Retention and Purging Policies","User-Controlled Export/Portability (optional)","Privacy-by-Design Principles","Data Minimization and Purpose Limitation","Right to Erasure and Account Deletion Behaviors","Traceability to Business Rules and Non-Functional Requirements"],"audience":"development team","keyQuestions":["How is user data handled from creation to deletion?","What privacy safeguards are required across the lifecycle?"],"detailLevel":"moderate detail","relatedDocuments":["06-todoApp-business-rules.md","08-todoApp-non-functional-requirements.md"],"constraints":["Keep descriptions conceptual; do not define database schemas or storage technologies","Use EARS for lifecycle requirements where applicable"],"content":"# todoApp Data Lifecycle and Privacy Requirements\n\nThis document defines business requirements for how data is created, processed, retained, exported, and deleted in the todoApp service. It focuses on what the system must do from a business and user perspective, not how to implement it. This document provides business requirements only; all technical implementation decisions (architecture, APIs, and database design) are at the discretion of the development team.\n\n## 1. Conceptual Data Flow Overview (business-level)\n\nThe todoApp manages a small set of data categories:\n- User Account Data: identity and authentication attributes required to operate an account (e.g., email, password-related artifacts, verification status), plus preferences strictly necessary to provide the service.\n- Todo Item Data: user-owned records representing tasks, including essential fields (e.g., title, status) and optional fields (e.g., description, due date) as defined in the functional scope.\n- Operational Security Data: tokens, verification and reset artifacts, and session metadata necessary to authenticate and authorize users.\n- Administrative and Audit Data: minimal logs and administrative actions necessary for support, safety, fraud control, and legal compliance.\n- Aggregated Analytics (Non-Personal): metrics computed in a way that cannot be reversed to identify individuals.\n\nHigh-level conceptual data flow:\n\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A[\"Account Creation\"] --> B[\"Email Verification\"]\n    B --> C[\"User Login\"]\n    C --> D[\"Create/Update Todo Items\"]\n    D --> E[\"Complete/Reopen/Delete Todo Items\"]\n  end\n\n  subgraph \"System Governance\"\n    F[\"Retention Counters\"] --> G[\"Soft Delete Window\"]\n    G --> H[\"Scheduled Purge\"]\n    I[\"Export Requests\"] --> J[\"Prepare User Data Export\"]\n    K[\"Audit Events\"] --> L[\"Time-bound Retention\"]\n  end\n\n  A --> M[\"Account Profile\"]\n  D --> N[\"Todo Dataset\"]\n  E --> N\n  C --> O[\"Session Lifecycle\"]\n  J --> P[\"User Delivery\"]\n  H --> Q[\"Permanent Deletion\"]\n  L --> R[\"Expiry or Compliance Hold\"]\n```\n\nNotes:\n- \"Soft Delete Window\" is a reversible state prior to permanent deletion.\n- \"Scheduled Purge\" removes data permanently when retention conditions are met.\n\n## 2. Data Creation, Update, and Deletion Lifecycle\n\n### 2.1 Ownership and Access\n- Users (role: user) own and control their own account data and todo items.\n- Administrators (role: admin) operate under least-privilege for support, safety, and policy enforcement. Administrative access to user data is limited to specific, auditable actions justified by a legitimate business need.\n\n### 2.2 Creation Requirements (EARS)\n- THE service SHALL record the creator’s user identifier as the immutable owner of each todo item at creation time.\n- WHEN a user creates a todo item, THE service SHALL store only fields defined as necessary by the functional scope and business rules.\n- IF a creation request omits a required business field, THEN THE service SHALL reject the creation with a clear, user-understandable explanation referencing the missing or invalid field.\n- WHERE optional fields are provided at creation, THE service SHALL validate them against business rules before accepting the item.\n\n### 2.3 Read and Listing Requirements (EARS)\n- THE service SHALL allow a user to view only their own todo items and account data, except where an admin is performing a permitted support action under audit.\n- WHEN a user lists todo items, THE service SHALL return only items not permanently deleted and within the user’s ownership scope.\n- WHERE filters and sorting are requested, THE service SHALL apply only supported business-level filters and sorts as defined in the functional requirements.\n\n### 2.4 Update Requirements (EARS)\n- WHEN a user updates a todo item they own, THE service SHALL validate each changed field against business rules and persist only if all validations pass.\n- IF an update conflicts with a more recent change, THEN THE service SHALL prevent silent overwrites and provide guidance for conflict resolution.\n- THE service SHALL record the time and actor for each successful update in an auditable manner without exposing implementation details to end users.\n\n### 2.5 Completion/Reopen Requirements (EARS)\n- WHEN a user marks an item as completed, THE service SHALL set the item’s status to completed and record the completion timestamp.\n- WHEN a user reopens a completed item, THE service SHALL revert the status and clear or update completion metadata as defined by business rules.\n\n### 2.6 Deletion Requirements (EARS)\n- WHEN a user deletes a todo item, THE service SHALL move the item to a soft-delete state that hides it from normal listings and starts a retention countdown.\n- WHILE a todo item is in soft-delete, THE service SHALL allow the owner to restore it within the defined retention window.\n- IF the soft-delete retention window elapses, THEN THE service SHALL permanently delete the item from active stores during the next scheduled purge.\n- WHERE an admin flags content for policy violations, THE service SHALL allow immediate soft-delete with admin justification recorded in audit data.\n\n## 3. Retention and Purging Policies\n\nRetention is purpose-driven and time-bound. The following policy durations are business requirements and may only be changed via documented policy updates.\n\n### 3.1 Todo Items (EARS)\n- THE service SHALL retain active todo items indefinitely until the owner deletes them or the account is deleted.\n- WHEN a todo item is soft-deleted by its owner, THE service SHALL retain it for up to 30 days to allow restoration.\n- IF a soft-deleted todo item reaches 30 days without restoration, THEN THE service SHALL permanently delete it during the next scheduled purge.\n\n### 3.2 Accounts and Profiles (EARS)\n- WHEN an account is created but not verified within 14 days, THE service SHALL purge the unverified account and all associated artifacts.\n- WHEN a verified user requests account deletion, THE service SHALL initiate a 14-day grace period before permanent deletion to allow reversal.\n- IF the grace period elapses without reversal, THEN THE service SHALL permanently delete the account and all user-owned todo items during the next scheduled purge.\n\n### 3.3 Operational Security Data (EARS)\n- THE service SHALL limit the lifetime of one-time email verification artifacts to 24 hours from issuance.\n- THE service SHALL limit the lifetime of password reset artifacts to 1 hour from issuance.\n- THE service SHALL limit the lifetime of user sessions according to the authentication policy defined in the user roles and authentication requirements.\n\n### 3.4 Administrative and Audit Data (EARS)\n- THE service SHALL retain minimal audit events necessary to reconstruct security- and policy-relevant actions for 180 days, unless a longer retention is mandated by documented legal obligations.\n- WHERE a legal hold is in effect, THE service SHALL suspend purge of affected audit records until the hold is lifted.\n\n### 3.5 Aggregated Analytics (EARS)\n- THE service SHALL keep only aggregated, non-personal metrics that cannot feasibly be re-identified.\n- WHERE any analytics processing would require personal data, THE service SHALL either minimize and anonymize the input or forego the processing to protect user privacy.\n\n### 3.6 Purge Execution (EARS)\n- THE service SHALL execute purge processes on a predictable schedule (at least daily) to remove data whose retention windows have expired.\n- IF a purge process fails partially, THEN THE service SHALL retry purging the remaining eligible records without duplicating prior deletions.\n\n## 4. User-Controlled Export/Portability (optional)\n\n### 4.1 Scope\nUser export includes user-owned account data and todo item content within the user’s ownership scope. Audit logs, administrative justifications, and internal security artifacts are excluded from user export unless required by applicable law.\n\n### 4.2 Export Requirements (EARS)\n- WHEN a user requests an export, THE service SHALL prepare a complete, machine-readable package of the user’s account data and todo items.\n- THE service SHALL deliver the export within 24 hours of the request under normal operating conditions.\n- WHERE an export is large or complex, THE service SHALL communicate progress and provide the completed package once preparation is finished.\n- THE service SHALL limit export requests to once per rolling 7-day period per user to manage capacity and abuse risk.\n\n## 5. Privacy-by-Design Principles\n\n### 5.1 Foundational Principles (EARS)\n- THE service SHALL default to the most privacy-preserving state for all new features and data flows (privacy by default).\n- THE service SHALL enforce least privilege for all role-based access to user data.\n- THE service SHALL ensure purpose limitation by collecting and processing data only for clearly defined, legitimate purposes necessary to operate todoApp.\n- THE service SHALL ensure transparency by documenting data uses and changes to policy in a user-accessible location.\n\n### 5.2 Administrative Access Governance (EARS)\n- WHERE an admin must access user data for support or policy enforcement, THE service SHALL require an explicit business justification recorded in audit data.\n- IF an admin action impacts a user’s data materially (e.g., forced deletion for policy), THEN THE service SHALL record the action with actor, time, scope, and justification in audit data.\n\n### 5.3 Security Posture at Business Level (EARS)\n- THE service SHALL protect personal data at rest and in transit using industry-appropriate safeguards without prescribing specific technologies in this document.\n- THE service SHALL restrict access to personal data to authorized roles only, consistent with the defined permission model.\n\n## 6. Data Minimization and Purpose Limitation\n\n### 6.1 Data Collection Boundaries (EARS)\n- THE service SHALL collect only the minimum personal data required to operate user accounts and manage todo items (e.g., contact identifier and authentication secrets).\n- WHERE optional data is provided by the user (e.g., description, due date), THE service SHALL use it solely to enhance the todo management experience.\n- THE service SHALL avoid collecting special categories of personal data; if such data is inadvertently submitted in free-text fields, the service SHALL treat it with the highest level of protection and not use it for profiling or analytics.\n\n### 6.2 Data Use Boundaries (EARS)\n- THE service SHALL not sell personal data or share it with third parties for independent marketing purposes.\n- WHERE service providers are engaged to operate core functionality, THE service SHALL ensure they process data only on behalf of todoApp for permitted purposes.\n\n### 6.3 Storage Boundaries (EARS)\n- THE service SHALL not store personal data beyond the retention periods defined in this document unless required for legal obligations documented by policy.\n\n## 7. Right to Erasure and Account Deletion Behaviors\n\n### 7.1 Conceptual Deletion Flow\n\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"User Requests Account Deletion\"] --> B[\"Start 14-day Grace Period\"]\n    B --> C{\"Login During Grace?\"}\n  end\n\n  subgraph \"System Outcomes\"\n    D[\"Cancel Deletion and Restore Access\"]\n    E[\"Maintain Grace and Restricted Access\"]\n    F[\"Permanent Deletion at Purge\"]\n  end\n\n  C -->|\"Yes\"| D\n  C -->|\"No\"| E\n  E --> G{\"Grace Expired?\"}\n  G -->|\"Yes\"| F\n  G -->|\"No\"| E\n```\n\n### 7.2 Erasure Requirements (EARS)\n- WHEN a verified user requests account deletion, THE service SHALL initiate a 14-day grace period and notify the user of the effective deletion date.\n- WHILE an account is in the grace period, THE service SHALL restrict access to read-only export and deletion cancellation; normal write operations SHALL be blocked.\n- IF the user logs in and cancels during the grace period, THEN THE service SHALL restore full access and stop the deletion process immediately.\n- IF the grace period ends without cancellation, THEN THE service SHALL permanently delete the account, user-owned todo items, and user-specific preferences during the next scheduled purge.\n- WHERE deletion would impact records under legal hold or unresolved disputes, THE service SHALL defer deletion of those specific records while completing deletion of all other user data.\n\n### 7.3 Exceptions and Residual Data (EARS)\n- THE service SHALL preserve non-identifying, aggregated analytics after account deletion, provided such aggregates cannot be used to re-identify the user.\n- WHERE audit records must be retained for security or compliance, THE service SHALL retain only the minimum necessary audit data for the mandated period, decoupled from content details where feasible.\n\n## 8. Traceability to Business Rules and Non-Functional Requirements\n\nThis document aligns with and should be read in concert with the following:\n- Refer to the [Business Rules and Validation Guide](./06-todoApp-business-rules.md) for field-level validations, ownership, and rate limits that complement lifecycle behaviors.\n- Refer to the [Non-Functional Requirements and Service Expectations](./08-todoApp-non-functional-requirements.md) for performance, availability, and security expectations that constrain lifecycle operations.\n\n### 8.1 Traceability Highlights\n- Creation, update, and deletion validations: see Business Rules sections on Todo Item Validation Rules and Ownership.\n- Export responsiveness and delivery window: see Non-Functional performance expectations.\n- Audit and monitoring expectations: see Non-Functional operational monitoring.\n\n## 9. Business-Level Acceptance and Monitoring Criteria (EARS)\n\n- THE service SHALL complete visible create, update, and delete operations on user data within 2 seconds under normal operating conditions.\n- THE service SHALL execute daily purge cycles that remove all data past retention within 24 hours of eligibility.\n- WHEN a user requests export, THE service SHALL provide the export within 24 hours under normal operating conditions.\n- WHEN a user initiates account deletion, THE service SHALL enforce the 14-day grace period and execute permanent deletion at the next scheduled purge thereafter.\n- WHERE legal hold or compliance exceptions apply, THE service SHALL document the scope and duration and prevent deletion of the held records until the hold is removed.\n\n## 10. Error and Recovery Expectations Across the Lifecycle (EARS)\n\n- IF a user attempts to restore a todo item after the retention window has expired, THEN THE service SHALL inform the user that restoration is no longer possible and the item has been permanently deleted.\n- IF an export preparation exceeds the standard 24-hour window due to exceptional load, THEN THE service SHALL notify the user of delay and deliver the export as soon as preparation completes.\n- IF a purge process encounters inconsistencies, THEN THE service SHALL isolate affected records, log the issue for investigation, and continue purging unaffected eligible records.\n- IF an admin-initiated action is missing a documented justification, THEN THE service SHALL block the action and request a valid justification entry.\n\n## 11. Glossary (Business-Level)\n\n- Soft Delete: A reversible state in which data is hidden from normal operations and scheduled for purge after a retention window.\n- Permanent Deletion (Hard Delete): Irreversible removal of data from active systems following retention rules.\n- Grace Period: A bounded time during which a user may reverse a pending account deletion.\n- Legal Hold: A suspension of purge and deletion for specific records due to legal or compliance obligations.\n- Aggregated Analytics: Non-personal statistical measures that cannot be traced back to an identifiable individual.\n\n---\n\nThis document is business-requirements-only. Developers have full autonomy to determine the technical architecture, interfaces, storage strategies, and operational mechanisms necessary to satisfy these requirements while adhering to organizational standards and applicable laws."},"tokenUsage":{"total":21174,"input":{"total":15537,"cached":0},"output":{"total":5637,"reasoning":1920,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":8,"created_at":"2025-08-15T03:57:03.047Z"},"tokenUsage":{"aggregate":{"total":198488,"input":{"total":143223,"cached":11648},"output":{"total":55265,"reasoning":21952,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":195704,"input":{"total":140886,"cached":11648},"output":{"total":54818,"reasoning":21568,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Define go-live readiness, measurable acceptance criteria, and success metrics to align delivery and evaluation.","filename":"10-todoApp-acceptance-criteria-and-success-metrics.md","documentType":"requirement","outline":["Release Readiness Checklist","MVP Acceptance Criteria (EARS)","Post-Launch Monitoring Plan (business-level)","User Satisfaction and Support Plan","Success Metrics and Reporting Cadence","Risks and Mitigations"],"audience":"business stakeholders","keyQuestions":["What constitutes acceptance for MVP release?","How will success be measured after launch?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md"],"constraints":["Acceptance criteria must be specific, measurable, and testable (EARS)","No technical implementation details or API specifications"],"content":"# todoApp – Acceptance Criteria and Success Metrics\n\nDocument date: 2025-08-15 (Asia/Seoul)\n\nThis document defines business acceptance criteria, release readiness, and post‑launch success metrics for the todoApp MVP. It describes WHAT must be satisfied to release and operate successfully from a business perspective. It does not prescribe HOW to implement. This document provides business requirements only; all technical implementation decisions (architecture, APIs, database design, libraries, infrastructure) belong to the development team.\n\n## Related Reading\n- Refer to the Service Overview in the [todoApp Service Overview](./01-todoApp-service-overview.md) for vision, scope, and business model context.\n- Functional scope and behaviors are described in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md).\n- System‑wide performance, security, and availability expectations are set in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n\n## 1) Release Readiness Checklist\nAll items in this checklist must be satisfied before declaring the MVP “Go‑Live Ready.” Items are written in business terms with measurable completion criteria.\n\n1. Scope and Feature Completeness\n   - Feature scope matches MVP defined in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md): account registration/login/logout, email verification, password reset/change, todo item create/read/update/delete, mark complete/reopen, optional attributes (description, due date), filtering/sorting, timezone handling, ownership/privacy rules.\n   - No open P0/P1 defects impacting core flows: register, login, create todo, mark complete, edit, delete, filter/search.\n   - All acceptance tests below (Section 2) pass with documented evidence.\n\n2. Non‑Functional Readiness\n   - Performance sampling over representative load shows 95th percentile response perceived by users within 2 seconds for core actions (register, login, view list, add item, mark complete, edit, delete, filter/sort), aligning to the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n   - Availability plan and on‑call schedule established for the first 4 weeks of launch.\n   - Monitoring dashboards for core KPIs and error rates configured and shared with stakeholders.\n\n3. Security, Privacy, and Compliance Readiness\n   - User data handling aligns with privacy guidelines in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n   - Account lifecycle behaviors (creation, verification, suspension, deletion) validated against role and ownership rules (see functional and roles specs).\n   - Audit trail expectations (business level) met for significant account and todo changes.\n\n4. Operational Readiness\n   - Incident management workflow established: severity definitions, escalation contacts, communication templates.\n   - Support processes prepared: FAQ/knowledge base draft published; response SLAs defined in Section 4.\n   - Rollback/disable plan documented in business terms (feature toggles or revert path available without data loss from user perspective).\n\n5. Documentation and Training\n   - This document is reviewed by stakeholders; QA test cases trace to acceptance criteria.\n   - User‑facing help content for common tasks and recovery scenarios (login issues, password reset, duplicate todos, date/time misunderstandings) prepared.\n\n6. Launch Logistics\n   - Launch window scheduled with stakeholder sign‑off; monitoring coverage for the first 72 hours confirmed.\n   - Communication plan drafted (release notes and internal updates) describing MVP scope and known limitations.\n\n### Go/No‑Go Decision Flow (Business View)\n```mermaid\ngraph LR\n  A[\"All Readiness Items Evaluated\"] --> B{\"All P0/P1 Defects Closed?\"}\n  B -->|\"Yes\"| C{\"Acceptance Tests Passed?\"}\n  B -->|\"No\"| H[\"No‑Go: Fix Critical Defects\"]\n  C -->|\"Yes\"| D{\"Monitoring & Support Ready?\"}\n  C -->|\"No\"| I[\"No‑Go: Complete Tests\"]\n  D -->|\"Yes\"| E{\"Stakeholder Sign‑Off Complete?\"}\n  D -->|\"No\"| J[\"No‑Go: Finalize Ops & Support\"]\n  E -->|\"Yes\"| F[\"Go: Launch Window\"]\n  E -->|\"No\"| G[\"No‑Go: Obtain Approvals\"]\n```\n\n## 2) MVP Acceptance Criteria (EARS)\nAll acceptance criteria below use EARS. Keywords WHEN, WHILE, IF, THEN, WHERE, THE, SHALL remain in English; descriptions are in en‑US.\n\n### 2.1 Authentication and Account Lifecycle\n- WHEN a person registers with valid email and password, THE todoApp SHALL create a new account and send an email verification within 1 minute.\n- IF a person attempts to register with an email already in use, THEN THE todoApp SHALL reject the registration and instruct the person to reset password or use another email.\n- WHEN a person verifies the email within 24 hours, THE todoApp SHALL activate the account and allow login.\n- IF an email verification link is expired, THEN THE todoApp SHALL present a method to request a new verification link.\n- WHEN a user logs in with correct credentials for an active account, THE todoApp SHALL grant access within 2 seconds perceived by the user.\n- IF a user enters incorrect credentials, THEN THE todoApp SHALL deny access and provide actionable guidance to recover (e.g., reset password).\n- WHEN a user logs out, THE todoApp SHALL end the active session immediately from the user perspective.\n- WHEN a user initiates password reset with a registered email, THE todoApp SHALL send reset instructions within 1 minute.\n- IF a password reset token is invalid or expired, THEN THE todoApp SHALL prevent password change and provide a method to request a new reset.\n- WHERE an account is suspended by an admin for policy reasons, THE todoApp SHALL prevent access to protected features and communicate suspension status at next sign‑in attempt.\n- WHEN a user requests account deletion, THE todoApp SHALL schedule deletion in accordance with data lifecycle requirements and confirm request receipt to the user.\n\n### 2.2 Todo Item Core Operations\n- WHEN a logged‑in user submits a new todo with a non‑empty title up to the allowed length, THE todoApp SHALL create the todo and show it in the user’s list immediately.\n- IF a user attempts to create a todo without a title or exceeding the maximum length, THEN THE todoApp SHALL reject creation and display validation guidance.\n- WHEN a user updates title, description, or due date of their own todo with valid values, THE todoApp SHALL persist the changes and reflect them in the list within 2 seconds perceived by the user.\n- IF a user attempts to update a todo they do not own, THEN THE todoApp SHALL deny the action and retain the original state.\n- WHEN a user marks their own todo as complete, THE todoApp SHALL set the completion state and update list indicators within 2 seconds perceived by the user.\n- WHEN a user reopens a completed todo, THE todoApp SHALL remove the completion state and update the list accordingly within 2 seconds perceived by the user.\n- WHEN a user deletes their own todo, THE todoApp SHALL remove it from the list and confirm deletion within 2 seconds perceived by the user.\n- IF a user attempts to delete a todo they do not own, THEN THE todoApp SHALL deny the action and provide an ownership restriction message.\n\n### 2.3 Filtering, Sorting, and Timezone Behaviors\n- WHEN a user filters todos by status (all, active, completed), THE todoApp SHALL return a filtered list consistent with the selected status within 2 seconds perceived by the user.\n- WHEN a user sorts todos by created time or due date, THE todoApp SHALL present results ordered according to the selected sort within 2 seconds perceived by the user.\n- WHILE a user’s timezone preference is set, THE todoApp SHALL display due dates and times in that timezone consistently in lists and details.\n- IF a due date is provided without time, THEN THE todoApp SHALL interpret it as end‑of‑day in the user’s timezone.\n- IF a due date is invalid or in an unsupported format from the user’s perspective, THEN THE todoApp SHALL reject it and provide clear correction guidance.\n\n### 2.4 Data Ownership and Privacy\n- THE todoApp SHALL restrict todos so that users can view and modify only their own items.\n- IF an unauthenticated person attempts to access protected todo features, THEN THE todoApp SHALL require authentication before continuing.\n- WHERE an admin needs to assist for support or policy enforcement, THE todoApp SHALL allow admin‑level access to the minimum necessary information for the task and log the access for audit.\n- WHEN a user exports their todo data (if enabled in MVP), THE todoApp SHALL provide a complete, human‑readable export within a reasonable timeframe communicated to the user.\n\n### 2.5 Error Handling and Recovery (Business View)\n- IF an operation fails due to validation errors, THEN THE todoApp SHALL not change data and SHALL present actionable messages enabling the user to correct and retry immediately.\n- IF an operation fails due to conflicting concurrent updates on the same todo, THEN THE todoApp SHALL preserve data integrity and inform the user how to proceed (e.g., refresh to load the latest and reapply changes).\n- IF a temporary service issue prevents completion of a core action, THEN THE todoApp SHALL encourage retry and avoid duplicate creations or updates from a single user action.\n\n### 2.6 Performance and Responsiveness\n- THE todoApp SHALL complete core interactions (login, list load, add, edit, complete, delete, filter/sort) within 2 seconds perceived by the user for the 95th percentile under expected MVP load.\n- WHERE larger lists are present (e.g., 500 todos), THE todoApp SHALL allow the user to access and interact with a subset without undue delay and provide a predictable way to navigate additional items.\n\n### 2.7 Administration (Business Controls)\n- WHEN an admin suspends an account for policy reasons, THE todoApp SHALL prevent further protected actions by that account and record the action for audit.\n- WHEN an admin reinstates a suspended account, THE todoApp SHALL restore access to protected features.\n- WHEN an admin needs to view a user’s account for support, THE todoApp SHALL limit visibility to the minimum necessary data and record the access for audit.\n\n## 3) Post‑Launch Monitoring Plan (Business‑Level)\nThe following monitoring is required from day 0. All metrics are business‑level and observable via dashboards available to stakeholders.\n\n1. Availability and Performance (User‑Perceived)\n   - Track percentage of successful core actions: login, view list, create, update, complete, delete.\n   - Track 95th percentile perceived completion time for core actions, target ≤ 2 seconds.\n   - Track error rate by category: authentication failures, authorization denials, validation errors, conflicts, temporary service issues.\n\n2. Adoption and Engagement\n   - New accounts created per day and percentage verified within 24 hours.\n   - Time‑to‑first‑todo: median time from account creation to first successful todo creation; target ≤ 5 minutes.\n   - Daily Active Users (DAU), 7‑day Active Users (WAU), Monthly Active Users (MAU).\n   - Task completion ratio: completed todos / created todos per cohort.\n\n3. Data Quality and Privacy Indicators\n   - Number of ownership violations prevented (should be zero successful violations; denials are counted but expected for attempted access to others’ data).\n   - Volume of admin support accesses with justification logs.\n\n4. Stability and Support Load\n   - Volume of support contacts per 1,000 active users per week; target ≤ 10 in the first month.\n   - Top 5 user‑reported issues and their time‑to‑resolution.\n\nAlerting Thresholds (Business View)\n- WHEN the 95th percentile perceived completion time for any core action exceeds 2 seconds for 15 continuous minutes, THE operations process SHALL initiate an incident response and prioritize restoration to target performance.\n- WHEN the success rate of any core action drops below 99% for 15 continuous minutes, THE operations process SHALL begin an investigation and user communication steps.\n- WHEN verification completion within 24 hours drops below 80% for two consecutive days, THE product process SHALL review onboarding guidance and potential friction points.\n\n## 4) User Satisfaction and Support Plan\n1. User Feedback Collection\n   - In‑product lightweight CSAT prompt for key actions (create todo, complete todo) shown non‑intrusively after action completion no more than once per 30 days per user.\n   - Quarterly NPS and qualitative survey distributed to verified users.\n   - Feedback channels: help center form and email address monitored during business hours.\n\n2. Support SLAs (Business Commitments)\n   - Severity 1 (core actions unavailable for many users): initial acknowledgement within 15 minutes; user‑facing update every 60 minutes until resolution.\n   - Severity 2 (significant degradation or feature impairment): acknowledgement within 2 business hours; updates every business day until resolution.\n   - Severity 3 (minor issues or guidance requests): acknowledgement within 2 business days; resolution targeted within 5 business days.\n\n3. Knowledge Resources\n   - Self‑service articles: account creation and verification, password reset, creating and managing todos, due date/timezone behavior, data privacy basics, account deletion.\n   - Release notes summarizing changes and known limitations for MVP.\n\n4. Post‑Incident Review\n   - For Severity 1 or Severity 2 incidents, a business‑readable post‑incident summary is circulated within 5 business days, including impact, user communication, and prevention actions.\n\n## 5) Success Metrics and Reporting Cadence\nThis section defines quantitative targets for the first 90 days post‑launch. Targets are set to be ambitious yet feasible for MVP.\n\n1. Activation and Onboarding\n   - Email verification completion within 24 hours ≥ 85% of new accounts by day 30, ≥ 90% by day 90.\n   - Time‑to‑first‑todo median ≤ 5 minutes by day 30, ≤ 3 minutes by day 90.\n\n2. Engagement\n   - D7 retention ≥ 25% by day 30; ≥ 30% by day 90.\n   - Task completion ratio (completed/created) ≥ 70% by day 30; ≥ 75% by day 90.\n   - Median todos created per active user per week ≥ 5 by day 90.\n\n3. Satisfaction and Support\n   - CSAT on key actions ≥ 4.3/5 by day 30; ≥ 4.5/5 by day 90.\n   - NPS ≥ +20 by quarter end.\n   - Support contacts ≤ 10 per 1,000 active users per week by day 30; ≤ 7 by day 90.\n\n4. Reliability and Performance (User‑Perceived)\n   - 95th percentile completion time for core actions ≤ 2 seconds sustained.\n   - Core action success rate ≥ 99.5% sustained (user‑perceived success not blocked by validation errors initiated by the user).\n\nReporting Cadence\n- Weekly: activation, engagement, reliability summary to stakeholders; highlight deltas vs. targets and top issues.\n- Monthly: deep dive report with cohort analysis, retention, satisfaction trends, and prioritized improvements.\n- Quarterly: strategic review against Service Overview KPIs with recommendations for roadmap adjustments.\n\n## 6) Risks and Mitigations\nThis section names major risks relevant to acceptance and sustained success, with business mitigations.\n\n1. Performance Risk (User‑Perceived Latency)\n   - Risk: Perceived delays above 2 seconds degrade satisfaction and retention.\n   - Mitigation: Performance budget tracked in monitoring; phased exposure if needed; prioritize optimization of list load and write actions; temporarily disable non‑critical features during incidents to preserve core actions.\n\n2. Onboarding Friction\n   - Risk: Low email verification rates and complex password resets reduce activation.\n   - Mitigation: Clear messaging for verification; resend links flow; simple reset guidance; monitor verification funnel and test copy improvements.\n\n3. Data Integrity and Concurrency Conflicts\n   - Risk: Lost updates or conflicting edits cause user confusion.\n   - Mitigation: Conflict detection behaviors and user guidance; encourage refresh and reapply; emphasize integrity in acceptance tests.\n\n4. Privacy and Access Control\n   - Risk: Improper access to another user’s data erodes trust.\n   - Mitigation: Strict ownership rules, minimum‑necessary admin access, and audit expectations; periodic review of admin support accesses.\n\n5. Support Overload at Launch\n   - Risk: High contact volume overwhelms support.\n   - Mitigation: Proactive FAQ, clear in‑product guidance for common errors, temporary extended support window during first 2 weeks, incident communication templates prepared.\n\n6. Scope Creep Before Go‑Live\n   - Risk: Unplanned features jeopardize schedule and quality.\n   - Mitigation: Enforce scope freeze for MVP; place additional requests into post‑MVP backlog with business justification and capacity planning.\n\n7. Insufficient Monitoring or Alert Fatigue\n   - Risk: Missed issues or slow response to degradations.\n   - Mitigation: Focus alerts on user‑perceived metrics (success rate, p95 time); define actionable thresholds; periodic tuning based on signal‑to‑noise.\n\n---\n\n## Traceability to Acceptance and Success\n- Each acceptance criterion maps to features defined in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md) and quality targets in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n- Release readiness and monitoring targets align with the go‑to‑market plan and KPIs stated in the [todoApp Service Overview](./01-todoApp-service-overview.md).\n\nEnd of document."},"tokenUsage":{"total":20869,"input":{"total":15537,"cached":0},"output":{"total":5332,"reasoning":1152,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":9,"created_at":"2025-08-15T03:57:15.172Z"},"tokenUsage":{"aggregate":{"total":219357,"input":{"total":158760,"cached":11648},"output":{"total":60597,"reasoning":23104,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":216573,"input":{"total":156423,"cached":11648},"output":{"total":60150,"reasoning":22720,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Codify validation rules, constraints, and state logic to ensure consistent handling across all features.","filename":"06-todoApp-business-rules.md","documentType":"requirement","outline":["Purpose and Scope","Terminology and States","Todo Item Validation Rules","Ownership and Access Rules","Rate Limits and Operational Constraints (business-level)","Retention and Deletion Rules","Time Zone and Date Handling Rules","Rule Conflict Resolution and Precedence","Traceability to Functional Requirements"],"audience":"development team","keyQuestions":["What validations apply to todo items and accounts?","What limits, if any, exist for operations?","How are conflicts in rules resolved?"],"detailLevel":"detailed specification","relatedDocuments":["03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md"],"constraints":["Express rules in testable, measurable terms (use EARS where applicable)","Avoid any database, API, or technical design details"],"content":"# todoApp Business Rules and Constraints\n\n## Purpose and Scope\nThis document codifies the business rules, validations, constraints, and state logic for todoApp to ensure consistent behavior across all features and scenarios. It provides business requirements only; it defines WHAT the system should do, not HOW to build it. All technical implementation decisions (architecture, APIs, database design, etc.) are at the discretion of the development team.\n\nScope includes: todo item field validations, item state transitions, ownership and access rules, rate limits and operational constraints, retention/deletion behaviors, time zone and date handling, conflict resolution principles, and traceability to related documents. This document applies to the roles defined for todoApp: user and admin.\n\nOut of scope: UI/UX layouts, API endpoint specifications, database schema design, and infrastructure choices.\n\nRelated documents for broader context:\n- See the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for end-to-end feature behaviors and acceptance criteria.\n- See the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance, security, and reliability expectations.\n- See the [Data Lifecycle and Privacy Requirements for todoApp](./09-todoApp-data-lifecycle-and-privacy.md) for conceptual data handling and privacy constraints.\n\n## Terminology and States\n- Owner: The authenticated account that created a todo item. Each todo item has exactly one Owner.\n- Todo Item (Item): A task record consisting minimally of a required title and optional attributes such as description and due date.\n- Active: The normal working state of an Item that is not completed and not in trash.\n- Completed: The state indicating the Item has been marked done.\n- Trashed: The state indicating the Item has been deleted by the Owner but is recoverable within the trash retention period.\n- Purged: The state indicating the Item has been irreversibly removed following retention rules.\n- Suspension: An account-level restriction under which write operations are blocked.\n\n### State Model and Allowed Transitions\nThe todoApp Item states and transitions are constrained to the following flow:\n\n```mermaid\ngraph LR\n  subgraph \"Todo Item States\"\n    A[\"Active\"] --> B[\"Completed\"]\n    B --> A\n    A --> C[\"Trashed\"]\n    B --> C\n    C --> A\n    C --> D[\"Purged (Irreversible)\"]\n  end\n```\n\n- Allowed transitions: Active → Completed, Completed → Active (reopen), Active → Trashed, Completed → Trashed, Trashed → Active (restore), Trashed → Purged.\n- Disallowed transitions: Any direct transition to Purged other than from Trashed; Purged has no outgoing transitions.\n\nEARS requirements:\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n\n## Todo Item Validation Rules\nThis section defines required and optional fields, permitted value ranges, and behavioral validations for creation, updates, completion, reopening, and deletion.\n\n### Field-Level Constraints\n- Title (required):\n  - Length: 1 to 120 Unicode characters after trimming leading/trailing whitespace.\n  - Content: No control characters; line breaks permitted but normalized to a single newline character.\n  - Uniqueness: Not required; duplicate titles are allowed for convenience.\n- Description (optional):\n  - Length: 0 to 2,000 Unicode characters after trimming.\n  - Content: May include line breaks; no active scripts or executable content.\n- Due Date (optional):\n  - Type: Either date-only (no time) or date-time (includes time and timezone implicit as user-local).\n  - Range: Not earlier than 1 January 1970 in user-local time; not later than 10 years from the current date in user-local time.\n  - Date-only Semantics: Treated as due at 23:59:59 in the user’s local time zone on the specified date.\n  - Date-time Semantics: Interpreted as an exact clock time in the user’s local time zone.\n\nEARS requirements (creation/update validation):\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 2,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 user-local on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values more than 10 years in the future or earlier than 1 January 1970 (user-local).\n- IF a field contains control characters, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n\n### Behavioral Validations\n- Completion and Reopening:\n  - An Item can be marked Completed only from Active.\n  - A Completed Item can be reopened only back to Active.\n- Deletion (Trash) and Purge:\n  - Only Items in Active or Completed can be moved to Trashed.\n  - Purge is only permitted from Trashed per retention rules.\n\nEARS requirements (state validations):\n- WHEN a user attempts to mark an Active Item as Completed, THE todoApp SHALL mark it Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n\n### Concurrency and Integrity (business perspective)\n- Edit Consistency:\n  - Edits should not silently overwrite more recent changes made by the Owner in another session.\n\nEARS requirements (concurrency):\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n\n## Ownership and Access Rules\nRoles: user (standard account), admin (administrative oversight under policy). All access rules are expressed from a business and privacy standpoint.\n\n### Core Ownership Rules\n- Each Item has exactly one Owner, which is the creating user account.\n- Owners can create, read, update, complete/reopen, trash, restore, and purge their own Items subject to other rules herein.\n- Cross-user access is not permitted for users.\n\n### Administrative Access (Support and Policy)\n- Admins can access any user’s Items only for legitimate support, security, or policy enforcement, with audit logging requirements.\n- Admin operations follow least-privilege: only the minimum actions necessary for the case and only for the minimum time required.\n\nEARS requirements (access control):\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or has an active administrative support scope.\n- IF a user attempts to modify an Item that they do not own, THEN THE todoApp SHALL deny the operation without revealing Item existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin read and write actions limited to the scope duration and case context.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n\n## Rate Limits and Operational Constraints (business-level)\nThe following limits exist to protect system integrity, reduce abuse, and provide predictable performance. Limits are measured per user account unless stated otherwise.\n\n### Per-Operation Frequency Limits\n- Create Item: up to 30 Items per minute, measured in rolling windows.\n- Update Item: up to 60 Item updates per minute.\n- Complete/Reopen: up to 120 state-change operations per minute.\n- Trash/Restore: up to 60 operations per minute.\n- Purge: up to 30 purges per minute.\n\n### Inventory and Size Limits\n- Maximum active (non-Trashed) Items per user: 5,000.\n- Maximum Trashed Items retained per user: 5,000 (older trashed Items purge sooner if this cap is exceeded).\n- Maximum total Items (all states except Purged) per user: 10,000.\n\n### Validation Response Expectations (business-level; detailed targets in NFR)\n- Single-field validation feedback is expected to be perceived as immediate for typical inputs.\n\nEARS requirements (limits):\n- WHERE a user exceeds the create rate limit, THE todoApp SHALL temporarily throttle further creates until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 5,000 active Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHEN a user purges Items, THE todoApp SHALL enforce the purge rate limit and queue excess purges for later or require retry.\n\n## Retention and Deletion Rules\nThese rules govern how Items are retained, restored, and permanently removed.\n\n### Trash Retention\n- Trashed Items are retained for 30 calendar days from the time of trashing.\n- Restoration returns the Item to Active with its previous content intact.\n\n### Purging\n- Automatic Purge: Items in Trashed are automatically purged after 30 days.\n- Manual Purge: The Owner may manually purge a Trashed Item at any time before automatic purge.\n- Purge is irreversible and removes the Item from user-accessible views and recovery.\n\n### Account Deletion and Suspension\n- Account Deletion: All Items owned by the account enter Trashed immediately and follow a shortened retention of 7 days before automatic purge.\n- Legal Hold: Admins may place a legal or policy hold that prevents purge until the hold is cleared.\n- Suspension: Suspended accounts cannot modify Items; retention timelines continue to elapse normally.\n\nEARS requirements (retention & deletion):\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of Trashed Items exceeds 5,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n\n## Time Zone and Date Handling Rules\nThese rules ensure consistent user-local behavior for dates and times in todoApp while avoiding reliance on device-specific interpretations.\n\n### User-Local Semantics\n- Date-Only Due Dates: Treated as due at 23:59:59 on that calendar date in the user’s selected time zone.\n- Date-Time Due Dates: Interpreted as exact local times in the user’s selected time zone.\n- Default Time Zone: If a user has not set a preferred time zone, the system uses a reasonable default aligned to the user’s locale.\n\n### Daylight Saving Time (DST) and Calendar Rules\n- DST Transition Forward (e.g., 01:59:59 → 03:00:00): A local time that does not exist shall be adjusted to the next valid local time on that date.\n- DST Transition Backward (hour repeats): A local time in the repeated hour is interpreted as the first occurrence unless the user specifies otherwise.\n- Leap Years and Month Length: Invalid calendar dates are rejected.\n\nEARS requirements (time zone & calendar):\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n\n## Account-Level Validation Rules (Business)\nThese constraints apply to account data relevant to using todoApp features.\n\n- Display Name (optional): 1 to 80 Unicode characters after trimming; no control characters.\n- Email (required for registration): Must be unique per account under todoApp policies.\n- Password (required for registration): Minimum 8 characters, at least one letter and one number; no spaces at either end after trimming.\n- Email Verification: Accounts may create and manage Items immediately after registration; however, recovery communications and sensitive account changes require a verified email.\n\nEARS requirements (account-level):\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 8 characters or lacking at least one letter and one number.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications until verification is completed.\n\n## Rule Conflict Resolution and Precedence\nTo resolve conflicts between rules or between rules and context-specific conditions, todoApp follows a defined precedence.\n\n### Precedence Order\n1. Legal/Compliance obligations (e.g., legal holds, court orders)\n2. Security and Privacy policies (e.g., least-privilege, non-disclosure of existence)\n3. Account status constraints (e.g., suspension, deletion)\n4. Ownership rules\n5. Retention and deletion rules\n6. Rate limits and operational constraints\n7. User preferences (e.g., time zone selection)\n\nEARS requirements (precedence):\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n### Examples\n- Privacy vs. Access Inquiry: If a user tries to open another user’s Item by ID, do not reveal whether it exists; respond as if inaccessible.\n- Rate Limit vs. Urgent Purge: If a purge request exceeds the allowed rate, queue or require retry while ensuring the user can eventually complete the purge.\n\n## Traceability to Functional Requirements\nThis section links rule groups in this document to relevant sections of related documents to ensure testability and cross-reference.\n\n| Business Rule Area | Related Functional Section | Notes |\n|---|---|---|\n| Field validations (title, description, due date) | [Todo Item Management in Functional Requirements](./03-todoApp-functional-requirements.md) | Aligns with create/update acceptance criteria |\n| State transitions (complete, reopen, trash, restore, purge) | [Completion and Reopening in Functional Requirements](./03-todoApp-functional-requirements.md) | Transitions must mirror acceptance tests |\n| Ownership and access | [Data Ownership and Privacy Rules in Functional Requirements](./03-todoApp-functional-requirements.md) | Must be consistent with role capabilities |\n| Rate limits and item caps | [Business Constraints and Limits in Functional Requirements](./03-todoApp-functional-requirements.md) | Limits are measurable and enforceable |\n| Retention and deletion | [Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md) | Trash retention and purge windows |\n| Time zone and date handling | [Non-Functional Requirements](./08-todoApp-non-functional-requirements.md) | Perceived immediacy and correctness in local time |\n| Account-level rules | [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md) | Password and email uniqueness behaviors |\n\n## Consolidated EARS Index (For Test Design)\nThis index consolidates EARS statements for ease of reference during test planning.\n\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 2,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 user-local on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values more than 10 years in the future or earlier than 1 January 1970 (user-local).\n- IF a field contains control characters, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n- WHEN a user attempts to mark an Active Item as Completed, THE todoApp SHALL mark it Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or has an active administrative support scope.\n- IF a user attempts to modify an Item that they do not own, THEN THE todoApp SHALL deny the operation without revealing Item existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin read and write actions limited to the scope duration and case context.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n- WHERE a user exceeds the create rate limit, THE todoApp SHALL temporarily throttle further creates until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 5,000 active Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHEN a user purges Items, THE todoApp SHALL enforce the purge rate limit and queue excess purges for later or require retry.\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of Trashed Items exceeds 5,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 8 characters or lacking at least one letter and one number.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications until verification is completed.\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n## Success Criteria\nThe rules in this document are considered implemented successfully when:\n- All EARS statements herein pass acceptance tests defined in the related documents.\n- Item state transitions are exactly as modeled and enforced in all features.\n- Validation and limit rules produce consistent, user-understandable outcomes across the system.\n- Retention and purge behaviors match specified timelines, including account deletion variations and legal holds.\n- Time zone and DST handling lead to correct, predictable due date semantics in user-local time.\n\nEnd of document."},"tokenUsage":{"total":23396,"input":{"total":15537,"cached":0},"output":{"total":7859,"reasoning":2624,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":10,"created_at":"2025-08-15T03:57:53.532Z"},"tokenUsage":{"aggregate":{"total":242753,"input":{"total":174297,"cached":11648},"output":{"total":68456,"reasoning":25728,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":239969,"input":{"total":171960,"cached":11648},"output":{"total":68009,"reasoning":25344,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeWrite","file":{"reason":"Set performance, security, privacy, reliability, and compliance expectations in user terms.","filename":"08-todoApp-non-functional-requirements.md","documentType":"requirement","outline":["Performance and Responsiveness Expectations","Security and Privacy Principles","Availability and Reliability Expectations","Scalability Expectations","Compliance and Legal Considerations","Operational Monitoring and Alerting (business expectations)","Non-Functional Acceptance Criteria (EARS)"],"audience":"development team","keyQuestions":["What performance is expected for core operations?","What security and privacy standards must be met?","What availability and reliability targets apply?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["State measurable targets in user terms (e.g., within N seconds)","Avoid technology choices or architectural prescriptions","Use EARS for acceptance criteria"],"content":"# 08 — todoApp Non-Functional Requirements\n\n## Document Purpose\nThis document defines the business-level non-functional requirements for todoApp. It specifies measurable expectations for performance, security, privacy, availability, reliability, scalability, compliance, and operational monitoring. The document describes WHAT outcomes the system must deliver from a user and business perspective and deliberately avoids prescribing HOW to implement them. No API specifications, database schemas, or technology choices are included.\n\n## Related Documents\n- Refer to the Service Vision and Scope in the [Service Overview for todoApp](./01-todoApp-service-overview.md) for business objectives and success metrics.\n- Role and access expectations are defined in the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n- Error categories, user messaging, and recovery guidance are defined in the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md).\n\n## Definitions and Assumptions\n- “Interactive action” refers to user-triggered operations with immediate feedback (e.g., viewing list, creating/updating/completing/deleting a todo item, logging in/out).\n- Time references are expressed in seconds (s) or milliseconds (ms) and percentiles (p50, p95, p99) measured at the boundary where the user perceives completion.\n- “Business day” refers to 09:00–18:00 in Asia/Seoul (KST) unless stated otherwise. Scheduled maintenance references local time in KST.\n- “Sensitive action” refers to operations that affect account control or privacy (e.g., password change, email change, account deletion, session revocation).\n- “Peak period” denotes high-usage windows typical of 19:00–23:00 KST on weekdays and 10:00–23:00 KST on weekends.\n- Confidential and personal data include identifiers (e.g., email), authentication factors, and any user-generated content in todo items or metadata.\n\n---\n\n## Performance and Responsiveness Expectations\nThe following targets are user-perceived. All targets are for the 95th percentile unless otherwise noted and must be met under the defined scale and concurrency assumptions in this document.\n\n### Core Interaction Targets\n- List my todos (paginated up to 50 items): p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Create a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Update a todo (title/description/due date/priority): p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Complete or reopen a todo: p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Delete a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Bulk complete/reopen up to 50 items: p95 ≤ 1,000 ms; p99 ≤ 2,000 ms.\n- Authentication (enter credentials to signed-in state): p95 ≤ 2,000 ms; p99 ≤ 4,000 ms.\n- Email-based actions (verification or password reset): email dispatched within 60 s p95.\n- Admin lookups for a single user account (non-invasive read): p95 ≤ 800 ms.\n\n### Payload and Result Size Expectations\n- Pagination size for interactive list retrieval: up to 50 items per request; results include minimal fields necessary for the list view.\n- Todo description length supported up to 1,000 characters without truncation in storage; if longer content is allowed by product policy, interactive viewing and editing must still meet targets above for up to 1,000 characters.\n- Import/export operations that exceed interactive targets SHALL be processed asynchronously with progress or completion notification.\n\n### Throughput and Concurrency Targets (Business-Level)\n- MVP load: sustain 100 requests per second (RPS) aggregate with short bursts up to 300 RPS for 5 minutes without violating p95 targets.\n- Concurrency: support at least 1,000 concurrently active signed-in sessions during peak periods with no degradation beyond the p95 targets.\n- Growth headroom: maintain stable performance up to 3× the MVP sustained load without user-visible regressions greater than 20% of stated targets.\n\n### Rate Limiting (User-Centric)\n- Write operations (create/update/complete/delete) per account: up to 60 actions per minute without throttling; above this threshold may be rate-limited to protect system availability.\n- Read operations (list/search/filter) per account: up to 120 actions per minute without throttling; above this threshold may be rate-limited.\n- Authentication attempts: see Security section for protections and lockout expectations.\n\n### Time Zone and Consistency\n- Read-after-write for a user’s own content: changes made by the user appear in subsequent reads immediately p95 ≤ 1,000 ms and p99 ≤ 2,000 ms.\n- Cross-device visibility for a user’s own changes: p95 ≤ 3,000 ms.\n\n---\n\n## Security and Privacy Principles\nSecurity requirements ensure confidentiality, integrity, and proper access control. Privacy requirements ensure minimal collection, transparent use, and user control over personal data. These principles align with role definitions and session behaviors defined in the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n\n### Authentication and Session Management\n- Only verified accounts may perform non-public actions. Unverified accounts have strictly limited capabilities per the roles document.\n- Sessions expire after 30 days of inactivity; sensitive actions always require recent re-authentication (within the last 15 minutes).\n- Users can revoke all active sessions immediately from an account security control.\n\n### Credential and Account Protection\n- Password policy: minimum 8 characters; acceptance of long passphrases (≥12 characters) without special-character requirements; rejection of top 10,000 common passwords.\n- Login protection: after 10 failed attempts within 10 minutes for an account or from a single source, impose a cooling period of 5 minutes with user-facing guidance for secure recovery.\n- Sensitive changes (email/password) require confirmation through a second factor channel (e.g., a one-time confirmation code via the verified email channel) without prescribing specific technologies.\n\n### Authorization and Least Privilege\n- Users may only access their own content. Admin actions are logged and limited to the minimum necessary for support and policy enforcement.\n- Admins cannot view or edit user content marked as private notes that include sensitive information beyond what is necessary for policy enforcement.\n\n### Data Minimization and Purpose Limitation\n- Collect only data necessary to operate todoApp and provide the service.\n- Prohibit storage of special categories of personal data in system-managed fields (e.g., national ID numbers) and discourage sensitive content in todo text through policy and guidance.\n\n### Data Protection\n- Data in transit and data at rest must be protected using strong, industry-accepted cryptographic safeguards without specifying particular ciphers or libraries.\n- Encryption keys and secrets must be protected by processes that enforce least privilege, dual control for changes, and auditability.\n\n### Audit Logging and Access Transparency\n- Log security-relevant events: authentication successes/failures, password changes, email changes, session revocations, account deletions, admin support actions, and mass/bulk operations affecting more than 20 items.\n- Provide user-accessible activity history for their own account, retaining at least 90 days of entries.\n\n### Privacy Controls and User Rights\n- Provide accessible Privacy Policy and Terms of Service before account creation and within account settings.\n- Provide self-service account deletion with clear warnings about irreversible effects and data retention timelines.\n- Provide export of user-owned data in a commonly used, machine-readable format within reasonable size limits.\n\n---\n\n## Availability and Reliability Expectations\nThese expectations define uptime, recovery, and continuity behaviors visible to users and administrators.\n\n### Availability Targets\n- Service-level objective (SLO) for user-facing availability: 99.9% monthly.\n- Planned maintenance windows: default window Sundays 02:00–04:00 KST, announced at least 72 hours in advance. Emergency maintenance is allowed with immediate notice and clear user messaging.\n\n### Reliability and Continuity\n- RTO (Recovery Time Objective): critical user operations recover within 60 minutes following an outage under the assumed deployment and operational model.\n- RPO (Recovery Point Objective): no more than 5 minutes of data for committed operations is lost in a disaster scenario.\n- Durability expectation: once a user receives a success confirmation for a write, that data persists and remains retrievable after any transient fault.\n\n### Degradation and Failover Behavior\n- Graceful degradation: non-critical features (e.g., bulk operations, optional analytics) may be temporarily disabled to preserve core CRUD functionality.\n- Read-only mode: during partial outages, the system may enter read-only mode with clear user messaging; write attempts should be queued or safely rejected with recovery guidance per the error handling document.\n\n### Consistency and Ordering\n- For a single user’s data, operations that depend on ordering (e.g., marking complete, then deleting) must reflect the most recent committed action in subsequent reads.\n- Conflict handling during concurrent updates follows the business rules in the relevant documents, ensuring users receive clear guidance without exposing technical details.\n\n---\n\n## Scalability Expectations\nScalability requirements ensure predictable behavior as usage grows.\n\n### Baseline and Growth Assumptions\n- MVP baseline: 50,000 monthly active users (MAU), 5,000 daily active users (DAU), 1,000 peak concurrent sessions, 100 sustained RPS with 300 RPS bursts.\n- Growth: targets must be maintainable up to 3× baseline without user-visible regressions beyond 20% of stated p95 targets and without service downtime for capacity increases.\n\n### Business Limits\n- Maximum todos per user: 10,000 active items. Archival or export workflows should be encouraged beyond this threshold.\n- Bulk operations: up to 100 items per interactive bulk action; larger sets are processed asynchronously with user notification upon completion.\n\n### Elasticity and Resource Management\n- Capacity increases and decreases should be transparent to users and must not cause outages or data loss.\n\n---\n\n## Compliance and Legal Considerations\nThese expectations align with common privacy frameworks without asserting jurisdiction-specific legal advice.\n\n- Privacy by design: default to the minimum data necessary; privacy settings default to the most protective reasonable option.\n- Notice and consent: obtain user consent for optional data uses such as marketing communications; provide easy opt-out.\n- Data subject rights: enable access, rectification, export, and deletion of user data within 30 days of verified request.\n- Child safety: the service is intended for users aged 13+ unless local law imposes a higher age; when required, obtain guardian consent consistent with applicable law.\n- Data retention: business records (e.g., audit logs) retained for 90 days minimum; user data retention after account deletion follows the data lifecycle policy in the relevant document.\n- Cross-border data transfer: disclose data processing locations and ensure transfers comply with applicable cross-border transfer requirements.\n\n---\n\n## Operational Monitoring and Alerting (Business Expectations)\nMonitoring ensures the stated objectives are continuously met and regressions are detected promptly.\n\n### Key Performance Indicators (KPIs)\n- Latency: p50/p95/p99 across core interactions (list, create, update, complete, delete, login).\n- Error rate: percentage of failed interactions per category (authentication, authorization, validation, conflict, not found, service unavailable) as defined in the error handling document.\n- Throughput: sustained and peak RPS; concurrency of active sessions.\n- Availability: monthly uptime against the 99.9% SLO and error budget consumption.\n- Security signals: failed login spikes, password reset spikes, session revocations, admin privileged operations.\n- Data integrity: periodic checks that ensure committed writes are retrievable and uncorrupted.\n\n### Alerting Thresholds and Response Expectations\n- Critical user operation latency breach: if p95 for list/create/update/complete/delete exceeds target by 25% for 5 consecutive minutes, generate a critical alert.\n- Availability breach: if rolling 5-minute availability falls below 99%, generate a critical alert.\n- Error spike: if failed interactions exceed 2% over 10 minutes for any core operation, generate a high-severity alert with categorization.\n- Security anomaly: if there are more than 50 failed logins for a single account or 500 across the service within 10 minutes, generate a high-severity alert and apply protective measures consistent with lockout policy.\n- On-call responsiveness: acknowledge critical alerts within 5 minutes 24/7; initiate mitigation within 15 minutes; communicate user-facing status within 30 minutes of incident start.\n\n### Incident Management Flow\n```mermaid\ngraph LR\n  subgraph \"Detection\"\n    A[\"Monitoring Detects Breach\"] --> B[\"Alert Generated\"]\n  end\n  subgraph \"Triage\"\n    C[\"On-call Acknowledges\"] --> D[\"Severity Classification\"]\n    D --> E[\"User Impact Assessment\"]\n  end\n  subgraph \"Mitigation\"\n    F[\"Apply Safeguards(Degrade/Throttle/Read-only)\"] --> G[\"Restore Core Functions\"]\n  end\n  subgraph \"Communication\"\n    H[\"Post Status Update(KST Time)\"] --> I[\"Customer Support Briefing\"]\n  end\n  subgraph \"Recovery\"\n    J[\"Validate Data Integrity\"] --> K[\"Confirm SLO Recovery\"]\n  end\n  subgraph \"Postmortem\"\n    L[\"Root Cause Analysis\"] --> M[\"Action Items&Owners\"]\n  end\n  B --> C\n  E --> F\n  G --> H\n  H -.-> I\n  G --> J\n  K --> L\n```\n\n---\n\n## Non-Functional Acceptance Criteria (EARS)\nThe following acceptance criteria are expressed in EARS format. Keywords WHEN/WHILE/IF/THEN/WHERE/THE/SHALL remain in English; all descriptions are in business terms.\n\n### Performance\n- WHEN a user retrieves a page of their todo list up to 50 items during peak period, THE todoApp SHALL deliver the response within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user creates a todo with title and optional description up to 1,000 characters, THE todoApp SHALL confirm creation within 400 ms at p95 and within 800 ms at p99.\n- WHEN a user completes or reopens a todo, THE todoApp SHALL reflect the change within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user logs in with valid credentials, THE todoApp SHALL transition to a signed-in state within 2,000 ms at p95 and within 4,000 ms at p99.\n- WHERE a bulk action affects up to 50 items, THE todoApp SHALL complete the action within 1,000 ms at p95 and within 2,000 ms at p99.\n- WHERE an operation exceeds interactive thresholds due to size or complexity, THE todoApp SHALL process it asynchronously and notify the user upon completion.\n\n### Consistency and Cross-Device\n- WHEN a user modifies their own todo items, THE todoApp SHALL provide read-after-write consistency for that user with visibility of the change within 1,000 ms at p95 and 2,000 ms at p99.\n- WHILE a user is signed in on multiple devices, THE todoApp SHALL propagate the user’s own changes across devices within 3,000 ms at p95.\n\n### Rate Limiting and Protection\n- WHERE an account issues more than 60 write actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance without blocking critical security actions.\n- WHERE an account issues more than 120 read actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance.\n\n### Security and Sessions\n- THE todoApp SHALL require account verification before granting non-public capabilities.\n- WHERE a session has been inactive for 30 days, THE todoApp SHALL require re-authentication before any further non-public actions.\n- IF there are 10 failed login attempts within 10 minutes for an account, THEN THE todoApp SHALL impose a 5-minute cooldown and provide secure recovery guidance to the user.\n- IF a user invokes “revoke all sessions”, THEN THE todoApp SHALL invalidate all existing sessions within 60 seconds and require re-authentication on all devices.\n- WHERE a user initiates a sensitive action, THE todoApp SHALL require recent re-authentication within the last 15 minutes.\n\n### Data Protection and Privacy\n- THE todoApp SHALL protect personal data in transit and at rest using strong safeguards and shall prevent unauthorized access by design and policy.\n- WHERE audit logs contain personal data, THE todoApp SHALL minimize and redact sensitive fields and retain logs for at least 90 days.\n- WHEN a verified user requests export of their data, THE todoApp SHALL provide a machine-readable export within 7 days for accounts smaller than 1 GB.\n- WHEN a verified user requests account deletion, THE todoApp SHALL remove user-accessible content promptly and complete deletion workflows within 30 days except where legal retention is required.\n\n### Availability and Reliability\n- THE todoApp SHALL achieve 99.9% monthly availability for core user operations under the defined load assumptions.\n- WHEN a service incident impacts users, THE todoApp SHALL publish a status update within 30 minutes of detection and provide subsequent updates at least every 60 minutes until resolution.\n- WHERE core functionality is impaired, THE todoApp SHALL prioritize read access and safe queuing or rejection of writes with clear guidance.\n- WHEN service is restored after an outage, THE todoApp SHALL meet the stated p95 performance targets within 15 minutes of recovery.\n- THE todoApp SHALL meet an RTO of 60 minutes and an RPO of 5 minutes for committed user operations.\n\n### Monitoring and Alerts\n- WHEN p95 latency for any core operation exceeds its target by 25% for 5 consecutive minutes, THE todoApp SHALL generate a critical alert for the on-call responder.\n- WHEN failed user interactions exceed 2% of attempts over a 10-minute window for any core operation, THE todoApp SHALL generate a high-severity alert with categorization.\n- WHEN security anomalies occur (e.g., more than 50 failed logins for an account or 500 service-wide within 10 minutes), THE todoApp SHALL generate a high-severity alert and apply protective measures.\n- WHERE a critical alert is generated, THE todoApp SHALL ensure on-call acknowledgment within 5 minutes and user-facing communication within 30 minutes.\n\n### Compliance and Legal\n- THE todoApp SHALL present accessible Terms of Service and Privacy Policy before account creation and within settings.\n- WHEN receiving a verified data subject request, THE todoApp SHALL fulfill access, rectification, export, or deletion within 30 days.\n- WHERE local law requires consent for optional data uses, THE todoApp SHALL capture, honor, and provide revocation of such consent.\n\n---\n\n## Appendices\n\n### A. Target Summary Tables\n\n| Category | Target |\n|---------|--------|\n| List todos (p95 | p99) | 300 ms | 600 ms |\n| Create/Update/Delete (p95 | p99) | 400 ms | 800 ms |\n| Complete/Reopen (p95 | p99) | 300 ms | 600 ms |\n| Bulk (≤50 items) (p95 | p99) | 1,000 ms | 2,000 ms |\n| Login (p95 | p99) | 2,000 ms | 4,000 ms |\n| Email dispatch (verification/reset) | ≤ 60 s p95 |\n| Availability (monthly) | 99.9% |\n| RTO | 60 minutes |\n| RPO | 5 minutes |\n| Session inactivity expiry | 30 days |\n| Sensitive action re-auth window | 15 minutes |\n| Audit log retention | ≥ 90 days |\n\n### B. Glossary\n- p95/p99: 95th and 99th percentile of response time distribution.\n- RTO: Maximum target time to restore service after an incident.\n- RPO: Maximum target window of data loss measured in time.\n- SLO: Service Level Objective, internal target for reliability.\n- Availability: Percentage of time the service is fully usable by users.\n\n---\n\nScope Clarification: This document provides business requirements only. All technical implementation decisions, including architecture, APIs, and data design, are at the discretion of the development team. The content here defines the outcomes and constraints that must be met from the user and business perspective."},"tokenUsage":{"total":23772,"input":{"total":15537,"cached":0},"output":{"total":8235,"reasoning":3392,"accepted_prediction":0,"rejected_prediction":0}},"step":0,"total":11,"completed":11,"created_at":"2025-08-15T03:58:01.605Z"},"tokenUsage":{"aggregate":{"total":266525,"input":{"total":189834,"cached":11648},"output":{"total":76691,"reasoning":29120,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":263741,"input":{"total":187497,"cached":11648},"output":{"total":76244,"reasoning":28736,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Provide a single entry point that lists and links all planning documents. Sets reading order and ensures navigation consistency across the project.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","How to Use This Documentation","Table of Contents (with descriptive links)","Document Maintenance Policy"],"audience":"general","keyQuestions":["What documents exist for this project?","How should readers navigate them in the correct order?"],"detailLevel":"high-level overview","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","04-todoApp-user-stories-and-personas.md","05-todoApp-user-flows.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Must include descriptive relative links to each listed document using the document title as link text","Must place the specified Developer Note blockquote at the very end exactly as provided","Must not include technical implementation details, API specs, or database schemas"],"content":"# todoApp Planning Documentation - Table of Contents\n\nLast updated: 2025-08-15 (KST)\n\n## Document Purpose\nThis document is the single entry point for all planning artifacts of the todoApp service. It establishes the recommended reading order, provides descriptive links to each document, and aligns stakeholders on how to navigate the documentation set. These documents define business requirements, user scenarios, and process flows in natural language so that backend developers can implement with clarity while retaining full autonomy over technical decisions.\n\n## How to Use This Documentation\n- Start with the service overview to understand the vision, scope, and business model for todoApp. Then proceed to roles and authentication to ground access control concepts before reading the functional scope.\n- Follow the reading order below to reduce ambiguity and ensure terms, rules, and flows are interpreted consistently across teams.\n- Each link uses the document’s title as link text and points to a relative file in this folder for portability.\n- This documentation focuses on what the system must do from a business perspective. All architectural choices, API designs, and data modeling decisions remain with the development team.\n\n## Table of Contents (with descriptive links)\n1. [todoApp Service Overview](./01-todoApp-service-overview.md)\n   - Establishes vision, scope, and business model for the minimal Todo service; clarifies value proposition, target users, and success metrics.\n2. [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n   - Defines complete authentication behaviors, role hierarchy, and permissions in business terms; includes session and token management expectations and EARS-formatted access rules.\n3. [todoApp Functional Requirements (MVP)](./03-todoApp-functional-requirements.md)\n   - Captures the minimum functional scope for a Todo list with testable business requirements; covers CRUD for items, completion/reopening, filtering/sorting, localization, and acceptance criteria in EARS.\n4. [todoApp User Stories and Personas](./04-todoApp-user-stories-and-personas.md)\n   - Describes personas and primary/secondary scenarios to guide prioritization and testing; includes role-based scenarios and acceptance statements.\n5. [todoApp User Flows and Process Diagrams](./05-todoApp-user-flows.md)\n   - Provides visual business flows for core processes (authentication, item lifecycle, error and recovery) using Mermaid with LR orientation, plus narrative explanations.\n6. [todoApp Business Rules Specification](./06-todoApp-business-rules.md)\n   - Codifies validation rules, constraints, ownership rules, rate limits, retention, time zone handling, and rule precedence in measurable terms (EARS where applicable).\n7. [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n   - Defines user-facing error conditions, guidance, and recovery paths; covers conflicts, retries, monitoring expectations, and EARS-formatted error requirements.\n8. [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n   - Sets measurable expectations for performance, security, privacy, availability, scalability, compliance, and operational monitoring; includes EARS-based acceptance criteria.\n9. [todoApp Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md)\n   - Describes conceptual information lifecycle, retention and purging policies, portability options, privacy-by-design principles, and right-to-erasure behaviors.\n10. [todoApp Acceptance Criteria and Success Metrics](./10-todoApp-acceptance-criteria-and-success-metrics.md)\n    - Defines go-live readiness, MVP acceptance criteria (EARS), post-launch monitoring plan, user satisfaction approach, KPIs, and risk mitigations.\n\n### Recommended Reading Order and Rationale\n- Foundation: Service overview → roles and authentication → functional requirements. This sequence builds shared context, clarifies permissions, then defines scope.\n- Behavior Details: User stories/personas → user flows → business rules. These documents translate scope into concrete scenarios, visual flows, and enforceable rules.\n- Quality and Safety: Error handling → non-functional requirements. They define predictable failure behavior and measurable experience goals.\n- Lifecycle and Acceptance: Data lifecycle and privacy → acceptance criteria and success metrics. They cover responsible data handling and how delivery will be evaluated.\n\n### Role-Based Quick Paths\n- Business stakeholders: Service overview → acceptance criteria and success metrics.\n- Product managers: Service overview → functional requirements → user stories and personas → user flows.\n- Development team: Roles and authentication → functional requirements → business rules → error handling → non-functional requirements → data lifecycle and privacy.\n- QA and compliance: Business rules → error handling → non-functional requirements → data lifecycle and privacy → acceptance criteria and success metrics.\n\n## Document Maintenance Policy\n- Ownership: The product team curates business content; the development team may propose clarifications via change requests. A designated documentation owner is accountable for approvals and publication.\n- Update cadence: Update documents whenever scope, rules, or acceptance criteria change. The ToC must be updated immediately when documents are added, renamed, or deprecated.\n- Versioning and change log: Each document should maintain a change log section or commit history that describes what changed and why in business terms.\n- Link conventions: Use descriptive link text matching the document title in en-US; keep relative paths within this folder. Do not link to non-existent files.\n- Consistency and traceability: Keep terminology, states, and rule names consistent across documents. Cross-reference related sections using descriptive links where helpful.\n- Decommissioning: If a document is retired, update this ToC to remove the link and add a short note in the change log indicating the successor or reason for removal.\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*"},"plan":"Purpose: Provide a single entry point and navigation order for todoApp planning documents.\nScope: Table of contents with descriptive links; guidance on reading order and role-based navigation; maintenance policy.\nAudience: General stakeholders (business, product, development, QA, compliance).\nOutline:\n1) Document Purpose\n2) How to Use This Documentation\n3) Table of Contents (with descriptive links)\n   - 01-todoApp-service-overview.md\n   - 02-todoApp-user-roles-and-authentication.md\n   - 03-todoApp-functional-requirements.md\n   - 04-todoApp-user-stories-and-personas.md\n   - 05-todoApp-user-flows.md\n   - 06-todoApp-business-rules.md\n   - 07-todoApp-error-handling-and-exception-scenarios.md\n   - 08-todoApp-non-functional-requirements.md\n   - 09-todoApp-data-lifecycle-and-privacy.md\n   - 10-todoApp-acceptance-criteria-and-success-metrics.md\n4) Document Maintenance Policy\nConstraints: Descriptive relative links; no technical specifications; developer note appended at end exactly as provided.","review":"Enhance and finalize 00-toc.md to meet all standards:\n- Language: en-US; audience: general\n- Structure: Follow outline [Document Purpose, How to Use, Table of Contents with descriptive links, Document Maintenance Policy]\n- Links: Use descriptive titles matching each document; relative paths only; link only to existing files\n- Content focus: Business requirements context only; avoid technical implementation details, API specs, or database schemas\n- EARS: Not required here except to maintain overall consistency references; avoid adding requirement statements unnecessarily\n- Mermaid: If any diagrams exist (not expected here), ensure double quotes on all labels and correct arrow syntax; prefer graph LR\n- Developer Note: Append exactly one blockquote line at the very end, exactly as provided\n- No questions, no requests for feedback, no meta-commentary (“This document…”) within body paragraphs; write as the document itself\n- Minimum length: 2,000+ characters; ensure completeness and clarity\n- Timezone/date: Use Asia/Seoul context for the update line\n- Consistency: Use service prefix todoApp consistently; ensure reading order rationale and role-based quick paths are included","content":"# todoApp Planning Documentation - Table of Contents\n\nLast updated: 2025-08-15 (KST)\n\n## Document Purpose\nSingle entry point for all planning artifacts of the todoApp service. Establishes the recommended reading order, provides descriptive links to each document, and aligns stakeholders on navigation across the documentation set. Defines business requirements, user scenarios, and process flows in natural language so backend developers can implement with clarity while retaining full autonomy over technical decisions.\n\n## How to Use This Documentation\n- Begin with the service overview to understand vision, scope, and business model. Proceed to roles and authentication to ground access control concepts before diving into the functional scope.\n- Follow the reading order below to reduce ambiguity and ensure terms, rules, and flows are interpreted consistently across teams.\n- Each link uses the document’s title as link text and points to a relative file in this folder for portability.\n- Focus remains on what the system must do from a business perspective. All architectural choices, API designs, and data modeling decisions remain with the development team.\n\n## Table of Contents (with descriptive links)\n1. [todoApp Service Overview](./01-todoApp-service-overview.md)\n   - Establishes vision, scope, and business model for the minimal Todo service; clarifies value proposition, target users, and success metrics.\n2. [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n   - Defines complete authentication behaviors, role hierarchy, and permissions in business terms; includes session and token management expectations and EARS-formatted access rules.\n3. [todoApp Functional Requirements (MVP)](./03-todoApp-functional-requirements.md)\n   - Captures the minimum functional scope for a Todo list with testable business requirements; covers CRUD for items, completion/reopening, filtering/sorting, localization, and acceptance criteria in EARS.\n4. [todoApp User Stories and Personas](./04-todoApp-user-stories-and-personas.md)\n   - Describes personas and primary/secondary scenarios to guide prioritization and testing; includes role-based scenarios and acceptance statements.\n5. [todoApp User Flows and Process Diagrams](./05-todoApp-user-flows.md)\n   - Provides visual business flows for core processes (authentication, item lifecycle, error and recovery) using Mermaid with LR orientation, plus narrative explanations.\n6. [todoApp Business Rules Specification](./06-todoApp-business-rules.md)\n   - Codifies validation rules, constraints, ownership rules, rate limits, retention, time zone handling, and rule precedence in measurable terms (EARS where applicable).\n7. [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n   - Defines user-facing error conditions, guidance, and recovery paths; covers conflicts, retries, monitoring expectations, and EARS-formatted error requirements.\n8. [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n   - Sets measurable expectations for performance, security, privacy, availability, scalability, compliance, and operational monitoring; includes EARS-based acceptance criteria.\n9. [todoApp Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md)\n   - Describes conceptual information lifecycle, retention and purging policies, portability options, privacy-by-design principles, and right-to-erasure behaviors.\n10. [todoApp Acceptance Criteria and Success Metrics](./10-todoApp-acceptance-criteria-and-success-metrics.md)\n    - Defines go-live readiness, MVP acceptance criteria (EARS), post-launch monitoring plan, user satisfaction approach, KPIs, and risk mitigations.\n\n### Recommended Reading Order and Rationale\n- Foundation: Service overview → roles and authentication → functional requirements. Builds shared context, clarifies permissions, then defines scope.\n- Behavior Details: User stories/personas → user flows → business rules. Translate scope into concrete scenarios, visual flows, and enforceable rules.\n- Quality and Safety: Error handling → non-functional requirements. Define predictable failure behavior and measurable experience goals.\n- Lifecycle and Acceptance: Data lifecycle and privacy → acceptance criteria and success metrics. Cover responsible data handling and evaluation of delivery.\n\n### Role-Based Quick Paths\n- Business stakeholders: Service overview → acceptance criteria and success metrics.\n- Product managers: Service overview → functional requirements → user stories and personas → user flows.\n- Development team: Roles and authentication → functional requirements → business rules → error handling → non-functional requirements → data lifecycle and privacy.\n- QA and compliance: Business rules → error handling → non-functional requirements → data lifecycle and privacy → acceptance criteria and success metrics.\n\n## Document Maintenance Policy\n- Ownership: Product team curates business content; development team may propose clarifications via change requests. A designated documentation owner is accountable for approvals and publication.\n- Update cadence: Update whenever scope, rules, or acceptance criteria change. Update this table of contents immediately when documents are added, renamed, or deprecated.\n- Versioning and change log: Maintain a change log section or commit history within each document describing what changed and why in business terms.\n- Link conventions: Use descriptive link text matching each document title in en-US; keep relative paths within this folder. Do not link to non-existent files.\n- Consistency and traceability: Keep terminology, states, and rule names consistent across documents. Cross-reference related sections using descriptive links where helpful.\n- Decommissioning: If a document is retired, remove its link here and record the successor or reason for removal in the project change log.\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*","tokenUsage":{"total":67160,"input":{"total":63885,"cached":0},"output":{"total":3275,"reasoning":1536,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":1,"step":0,"created_at":"2025-08-15T03:59:25.038Z"},"tokenUsage":{"aggregate":{"total":333685,"input":{"total":253719,"cached":11648},"output":{"total":79966,"reasoning":30656,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":330901,"input":{"total":251382,"cached":11648},"output":{"total":79519,"reasoning":30272,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Establish vision, scope, and business model for the minimal Todo service to align stakeholders before detailing requirements.","filename":"01-todoApp-service-overview.md","documentType":"service-overview","outline":["Executive Summary","Problem Definition and Market Gap","Target Users","Core Value Proposition","Service Scope and Out-of-Scope","Business Model","Why This Service Exists","Revenue Strategy","Growth Plan","Success Metrics and KPIs","Assumptions and Dependencies","Glossary of Terms"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who is the target user and what value is delivered?","What scope is included for the minimal viable Todo service?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Focus on business goals and outcomes only","Avoid technical implementation details entirely","Define clear success metrics aligned with business value"],"content":"# todoApp Service Overview\n\n## Executive Summary\nThe purpose of todoApp is to provide a minimal, reliable, and privacy-respecting personal task management service that enables individuals to quickly capture, organize, and complete their tasks without distraction. The MVP focuses on core value: simple todo item creation, editing, completion/reopening, and deletion for authenticated users, with clear ownership and predictable behavior across time zones.\n\nScope of this document: This document defines business goals and outcomes only; it describes what the service must achieve from a business perspective. All technical implementation decisions (architecture, APIs, database design, and infrastructure) are at the discretion of the development team.\n\nKey outcomes targeted by the MVP include faster first value (time-to-first-task within one minute of registration), habitual daily use, and a high completion ratio of created tasks. The product deliberately excludes complex project management features to avoid friction and cognitive overload.\n\nFor detailed behaviors after this overview, refer to the following complementary documents: the [Table of Contents and Navigation Guide](./00-toc.md), the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md), the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md), and the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Problem Definition and Market Gap\nMost task tools attempt to serve both simple and complex workflows, creating barriers for individuals who only need the basics. Common pain points observed in the market include:\n- Over-featured interfaces that require configuration before usefulness emerges, delaying time-to-first-value.\n- Unclear ownership rules and privacy concerns in tools primarily designed for teams.\n- Unpredictable due-date handling across time zones, leading to missed or premature deadlines.\n- Lack of reliability for core actions (create, complete, find), which undermines trust and daily habit formation.\n- Hidden costs and complex pricing that discourage early adoption.\n\ntodoApp addresses a specific gap: a minimal, high-trust personal todo service with explicit privacy guarantees, consistent date behavior, and frictionless onboarding.\n\n## Target Users\n- Individual professionals and students who need a fast, minimal personal task list to manage daily obligations.\n- Early-career knowledge workers who prefer predictable behavior over breadth of features.\n- Privacy-conscious users who want clear control and ownership of their data.\n- Secondary audience: service administrators who need limited oversight to support users and enforce policies.\n\nPrimary roles in the service:\n- User: authenticated end user who manages only their own todo items and account.\n- Admin: administrative user who may manage accounts for support and policy enforcement.\n\n## Core Value Proposition\n- Minimalism with purpose: only the features that directly support task capture and completion.\n- Predictable behavior: deterministic rules for ownership, visibility, and time handling.\n- Trust and privacy: personal data is private to each user; no default sharing or exposure.\n- Fast first value: immediate utility on first login.\n\nGuiding high-level requirements (EARS format) for the MVP value proposition:\n- THE todoApp SHALL enable an authenticated user to capture a new todo in under one minute from registration, measured by median time-to-first-task.\n- THE todoApp SHALL keep each user’s todos private to that user by default, with no sharing features in the MVP.\n- WHEN a user records or modifies a due date, THE todoApp SHALL display and process that due date consistently in the user’s preferred local time.\n- WHEN a user searches or filters their todos, THE todoApp SHALL return results within a user-perceived short duration aligned with non-functional expectations.\n\n## Service Scope and Out-of-Scope\n\n### In Scope (MVP)\n- User accounts: registration, login, logout, email verification, password reset, and session revocation from a business perspective.\n- Todo item management: create, read, update, complete, reopen, and delete personal items.\n- Optional attributes: textual description and due date.\n- Filtering and sorting: basic filtering by completion status and optional due date; sorting by creation time or due date.\n- Ownership and privacy: strict separation so users access only their data; admins can perform specific support actions according to policy.\n- Time zone behavior: all date-related operations are consistent with the user’s preferred local time.\n- Data lifecycle basics: user-initiated deletion of items; account deletion that removes personal data subject to retention policies.\n\n### Out of Scope (MVP)\n- Collaboration: sharing, assignments, comments, team workspaces, or mentions.\n- Complex task structures: subtasks, checklists, tags/labels, priorities, or recurring tasks.\n- Media attachments: file uploads or images.\n- Integrations: calendar sync, third-party automations, or external identity providers.\n- Notifications and reminders: push, SMS, or email reminders.\n- Advanced analytics dashboards and reporting for end users.\n- Public APIs or developer platforms.\n- Mobile or desktop native applications; the MVP focuses on core service behavior without specifying client platforms.\n\n## Business Model\nThe business model emphasizes a trust-first entry with a minimal product, followed by value-based monetization. The service begins as a free, fully functional personal todo list for early adoption. Monetization follows once the daily habit and core trust are validated.\n\n- Value creation: reliable, distraction-free personal task management that increases completion rate and reduces task-related anxiety.\n- Value capture: subscription plans post-MVP for power users and small teams (future), while retaining a free tier for personal use.\n- Cost structure: customer support, basic infrastructure and operations, content and onboarding materials, and minimal compliance overhead.\n- Differentiation: privacy clarity, deterministic time rules, and purposeful minimalism.\n\n## Why This Service Exists\n- Market need: Individuals require a simple, dependable system that does not force team constructs or heavyweight configuration.\n- Opportunity: Many competitors optimize for breadth and collaboration, leaving underserved users who want speed, clarity, and privacy.\n- Strategic fit: A minimal, high-trust product creates a foundation for future extensions (e.g., optional premium features) without compromising core simplicity.\n\nEARS-formulated business objectives:\n- THE todoApp SHALL minimize user time-to-first-value by guiding new users to create a first todo within 60 seconds.\n- THE todoApp SHALL maintain user trust by keeping todos private and avoiding unexpected data exposure.\n- WHERE a free tier is provided, THE todoApp SHALL retain full personal task functionality in that tier during the MVP phase.\n\n## Revenue Strategy\n- Initial phase (MVP to early traction): free tier supporting personal use to maximize adoption and learning.\n- Paid plans (post-MVP, contingent on traction):\n  - Individual Pro: premium features such as advanced filters and export options.\n  - Teams (future): multi-user oversight and policy features (added only when simplicity can be preserved).\n- Pricing principles: transparent, simple, and predictable; no hidden limits that block core personal use.\n\nEARS-formulated revenue and ethics requirements:\n- THE todoApp SHALL avoid paywalls on basic personal task creation, completion, and deletion during the MVP phase.\n- IF a user downgrades from paid to free in the future, THEN THE todoApp SHALL preserve access to existing personal tasks without data loss.\n\n## Growth Plan\n- Acquisition: content marketing around productivity fundamentals, referral incentives, and distribution via student and early-career communities.\n- Activation: frictionless onboarding focused on first task creation, with contextual tips rather than complex setup.\n- Retention: habit loops centered on completion, simple reminders inside the product scope (without external notifications in MVP), and weekly reflection prompts as content.\n- Expansion: optional premium features introduced only after retention metrics are healthy, ensuring the core remains uncluttered.\n\nEARS-formulated growth objectives:\n- THE todoApp SHALL target a median time-to-first-task of ≤60 seconds for newly registered users during the MVP.\n- THE todoApp SHALL aim for a 7-day retention (user returns and interacts with tasks) of at least 25% within 90 days of launch.\n- WHERE a referral mechanism is offered, THE todoApp SHALL allow users to invite others without introducing sharing features that compromise privacy.\n\n## Success Metrics and KPIs\nAll metrics are defined in business terms. Technical measurement methods are left to the development team.\n\nCore metrics (MVP):\n- Activation rate: percentage of newly registered users who create at least one todo within 24 hours.\n- Time-to-first-task (median): elapsed time from registration to first todo creation.\n- Weekly engaged users: users who created, updated, or completed at least one todo in a 7-day window.\n- Completion ratio: completed todos divided by created todos within a period.\n- Churn rate: percentage of active users who become inactive over a 30-day period.\n- Support ticket volume per 1,000 MAU: proxy for usability and reliability.\n\nEARS-formulated success targets:\n- THE todoApp SHALL achieve an activation rate of ≥70% within the first 90 days post-launch.\n- THE todoApp SHALL maintain a median time-to-first-task of ≤60 seconds during the MVP.\n- THE todoApp SHALL achieve a weekly completion ratio of ≥50% for active users within 90 days of launch.\n- WHERE user support is available, THE todoApp SHALL maintain a support ticket volume of ≤20 per 1,000 MAU related to core task operations.\n\n## Assumptions and Dependencies\n- Email channel availability for account verification and password resets.\n- Basic legal and privacy compliance appropriate for operating regions, including clear consent for data processing and retention policies defined at a business level.\n- Stable time zone libraries and consistent business rules for due-date handling described in the requirements.\n- English-language product framing for MVP, with localization considered in subsequent phases.\n- Reasonable baseline of user devices and connectivity; non-functional expectations will define responsiveness in user terms.\n- Administrative oversight limited to support and policy enforcement, with strict adherence to least-privilege principles at the business level.\n\nEARS-formulated constraints:\n- IF email verification is not completed within a defined grace period, THEN THE todoApp SHALL limit access to functions that depend on verified identity.\n- WHILE account deletion is in progress, THE todoApp SHALL prevent new content creation by that account to avoid data inconsistency.\n\n## Linkage to Detailed Requirements\nThis overview sets the direction for all subsequent specifications. Detailed business behavior is further defined in the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md). User-centered reliability, performance, security, and privacy expectations are defined in the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md). Release readiness and measurable acceptance criteria are captured in the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Glossary of Terms\n- Activation: the point at which a newly registered user creates their first todo.\n- Admin: administrative role authorized to perform limited oversight actions for support and policy enforcement.\n- Completion ratio: number of completed todos divided by created todos over the same period.\n- Due date: an optional date attached to a todo indicating a target completion day in the user’s local time.\n- MVP (Minimum Viable Product): the minimal set of features that delivers core value to early users and validates the product hypothesis.\n- Ownership: the principle that a user’s todos belong exclusively to that user and are not visible to others in the MVP.\n- Retention: the rate at which users return and interact with the service over time.\n- Time-to-first-task: elapsed time between account registration and creation of the first todo.\n- User: authenticated end user who manages only their own todo items and account.\n\nClosing statement: This document specifies business outcomes and constraints only. It intentionally avoids technical implementation details. Developers have full autonomy over architecture, APIs, and data design to meet these outcomes."},"plan":"Document structure and intent:\n- Title: # todoApp Service Overview\n- Executive Summary: Vision, MVP scope, core outcomes, business-only statement.\n- Problem Definition and Market Gap: Pain points, competitor landscape, differentiation.\n- Target Users: Primary users, secondary admin audience, role framing.\n- Core Value Proposition: Value pillars; add EARS objectives; include a simple value-loop diagram (Mermaid) for business flow.\n- Service Scope and Out-of-Scope: Explicit bullets for MVP; clear exclusions to avoid scope creep.\n- Business Model: Value creation/capture, cost structure, differentiation, monetization guardrails.\n- Why This Service Exists: Strategic fit, opportunity; add EARS business objectives.\n- Revenue Strategy: Free-to-paid path, plan variants, ethics guardrails; add EARS requirements.\n- Growth Plan: Acquisition, activation, retention, expansion; add EARS growth objectives.\n- Success Metrics and KPIs: Definitions, targets, measurement cadence; include EARS targets and a small table of KPIs.\n- Assumptions and Dependencies: Channels, compliance, localization, roles, and constraints; add EARS constraints.\n- Linkage to Detailed Requirements: Descriptive links to related docs.\n- Glossary of Terms: Precise business definitions.\n- Closing business-only scope statement for developer autonomy.\n","review":"Enhance the service-overview document to be implementation-ready for backend developers in business terms only. Apply the following criteria strictly:\n\n- Length and completeness: At least 2,000 characters; expand sections for clarity and specificity.\n- EARS compliance: Convert applicable statements into EARS (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL). Keep keywords in English; write descriptions in en-US.\n- Business focus: Do not include any APIs, database schemas, or technical architecture. No frontend UI/UX details.\n- Roles & scope consistency: Reference roles [user, admin] in business terms, not technical privileges.\n- Links: Use descriptive link text with relative paths that match actual filenames.\n- Mermaid diagrams: If present, ensure strict syntax—ALL labels in double quotes; no spaces between brackets/braces and quotes; no nested quotes; correct arrows (-->). Prefer graph LR.\n- Requirements specificity: State measurable targets (e.g., response times, conversion rates, retention percentages). Avoid vague terms like “fast” or “good”.\n- Business model: Include Why, Revenue Strategy, Growth Plan, Success Metrics, with measurable KPIs.\n- Error/constraint notes: Add EARS-formulated constraints and assumptions where applicable.\n- Prohibited content: No API endpoints, no database schema, no technical architecture. No developer notes except in 00-toc.md (not applicable here).\n- Closing clarity: Include the business-only scope statement that technical implementation is at developer discretion.\n","content":"# todoApp Service Overview\n\n## Executive Summary\nA minimal, reliable, and privacy‑respecting personal task management service enabling individuals to quickly capture, organize, and complete tasks without distraction. The MVP emphasizes core value: todo creation, editing, completion/reopening, and deletion for authenticated users, with explicit ownership and predictable behavior across time zones.\n\nKey outcomes for MVP:\n- Accelerate time‑to‑first‑value: users create their first todo within one minute of registration (median).\n- Establish daily habit loops centered on completion and review.\n- Build trust through privacy‑first defaults and deterministic date/time handling.\n\nEARS guiding objectives:\n- THE todoApp SHALL enable a newly registered user to create a first todo within 60 seconds (median) from completing registration.\n- THE todoApp SHALL keep each user’s todos private by default, with no sharing in MVP.\n- WHEN a user records or modifies a due date, THE todoApp SHALL display and process that due date in the user’s preferred local time consistently.\n- WHEN a user filters their todos, THE todoApp SHALL present results within user‑perceived expectations aligned with the non‑functional targets.\n\nFor deeper specifications, see the [Table of Contents and Navigation Guide](./00-toc.md), the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md), the [Non‑Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md), and the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Problem Definition and Market Gap\nMany task tools try to satisfy both simple and complex workflows, burdening users who only need essentials. Observed pain points:\n- Over‑featured products delaying time‑to‑first‑value due to configuration overhead.\n- Privacy risk and unclear ownership in team‑oriented tools.\n- Inconsistent due‑date handling across time zones, creating missed or premature deadlines.\n- Reliability gaps in core actions (create, complete, find) that erode trust.\n- Pricing complexity that discourages early adoption.\n\nCompetitor landscape (business characterization):\n- Team‑centric platforms: optimized for collaboration; often complex for personal use; unclear privacy defaults.\n- Power‑user task managers: rich features with steeper learning curves; slower activation for minimal needs.\n- Simple list apps: fast but often lack rigorous ownership rules, retention clarity, and predictable date semantics.\n\nDifferentiation:\n- Purposeful minimalism tied directly to value delivery.\n- Privacy clarity and least‑privilege oversight.\n- Deterministic time and date semantics across locales.\n\n## Target Users\nPrimary audiences:\n- Individual professionals, students, and early‑career knowledge workers who prefer predictability over breadth.\n- Privacy‑conscious individuals seeking control and ownership of personal task data.\n\nSecondary audience:\n- Service administrators who provide user support and enforce policies under least‑privilege constraints.\n\nRoles in service context:\n- User: authenticated end user managing only their own todo items and account.\n- Admin: administrative user performing limited oversight for support/policy enforcement with auditability.\n\n## Core Value Proposition\n- Minimalism with purpose: only capabilities that directly support capture and completion.\n- Predictability: deterministic rules for ownership, visibility, and time semantics.\n- Trust and privacy: personal data is private; no default sharing or exposure in MVP.\n- Fast first value: immediate utility on first login.\n\nBusiness value loop (conceptual):\n\n```mermaid\ngraph LR\n  A[\"Register\"] --> B[\"Create First Todo(≤60s median)\"]\n  B --> C[\"Daily Review & Complete\"]\n  C --> D[\"Completion Satisfaction\"]\n  D --> E[\"Habit & Retention\"]\n  E --> F[\"Sustained Engagement\"]\n```\n\nEARS commitments reinforcing value delivery:\n- WHEN a newly verified account first signs in, THE todoApp SHALL make task capture immediately accessible without mandatory configuration.\n- THE todoApp SHALL avoid features that do not materially improve capture, review, and completion during MVP.\n- WHERE a user lacks a configured time zone, THE todoApp SHALL default to a reasonable locale‑aligned time zone (see non‑functional expectations) and communicate the default in context.\n\n## Service Scope and Out‑of‑Scope\n\n### In Scope (MVP)\n- User accounts: registration, login, logout, email verification, password reset, session revocation (business perspective only).\n- Todo item management: create, read, update, complete, reopen, delete personal items.\n- Optional attributes: description and due date.\n- Filtering and sorting: by completion status and due date; ordering by creation time or due date.\n- Ownership and privacy: strict separation; users access only their data; admins act only for support under audit.\n- Time zone semantics: consistent date/time handling per user preference.\n- Data lifecycle basics: user‑initiated deletion; account deletion with retention policy adherence.\n\n### Out of Scope (MVP)\n- Collaboration: sharing, assignments, comments, team workspaces, mentions.\n- Complex structures: subtasks, tags/labels, priorities, recurring tasks.\n- Media: file/image attachments.\n- Integrations: calendar sync, third‑party automations, external identity providers.\n- Notifications/reminders: push/SMS/email reminders.\n- Advanced analytics dashboards for end users.\n- Public APIs or developer platform guarantees.\n- Client platform specifics (no UI/UX or native app prescriptions).\n\nBoundary EARS:\n- THE todoApp SHALL exclude sharing and collaboration features in MVP.\n- IF a feature introduces privacy ambiguity or increases time‑to‑first‑value beyond 60 seconds (median), THEN THE todoApp SHALL defer it beyond MVP.\n\n## Business Model\nEmphasizes a trust‑first entry with a minimal product, followed by value‑based monetization once habit and trust are validated.\n\nValue creation and capture:\n- Reliable, distraction‑free personal task management that improves completion rate and reduces anxiety.\n- Free tier at launch to maximize adoption and learning; subscription options post‑MVP for power users and small teams while keeping core personal use free.\n\nCost structure (business level):\n- Customer support and content for onboarding and guidance.\n- Operations and compliance appropriate to geography and scale.\n- Privacy and security program proportional to risk and data footprint.\n\nDifferentiation:\n- Privacy clarity and least‑privilege operations.\n- Deterministic time zone semantics and predictable behavior.\n- Purposeful minimalism avoiding feature sprawl.\n\nGuardrails (EARS):\n- THE todoApp SHALL not introduce monetization that blocks basic personal task creation, completion, or deletion during MVP.\n- WHERE monetization is later introduced, THE todoApp SHALL ensure continuity of access to existing data for users who downgrade.\n\n## Why This Service Exists\nMarket need: a simple, dependable system without team constructs or heavy configuration.\nOpportunity: competitors optimize for breadth and collaboration, underserving users seeking speed, clarity, and privacy.\nStrategic fit: a minimal, high‑trust core creates a durable foundation for optional premium extensions without compromising simplicity.\n\nEARS business objectives:\n- THE todoApp SHALL minimize time‑to‑first‑value, targeting first‑todo creation ≤60 seconds (median) after registration.\n- THE todoApp SHALL maintain privacy by default; no exposure of personal tasks to others in MVP.\n- WHERE a free tier is offered, THE todoApp SHALL retain full personal task functionality in that tier during MVP.\n\n## Revenue Strategy\nPhased monetization to follow demonstrated engagement and retention.\n- MVP to early traction: free tier for personal use to maximize adoption and learn from usage patterns.\n- Post‑MVP (contingent on traction):\n  - Individual Pro: advanced filters, export options, and optional productivity insights.\n  - Teams (future): oversight and policy tools only if simplicity is preserved.\n- Pricing principles: transparent, predictable, and free from hidden limits that undermine personal use.\n\nEARS monetization ethics:\n- THE todoApp SHALL avoid paywalls on core personal task operations during MVP.\n- IF a user downgrades from paid to free, THEN THE todoApp SHALL preserve access to all existing personal tasks without data loss.\n\n## Growth Plan\nAcquisition: content marketing on productivity fundamentals; referrals; distribution via student and early‑career communities.\nActivation: frictionless onboarding oriented to first task creation; contextual, minimal guidance.\nRetention: habit loops centered on completion; simple in‑product prompts within MVP scope; weekly reflection content.\nExpansion: optional premium features introduced only after healthy retention; core remains uncluttered.\n\nEARS growth targets:\n- THE todoApp SHALL achieve a median time‑to‑first‑task of ≤60 seconds for newly registered users during MVP.\n- THE todoApp SHALL target 7‑day retention ≥25% within 90 days post‑launch.\n- WHERE a referral mechanism is offered, THE todoApp SHALL allow invitation flows that do not introduce sharing features.\n\n## Success Metrics and KPIs\nDefinitions (business level):\n- Activation rate: % of new registrants creating a todo within 24 hours.\n- Time‑to‑first‑task (median): time from registration to first todo creation.\n- Weekly engaged users: users who created, updated, or completed at least one todo in a 7‑day window.\n- Completion ratio: completed todos / created todos within a period.\n- Churn rate: % of active users who become inactive over 30 days.\n- Support ticket volume per 1,000 MAU: proxy for usability and reliability.\n\nTargets (EARS):\n- THE todoApp SHALL achieve activation rate ≥70% within 90 days post‑launch.\n- THE todoApp SHALL maintain median time‑to‑first‑task ≤60 seconds during MVP.\n- THE todoApp SHALL achieve weekly completion ratio ≥50% for active users within 90 days post‑launch.\n- WHERE support is provided, THE todoApp SHALL keep support ticket volume ≤20 per 1,000 MAU related to core operations.\n\nIllustrative KPI table:\n\n| KPI | Definition | MVP Target |\n|-----|------------|------------|\n| Activation rate | % new users with ≥1 todo in 24h | ≥ 70% |\n| Time‑to‑first‑task | Median time to first todo | ≤ 60 s |\n| Weekly completion ratio | Completed / created (active users) | ≥ 50% |\n| 7‑day retention | Users returning within 7 days | ≥ 25% |\n| Support volume | Tickets per 1,000 MAU | ≤ 20 |\n\n## Assumptions and Dependencies\nAssumptions:\n- Email channel availability for verification and password resets.\n- Baseline compliance (privacy/legal) for operating regions; documented consent for data processing.\n- Stable time zone rules and consistent business semantics for due dates.\n- English‑language product framing for MVP; broader localization later.\n- Reasonable baseline of user devices and connectivity.\n- Administrative oversight limited to support/policy enforcement with least‑privilege principles.\n\nDependencies:\n- Content and onboarding materials to reduce activation friction.\n- Support capacity for early launch weeks to handle inquiries.\n- Monitoring and analytics to measure activation, retention, and completion.\n\nConstraints (EARS):\n- IF email verification is not completed within a defined grace period, THEN THE todoApp SHALL limit access to functions requiring verified identity until verification is complete.\n- WHILE account deletion is in progress, THE todoApp SHALL prevent new content creation to avoid data inconsistency.\n- WHERE privacy policy prohibits data sharing, THE todoApp SHALL avoid features that expose personal content to others during MVP.\n\n## Linkage to Detailed Requirements\nBusiness behavior and acceptance details are elaborated in the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md). User‑perceived reliability, performance, security, and privacy expectations are set in the [Non‑Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md). Release readiness and measurable acceptance criteria are defined in the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Glossary of Terms\n- Activation: point at which a newly registered user creates the first todo.\n- Admin: role authorized to perform limited oversight for support and policy enforcement with auditability.\n- Completion ratio: completed todos divided by created todos over the same period.\n- Due date: optional date attached to a todo indicating a target completion day in the user’s local time.\n- Habit loop: recurring cycle of capture, review, and completion that fosters retention.\n- MVP: minimal set of features delivering core value and validating the product hypothesis.\n- Ownership: principle that a user’s todos belong exclusively to that user and are not visible to others in MVP.\n- Retention: rate at which users return and interact with the service over time.\n- Time‑to‑first‑task: elapsed time between account registration and first todo creation.\n- User: authenticated end user who manages only their own todo items and account.\n\nBusiness scope statement: This document provides business requirements and outcomes only. All technical implementation decisions (architecture, APIs, database design, infrastructure) are at the discretion of the development team; the content defines WHAT the system should do, not HOW to build it.","tokenUsage":{"total":71521,"input":{"total":65185,"cached":0},"output":{"total":6336,"reasoning":2816,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":2,"step":0,"created_at":"2025-08-15T04:00:20.327Z"},"tokenUsage":{"aggregate":{"total":405206,"input":{"total":318904,"cached":11648},"output":{"total":86302,"reasoning":33472,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":402422,"input":{"total":316567,"cached":11648},"output":{"total":85855,"reasoning":33088,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Define user-facing error conditions and recovery paths to create predictable behavior under failure.","filename":"07-todoApp-error-handling-and-exception-scenarios.md","documentType":"requirement","outline":["Error Taxonomy (Authentication, Authorization, Validation, Not Found, Conflict, Rate Limit, Service Unavailable)","User-Facing Messages and Guidance","Recovery and Retry Policies","Conflict Resolution for Concurrent Updates (business perspective)","Audit and Monitoring Expectations (business-level)","EARS-Formatted Error Requirements and Acceptance Criteria"],"audience":"development team","keyQuestions":["What errors can occur and how should the system respond for the user?","How can users recover or proceed after an error?","What monitoring is expected from a business standpoint?"],"detailLevel":"detailed specification","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS for all error and exception requirements","Do not reference HTTP codes or API responses; keep user-focused","No technical implementation details"],"content":"# todoApp Error Handling and Exception Scenarios\n\n## Introduction and Scope\nThis document defines business-level error handling and exception scenarios for the todoApp service. It specifies how the system responds to failures from a user’s perspective, the messages and guidance users receive, and the recovery paths that allow users to continue work safely. It also sets expectations for auditing and monitoring in business terms. This document describes WHAT the system should do in failure conditions, not HOW to implement it.\n\nThis document is consistent with and should be read alongside the following planning documents:\n- Refer to the [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md) for role definitions and session-related behaviors that trigger authentication and authorization errors.\n- Refer to the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for the accepted behavior and constraints of core features that interact with errors described here.\n- Refer to the [User Flows for todoApp](./05-todoApp-user-flows.md) for narrative and diagrammatic flows into which error branches must fit.\n- Refer to the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance and reliability expectations referenced in recovery and retry policies.\n\n## Error Taxonomy\nThe todoApp service classifies errors into the following user-facing categories. Each category defines representative scenarios, typical causes, and business rules for messaging and recovery.\n\n### 1) Authentication Errors\nDefinition: Failures related to user identity verification or session validity.\nExamples:\n- Incorrect credentials submitted during sign-in.\n- Unverified email attempting to sign in where verification is mandatory.\n- Expired or invalid session attempting to perform an action requiring authentication.\n- Revoked session due to user-initiated global logout.\n\nBusiness expectations:\n- Clear, non-technical messaging that avoids disclosing sensitive details.\n- Guided next steps (retry, verify email, or reauthenticate) without exposing system internals.\n\n### 2) Authorization Errors\nDefinition: Authenticated user lacks permission for the requested action.\nExamples:\n- A user attempting to access another user’s todo item.\n- A user attempting admin-only actions (e.g., service configuration or policy enforcement activities).\n\nBusiness expectations:\n- Clear statement that the action is not permitted, without revealing whether the resource exists.\n- Provide safe alternatives or guidance (e.g., return to list, request appropriate access through supported channels).\n\n### 3) Validation Errors\nDefinition: Input does not satisfy business rules for fields or operations.\nRepresentative rules (aligned with functional and business rules documents):\n- Title: required, 1–100 characters.\n- Description: optional, up to 1,000 characters.\n- Due date: optional; if present, must be a valid calendar date-time not earlier than the current time in the user’s configured time zone.\n- Completion actions: only allowed on existing, active items owned by the user.\n\nBusiness expectations:\n- Highlight each invalid field with a specific reason and actionable correction guidance.\n- Preserve valid portions of user input where safe.\n\n### 4) Not Found Errors\nDefinition: Requested resource does not exist or is no longer available to the requesting user.\nExamples:\n- A todo item has been deleted or does not belong to the user.\n- A link to a previously existing item after account deletion.\n\nBusiness expectations:\n- Inform the user that the item is unavailable without revealing ownership or existence details.\n- Offer to return to a safe context such as the user’s list.\n\n### 5) Conflict Errors\nDefinition: The requested change conflicts with the current state of the resource.\nExamples:\n- Concurrent update: another session or device modified the todo item between read and write.\n- State conflict: attempting to reopen an item already changed by another action.\n\nBusiness expectations:\n- Provide a safe, guided path to reconcile changes.\n- Avoid silent overwrites of user data.\n\n### 6) Rate Limit Errors\nDefinition: The frequency of actions exceeds business-defined safe thresholds for the user or system.\nExamples (example thresholds; see EARS requirements for specifics):\n- Excessive create/update/delete operations within a short period.\n- Excessive sign-in attempts.\n\nBusiness expectations:\n- Clearly communicate that limits have been reached, the duration before users may retry, and safe alternatives.\n\n### 7) Service Unavailable / Degraded Errors\nDefinition: Temporary unavailability or degraded service capability.\nExamples:\n- Maintenance windows.\n- Transient upstream issues or partial feature outage.\n\nBusiness expectations:\n- Provide a concise status message and expected retry guidance.\n- Fail gracefully and preserve user-entered data when feasible.\n\n## User-Facing Messages and Guidance\nThe system uses concise, plain-language messages written for clarity and actionability. Messages include a short title, a brief explanation, and a user-guidance sentence with the next best action. Messages avoid technical jargon and never disclose sensitive security details.\n\nMessage design principles:\n- Clarity over completeness: keep sentences short and action-oriented.\n- Specific next step: tell users exactly what to do.\n- Consistent tone: helpful, neutral, and non-blaming.\n- Localization-ready: messages are written to support translation without idioms.\n\nCanonical message examples (business-level text; actual phrasing may be localized):\n- Authentication (invalid credentials): \"We couldn’t sign you in. Check your email and password and try again.\"\n- Authentication (verification required): \"Please verify your email to continue. We’ve sent a verification message to your inbox.\"\n- Authentication (session expired): \"Your session has ended. Sign in again to continue.\"\n- Authorization: \"You don’t have permission to do that.\"\n- Validation (title missing): \"Title is required and must be between 1 and 100 characters.\"\n- Validation (due date): \"Due date must be in the future.\"\n- Not Found: \"This item is no longer available.\"\n- Conflict: \"This item was changed elsewhere. Review updates before saving.\"\n- Rate Limit: \"You’ve reached the limit for this action. Please wait a moment and try again.\"\n- Service Unavailable: \"We’re having trouble right now. Please try again shortly.\"\n\nGuidance patterns:\n- Offer safe navigation destinations (e.g., user’s list) rather than exposing internal states.\n- Preserve unsaved input where possible for local reuse after recovery.\n- Where relevant, mention expected wait times in natural language (e.g., \"about a minute\") consistent with rate-limit windows.\n\n## Recovery and Retry Policies\nThe system provides predictable recovery paths for each error class. These policies are stated from a user perspective and avoid technical implementation details.\n\nGeneral recovery principles:\n- Preserve user intent: maintain entered data locally during failures where safe.\n- Encourage minimal-effort retries: if an action can be retried safely, provide a one-step retry option.\n- Backoff expectations: spread retries to reduce repeat failures and improve success odds.\n- Idempotence from user perspective: repeated submissions during recovery should not create duplicated items or repeated side-effects.\n\nBusiness-level retry/backoff expectations by category:\n- Authentication\n  - Invalid credentials: retry immediately after correction.\n  - Unverified email: guide to verification; allow retry after verification is complete.\n  - Session expired: require sign-in; return user to previous context after success.\n- Authorization\n  - No retry until permissions change; direct user to safe context.\n- Validation\n  - Retry immediately after correcting invalid fields; do not discard valid entries.\n- Not Found\n  - No retry expected; guide to safe context. If the user reasonably expects the item to exist (e.g., recently created), suggest refreshing the list view.\n- Conflict\n  - Offer reconciliation actions described in the conflict resolution section below.\n- Rate Limit\n  - Communicate the expected minimum wait before next attempt. Provide reasonable example windows (e.g., \"about 1 minute\").\n- Service Unavailable/Degraded\n  - Suggest retry after a short interval; if a known maintenance window exists, indicate general timing (e.g., \"after maintenance ends\"). Preserve user-entered data for later submission.\n\n### Error Handling Flow (Business-Level)\n\n```mermaid\ngraph LR\n  subgraph \"User Experience\"\n    A[\"User Attempts Action\"] --> B[\"System Evaluates Request State\"]\n    B --> C{\"Is User Authenticated?\"}\n    C -->|\"No\"| D[\"Guide to Sign In or Verify Email\"]\n    C -->|\"Yes\"| E{\"Has Permission?\"}\n    E -->|\"No\"| F[\"Show Not Permitted Message\"]\n    E -->|\"Yes\"| G{\"Is Input Valid?\"}\n    G -->|\"No\"| H[\"Show Field-Specific Guidance\"]\n    G -->|\"Yes\"| I{\"Resource State OK? (Exists/Not Conflicting)\"}\n    I -->|\"No\"| J[\"Handle Not Found or Conflict with Guidance\"]\n    I -->|\"Yes\"| K{\"Service Healthy?\"}\n    K -->|\"No\"| L[\"Show Retry Guidance and Preserve Input\"]\n    K -->|\"Yes\"| M[\"Perform Action Successfully\"]\n  end\n```\n\n## Conflict Resolution for Concurrent Updates (Business Perspective)\nConcurrent edits can occur when the same todo item is open on multiple devices or sessions. The system handles such conflicts to protect user data and ensure clarity.\n\nPrinciples:\n- No silent overwrites: the system informs users when the item changed elsewhere.\n- User choice with safe defaults: provide clear options that minimize unintended data loss.\n- Visibility of differences: describe that the item has changed and that the user’s edits may conflict.\n\nBusiness-level resolution options (presented without UI design):\n- Review and Merge: users may update their draft to reflect the latest changes and reapply their edits.\n- Overwrite with My Changes: users may choose to overwrite the current item with their recent edits.\n- Discard My Edits: users may discard their edits and accept the latest item state.\n\nExpected behaviors:\n- When a conflict is detected, the system pauses the save operation and presents the above options.\n- If the user chooses to review and merge, the system provides the latest version and retains the user’s attempted changes for manual reconciliation.\n- If the user overwrites, the system records that a conflict was resolved by overwrite for audit purposes.\n- If the user discards edits, the system reverts to the latest version and confirms completion to the user.\n\n### Conflict Handling Flow (Business-Level)\n\n```mermaid\ngraph LR\n  A[\"User Submits Changes\"] --> B[\"Detect Version Mismatch\"]\n  B --> C{\"Conflict Detected?\"}\n  C -->|\"No\"| D[\"Save Changes\"]\n  C -->|\"Yes\"| E[\"Inform User and Offer Options\"]\n  E --> F{\"User Chooses Path\"}\n  F -->|\"Review and Merge\"| G[\"Load Latest and Retain User Edits\"]\n  F -->|\"Overwrite\"| H[\"Apply User Edits and Mark Overwrite\"]\n  F -->|\"Discard Edits\"| I[\"Show Latest and Discard User Attempt\"]\n  G --> J[\"User Completes Reconciliation and Saves\"]\n  H --> J\n  I --> K[\"Return to Item View\"]\n```\n\n## Audit and Monitoring Expectations (Business-Level)\nAudit and monitoring ensure accountability, security, and service quality. The following are business expectations and do not mandate specific technologies.\n\nAudit scope (business events):\n- Sign-in success and failure events (without storing sensitive secrets).\n- Email verification initiation and completion.\n- Session termination events including user-initiated global logout.\n- Authorization denials for protected actions.\n- Validation denials with categorical reasons (e.g., \"title length\").\n- Not found access attempts for protected resources.\n- Conflict detections and chosen resolution paths (merge, overwrite, discard).\n- Rate limit denials by action category.\n- Service unavailable or degraded events affecting user actions.\n\nMonitoring scope (business indicators):\n- Error rate by category and action (e.g., percentage of failed create attempts due to validation).\n- Retry success rates after guidance is provided.\n- Time-to-recovery for transient failures.\n- Distribution of conflict resolution choices.\n- Rate limit incidents per user segment.\n\nPrivacy expectations:\n- Audit entries exclude sensitive content (e.g., full passwords, private todo text). Where necessary, use categorical labels (e.g., \"validation: title length exceeded\") rather than raw content.\n- Aggregated analytics may be used to improve service quality.\n\nRetention expectations:\n- Maintain audit records for a period consistent with business and legal requirements. Summarized metrics may be retained longer than raw events when permissible.\n\n## EARS-Formatted Error Requirements and Acceptance Criteria\nAll applicable error and exception requirements are written in EARS to ensure clarity and testability. The following requirements are organized by error category.\n\n### Authentication (EARS)\n- WHEN 사용자가 잘못된 자격 증명을 제출할 때, THE todoApp SHALL 사용자에게 \"We couldn’t sign you in. Check your email and password and try again.\" 메시지와 함께 즉시 재시도를 안내한다.\n- WHEN 사용자가 이메일 미인증 상태에서 로그인을 시도할 때, THE todoApp SHALL 사용자에게 이메일 인증 필요 메시지를 제공하고 인증 완료 후 재시도를 허용한다.\n- WHEN 사용자 세션이 만료되었을 때, THE todoApp SHALL 사용자에게 다시 로그인하도록 안내하고 성공적인 로그인 후 직전 작업 컨텍스트로 복귀시킨다.\n- IF 동일 사용자가 모든 기기에서 로그아웃을 수행했을 경우, THEN THE todoApp SHALL 기존 세션을 종료하고 재인증을 요구한다.\n\nAcceptance criteria (Authentication):\n- THE todoApp SHALL 표준 메시지 문구를 제공하고, 동일 상황에서 메시지가 일관되게 노출된다.\n- THE todoApp SHALL 로그인 실패 횟수를 모니터링 가능한 이벤트로 기록하되, 민감 정보를 저장하지 않는다.\n\n### Authorization (EARS)\n- WHEN 사용자가 권한이 없는 작업을 시도할 때, THE todoApp SHALL \"You don’t have permission to do that.\" 메시지를 표시하고 안전한 대체 경로로 이동을 제안한다.\n- IF 사용자가 다른 사람의 항목에 접근을 시도할 경우, THEN THE todoApp SHALL 해당 항목의 존재 여부를 노출하지 않고 접근 거부 안내만 제공한다.\n\nAcceptance criteria (Authorization):\n- THE todoApp SHALL 모든 권한 부재 케이스에서 동일 톤의 안내 문구를 사용한다.\n- THE todoApp SHALL 권한 거부 사건을 카테고리화하여 감사 로그에 기록한다.\n\n### Validation (EARS)\n- WHEN 사용자가 제목 없이 항목 생성을 시도할 때, THE todoApp SHALL 제목이 필요하다는 메시지와 길이 기준(1–100자)을 안내한다.\n- WHEN 사용자가 설명 길이 1,000자를 초과할 때, THE todoApp SHALL 초과 길이 안내를 제공하고 입력을 수정하도록 유도한다.\n- WHEN 사용자가 현재 시간보다 과거의 기한을 설정할 때, THE todoApp SHALL 사용자 설정 시간대를 기준으로 미래 시점이어야 한다는 메시지를 제공한다.\n- WHEN 일부 필드만 유효하지 않을 때, THE todoApp SHALL 유효한 입력을 보존하고 유효하지 않은 필드만 수정하도록 안내한다.\n\nAcceptance criteria (Validation):\n- THE todoApp SHALL 각 유효성 오류에 대해 구체적이고 단일 원인을 밝히는 메시지를 제공한다.\n- THE todoApp SHALL 유효한 입력을 잃지 않도록 보존한다.\n\n### Not Found (EARS)\n- WHEN 사용자가 더 이상 존재하지 않거나 접근할 수 없는 항목을 요청할 때, THE todoApp SHALL 항목이 사용 불가하다는 메시지를 제공하고 사용자의 목록으로 돌아가도록 제안한다.\n- IF 사용자가 오래된 링크를 통해 접근할 경우, THEN THE todoApp SHALL 새로고침 또는 목록 보기로 이동하도록 안내한다.\n\nAcceptance criteria (Not Found):\n- THE todoApp SHALL 항목 존재 여부나 소유권을 유추할 수 있는 정보를 노출하지 않는다.\n- THE todoApp SHALL 안전한 탐색 경로를 항상 제공한다.\n\n### Conflict (EARS)\n- WHEN 동시 수정이 감지될 때, THE todoApp SHALL 저장을 일시 중단하고 사용자가 선택할 수 있는 \"Review and Merge\", \"Overwrite\", \"Discard My Edits\" 옵션을 제시한다.\n- WHEN 사용자가 \"Review and Merge\"를 선택할 때, THE todoApp SHALL 최신 버전을 불러오고 사용자의 시도한 변경을 보존하여 수동 병합을 지원한다.\n- WHEN 사용자가 \"Overwrite\"를 선택할 때, THE todoApp SHALL 사용자의 변경으로 현재 항목을 덮어쓰고 이 결정을 감사 용도로 기록한다.\n- WHEN 사용자가 \"Discard My Edits\"를 선택할 때, THE todoApp SHALL 최신 상태를 표시하고 사용자의 시도한 변경을 폐기한다.\n\nAcceptance criteria (Conflict):\n- THE todoApp SHALL 충돌이 발생한 저장 시도에서 사용자 데이터의 무통보 덮어쓰기를 방지한다.\n- THE todoApp SHALL 충돌 해결 옵션 중 하나를 사용자가 선택하지 않으면 항목 상태가 변경되지 않는다.\n\n### Rate Limit (EARS)\n- WHERE 단일 사용자에 대해 쓰기 동작(생성/수정/삭제)이 1분 내 60회를 초과하는 경우, THE todoApp SHALL 해당 사용자에게 \"You’ve reached the limit for this action. Please wait a moment and try again.\" 메시지로 안내하고 최소 1분 후 재시도를 허용한다.\n- WHERE 로그인 시도가 10분 내 10회를 초과하는 경우, THE todoApp SHALL 추가 시도를 일시 차단하고 사용자에게 일정 시간 후 재시도 안내 및 비밀번호 재설정 경로를 제시한다.\n- WHERE 시스템 보호가 필요한 기타 민감 동작이 단시간에 과도하게 반복되는 경우, THE todoApp SHALL 사용 빈도 및 대기 시간에 대한 명확한 안내를 제공한다.\n\nAcceptance criteria (Rate Limit):\n- THE todoApp SHALL 사용자에게 남은 대기 시간의 대략적 범위를 자연어로 안내한다.\n- THE todoApp SHALL 속도 제한 사건을 모니터링 가능한 형태로 집계한다.\n\n### Service Unavailable / Degraded (EARS)\n- WHEN 일시적인 서비스 문제로 요청을 처리할 수 없을 때, THE todoApp SHALL 사용자에게 재시도 권장 메시지와 짧은 대기 후 시도를 안내한다.\n- WHERE 계획된 점검 기간 동안, THE todoApp SHALL 제한된 가용성을 알리고 점검 종료 후 이용 가능하다는 일반적 일정을 제시한다.\n- WHILE 서비스가 부분적으로 저하된 상태일 때, THE todoApp SHALL 영향을 받는 기능을 명시하고 대체 가능한 경로가 있으면 안내한다.\n- IF 요청이 실패했지만 사용자가 입력한 데이터가 보존 가능할 경우, THEN THE todoApp SHALL 데이터를 안전하게 보존하여 사용자가 나중에 다시 제출할 수 있도록 한다.\n\nAcceptance criteria (Service Unavailable / Degraded):\n- THE todoApp SHALL 사용자 데이터 손실 없이 실패를 통지하며 재시도 경로를 제공한다.\n- THE todoApp SHALL 점검 등 예측 가능한 제한이 있는 경우 사전에 고지 가능한 메시지 형식을 지원한다.\n\n### Cross-Cutting Error Handling Principles (EARS)\n- THE todoApp SHALL 모든 오류 메시지에서 기술적 세부 정보(내부 오류 코드, 내부 식별자)를 노출하지 않는다.\n- THE todoApp SHALL 동일한 오류 상황에 대해 일관된 문구와 톤을 사용한다.\n- THE todoApp SHALL 사용자의 최근 작업 컨텍스트를 가능한 범위에서 보존하여 회복 후 작업을 이어갈 수 있도록 한다.\n- THE todoApp SHALL 오류 발생 시 사용자가 한 번의 조작으로 재시도할 수 있는 흐름을 제공한다(가능한 경우).\n- THE todoApp SHALL 모든 오류 범주에 대해 감사 및 모니터링 가능한 비식별 이벤트를 생성한다.\n\n## Acceptance Test Scenarios (EARS)\n- WHEN 사용자가 제목 없이 항목 생성을 제출할 때, THE todoApp SHALL 제목 유효성 메시지를 즉시 표시하고 다른 필드 값은 보존한다.\n- WHEN 사용자가 세션 만료 후 항목 완료를 시도할 때, THE todoApp SHALL 다시 로그인하도록 안내하고 성공 후 항목 완료 시도를 이어갈 수 있도록 한다.\n- WHEN 두 기기에서 같은 항목을 거의 동시에 수정 및 저장할 때, THE todoApp SHALL 한 저장을 성공시키고 다른 저장에는 충돌 메시지와 해결 옵션을 제공한다.\n- WHEN 사용자가 1분 내 60회를 초과하는 수정 시도를 할 때, THE todoApp SHALL 추가 시도를 제한하고 대기 안내 메시지를 제공한다.\n- WHEN 서비스가 일시적으로 가용하지 않을 때, THE todoApp SHALL 사용자 입력을 보존하고 짧은 대기 후 재시도를 유도한다.\n\n## Glossary (Business-Level)\n- Authentication: Processes ensuring a user is who they claim to be.\n- Authorization: Processes ensuring a user is allowed to perform a requested action.\n- Validation: Checking that user-provided inputs meet business rules.\n- Conflict: Differences between the user’s attempted changes and the resource’s current state.\n- Rate Limit: Business-defined bounds on action frequency to protect users and the system.\n- Service Degraded/Unavailable: Temporary reduction or loss of service capability.\n\n## Traceability\n- Authentication and Authorization sections trace to the [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md).\n- Validation and Not Found sections trace to the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md).\n- Conflict resolution traces to the [User Flows for todoApp](./05-todoApp-user-flows.md).\n- Retry and service health expectations align with the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md).\n"},"plan":"Title and structure per outline:\n1) Title: todoApp Error Handling and Exception Scenarios\n2) Introduction and Scope (content-only phrasing, no meta)\n3) Error Taxonomy (seven categories with definitions, examples, expectations) aligned with functional limits (title 1–120, description ≤1,000, due date rules)\n4) User-Facing Messages and Guidance (principles + canonical examples in en-US)\n5) Recovery and Retry Policies (general principles + category specifics) and Mermaid flow (graph LR, quoted labels, valid arrows)\n6) Conflict Resolution for Concurrent Updates (principles, options, outcomes) and Mermaid flow\n7) Audit and Monitoring Expectations (audit scope, monitoring indicators, privacy and retention expectations)\n8) EARS-Formatted Error Requirements and Acceptance Criteria (by category; all in en-US; consistent limits)\n9) Acceptance Test Scenarios (EARS) in en-US\n10) Glossary (business-level)\n11) Traceability (descriptive links to existing related docs)\nGlobal rules: No HTTP codes, no implementation details, no meta, correct Mermaid syntax, consistent terminology, all content en-US.","review":"Enhance to a production-ready, en-US business requirements document with:\n- Length: 5,000–30,000+ chars; fully expand all sections\n- EARS compliance for ALL applicable requirements (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL in English; descriptions in en-US)\n- No API specs, HTTP codes, or database schemas; no technical implementation details\n- No meta-commentary (avoid phrases like “This document…”); write as the document itself\n- Correct, left-to-right Mermaid diagrams with ALL labels in double quotes, no spaces between brackets/braces and quotes, valid arrow syntax (--> , -.-> , ==>), and labeled edges as -->|\"Label\"|\n- Specific, testable business rules; align with related documents (roles/auth, functional, user flows, NFRs)\n- Consistent field limits with functional specs (e.g., title 1–120, description up to 1,000, due date rules per functional scope)\n- Clear user-facing messages and recovery guidance\n- Comprehensive taxonomy: Authentication, Authorization, Validation, Not Found, Conflict, Rate Limit, Service Unavailable/Degraded\n- Detailed recovery/retry, conflict resolution, audit & monitoring expectations\n- Acceptance criteria and scenarios in EARS; no questions to reader\n- User locale: en-US; translate any non-English content to en-US\n- Business-only authentication/authorization references; no tokens, headers, or HTTP statuses\n- Link text must be descriptive and point to existing files via relative paths","content":"# todoApp Error Handling and Exception Scenarios\n\n## Introduction and Scope\nBusiness-level error handling and exception scenarios govern how todoApp behaves under failure from the user’s perspective. Responses include clear messages, actionable guidance, and safe recovery paths that protect user intent and data. Policies below set auditing and monitoring expectations in business terms. Content describes WHAT the system must do in failure conditions, not HOW to implement it.\n\nRelated references for context:\n- [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md)\n- [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md)\n- [User Flows for todoApp](./05-todoApp-user-flows.md)\n- [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md)\n\n## Error Taxonomy\nErrors are grouped into seven user-facing categories. Each category includes representative scenarios, causes, and business expectations for messaging and recovery.\n\n### 1) Authentication Errors\nDefinition: Failures related to verifying identity or session validity.\nExamples:\n- Invalid email or password during sign-in.\n- Attempt to sign in while email remains unverified where verification is required.\n- Expired or invalid session when accessing protected features.\n- Global logout invoked by the same user resulting in session revocation.\nBusiness expectations:\n- Provide neutral, clear messaging without exposing sensitive details.\n- Guide immediate next steps such as retrying, verifying email, or signing in again.\n\n### 2) Authorization Errors\nDefinition: Authenticated identity lacks permission for the requested action.\nExamples:\n- Attempt to access another user’s todo item.\n- Attempt to perform administrative actions without the admin role.\nBusiness expectations:\n- State that the action is not permitted without confirming whether the resource exists.\n- Offer safe alternatives (e.g., return to the user’s list, contact support via approved channels).\n\n### 3) Validation Errors\nDefinition: Submitted input fails business rules.\nRepresentative rules (aligned with functional and business rules):\n- Title: required, 1–120 characters (trimmed).\n- Description: optional, up to 1,000 characters.\n- Due date: optional; if present, must be a valid calendar date-time and not earlier than the creation date in the user’s time zone; not more than 5 years in the future.\n- Completion actions: only allowed on existing, owned items in a valid state for the transition.\nBusiness expectations:\n- Identify each invalid field with a specific reason and a concrete correction.\n- Preserve valid portions of user input where safe.\n\n### 4) Not Found Errors\nDefinition: Requested resource does not exist or is not available to the requesting user.\nExamples:\n- Todo item was deleted or is owned by someone else.\n- Link to an item after the owner’s account was deleted.\nBusiness expectations:\n- Communicate unavailability without confirming ownership or prior existence.\n- Offer navigation to a safe context (e.g., the user’s list) or a refresh suggestion.\n\n### 5) Conflict Errors\nDefinition: Requested change conflicts with the current resource state.\nExamples:\n- Concurrent update: another session or device modified the item between read and write.\n- State conflict: attempting a transition inconsistent with the latest state.\nBusiness expectations:\n- Prevent silent overwrites and provide a guided reconciliation path.\n- Offer clear options that minimize unintended data loss.\n\n### 6) Rate Limit Errors\nDefinition: Action frequency exceeds business-defined safe thresholds.\nExamples:\n- Excessive create/update/delete operations within a short period.\n- Excessive sign-in attempts.\nBusiness expectations:\n- Communicate that limits have been reached, the approximate wait before retry, and safe alternatives.\n\n### 7) Service Unavailable / Degraded Errors\nDefinition: Temporary unavailability or degraded capability of part or all of the service.\nExamples:\n- Planned maintenance window.\n- Transient upstream issue or partial feature outage.\nBusiness expectations:\n- Provide a concise status message and retry guidance.\n- Preserve user-entered data when feasible so users can retry later.\n\n## User-Facing Messages and Guidance\nMessages are short, neutral, and action-oriented. Each includes a succinct title or first sentence, a brief explanation, and a specific next step. Messages avoid technical jargon and do not disclose security-sensitive details. Tone remains consistent across categories.\n\nCanonical message examples (business-level, localization-ready):\n- Authentication (invalid credentials): \"We couldn’t sign you in. Check your email and password and try again.\"\n- Authentication (verification required): \"Please verify your email to continue. We’ve sent a verification message to your inbox.\"\n- Authentication (session expired): \"Your session has ended. Sign in again to continue.\"\n- Authorization: \"You don’t have permission to do that.\"\n- Validation (title missing): \"Title is required and must be between 1 and 120 characters.\"\n- Validation (due date): \"Due date must be valid and not earlier than the creation date.\"\n- Not Found: \"This item is no longer available.\"\n- Conflict: \"This item changed elsewhere. Review updates before saving.\"\n- Rate Limit: \"You’ve reached the limit for this action. Please wait a moment and try again.\"\n- Service Unavailable: \"We’re having trouble right now. Please try again shortly.\"\n\nGuidance patterns:\n- Offer safe navigation (e.g., return to my list) rather than exposing internal details.\n- Preserve unsaved input locally where feasible to honor user intent after recovery.\n- Indicate approximate wait times in natural language (e.g., \"about a minute\") when limits or maintenance apply.\n\n## Recovery and Retry Policies\nBehavior under failure aims to preserve user intent and minimize repeated effort.\n\nGeneral recovery principles:\n- Preserve user intent by maintaining entered data locally where safe.\n- Encourage low-effort retries; if an action is safe to retry, provide a one-step retry affordance.\n- Spread retries to avoid repeated failures and improve success likelihood.\n- Ensure that repeated submissions do not create duplicates or repeated side effects from the user’s perspective.\n\nCategory-specific expectations:\n- Authentication\n  - Invalid credentials: allow immediate retry after correction.\n  - Unverified email: guide to verification; allow retry after verification completes.\n  - Session expired: prompt sign-in; upon success, return the user to the prior action context.\n- Authorization\n  - Do not retry until permissions change; route the user to a safe context.\n- Validation\n  - Allow immediate retry after correcting invalid fields; preserve all valid entries.\n- Not Found\n  - Do not encourage retry; guide to a safe context. If the user expects the item to exist (e.g., just created), suggest refreshing the list.\n- Conflict\n  - Offer reconciliation as described in the conflict section.\n- Rate Limit\n  - Communicate the minimum wait before the next attempt, using natural language.\n- Service Unavailable/Degraded\n  - Suggest retry after a short interval; if planned maintenance is in progress, indicate general timing. Preserve user-entered data for later submission.\n\n### Error Handling Flow (Business-Level)\n```mermaid\ngraph LR\n  subgraph \"User Experience\"\n    A[\"User Attempts Action\"] --> B[\"Evaluate Request State\"]\n    B --> C{\"Is User Authenticated?\"}\n    C -->|\"No\"| D[\"Guide to Sign In or Verify Email\"]\n    C -->|\"Yes\"| E{\"Has Permission?\"}\n    E -->|\"No\"| F[\"Show Not Permitted Message\"]\n    E -->|\"Yes\"| G{\"Is Input Valid?\"}\n    G -->|\"No\"| H[\"Show Field-Specific Guidance\"]\n    G -->|\"Yes\"| I{\"Resource State OK?\"}\n    I -->|\"No\"| J[\"Handle Not Found or Conflict\"]\n    I -->|\"Yes\"| K{\"Service Healthy?\"}\n    K -->|\"No\"| L[\"Show Retry Guidance and Preserve Input\"]\n    K -->|\"Yes\"| M[\"Perform Action Successfully\"]\n  end\n```\n\n## Conflict Resolution for Concurrent Updates (Business Perspective)\nConcurrent edits occur when the same item is open on multiple devices or sessions. Behavior protects user data and ensures clarity.\n\nPrinciples:\n- No silent overwrites; inform users when the item changed elsewhere.\n- Provide options with safe defaults to minimize unintended data loss.\n- Communicate that the item changed and the user’s pending edits may conflict.\n\nResolution options (business-level; not UI design):\n- Review and Merge: update the draft to reflect the latest version and reapply the user’s edits.\n- Overwrite with My Changes: overwrite the current item with the user’s edits.\n- Discard My Edits: discard the user’s edits and accept the latest item state.\n\nExpected behaviors:\n- Pause the save operation upon detecting a conflict and present the options above.\n- For Review and Merge, provide the latest version while retaining the user’s attempted changes for manual reconciliation.\n- For Overwrite, apply the user’s edits and record that overwrite was chosen for audit purposes.\n- For Discard My Edits, revert to the latest version and confirm completion to the user.\n\n### Conflict Handling Flow (Business-Level)\n```mermaid\ngraph LR\n  A[\"User Submits Changes\"] --> B[\"Detect Version Mismatch\"]\n  B --> C{\"Conflict Detected?\"}\n  C -->|\"No\"| D[\"Save Changes\"]\n  C -->|\"Yes\"| E[\"Inform and Offer Options\"]\n  E --> F{\"User Choice\"}\n  F -->|\"Review and Merge\"| G[\"Load Latest and Retain Edits\"]\n  F -->|\"Overwrite\"| H[\"Apply Edits and Mark Overwrite\"]\n  F -->|\"Discard My Edits\"| I[\"Show Latest and Discard Attempt\"]\n  G --> J[\"Complete Reconciliation and Save\"]\n  H --> J\n  I --> K[\"Return to Item View\"]\n```\n\n## Audit and Monitoring Expectations (Business-Level)\nAudit and monitoring provide accountability, security, and service quality without exposing sensitive content.\n\nAudit scope (business events):\n- Sign-in successes and failures (no sensitive secrets retained).\n- Email verification initiation and completion.\n- Session terminations, including user-initiated global logout.\n- Authorization denials for protected actions.\n- Validation denials with categorical reasons (e.g., \"title length\").\n- Not found attempts on protected resources.\n- Conflict detections and chosen resolutions (merge, overwrite, discard).\n- Rate limit denials by action category.\n- Service unavailable or degraded events affecting user actions.\n\nMonitoring scope (business indicators):\n- Error rate by category and action (e.g., percentage of failed creates due to validation).\n- Retry success rates after guidance.\n- Time-to-recovery for transient failures.\n- Distribution of conflict resolution choices.\n- Rate limit incidents per user segment.\n\nPrivacy expectations:\n- Exclude sensitive secrets and private todo text from audit entries; use categorical labels (e.g., \"validation: title length exceeded\").\n- Aggregated, non-identifying analytics may be used to improve service quality.\n\nRetention expectations:\n- Maintain audit records for a period consistent with business and legal requirements. Summarized metrics may be retained longer than raw events where permissible.\n\n## EARS-Formatted Error Requirements and Acceptance Criteria\nAll requirements appear in EARS format to ensure clarity and testability.\n\n### Authentication (EARS)\n- WHEN a user submits invalid credentials, THE todoApp SHALL show the message \"We couldn’t sign you in. Check your email and password and try again.\" and guide immediate retry.\n- WHEN a user attempts to sign in with an unverified email, THE todoApp SHALL present an email verification required message and allow retry after verification completes.\n- WHEN a user’s session has expired, THE todoApp SHALL prompt the user to sign in again and, upon success, return to the prior action context.\n- IF the same user triggers sign out from all devices, THEN THE todoApp SHALL terminate existing sessions and require re-authentication for further actions.\n\nAcceptance criteria (Authentication):\n- THE todoApp SHALL use standard, consistent phrasing for the same situations across the service.\n- THE todoApp SHALL record sign-in failures as auditable, non-sensitive events suitable for monitoring.\n\n### Authorization (EARS)\n- WHEN a user attempts an action without permission, THE todoApp SHALL display \"You don’t have permission to do that.\" and suggest a safe navigation path.\n- IF a user attempts to access another user’s item, THEN THE todoApp SHALL deny access without revealing the item’s existence or ownership.\n\nAcceptance criteria (Authorization):\n- THE todoApp SHALL apply a consistent tone for permission denials.\n- THE todoApp SHALL categorize permission denials in audit logs for monitoring.\n\n### Validation (EARS)\n- WHEN a user attempts to create an item without a title, THE todoApp SHALL present guidance that a title is required and must be 1–120 characters.\n- WHEN a user provides a description longer than 1,000 characters, THE todoApp SHALL indicate the limit and prompt the user to shorten it.\n- WHEN a user provides a due date earlier than the creation date or more than 5 years in the future (user’s time zone), THE todoApp SHALL prompt for a valid due date.\n- WHEN some fields are valid and others are not, THE todoApp SHALL preserve valid inputs and ask the user to correct only the invalid fields.\n\nAcceptance criteria (Validation):\n- THE todoApp SHALL present a single, concrete reason per invalid field.\n- THE todoApp SHALL preserve all valid inputs during correction.\n\n### Not Found (EARS)\n- WHEN a user requests an item that does not exist or is no longer available, THE todoApp SHALL show an unavailability message and suggest returning to the user’s list or refreshing.\n- IF a user follows an outdated link to an item, THEN THE todoApp SHALL suggest refreshing or navigating back to the list without revealing ownership information.\n\nAcceptance criteria (Not Found):\n- THE todoApp SHALL avoid disclosing existence or ownership of resources the user cannot access.\n- THE todoApp SHALL always provide a safe navigation path.\n\n### Conflict (EARS)\n- WHEN concurrent modification is detected, THE todoApp SHALL pause the save and present the options \"Review and Merge\", \"Overwrite\", and \"Discard My Edits\".\n- WHEN the user selects \"Review and Merge\", THE todoApp SHALL load the latest version and retain the user’s attempted changes for manual reconciliation.\n- WHEN the user selects \"Overwrite\", THE todoApp SHALL apply the user’s edits and record the overwrite choice for audit purposes.\n- WHEN the user selects \"Discard My Edits\", THE todoApp SHALL show the latest version and discard the user’s attempted changes.\n\nAcceptance criteria (Conflict):\n- THE todoApp SHALL prevent silent overwrites when a save is in conflict.\n- THE todoApp SHALL make no state change unless the user chooses one of the provided resolution options.\n\n### Rate Limit (EARS)\n- WHERE a single user performs more than 60 write actions (create/update/delete) within 1 minute, THE todoApp SHALL inform the user \"You’ve reached the limit for this action. Please wait a moment and try again.\" and allow retry after approximately 1 minute.\n- WHERE sign-in attempts exceed 10 within 10 minutes for a user, THE todoApp SHALL temporarily block further attempts and present retry guidance and a password reset path.\n- WHERE other sensitive actions are repeated excessively within a short time, THE todoApp SHALL provide clear guidance on usage limits and approximate wait time.\n\nAcceptance criteria (Rate Limit):\n- THE todoApp SHALL communicate an approximate remaining wait time in natural language.\n- THE todoApp SHALL aggregate rate limit incidents for monitoring.\n\n### Service Unavailable / Degraded (EARS)\n- WHEN a temporary service issue prevents completing a request, THE todoApp SHALL present retry guidance and suggest waiting briefly before trying again.\n- WHERE a planned maintenance window is active, THE todoApp SHALL indicate limited availability and suggest retry after maintenance ends.\n- WHILE the service is partially degraded, THE todoApp SHALL name the affected feature areas and suggest alternatives if available.\n- IF a request fails but user-entered data can be preserved safely, THEN THE todoApp SHALL preserve the data so the user can resubmit later.\n\nAcceptance criteria (Service Unavailable / Degraded):\n- THE todoApp SHALL notify failure without losing user-entered data and provide a retry path.\n- THE todoApp SHALL support proactive messages for predictable limitations such as scheduled maintenance.\n\n### Cross-Cutting Error Handling Principles (EARS)\n- THE todoApp SHALL avoid exposing technical internals (e.g., internal error codes or identifiers) in user-facing messages.\n- THE todoApp SHALL use consistent tone and language for the same error situations across the service.\n- THE todoApp SHALL preserve the user’s recent working context where feasible so work can continue after recovery.\n- THE todoApp SHALL provide a one-step retry mechanism for recoverable failures where possible.\n- THE todoApp SHALL emit non-identifying audit and monitoring events for every error category.\n\n## Acceptance Test Scenarios (EARS)\n- WHEN a user submits creation without a title, THE todoApp SHALL display title validation guidance immediately and preserve other entered fields.\n- WHEN a user attempts to complete an item after the session has expired, THE todoApp SHALL prompt for sign-in and, upon success, continue with the completion attempt.\n- WHEN two devices save edits to the same item nearly simultaneously, THE todoApp SHALL commit one save and, for the other, show a conflict message with resolution options.\n- WHEN a user exceeds 60 write attempts within a minute, THE todoApp SHALL limit additional attempts and display wait guidance.\n- WHEN the service is temporarily unavailable, THE todoApp SHALL preserve user-entered input and encourage retry after a short interval.\n\n## Glossary (Business-Level)\n- Authentication: Verifying a user’s identity.\n- Authorization: Determining whether a user has permission for an action.\n- Validation: Checking that input values comply with business rules.\n- Conflict: A situation where attempted changes differ from the current resource state.\n- Rate Limit: A business-defined threshold on action frequency to protect users and the service.\n- Service Degraded/Unavailable: A temporary reduction or loss of service capability.\n\n## Traceability\n- Authentication and authorization behaviors align with the [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md).\n- Validation and not found behaviors align with the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md).\n- Conflict handling aligns with the [User Flows for todoApp](./05-todoApp-user-flows.md).\n- Retry and service health expectations align with the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md).","tokenUsage":{"total":74880,"input":{"total":67578,"cached":0},"output":{"total":7302,"reasoning":2560,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":3,"step":0,"created_at":"2025-08-15T04:00:34.147Z"},"tokenUsage":{"aggregate":{"total":480086,"input":{"total":386482,"cached":11648},"output":{"total":93604,"reasoning":36032,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":477302,"input":{"total":384145,"cached":11648},"output":{"total":93157,"reasoning":35648,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Describe how information conceptually moves through its lifecycle and the related privacy requirements.","filename":"09-todoApp-data-lifecycle-and-privacy.md","documentType":"requirement","outline":["Conceptual Data Flow Overview (business-level)","Data Creation, Update, and Deletion Lifecycle","Retention and Purging Policies","User-Controlled Export/Portability (optional)","Privacy-by-Design Principles","Data Minimization and Purpose Limitation","Right to Erasure and Account Deletion Behaviors","Traceability to Business Rules and Non-Functional Requirements"],"audience":"development team","keyQuestions":["How is user data handled from creation to deletion?","What privacy safeguards are required across the lifecycle?"],"detailLevel":"moderate detail","relatedDocuments":["06-todoApp-business-rules.md","08-todoApp-non-functional-requirements.md"],"constraints":["Keep descriptions conceptual; do not define database schemas or storage technologies","Use EARS for lifecycle requirements where applicable"],"content":"# todoApp Data Lifecycle and Privacy Requirements\n\nThis document defines business requirements for how data is created, processed, retained, exported, and deleted in the todoApp service. It focuses on what the system must do from a business and user perspective, not how to implement it. This document provides business requirements only; all technical implementation decisions (architecture, APIs, and database design) are at the discretion of the development team.\n\n## 1. Conceptual Data Flow Overview (business-level)\n\nThe todoApp manages a small set of data categories:\n- User Account Data: identity and authentication attributes required to operate an account (e.g., email, password-related artifacts, verification status), plus preferences strictly necessary to provide the service.\n- Todo Item Data: user-owned records representing tasks, including essential fields (e.g., title, status) and optional fields (e.g., description, due date) as defined in the functional scope.\n- Operational Security Data: tokens, verification and reset artifacts, and session metadata necessary to authenticate and authorize users.\n- Administrative and Audit Data: minimal logs and administrative actions necessary for support, safety, fraud control, and legal compliance.\n- Aggregated Analytics (Non-Personal): metrics computed in a way that cannot be reversed to identify individuals.\n\nHigh-level conceptual data flow:\n\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A[\"Account Creation\"] --> B[\"Email Verification\"]\n    B --> C[\"User Login\"]\n    C --> D[\"Create/Update Todo Items\"]\n    D --> E[\"Complete/Reopen/Delete Todo Items\"]\n  end\n\n  subgraph \"System Governance\"\n    F[\"Retention Counters\"] --> G[\"Soft Delete Window\"]\n    G --> H[\"Scheduled Purge\"]\n    I[\"Export Requests\"] --> J[\"Prepare User Data Export\"]\n    K[\"Audit Events\"] --> L[\"Time-bound Retention\"]\n  end\n\n  A --> M[\"Account Profile\"]\n  D --> N[\"Todo Dataset\"]\n  E --> N\n  C --> O[\"Session Lifecycle\"]\n  J --> P[\"User Delivery\"]\n  H --> Q[\"Permanent Deletion\"]\n  L --> R[\"Expiry or Compliance Hold\"]\n```\n\nNotes:\n- \"Soft Delete Window\" is a reversible state prior to permanent deletion.\n- \"Scheduled Purge\" removes data permanently when retention conditions are met.\n\n## 2. Data Creation, Update, and Deletion Lifecycle\n\n### 2.1 Ownership and Access\n- Users (role: user) own and control their own account data and todo items.\n- Administrators (role: admin) operate under least-privilege for support, safety, and policy enforcement. Administrative access to user data is limited to specific, auditable actions justified by a legitimate business need.\n\n### 2.2 Creation Requirements (EARS)\n- THE service SHALL record the creator’s user identifier as the immutable owner of each todo item at creation time.\n- WHEN a user creates a todo item, THE service SHALL store only fields defined as necessary by the functional scope and business rules.\n- IF a creation request omits a required business field, THEN THE service SHALL reject the creation with a clear, user-understandable explanation referencing the missing or invalid field.\n- WHERE optional fields are provided at creation, THE service SHALL validate them against business rules before accepting the item.\n\n### 2.3 Read and Listing Requirements (EARS)\n- THE service SHALL allow a user to view only their own todo items and account data, except where an admin is performing a permitted support action under audit.\n- WHEN a user lists todo items, THE service SHALL return only items not permanently deleted and within the user’s ownership scope.\n- WHERE filters and sorting are requested, THE service SHALL apply only supported business-level filters and sorts as defined in the functional requirements.\n\n### 2.4 Update Requirements (EARS)\n- WHEN a user updates a todo item they own, THE service SHALL validate each changed field against business rules and persist only if all validations pass.\n- IF an update conflicts with a more recent change, THEN THE service SHALL prevent silent overwrites and provide guidance for conflict resolution.\n- THE service SHALL record the time and actor for each successful update in an auditable manner without exposing implementation details to end users.\n\n### 2.5 Completion/Reopen Requirements (EARS)\n- WHEN a user marks an item as completed, THE service SHALL set the item’s status to completed and record the completion timestamp.\n- WHEN a user reopens a completed item, THE service SHALL revert the status and clear or update completion metadata as defined by business rules.\n\n### 2.6 Deletion Requirements (EARS)\n- WHEN a user deletes a todo item, THE service SHALL move the item to a soft-delete state that hides it from normal listings and starts a retention countdown.\n- WHILE a todo item is in soft-delete, THE service SHALL allow the owner to restore it within the defined retention window.\n- IF the soft-delete retention window elapses, THEN THE service SHALL permanently delete the item from active stores during the next scheduled purge.\n- WHERE an admin flags content for policy violations, THE service SHALL allow immediate soft-delete with admin justification recorded in audit data.\n\n## 3. Retention and Purging Policies\n\nRetention is purpose-driven and time-bound. The following policy durations are business requirements and may only be changed via documented policy updates.\n\n### 3.1 Todo Items (EARS)\n- THE service SHALL retain active todo items indefinitely until the owner deletes them or the account is deleted.\n- WHEN a todo item is soft-deleted by its owner, THE service SHALL retain it for up to 30 days to allow restoration.\n- IF a soft-deleted todo item reaches 30 days without restoration, THEN THE service SHALL permanently delete it during the next scheduled purge.\n\n### 3.2 Accounts and Profiles (EARS)\n- WHEN an account is created but not verified within 14 days, THE service SHALL purge the unverified account and all associated artifacts.\n- WHEN a verified user requests account deletion, THE service SHALL initiate a 14-day grace period before permanent deletion to allow reversal.\n- IF the grace period elapses without reversal, THEN THE service SHALL permanently delete the account and all user-owned todo items during the next scheduled purge.\n\n### 3.3 Operational Security Data (EARS)\n- THE service SHALL limit the lifetime of one-time email verification artifacts to 24 hours from issuance.\n- THE service SHALL limit the lifetime of password reset artifacts to 1 hour from issuance.\n- THE service SHALL limit the lifetime of user sessions according to the authentication policy defined in the user roles and authentication requirements.\n\n### 3.4 Administrative and Audit Data (EARS)\n- THE service SHALL retain minimal audit events necessary to reconstruct security- and policy-relevant actions for 180 days, unless a longer retention is mandated by documented legal obligations.\n- WHERE a legal hold is in effect, THE service SHALL suspend purge of affected audit records until the hold is lifted.\n\n### 3.5 Aggregated Analytics (EARS)\n- THE service SHALL keep only aggregated, non-personal metrics that cannot feasibly be re-identified.\n- WHERE any analytics processing would require personal data, THE service SHALL either minimize and anonymize the input or forego the processing to protect user privacy.\n\n### 3.6 Purge Execution (EARS)\n- THE service SHALL execute purge processes on a predictable schedule (at least daily) to remove data whose retention windows have expired.\n- IF a purge process fails partially, THEN THE service SHALL retry purging the remaining eligible records without duplicating prior deletions.\n\n## 4. User-Controlled Export/Portability (optional)\n\n### 4.1 Scope\nUser export includes user-owned account data and todo item content within the user’s ownership scope. Audit logs, administrative justifications, and internal security artifacts are excluded from user export unless required by applicable law.\n\n### 4.2 Export Requirements (EARS)\n- WHEN a user requests an export, THE service SHALL prepare a complete, machine-readable package of the user’s account data and todo items.\n- THE service SHALL deliver the export within 24 hours of the request under normal operating conditions.\n- WHERE an export is large or complex, THE service SHALL communicate progress and provide the completed package once preparation is finished.\n- THE service SHALL limit export requests to once per rolling 7-day period per user to manage capacity and abuse risk.\n\n## 5. Privacy-by-Design Principles\n\n### 5.1 Foundational Principles (EARS)\n- THE service SHALL default to the most privacy-preserving state for all new features and data flows (privacy by default).\n- THE service SHALL enforce least privilege for all role-based access to user data.\n- THE service SHALL ensure purpose limitation by collecting and processing data only for clearly defined, legitimate purposes necessary to operate todoApp.\n- THE service SHALL ensure transparency by documenting data uses and changes to policy in a user-accessible location.\n\n### 5.2 Administrative Access Governance (EARS)\n- WHERE an admin must access user data for support or policy enforcement, THE service SHALL require an explicit business justification recorded in audit data.\n- IF an admin action impacts a user’s data materially (e.g., forced deletion for policy), THEN THE service SHALL record the action with actor, time, scope, and justification in audit data.\n\n### 5.3 Security Posture at Business Level (EARS)\n- THE service SHALL protect personal data at rest and in transit using industry-appropriate safeguards without prescribing specific technologies in this document.\n- THE service SHALL restrict access to personal data to authorized roles only, consistent with the defined permission model.\n\n## 6. Data Minimization and Purpose Limitation\n\n### 6.1 Data Collection Boundaries (EARS)\n- THE service SHALL collect only the minimum personal data required to operate user accounts and manage todo items (e.g., contact identifier and authentication secrets).\n- WHERE optional data is provided by the user (e.g., description, due date), THE service SHALL use it solely to enhance the todo management experience.\n- THE service SHALL avoid collecting special categories of personal data; if such data is inadvertently submitted in free-text fields, the service SHALL treat it with the highest level of protection and not use it for profiling or analytics.\n\n### 6.2 Data Use Boundaries (EARS)\n- THE service SHALL not sell personal data or share it with third parties for independent marketing purposes.\n- WHERE service providers are engaged to operate core functionality, THE service SHALL ensure they process data only on behalf of todoApp for permitted purposes.\n\n### 6.3 Storage Boundaries (EARS)\n- THE service SHALL not store personal data beyond the retention periods defined in this document unless required for legal obligations documented by policy.\n\n## 7. Right to Erasure and Account Deletion Behaviors\n\n### 7.1 Conceptual Deletion Flow\n\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"User Requests Account Deletion\"] --> B[\"Start 14-day Grace Period\"]\n    B --> C{\"Login During Grace?\"}\n  end\n\n  subgraph \"System Outcomes\"\n    D[\"Cancel Deletion and Restore Access\"]\n    E[\"Maintain Grace and Restricted Access\"]\n    F[\"Permanent Deletion at Purge\"]\n  end\n\n  C -->|\"Yes\"| D\n  C -->|\"No\"| E\n  E --> G{\"Grace Expired?\"}\n  G -->|\"Yes\"| F\n  G -->|\"No\"| E\n```\n\n### 7.2 Erasure Requirements (EARS)\n- WHEN a verified user requests account deletion, THE service SHALL initiate a 14-day grace period and notify the user of the effective deletion date.\n- WHILE an account is in the grace period, THE service SHALL restrict access to read-only export and deletion cancellation; normal write operations SHALL be blocked.\n- IF the user logs in and cancels during the grace period, THEN THE service SHALL restore full access and stop the deletion process immediately.\n- IF the grace period ends without cancellation, THEN THE service SHALL permanently delete the account, user-owned todo items, and user-specific preferences during the next scheduled purge.\n- WHERE deletion would impact records under legal hold or unresolved disputes, THE service SHALL defer deletion of those specific records while completing deletion of all other user data.\n\n### 7.3 Exceptions and Residual Data (EARS)\n- THE service SHALL preserve non-identifying, aggregated analytics after account deletion, provided such aggregates cannot be used to re-identify the user.\n- WHERE audit records must be retained for security or compliance, THE service SHALL retain only the minimum necessary audit data for the mandated period, decoupled from content details where feasible.\n\n## 8. Traceability to Business Rules and Non-Functional Requirements\n\nThis document aligns with and should be read in concert with the following:\n- Refer to the [Business Rules and Validation Guide](./06-todoApp-business-rules.md) for field-level validations, ownership, and rate limits that complement lifecycle behaviors.\n- Refer to the [Non-Functional Requirements and Service Expectations](./08-todoApp-non-functional-requirements.md) for performance, availability, and security expectations that constrain lifecycle operations.\n\n### 8.1 Traceability Highlights\n- Creation, update, and deletion validations: see Business Rules sections on Todo Item Validation Rules and Ownership.\n- Export responsiveness and delivery window: see Non-Functional performance expectations.\n- Audit and monitoring expectations: see Non-Functional operational monitoring.\n\n## 9. Business-Level Acceptance and Monitoring Criteria (EARS)\n\n- THE service SHALL complete visible create, update, and delete operations on user data within 2 seconds under normal operating conditions.\n- THE service SHALL execute daily purge cycles that remove all data past retention within 24 hours of eligibility.\n- WHEN a user requests export, THE service SHALL provide the export within 24 hours under normal operating conditions.\n- WHEN a user initiates account deletion, THE service SHALL enforce the 14-day grace period and execute permanent deletion at the next scheduled purge thereafter.\n- WHERE legal hold or compliance exceptions apply, THE service SHALL document the scope and duration and prevent deletion of the held records until the hold is removed.\n\n## 10. Error and Recovery Expectations Across the Lifecycle (EARS)\n\n- IF a user attempts to restore a todo item after the retention window has expired, THEN THE service SHALL inform the user that restoration is no longer possible and the item has been permanently deleted.\n- IF an export preparation exceeds the standard 24-hour window due to exceptional load, THEN THE service SHALL notify the user of delay and deliver the export as soon as preparation completes.\n- IF a purge process encounters inconsistencies, THEN THE service SHALL isolate affected records, log the issue for investigation, and continue purging unaffected eligible records.\n- IF an admin-initiated action is missing a documented justification, THEN THE service SHALL block the action and request a valid justification entry.\n\n## 11. Glossary (Business-Level)\n\n- Soft Delete: A reversible state in which data is hidden from normal operations and scheduled for purge after a retention window.\n- Permanent Deletion (Hard Delete): Irreversible removal of data from active systems following retention rules.\n- Grace Period: A bounded time during which a user may reverse a pending account deletion.\n- Legal Hold: A suspension of purge and deletion for specific records due to legal or compliance obligations.\n- Aggregated Analytics: Non-personal statistical measures that cannot be traced back to an identifiable individual.\n\n---\n\nThis document is business-requirements-only. Developers have full autonomy to determine the technical architecture, interfaces, storage strategies, and operational mechanisms necessary to satisfy these requirements while adhering to organizational standards and applicable laws."},"plan":"Structure per metadata outline, adding supportive sections where necessary:\n1) Title and business‑only autonomy statement\n2) Conceptual Data Flow Overview with Mermaid (User Initiated, System Governance, Data Stores)\n3) Data Creation/Read/Update/Completion/Reopen/Deletion lifecycle (EARS)\n4) Retention and Purging (todos, accounts, security artifacts, audit, analytics, purge execution) and Backups (residual data behavior)\n5) User‑Controlled Export/Portability (scope, limits, delivery expectations, rate‑limits)\n6) Privacy‑by‑Design (least privilege, transparency, DPIA triggers, admin governance, security posture)\n7) Data Minimization and Purpose Limitation (collection, use, storage, prohibited categories)\n8) Right to Erasure & Account Deletion (conceptual flows with Mermaid; grace period behaviors and exceptions)\n9) Additional Lifecycle Topics: Data Lineage & Auditability; Caching/Indexing Propagation; Non‑Production/Test Data Controls; Third‑Party Processors & Data Transfers; Consent and Preference Management; Data Breach Response Expectations (business‑level)\n10) Traceability to Business Rules and NFR with descriptive links\n11) Business‑Level Acceptance & Monitoring Criteria (EARS)\n12) Error & Recovery Expectations (EARS)\n13) Data Categorization Table\n14) Glossary","review":"Enhance to fully meet: length (≥5,000 chars), section completeness per outline, EARS specificity for all lifecycle requirements, correct Mermaid syntax (double quotes, no spaces between brackets/braces and quotes, proper arrows), conceptual focus (no APIs, schemas, or tech stack), inclusion of business-only autonomy statement without meta phrasing, comprehensive privacy safeguards across lifecycle (minimization, purpose limitation, erasure, export, audit, admin governance), alignment with roles (user, admin), alignment with related docs (06 business rules, 08 NFR). Add missing processes: backups and restore visibility, cache/index propagation, non‑production data handling, third‑party processors and data transfers, consent/preferences, data lineage/auditability, data breach response expectations in business terms. Ensure links use descriptive text. Expand EARS for DSAR (access/rectification), audit, purge, export, legal hold, rate limits for exports, and residual data in backups. Validate all Mermaid diagrams per rules (graph LR, quoted labels, correct edges).","content":"# todoApp Data Lifecycle and Privacy Requirements\n\nBusiness requirements only; all technical implementation decisions (architecture, APIs, database design, and storage technologies) belong to the development team. The content defines WHAT todoApp must do for data across its lifecycle, not HOW to implement it.\n\n## 1. Conceptual Data Flow Overview (business‑level)\n\nData categories\n- User Account Data: identity and authentication attributes needed to operate an account, plus preferences strictly necessary to provide the service.\n- Todo Item Data: user‑owned task records with required fields (e.g., title, status) and optional fields (e.g., description, due date) per functional scope.\n- Operational Security Data: verification/reset artifacts, sessions, and related metadata necessary for authentication and authorization.\n- Administrative and Audit Data: minimal event logs and administrative actions required for support, safety, fraud control, and compliance oversight.\n- Aggregated Analytics (Non‑Personal): metrics computed so that they cannot be used to re‑identify individuals.\n\nConceptual flow\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A[\"Account Creation\"] --> B[\"Email Verification\"]\n    B --> C[\"User Login\"]\n    C --> D[\"Create/Update Todo Items\"]\n    D --> E[\"Complete/Reopen/Delete Todo Items\"]\n    C --> I[\"Request Export\"]\n  end\n\n  subgraph \"System Governance\"\n    F[\"Retention Counters\"] --> G[\"Soft Delete Window\"]\n    G --> H[\"Scheduled Purge\"]\n    J[\"Prepare User Data Export\"] --> K[\"Deliver Export Package\"]\n    L[\"Audit Events\"] --> M[\"Time‑bound Retention\"]\n    N[\"Backups/Snapshots\"] --> O[\"Expiry per Policy\"]\n  end\n\n  A --> P[\"Account Profile\"]\n  D --> Q[\"Todo Dataset\"]\n  E --> Q\n  C --> R[\"Session Lifecycle\"]\n  I --> J\n  H --> S[\"Permanent Deletion\"]\n  M --> T[\"Expiry or Legal Hold\"]\n  Q -.-> U[\"Indexes/Caches(Update)\"]\n```\n\nNotes\n- \"Soft Delete Window\" is a reversible state prior to permanent deletion.\n- \"Scheduled Purge\" removes data permanently when retention conditions are met.\n- \"Backups/Snapshots\" are immutable recovery copies; access is restricted to disaster recovery scenarios and expire per policy.\n\n## 2. Data Creation, Read, Update, Completion/Reopen, and Deletion Lifecycle\n\n### 2.1 Ownership and Access\n- Users (role: user) own and control their account data and todo items.\n- Administrators (role: admin) operate under least‑privilege for support, safety, and policy enforcement. Administrative access to user data is limited to specific, auditable actions justified by a legitimate business need.\n\n### 2.2 Creation Requirements (EARS)\n- THE todoApp SHALL record the creator’s user identifier as the immutable owner of each todo item at creation time.\n- WHEN a user creates a todo item, THE todoApp SHALL store only fields defined as necessary by the functional scope and business rules.\n- IF a creation request omits a required business field, THEN THE todoApp SHALL reject the creation with a clear explanation referencing the missing or invalid field.\n- WHERE optional fields are provided at creation, THE todoApp SHALL validate them against business rules before accepting the item.\n\n### 2.3 Read and Listing Requirements (EARS)\n- THE todoApp SHALL allow a user to view only their own todo items and account data, except where an admin performs a permitted support action under audit.\n- WHEN a user lists todo items, THE todoApp SHALL return only items not permanently deleted and within the user’s ownership scope.\n- WHERE filters and sorting are requested, THE todoApp SHALL apply only supported business‑level filters and sorts as defined in the functional requirements.\n\n### 2.4 Update Requirements (EARS)\n- WHEN a user updates a todo item they own, THE todoApp SHALL validate each changed field against business rules and persist only if all validations pass.\n- IF an update conflicts with a more recent change, THEN THE todoApp SHALL prevent silent overwrites and provide guidance for conflict resolution.\n- THE todoApp SHALL record the time and actor for each successful update in an auditable manner without exposing implementation details to end users.\n\n### 2.5 Completion/Reopen Requirements (EARS)\n- WHEN a user marks an item as completed, THE todoApp SHALL set the item’s status to completed and record the completion timestamp.\n- WHEN a user reopens a completed item, THE todoApp SHALL revert the status and clear or update completion metadata as defined by business rules.\n\n### 2.6 Deletion Requirements (EARS)\n- WHEN a user deletes a todo item, THE todoApp SHALL move the item to a soft‑delete state that hides it from normal listings and starts a retention countdown.\n- WHILE a todo item is in soft‑delete, THE todoApp SHALL allow the owner to restore it within the defined retention window.\n- IF the soft‑delete retention window elapses, THEN THE todoApp SHALL permanently delete the item during the next scheduled purge.\n- WHERE an admin flags content for policy violations, THE todoApp SHALL allow immediate soft‑delete with admin justification recorded in audit data.\n\n## 3. Retention and Purging Policies\n\nRetention is purpose‑driven and time‑bound. Policy durations are business requirements and may be changed only through documented policy updates.\n\n### 3.1 Todo Items (EARS)\n- THE todoApp SHALL retain active todo items indefinitely until the owner deletes them or the account is deleted.\n- WHEN a todo item is soft‑deleted by its owner, THE todoApp SHALL retain it for up to 30 days to allow restoration.\n- IF a soft‑deleted todo item reaches 30 days without restoration, THEN THE todoApp SHALL permanently delete it during the next scheduled purge.\n\n### 3.2 Accounts and Profiles (EARS)\n- WHEN an account is created but not verified within 14 days, THE todoApp SHALL purge the unverified account and associated artifacts.\n- WHEN a verified user requests account deletion, THE todoApp SHALL initiate a 14‑day grace period before permanent deletion to allow reversal.\n- IF the grace period elapses without reversal, THEN THE todoApp SHALL permanently delete the account and all user‑owned todo items during the next scheduled purge.\n\n### 3.3 Operational Security Data (EARS)\n- THE todoApp SHALL limit the lifetime of one‑time email verification artifacts to 24 hours from issuance.\n- THE todoApp SHALL limit the lifetime of password reset artifacts to 1 hour from issuance.\n- THE todoApp SHALL limit the lifetime of user sessions according to the authentication policy defined in the roles and authentication requirements.\n\n### 3.4 Administrative and Audit Data (EARS)\n- THE todoApp SHALL retain minimal audit events necessary to reconstruct security‑ and policy‑relevant actions for 180 days unless a longer retention is mandated by documented legal obligations.\n- WHERE a legal hold is in effect, THE todoApp SHALL suspend purge of affected audit records until the hold is lifted.\n\n### 3.5 Aggregated Analytics (EARS)\n- THE todoApp SHALL keep only aggregated, non‑personal metrics that cannot feasibly be re‑identified.\n- WHERE any analytics processing would require personal data, THE todoApp SHALL either minimize and anonymize the input or forego the processing to protect user privacy.\n\n### 3.6 Purge Execution (EARS)\n- THE todoApp SHALL execute purge processes on a predictable schedule (at least daily) to remove data whose retention windows have expired.\n- IF a purge process fails partially, THEN THE todoApp SHALL retry purging the remaining eligible records without duplicating prior deletions.\n\n### 3.7 Backups and Disaster Recovery Copies (Business‑Level)\n- THE todoApp SHALL maintain immutable backup/snapshot copies only for disaster recovery and service continuity.\n- WHERE user data is deleted from active systems, THE todoApp SHALL ensure that any residual presence in immutable backups is inaccessible for normal operations and expires automatically per backup retention policy.\n- IF a disaster recovery event requires restoration from backups, THEN THE todoApp SHALL re‑apply applicable deletion and retention rules to restored data as soon as operationally feasible.\n\n## 4. User‑Controlled Export/Portability (optional)\n\n### 4.1 Scope\nUser export includes user‑owned account data and todo item content within the user’s ownership scope. Audit logs, administrative justifications, and internal security artifacts are excluded from user export unless required by applicable law.\n\n### 4.2 Export Requirements (EARS)\n- WHEN a user requests an export, THE todoApp SHALL prepare a complete, machine‑readable package of the user’s account data and todo items.\n- THE todoApp SHALL deliver the export within 24 hours of the request under normal operating conditions.\n- WHERE an export is large or complex, THE todoApp SHALL communicate progress and provide the completed package once preparation is finished.\n- THE todoApp SHALL limit export requests to once per rolling 7‑day period per user to manage capacity and abuse risk.\n- WHERE identity verification is required, THE todoApp SHALL complete appropriate verification before releasing an export package.\n\n## 5. Privacy‑by‑Design Principles\n\n### 5.1 Foundational Principles (EARS)\n- THE todoApp SHALL default to the most privacy‑preserving state for all new features and data flows (privacy by default).\n- THE todoApp SHALL enforce least privilege for all role‑based access to user data.\n- THE todoApp SHALL ensure purpose limitation by collecting and processing data only for clearly defined, legitimate purposes necessary to operate todoApp.\n- THE todoApp SHALL ensure transparency by documenting data uses and changes to policy in a user‑accessible location.\n\n### 5.2 Administrative Access Governance (EARS)\n- WHERE an admin must access user data for support or policy enforcement, THE todoApp SHALL require an explicit business justification recorded in audit data.\n- IF an admin action impacts a user’s data materially (e.g., forced deletion for policy), THEN THE todoApp SHALL record the action with actor, time, scope, and justification in audit data.\n\n### 5.3 Security Posture at Business Level (EARS)\n- THE todoApp SHALL protect personal data at rest and in transit using industry‑appropriate safeguards without prescribing specific technologies.\n- THE todoApp SHALL restrict access to personal data to authorized roles only, consistent with the defined permission model.\n\n### 5.4 Review Gates for New Data Uses (EARS)\n- WHERE a new data category or use is proposed, THE todoApp SHALL undergo a privacy review to confirm minimization, purpose limitation, and retention alignment before launch.\n- IF a proposed use cannot meet privacy principles, THEN THE todoApp SHALL block the change until a compliant approach is defined.\n\n## 6. Data Minimization and Purpose Limitation\n\n### 6.1 Data Collection Boundaries (EARS)\n- THE todoApp SHALL collect only the minimum personal data required to operate user accounts and manage todo items (e.g., contact identifier and authentication secrets).\n- WHERE optional data is provided by the user (e.g., description, due date), THE todoApp SHALL use it solely to enhance the todo management experience.\n- THE todoApp SHALL avoid collecting special categories of personal data; if such data is inadvertently submitted in free‑text fields, THE todoApp SHALL treat it with heightened protection and refrain from using it for profiling or analytics.\n\n### 6.2 Data Use Boundaries (EARS)\n- THE todoApp SHALL not sell personal data or share it with third parties for independent marketing purposes.\n- WHERE service providers are engaged to operate core functionality, THE todoApp SHALL ensure they process data only on behalf of todoApp for permitted purposes.\n\n### 6.3 Storage Boundaries (EARS)\n- THE todoApp SHALL not store personal data beyond the retention periods defined in this document unless required by legal obligations documented by policy.\n\n## 7. Right to Erasure and Account Deletion Behaviors\n\n### 7.1 Conceptual Deletion Flow\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"User Requests Account Deletion\"] --> B[\"Start 14‑day Grace Period\"]\n    B --> C{\"Login During Grace?\"}\n  end\n\n  subgraph \"System Outcomes\"\n    D[\"Cancel Deletion and Restore Access\"]\n    E[\"Maintain Grace and Restricted Access\"]\n    F[\"Permanent Deletion at Purge\"]\n  end\n\n  C -->|\"Yes\"| D\n  C -->|\"No\"| E\n  E --> G{\"Grace Expired?\"}\n  G -->|\"Yes\"| F\n  G -->|\"No\"| E\n```\n\n### 7.2 Erasure Requirements (EARS)\n- WHEN a verified user requests account deletion, THE todoApp SHALL initiate a 14‑day grace period and notify the user of the effective deletion date.\n- WHILE an account is in the grace period, THE todoApp SHALL restrict access to read‑only export and deletion cancellation; normal write operations SHALL be blocked.\n- IF the user logs in and cancels during the grace period, THEN THE todoApp SHALL restore full access and stop the deletion process immediately.\n- IF the grace period ends without cancellation, THEN THE todoApp SHALL permanently delete the account, user‑owned todo items, and user‑specific preferences during the next scheduled purge.\n- WHERE deletion would impact records under legal hold or unresolved disputes, THE todoApp SHALL defer deletion of those specific records while completing deletion of all other user data.\n\n### 7.3 Exceptions and Residual Data (EARS)\n- THE todoApp SHALL preserve non‑identifying, aggregated analytics after account deletion, provided such aggregates cannot be used to re‑identify the user.\n- WHERE audit records must be retained for security or compliance, THE todoApp SHALL retain only the minimum necessary audit data for the mandated period, decoupled from content details where feasible.\n- WHERE immutable backups exist, THE todoApp SHALL allow residual traces to expire per backup policy and SHALL not restore deleted user data for ordinary requests.\n\n## 8. Additional Lifecycle Topics\n\n### 8.1 Data Lineage and Auditability (EARS)\n- THE todoApp SHALL maintain auditable records for materially significant events: account lifecycle, session lifecycle, item creation/update/deletion, admin access with justification, export requests and deliveries, purge executions, and legal hold changes.\n- WHERE feasible, THE todoApp SHALL include actor, timestamp (UTC), target scope, and outcome in audit entries while avoiding sensitive content.\n- IF an audit entry would expose secrets or personal content, THEN THE todoApp SHALL store categorical labels instead of raw content.\n\n### 8.2 Caching and Indexing Propagation (EARS)\n- WHEN todo items change state (create/update/complete/reopen/delete), THE todoApp SHALL propagate visibility changes to derived representations (e.g., caches, indexes) within a user‑perceived short interval aligned with non‑functional targets.\n- IF an index or cache temporarily presents stale results, THEN THE todoApp SHALL converge to the correct state within the non‑functional consistency window and avoid re‑exposing permanently deleted content.\n\n### 8.3 Non‑Production/Test Data Controls (EARS)\n- THE todoApp SHALL prohibit the use of live personal data in non‑production environments unless de‑identified to a level that prevents re‑identification.\n- WHERE test data is needed, THE todoApp SHALL use synthetic or de‑identified datasets and SHALL destroy them when no longer needed.\n\n### 8.4 Third‑Party Processors and Data Transfers (EARS)\n- WHERE subprocessors are used to provide core capabilities (e.g., email delivery), THE todoApp SHALL ensure they act as processors on behalf of todoApp and process only for permitted purposes.\n- WHERE cross‑border transfer is required to operate the service, THE todoApp SHALL disclose the general regions involved and ensure transfers occur under appropriate safeguards consistent with applicable policy.\n\n### 8.5 Consent and Preference Management (EARS)\n- WHERE optional communications or features require consent, THE todoApp SHALL capture, honor, and allow revocation of consent without degrading core functionality.\n- IF a user revokes consent, THEN THE todoApp SHALL cease the associated processing promptly and update preference records accordingly.\n\n### 8.6 Data Subject Requests Beyond Deletion (EARS)\n- WHEN a verified user requests access to their personal data, THE todoApp SHALL provide a summary of user‑owned data and profile attributes in a human‑readable and machine‑readable form within a reasonable timeframe communicated to the user (target within 30 days unless policy dictates faster timelines).\n- WHEN a verified user requests rectification of inaccurate personal data they control (e.g., display name), THE todoApp SHALL allow correction and reflect changes in derived views and caches within the non‑functional consistency window.\n- WHERE a request is manifestly unfounded or excessive under applicable policy, THE todoApp SHALL provide a business‑level explanation and may decline the request consistent with policy.\n\n### 8.7 Data Breach Response Expectations (Business‑Level)\n- WHEN a data incident is suspected to have impacted personal data, THE todoApp SHALL initiate incident response procedures, assess scope and impact, and provide user‑facing communication consistent with applicable policy and timelines.\n- WHERE notification is required, THE todoApp SHALL communicate in clear, user‑centric language describing what happened, what data may be involved, protective steps users can take, and how todoApp is addressing the issue.\n\n## 9. Traceability to Business Rules and Non‑Functional Requirements\n\n- Refer to the [Business Rules and Validation Guide](./06-todoApp-business-rules.md) for field‑level validations, ownership, trash/restore rules, rate limits, and time‑zone handling that complement lifecycle behaviors.\n- Refer to the [Non‑Functional Requirements and Service Expectations](./08-todoApp-non-functional-requirements.md) for performance, availability, security, and operational monitoring expectations that constrain lifecycle operations.\n\nTraceability highlights\n- Creation, update, and deletion validations: Business Rules → Todo Item Validation Rules and Ownership.\n- Export responsiveness and delivery window: Non‑Functional → Performance targets for asynchronous operations.\n- Audit and monitoring expectations: Non‑Functional → Operational Monitoring and Alerting.\n\n## 10. Business‑Level Acceptance and Monitoring Criteria (EARS)\n\n- THE todoApp SHALL complete visible create, update, and delete operations on user data within 2 seconds under normal operating conditions.\n- THE todoApp SHALL execute daily purge cycles that remove all data past retention within 24 hours of eligibility.\n- WHEN a user requests export, THE todoApp SHALL provide the export within 24 hours under normal operating conditions.\n- WHEN a user initiates account deletion, THE todoApp SHALL enforce the 14‑day grace period and execute permanent deletion at the next scheduled purge thereafter.\n- WHERE legal hold or compliance exceptions apply, THE todoApp SHALL document the scope and duration and prevent deletion of the held records until the hold is removed.\n- WHERE backups contain residual copies, THE todoApp SHALL ensure they are inaccessible for ordinary operations and expire automatically per policy.\n- WHEN a user requests access or rectification, THE todoApp SHALL fulfill the request within a reasonable timeframe communicated to the user (target within 30 days unless policy dictates otherwise).\n\n## 11. Error and Recovery Expectations Across the Lifecycle (EARS)\n\n- IF a user attempts to restore a todo item after the retention window has expired, THEN THE todoApp SHALL inform the user that restoration is no longer possible and the item has been permanently deleted.\n- IF an export preparation exceeds the standard 24‑hour window due to exceptional load, THEN THE todoApp SHALL notify the user of delay and deliver the export as soon as preparation completes.\n- IF a purge process encounters inconsistencies, THEN THE todoApp SHALL isolate affected records, log the issue for investigation, and continue purging unaffected eligible records.\n- IF an admin‑initiated action is missing a documented justification, THEN THE todoApp SHALL block the action and request a valid justification entry.\n- IF derived indexes or caches temporarily lag after deletion, THEN THE todoApp SHALL prevent re‑exposure of deleted content and converge to the correct state within the non‑functional consistency window.\n\n## 12. Data Categorization (Business‑Level)\n\n| Category | Examples | Owner | Primary Uses | Retention (Business Policy) | Purge Path |\n|---|---|---|---|---|---|\n| User Account Data | Email, display name, locale/time zone, verification status | User | Authentication, personalization | Unverified: 14 days; Verified: until deletion request + 14‑day grace | Account deletion purge |\n| Todo Item Data | Title, description, due date, status, timestamps | User | Personal task management | Active: indefinite; Soft‑deleted: 30 days | Soft‑delete → scheduled purge |\n| Operational Security Data | Verification tokens, reset tokens, session metadata | System | Authentication and recovery | Verification: 24h; Reset: 1h; Sessions: per auth policy | Expire on schedule |\n| Administrative and Audit Data | Admin actions, access justifications, security‑relevant events | System | Accountability, safety, compliance | 180 days or per legal hold | Scheduled purge or hold release |\n| Aggregated Analytics | De‑identified usage metrics | System | Service improvement | As needed, non‑reidentifiable | Not applicable (non‑personal) |\n| Backups/Snapshots | Immutable copies for DR only | System | Disaster recovery | Per backup policy (time‑bound) | Automatic expiry; re‑apply deletions post‑restore |\n\n## 13. Additional Visuals\n\n### 13.1 Todo Item Soft‑Delete Lifecycle\n```mermaid\ngraph LR\n  A[\"Active Item\"] --> B[\"User Deletes(Item→Soft‑Delete)\"]\n  B --> C{\"Within 30 Days?\"}\n  C -->|\"Yes\"| D[\"User Restores(Item→Active)\"]\n  C -->|\"No\"| E[\"Scheduled Purge(Permanent Deletion)\"]\n```\n\n### 13.2 Export Request Flow (Business‑Level)\n```mermaid\ngraph LR\n  A[\"User Requests Export\"] --> B[\"Verify Identity\"]\n  B --> C{\"Verified?\"}\n  C -->|\"Yes\"| D[\"Prepare Package(Machine‑Readable)\"]\n  C -->|\"No\"| E[\"Request Verification\"]\n  D --> F{\"Large/Complex?\"}\n  F -->|\"Yes\"| G[\"Communicate Progress\"]\n  F -->|\"No\"| H[\"Deliver Export\"]\n  G --> H\n```\n\n## 14. Glossary (Business‑Level)\n\n- Aggregated Analytics: Non‑personal statistical measures that cannot be traced back to an identifiable individual.\n- Audit Event: A recorded business event capturing actor, time, scope, and outcome without sensitive content.\n- Grace Period: A bounded time during which a user may reverse a pending account deletion.\n- Legal Hold: A suspension of purge and deletion for specific records due to legal or compliance obligations.\n- Personal Data: Any information relating to an identified or identifiable natural person within todoApp’s scope (e.g., email, user‑generated todo content).\n- Pseudonymization: Processing data in a manner that it can no longer be attributed to a specific user without additional information kept separately.\n- Soft Delete: A reversible state in which data is hidden from normal operations and scheduled for purge after a retention window.\n- Permanent Deletion (Hard Delete): Irreversible removal of data from active systems following retention rules.\n- Subprocessor: A service provider engaged to process personal data on behalf of todoApp for permitted purposes.\n\n---\n\nBusiness requirements only; developers have full autonomy to determine the technical architecture, interfaces, storage strategies, and operational mechanisms necessary to satisfy these requirements while adhering to organizational standards and applicable laws.","tokenUsage":{"total":74385,"input":{"total":66066,"cached":0},"output":{"total":8319,"reasoning":2560,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":4,"step":0,"created_at":"2025-08-15T04:00:38.863Z"},"tokenUsage":{"aggregate":{"total":554471,"input":{"total":452548,"cached":11648},"output":{"total":101923,"reasoning":38592,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":551687,"input":{"total":450211,"cached":11648},"output":{"total":101476,"reasoning":38208,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Describe who uses the system and the primary/secondary scenarios to guide requirement prioritization and testing.","filename":"04-todoApp-user-stories-and-personas.md","documentType":"user-story","outline":["Personas","Primary Scenarios (Happy Paths)","Secondary Scenarios and Edge Cases","Role-based Scenarios (user, admin)","Acceptance Tests in Natural Language (EARS where applicable)","Success Indicators per Scenario"],"audience":"product managers","keyQuestions":["Who are the typical users of this service?","What scenarios are most critical to support?","What edge cases must be considered for MVP?"],"detailLevel":"moderate detail","relatedDocuments":["03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["Avoid UI/UX design details and screen layouts","Use natural language and business logic only","Write acceptance tests in EARS where possible"],"content":"# todoApp User Stories and Personas\n\n## Personas\n\n### Persona 1: Focused Professional (User)\n- Profile: Employed knowledge worker balancing multiple projects and deadlines.\n- Goals: Capture tasks quickly, prioritize by urgency, complete tasks on schedule, review what’s done.\n- Motivations: Reduce mental load, maintain reliability, demonstrate progress.\n- Pain Points: Task sprawl across tools, forgetting deadlines, difficulty filtering by status.\n- Environment: Desktop during work hours; mobile on the go. Intermittent connectivity possible.\n- Success Measures: Can capture a task in under 10 seconds; can find any task within 5 seconds via filtering or search-like mechanisms; misses no critical due date over a week.\n\n### Persona 2: Organized Student (User)\n- Profile: University student juggling classes, assignments, and part-time work.\n- Goals: Track assignments by due dates, mark completed work, reopen items when requirements change.\n- Motivations: Stay ahead of deadlines, visualize workload by due date, avoid penalties.\n- Pain Points: Overdue tracking confusion, accidental deletions, unclear item states.\n- Environment: Mobile-first; occasional desktop sessions in labs or dorm.\n- Success Measures: Keeps assignment list current daily; can see upcoming items due this week within 2 seconds; can undo a completion or correct a mistake without data loss.\n\n### Persona 3: Casual Planner (User)\n- Profile: Non-technical individual using the app occasionally for personal reminders.\n- Goals: Add simple reminders, check off completed items, clear clutter periodically.\n- Motivations: Minimal friction, clarity of state (open vs completed), confidence items aren’t lost.\n- Pain Points: Complexity overload, needlessly required fields, confusing error messages.\n- Environment: Mobile with variable connectivity.\n- Success Measures: Zero confusion about item state; never blocked by optional fields; can delete or archive clutter quickly.\n\n### Persona 4: Support Administrator (Admin)\n- Profile: Service operator ensuring policy compliance and user support.\n- Goals: Assist users with account issues, enforce content and safety policies, monitor basic health indicators at a business level.\n- Motivations: Maintain trust and safety, minimize support burden, resolve issues quickly.\n- Pain Points: Ambiguity around user permissions, incomplete audit trails, difficulty revoking sessions when necessary.\n- Environment: Desktop in secure environment.\n- Success Measures: Can locate a user account within seconds; can revoke sessions and suspend/restore accounts swiftly with clear outcomes; minimal escalations.\n\n## Primary Scenarios (Happy Paths)\n\n### Scenario A: First-Time Registration and Email Verification (User)\n- Objective: Enable a new user to register and verify ownership of email to start using todoApp.\n- Steps (business flow):\n  1. User provides required registration information (email and password).\n  2. System records a new account in unverified state and initiates email verification.\n  3. User opens the verification link within its validity window.\n  4. System transitions account to verified state; user can sign in and use features.\n- Success Criteria: Account verified within minutes; user can sign in immediately after verification.\n\n### Scenario B: Create a New Todo (User)\n- Objective: Allow rapid creation of a minimal todo with optional enrichment.\n- Steps (business flow):\n  1. User initiates creation and supplies a title (mandatory), may add description and due date (optional).\n  2. System validates inputs and saves the item as \"open\".\n  3. System associates the item with the creator’s account and sets timestamps.\n- Success Criteria: Item appears in the user’s list immediately; optional fields remain optional without blocking.\n\n### Scenario C: Review and Filter Todos (User)\n- Objective: View own items and limit the list by status and due date expectations.\n- Steps (business flow):\n  1. User requests their todo list.\n  2. System returns items owned by the user, with default ordering (most recently updated first) and business-level filtering controls (e.g., open vs completed).\n  3. User applies filters (e.g., show open only, or items due within next 7 days).\n- Success Criteria: User finds the intended item within 5 seconds; list reflects filter choices consistently.\n\n### Scenario D: Complete and Reopen a Todo (User)\n- Objective: Mark work done, with ability to reverse if needed.\n- Steps (business flow):\n  1. User marks an open item as completed.\n  2. System records completion timestamp and sets state to \"completed\".\n  3. If the user later reopens the item, system removes the completion timestamp and returns state to \"open\".\n- Success Criteria: State changes are instant; history is consistent.\n\n### Scenario E: Edit a Todo (User)\n- Objective: Adjust details without causing confusion or loss.\n- Steps (business flow):\n  1. User updates title and/or optional fields.\n  2. System validates edits, saves changes, updates last-updated timestamp.\n- Success Criteria: Edits are reflected immediately and persist across sessions.\n\n### Scenario F: Delete a Todo (User)\n- Objective: Remove clutter intentionally and safely.\n- Steps (business flow):\n  1. User requests deletion of one of their items.\n  2. System validates ownership and removes the item from the active list.\n- Success Criteria: Item no longer appears in active lists; user cannot access deleted item through normal navigation.\n\n### Scenario G: Administrative Session Revocation (Admin)\n- Objective: End a user’s active sessions for safety or policy reasons.\n- Steps (business flow):\n  1. Admin identifies the relevant user account.\n  2. Admin initiates revoke-all-sessions for that user.\n  3. System invalidates active user sessions.\n- Success Criteria: User’s devices require re-authentication; action is auditable.\n\n```mermaid\ngraph LR\n  A[\"User Starts\"] --> B[\"Register Account\"]\n  B --> C[\"Email Verification Sent\"]\n  C --> D{\"Verification Link Opened?\"}\n  D -->|\"Yes\"| E[\"Account Verified\"]\n  D -->|\"No\"| F[\"Reminder/Resend Option\"]\n  E --> G[\"Create First Todo\"]\n  G --> H[\"Review & Filter List\"]\n  H --> I[\"Complete Item\"]\n  I --> J{\"Need To Reopen?\"}\n  J -->|\"Yes\"| K[\"Reopen Item\"]\n  J -->|\"No\"| L[\"Continue Working\"]\n```\n\n## Secondary Scenarios and Edge Cases\n\n- Duplicate Titles:\n  - Business Rule: Titles need not be unique; disambiguation is by creation time and context.\n- Due Dates in the Past:\n  - Business Rule: Acceptable, as users may record historical tasks; system should clearly reflect overdue status.\n- Optional Fields:\n  - Business Rule: Description and due date are optional at all times; absence must not block creation or editing of other fields.\n- Time Zone Handling:\n  - Business Rule: Due date interpretation is based on the user’s current local time setting; changes in time zone should not cause silent shifts of the intended calendar day.\n- Large Lists and Navigation:\n  - Business Expectation: Users can access and review their task list without undue delay; ordering defaults to last updated first; mechanisms to focus on open or upcoming tasks must be available.\n- Concurrent Edits (same item, multiple sessions/devices):\n  - Business Rule: The system must prevent silent overwrites; users must receive clear guidance to retry, merge, or refresh when conflicts occur.\n- Session Expiration During Use:\n  - Business Rule: Saved items remain unaffected; unsaved input that was not persisted is out of scope for guarantee in MVP.\n- Account Deletion:\n  - Business Rule: Deleting an account removes access to associated items according to data lifecycle rules; users must confirm intention before irreversible actions.\n- Rate Limiting and Abuse Prevention:\n  - Business Rule: The system may throttle excessively frequent operations for stability and fairness while clearly communicating limits to users.\n- Accessibility and Clarity:\n  - Business Rule: System messages and labels use unambiguous, plain language describing item state and required actions.\n\n## Role-based Scenarios (user, admin)\n\n### User Role: Owned-Data Operations\n- Create Todo: User creates items with required title and optional fields; items belong exclusively to the creator.\n- Read Own Todos: User views only their items; no leakage of other users’ data.\n- Update Own Todos: User edits only their items; state transitions are controlled (open ⇄ completed).\n- Delete Own Todos: User removes only their items.\n- Account Management: User can verify email, sign in/out, change password, and revoke own sessions.\n\n### Admin Role: Support and Policy Enforcement\n- View User Profile (Business-Level): Admin locates a user account and reviews business-level details needed for support.\n- Revoke User Sessions: Admin ends all of a user’s sessions when safety or policy requires.\n- Suspend/Restore Account: Admin changes account state to restrict or restore access when warranted.\n- Access Aggregated Health Indicators: Admin reviews aggregate-level indicators (e.g., volume trends) without exposing personal content beyond what is necessary for support.\n\n## Acceptance Tests in Natural Language (EARS where applicable)\n\n### Registration and Verification\n- WHEN a new user submits valid registration information, THE system SHALL create an unverified account and send a verification instruction within 1 minute.\n- IF a user opens a valid verification link within its validity window, THEN THE system SHALL mark the account as verified immediately.\n- IF a user attempts to sign in before verifying, THEN THE system SHALL prevent access to todo features and direct the user to verify.\n\n### Create Todo\n- WHEN a verified user provides a title and submits a new todo, THE system SHALL create the item as \"open\" and associate it with that user within 2 seconds.\n- IF the user omits description and due date, THEN THE system SHALL still create the item without error.\n- IF the title length exceeds the business-defined limit, THEN THE system SHALL reject the creation with a clear message referencing the limit.\n\n### Review and Filter\n- WHEN a user requests their todo list, THE system SHALL return only items owned by that user ordered by last updated, newest first.\n- WHERE a user applies a filter to show only \"open\" items, THE system SHALL display only items with state \"open\" consistently across navigation within the same session.\n\n### Complete and Reopen\n- WHEN a user marks an open item as completed, THE system SHALL set the item state to \"completed\" and record a completion timestamp.\n- IF a user reopens a completed item, THEN THE system SHALL remove the completion timestamp and set state to \"open\".\n\n### Edit Todo\n- WHEN a user updates the title of their own item to a valid value, THE system SHALL save the change and update the last-updated timestamp.\n- IF a user attempts to edit another user’s item, THEN THE system SHALL deny the action and inform the user they lack permission.\n\n### Delete Todo\n- WHEN a user requests deletion of their own item, THE system SHALL remove the item from active views.\n- IF a user attempts to delete an item they do not own, THEN THE system SHALL deny the action and provide a clear permission error message.\n\n### Time Zone and Due Dates\n- WHILE the user’s time zone setting differs from the time zone at item creation, THE system SHALL preserve the intended due calendar date when displaying the item.\n- IF a due date is set in the past, THEN THE system SHALL mark the item as overdue without blocking save operations.\n\n### Concurrency and Conflicts\n- IF two sessions attempt to update the same item concurrently, THEN THE system SHALL prevent silent overwrite and instruct the user to refresh or reconcile.\n\n### Administrative Controls\n- WHEN an admin executes revoke-all-sessions for a user, THE system SHALL end the user’s active sessions so that the next action requires re-authentication.\n- WHEN an admin suspends a user account, THE system SHALL block access to todo features for that account until restored.\n\n## Success Indicators per Scenario\n\n| Scenario | Primary KPI | Target for MVP | Measurement Method |\n|---------|-------------|----------------|--------------------|\n| Registration & Verification | Verification completion rate within 24 hours | ≥ 80% | Ratio of verified/registered within 24h |\n| Create Todo | Median time from intent to saved item | ≤ 10 seconds | Time from create action start to item persistence |\n| Review & Filter | Time-to-find (specific item) | ≤ 5 seconds | Time from list request to visibility of targeted item via filters |\n| Complete/Reopen | State change latency | ≤ 2 seconds | Time from user action to list reflecting new state |\n| Edit Todo | Edit persistence success rate | ≥ 99% | Successful saves / attempts |\n| Delete Todo | Erroneous deletions rate | ≤ 0.1% | Confirmed mistaken deletions / deletions |\n| Admin Session Revocation | Time to invalidate sessions | ≤ 1 minute | Time from revocation to enforced re-authentication |\n\n## References to Related Documents\n- See the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for field validations, ownership rules, and acceptance criteria.\n- Review the [User Flows for todoApp](./05-todoApp-user-flows.md) for visual flow details complementing these scenarios.\n- Consult the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md) for recovery paths and user-facing guidance.\n\n## Scope Clarification\nThis document describes business requirements, personas, and scenarios for todoApp. It focuses on what the system must do from a user and business perspective and does not prescribe technical implementation. All architecture, API design, and database decisions are at the discretion of the development team."},"plan":"Document plan and structure for 04-todoApp-user-stories-and-personas.md:\n- Title: todoApp User Stories and Personas\n- Sections:\n  1) Personas (profiles, goals, motivations, pain points, environments, success measures)\n  2) User Stories per Persona (As a..., I want..., so that... with acceptance intent)\n  3) Primary Scenarios (Happy Paths) with objective, business flow steps, measurable success criteria, and 1 Mermaid overview diagram\n  4) Secondary Scenarios and Edge Cases (business rules/expectations)\n  5) Role-based Scenarios (user, admin) in business terms\n  6) Acceptance Tests in Natural Language (EARS where applicable) with measurable criteria\n  7) Success Indicators per Scenario (table of KPIs and targets)\n  8) References to Related Documents (descriptive links, relative paths)\n  9) Scope Clarification (business requirements only; developers have autonomy)\n- Tone: formal, professional en‑US; oriented to product managers and development team\n- Constraints: avoid technical implementation details; use EARS wherever applicable; ensure Mermaid compliance; align with roles and MVP scope\n","review":"Enhancement criteria and guidelines:\n- Minimum length: 2,000+ characters (expand for completeness); cover all outline sections fully\n- Use EARS format for all applicable requirements; keywords WHEN/WHILE/IF/THEN/WHERE/THE/SHALL in English; descriptions in en-US\n- Focus on business requirements and user scenarios; no API specs, database schemas, technical architecture, or UI layout details\n- Define user roles and permissions in business terms; ensure role-based scenarios (user, admin) are covered\n- Include measurable success criteria (latency in seconds, rates, counts) where appropriate\n- Mermaid rules: all labels in double quotes; no spaces between brackets/braces and quotes; correct arrow syntax (--> ; -.-> ; ==>); edge labels in double quotes; avoid nested quotes; prefer graph LR; subgraph titles in double quotes if used\n- Link rules: use descriptive link texts in en-US with relative paths only to existing documents\n- Content specificity: actionable, testable language; avoid vague statements\n- Include error handling and edge cases from user perspective\n- Prohibit database schemas, API endpoints, and technical implementation details; authentication/auth flows mentioned only in business terms\n- Ensure consistency with related documents and roles (user, admin); keep scope aligned with MVP functional requirements\n- Reject UI/UX design details; write natural language processes and validations\n- The output is the enhanced document itself (complete markdown), not a review\n","content":"# todoApp User Stories and Personas\n\n## Personas\n\n### Persona 1: Focused Professional (User)\n- Profile: Employed knowledge worker balancing multiple projects and deadlines.\n- Goals: Capture tasks quickly, prioritize by urgency, complete tasks on schedule, review what’s done.\n- Motivations: Reduce mental load, maintain reliability, demonstrate progress.\n- Pain Points: Task sprawl across tools, forgetting deadlines, difficulty filtering by status.\n- Environment: Desktop during work hours; mobile on the go. Intermittent connectivity possible.\n- Success Measures: Can capture a task in under 10 seconds; can find any task within 5 seconds via filtering or search-like mechanisms; misses no critical due date over a week.\n\n### Persona 2: Organized Student (User)\n- Profile: University student juggling classes, assignments, and part-time work.\n- Goals: Track assignments by due dates, mark completed work, reopen items when requirements change.\n- Motivations: Stay ahead of deadlines, visualize workload by due date, avoid penalties.\n- Pain Points: Overdue tracking confusion, accidental deletions, unclear item states.\n- Environment: Mobile-first; occasional desktop sessions in labs or dorm.\n- Success Measures: Keeps assignment list current daily; can see upcoming items due this week within 2 seconds; can undo a completion or correct a mistake without data loss.\n\n### Persona 3: Casual Planner (User)\n- Profile: Non-technical individual using the app occasionally for personal reminders.\n- Goals: Add simple reminders, check off completed items, clear clutter periodically.\n- Motivations: Minimal friction, clarity of state (open vs completed), confidence items aren’t lost.\n- Pain Points: Complexity overload, needlessly required fields, confusing error messages.\n- Environment: Mobile with variable connectivity.\n- Success Measures: Zero confusion about item state; never blocked by optional fields; can delete or archive clutter quickly.\n\n### Persona 4: Support Administrator (Admin)\n- Profile: Service operator ensuring policy compliance and user support.\n- Goals: Assist users with account issues, enforce content and safety policies, monitor basic health indicators at a business level.\n- Motivations: Maintain trust and safety, minimize support burden, resolve issues quickly.\n- Pain Points: Ambiguity around user permissions, incomplete audit trails, difficulty revoking sessions when necessary.\n- Environment: Desktop in secure environment.\n- Success Measures: Can locate a user account within seconds; can revoke sessions and suspend/restore accounts swiftly with clear outcomes; minimal escalations.\n\n## User Stories per Persona\n\n### Focused Professional\n- As a focused professional, I want to capture a new task with only a title so that I can record intent without friction.\n- As a focused professional, I want to filter my list by status and due window so that I can focus on what is actionable today.\n- As a focused professional, I want to complete and later reopen a task so that I can correct mistakes without losing history.\n- As a focused professional, I want to find a specific task quickly so that I can resume work within seconds.\n\nAcceptance intent (business expectations):\n- WHEN a title-only todo is submitted, THE system SHALL create it within 2 seconds and show it in the list.\n- WHEN filters for status and due window are applied, THE system SHALL display only matching items consistently within the session.\n- WHEN a completed task is reopened, THE system SHALL revert the state and remove completion timestamp immediately.\n- WHEN a search-like filter is used, THE system SHALL locate a target item within 5 seconds as perceived by the user.\n\n### Organized Student\n- As an organized student, I want to add a due date to assignments so that I can plan ahead.\n- As an organized student, I want to see items due this week so that I can balance workload.\n- As an organized student, I want to undo a completion so that I can reflect changing requirements.\n- As an organized student, I want to avoid losing data on accidental edits or deletions so that I maintain confidence in the system.\n\nAcceptance intent (business expectations):\n- WHEN a due date is added, THE system SHALL display the due date according to the user’s time zone.\n- WHEN a “this week” filter is set, THE system SHALL return items due within the current week.\n- WHEN a completion is undone, THE system SHALL restore state to open and clear the completion timestamp.\n- IF a deletion or edit is attempted on another user’s item, THEN THE system SHALL deny and provide a permission message.\n\n### Casual Planner\n- As a casual planner, I want minimal required fields so that adding reminders is effortless.\n- As a casual planner, I want clear status labels so that I always know whether an item is open or completed.\n- As a casual planner, I want to remove clutter quickly so that my list stays manageable.\n\nAcceptance intent (business expectations):\n- WHEN only a title is given, THE system SHALL accept it and create the item without requiring optional fields.\n- WHEN I mark an item complete, THE system SHALL indicate completion immediately and allow easy reversal.\n- WHEN I delete an item, THE system SHALL remove it from active lists right away.\n\n### Support Administrator\n- As a support administrator, I want to revoke a user’s sessions so that security incidents can be mitigated quickly.\n- As a support administrator, I want to suspend and restore accounts so that policy compliance is enforced.\n- As a support administrator, I want visibility into account-level activity so that I can resolve support requests efficiently.\n\nAcceptance intent (business expectations):\n- WHEN revoke-all-sessions is executed for a user, THE system SHALL require re-authentication on that user’s devices within 1 minute.\n- WHEN an account suspension is applied, THE system SHALL block protected actions until restored.\n- WHEN administrative actions occur, THE system SHALL record them for audit.\n\n## Primary Scenarios (Happy Paths)\n\n### Scenario A: First-Time Registration and Email Verification (User)\n- Objective: Enable a new user to register and verify ownership of email to start using todoApp.\n- Steps (business flow):\n  1. User provides required registration information (email and password).\n  2. System records a new account in unverified state and initiates email verification.\n  3. User opens the verification link within its validity window.\n  4. System transitions account to verified state; user can sign in and use features.\n- Success Criteria: Verification instruction dispatched within 1 minute; account verified within minutes; user can sign in immediately after verification.\n\n### Scenario B: Create a New Todo (User)\n- Objective: Allow rapid creation of a minimal todo with optional enrichment.\n- Steps (business flow):\n  1. User initiates creation and supplies a title (mandatory), may add description and due date (optional).\n  2. System validates inputs and saves the item as \"open\".\n  3. System associates the item with the creator’s account and sets timestamps.\n- Success Criteria: Item appears in the user’s list immediately; optional fields remain optional without blocking.\n\n### Scenario C: Review and Filter Todos (User)\n- Objective: View own items and limit the list by status and due date expectations.\n- Steps (business flow):\n  1. User requests their todo list.\n  2. System returns items owned by the user with default ordering and business-level filtering controls (e.g., open vs completed).\n  3. User applies filters (e.g., show open only, or items due within next 7 days).\n- Success Criteria: User finds the intended item within 5 seconds; list reflects filter choices consistently.\n\n### Scenario D: Complete and Reopen a Todo (User)\n- Objective: Mark work done, with ability to reverse if needed.\n- Steps (business flow):\n  1. User marks an open item as completed.\n  2. System records completion timestamp and sets state to \"completed\".\n  3. If reopened, system removes the completion timestamp and returns state to \"open\".\n- Success Criteria: State changes are instant; history is consistent.\n\n### Scenario E: Edit a Todo (User)\n- Objective: Adjust details without causing confusion or loss.\n- Steps (business flow):\n  1. User updates title and/or optional fields.\n  2. System validates edits, saves changes, updates last-updated timestamp.\n- Success Criteria: Edits reflect immediately and persist across sessions.\n\n### Scenario F: Delete a Todo (User)\n- Objective: Remove clutter intentionally and safely.\n- Steps (business flow):\n  1. User requests deletion of one of their items.\n  2. System validates ownership and removes the item from active lists.\n- Success Criteria: Item no longer appears in active lists; user cannot access deleted item through normal navigation.\n\n### Scenario G: Administrative Session Revocation (Admin)\n- Objective: End a user’s active sessions for safety or policy reasons.\n- Steps (business flow):\n  1. Admin identifies the relevant user account.\n  2. Admin initiates revoke-all-sessions for that user.\n  3. System invalidates active user sessions.\n- Success Criteria: User’s devices require re-authentication; action is auditable.\n\n### Scenario H: Bulk Complete and Reopen (User)\n- Objective: Update the state of multiple items efficiently.\n- Steps (business flow):\n  1. User selects up to 50 items.\n  2. User triggers bulk complete or bulk reopen.\n  3. System applies state changes to all selected items that are eligible.\n- Success Criteria: Bulk operation completes within 2 seconds perceived by the user for up to 50 items; partial ineligibility is reported with clear guidance.\n\n### Scenario I: Export My Data (User)\n- Objective: Obtain a portable copy of owned todos.\n- Steps (business flow):\n  1. User requests export of own data.\n  2. System prepares a complete package of the user’s items and attributes.\n  3. System notifies the user when the export is ready.\n- Success Criteria: Export includes all owned items and attributes; delivery within a reasonable window as defined in requirements.\n\n### Scenario J: Change Time Zone Preference (User)\n- Objective: Ensure dates and times reflect local expectations after a time zone change.\n- Steps (business flow):\n  1. User changes profile time zone.\n  2. System reinterprets and displays due dates and timestamps in the new time zone.\n- Success Criteria: Intended due calendar dates remain unchanged; timestamps display consistently in the new time zone.\n\n```mermaid\ngraph LR\n  A[\"User Starts\"] --> B[\"Register Account\"]\n  B --> C[\"Email Verification Sent\"]\n  C --> D{\"Verification Link Opened?\"}\n  D -->|\"Yes\"| E[\"Account Verified\"]\n  D -->|\"No\"| F[\"Reminder/Resend Option\"]\n  E --> G[\"Create First Todo\"]\n  G --> H[\"Review & Filter List\"]\n  H --> I[\"Complete Item\"]\n  I --> J{\"Need To Reopen?\"}\n  J -->|\"Yes\"| K[\"Reopen Item\"]\n  J -->|\"No\"| L[\"Continue Working\"]\n```\n\nAdditional lifecycle overview:\n\n```mermaid\ngraph LR\n  U1[\"Start Authenticated Session\"] --> T1[\"Create Todo\"]\n  T1 --> T2[\"Edit Todo\"]\n  T2 --> T3[\"Complete Todo\"]\n  T3 --> Q1{\"Reopen Needed?\"}\n  Q1 -->|\"Yes\"| T5[\"Reopen Todo\"]\n  Q1 -->|\"No\"| T6[\"Proceed\"]\n  T5 --> T2\n  T3 --> T7[\"Delete Todo\"]\n  T7 --> T8[\"Removed from Active Views\"]\n```\n\n## Secondary Scenarios and Edge Cases\n\n- Duplicate Titles:\n  - Business Rule: Titles need not be unique; disambiguation is by context and timestamps.\n- Title Whitespace and Length:\n  - Business Rule: Leading/trailing whitespace is ignored; trimmed length must be within allowed bounds.\n- Description Length and Multi-line Text:\n  - Business Rule: Long descriptions up to the allowed limit are accepted; line breaks are preserved; executable content is not permitted.\n- Due Dates in the Past:\n  - Business Rule: Acceptable for historical capture; system reflects overdue status without blocking.\n- Daylight Saving Time (DST) and Leap Days:\n  - Business Rule: Non-existent times adjust to the next valid time; invalid calendar dates are rejected; due dates represent end-of-day obligations for date-only entries.\n- Time Zone Handling:\n  - Business Rule: Due date interpretation follows the user’s current time zone; changing time zone re-renders dates without altering intended calendar days.\n- Large Lists and Navigation:\n  - Business Expectation: Lists are responsive with pagination; ordering defaults are predictable; filters persist during navigation.\n- Concurrent Edits and Deletes:\n  - Business Rule: Prevent silent overwrites; provide guidance to refresh, reconcile, or retry when conflicts occur; if an item is deleted during edit, inform the user gracefully.\n- Session Expiration During Use:\n  - Business Rule: Persisted data remains; subsequent protected actions require re-authentication.\n- Account Suspension:\n  - Business Rule: Suspended accounts cannot perform protected actions; read-only access may be allowed per policy.\n- Rate Limiting and Abuse Prevention:\n  - Business Rule: Excessive operation frequency may be throttled; communicate limits and retry expectations clearly.\n- Export Size and Frequency:\n  - Business Rule: Exports may be rate-limited; large exports may be processed asynchronously with notification on completion.\n- Accessibility and Clarity:\n  - Business Rule: Messages use unambiguous, plain language that directs users toward successful recovery actions.\n\n## Role-based Scenarios (user, admin)\n\n### User Role: Owned-Data Operations\n- Create Todo: Creates items with required title and optional fields; items belong exclusively to the creator.\n- Read Own Todos: Views only owned items; no leakage of other users’ data.\n- Update Own Todos: Edits only owned items; state transitions are controlled (open ⇄ completed).\n- Delete Own Todos: Removes only owned items from active lists.\n- Export Own Data: Requests export of owned items subject to capacity limits.\n- Account Management: Verifies email, signs in/out, changes password, revokes own sessions.\n\n### Admin Role: Support and Policy Enforcement\n- Locate and Review User Profile: Finds accounts and reviews business-level details needed for support.\n- Revoke User Sessions: Ends all sessions for a user when safety or policy requires; action is auditable.\n- Suspend/Restore Account: Changes account status to restrict or restore access as warranted.\n- Access Aggregated Indicators: Reviews aggregate-level health indicators without exposing personal content beyond the minimum necessary for support.\n- Enforce Policy on Content: Performs support actions on items where justified (e.g., immediate removal of clearly violating content) with audit trail.\n\n## Acceptance Tests in Natural Language (EARS where applicable)\n\n### Registration and Verification\n- WHEN a new user submits valid registration information, THE system SHALL create an unverified account and send a verification instruction within 1 minute.\n- IF a user opens a valid verification link within its validity window, THEN THE system SHALL mark the account as verified immediately.\n- IF a user attempts to sign in before verifying, THEN THE system SHALL prevent access to todo features and direct the user to verify.\n\n### Create Todo\n- WHEN a verified user provides a title and submits a new todo, THE system SHALL create the item as \"open\" and associate it with that user within 2 seconds.\n- IF the user omits description and due date, THEN THE system SHALL still create the item without error.\n- IF the title length exceeds the business-defined limit, THEN THE system SHALL reject the creation with a clear message referencing the limit.\n\n### Review and Filter\n- WHEN a user requests their todo list, THE system SHALL return only items owned by that user ordered by last updated, newest first.\n- WHERE a user applies a filter to show only \"open\" items, THE system SHALL display only items with state \"open\" consistently across navigation within the same session.\n- WHERE a user filters by a due window (today, this week), THE system SHALL compute the window using the user’s time zone and display matching items only.\n\n### Complete and Reopen\n- WHEN a user marks an open item as completed, THE system SHALL set the item state to \"completed\" and record a completion timestamp.\n- IF a user reopens a completed item, THEN THE system SHALL remove the completion timestamp and set state to \"open\".\n- IF a user attempts to complete an already completed item, THEN THE system SHALL keep the state unchanged and provide guidance that it is already completed.\n\n### Edit Todo\n- WHEN a user updates the title of their own item to a valid value, THE system SHALL save the change and update the last-updated timestamp.\n- IF a user attempts to edit another user’s item, THEN THE system SHALL deny the action and inform the user they lack permission.\n\n### Delete Todo\n- WHEN a user requests deletion of their own item, THE system SHALL remove the item from active views.\n- IF a user attempts to delete an item they do not own, THEN THE system SHALL deny the action and provide a clear permission error message.\n\n### Bulk Operations\n- WHEN a user selects up to 50 items and triggers bulk complete, THE system SHALL complete all eligible items within 2 seconds perceived by the user and report any ineligible selections.\n- WHEN a user selects up to 50 items and triggers bulk reopen, THE system SHALL reopen all eligible items within 2 seconds perceived by the user and report any ineligible selections.\n\n### Export\n- WHEN a user requests export of their own items, THE system SHALL prepare a complete, portable package and notify the user upon completion within a reasonable window.\n- IF a user requests export when no items exist, THEN THE system SHALL provide a valid export package indicating zero items.\n\n### Time Zone and Due Dates\n- WHILE the user’s time zone setting differs from the time zone at item creation, THE system SHALL preserve the intended due calendar date when displaying the item.\n- IF a due date is set in the past, THEN THE system SHALL mark the item as overdue without blocking save operations.\n- IF a due date falls into a DST gap in the selected time zone, THEN THE system SHALL adjust to the next valid local time and inform the user.\n\n### Concurrency and Conflicts\n- IF two sessions attempt to update the same item concurrently, THEN THE system SHALL prevent silent overwrite and instruct the user to refresh or reconcile.\n- IF an item is deleted in another session during an edit attempt, THEN THE system SHALL inform that the item is no longer available and preserve the user’s input locally where feasible.\n\n### Administrative Controls\n- WHEN an admin executes revoke-all-sessions for a user, THE system SHALL end the user’s active sessions so that the next action requires re-authentication.\n- WHEN an admin suspends a user account, THE system SHALL block access to todo features for that account until restored and record the action for audit.\n\n### Rate Limiting and Recovery\n- WHERE a user exceeds defined write operation limits, THE system SHALL throttle further writes temporarily and provide guidance on when to retry.\n- WHEN a transient service issue prevents completion of an action, THE system SHALL encourage retry and avoid duplicated creations or updates from a single submitted intent.\n\n## Success Indicators per Scenario\n\n| Scenario | Primary KPI | Target for MVP | Measurement Method |\n|---------|-------------|----------------|--------------------|\n| Registration & Verification | Verification completion rate within 24 hours | ≥ 80% | Ratio of verified/registered within 24h |\n| Create Todo | Median time from intent to saved item | ≤ 10 seconds | Time from create action start to item persistence |\n| Review & Filter | Time-to-find (specific item) | ≤ 5 seconds | Time from list request to visibility of targeted item via filters |\n| Complete/Reopen | State change latency | ≤ 2 seconds | Time from user action to list reflecting new state |\n| Edit Todo | Edit persistence success rate | ≥ 99% | Successful saves / attempts |\n| Delete Todo | Erroneous deletions rate | ≤ 0.1% | Confirmed mistaken deletions / deletions |\n| Admin Session Revocation | Time to invalidate sessions | ≤ 1 minute | Time from revocation to enforced re-authentication |\n| Bulk Complete/Reopen | Completion of eligible items | 100% eligible within 2 seconds | Operation timing and eligibility reporting |\n| Export | Export readiness window | ≤ 24 hours (typical) | Time from request to availability notification |\n| Time Zone Change | Consistency of due calendar day | 100% preserved | Audit sample of items before/after change |\n\n## References to Related Documents\n- See the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for field validations, ownership rules, and acceptance criteria.\n- Review the [User Flows for todoApp](./05-todoApp-user-flows.md) for visual flow details complementing these scenarios.\n- Consult the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md) for recovery paths and user-facing guidance.\n\n## Scope Clarification\nThis content provides business requirements, personas, stories, and scenarios for todoApp. It focuses on what the system must do from a user and business perspective and does not prescribe technical implementation. All architecture, API design, and database decisions are at the discretion of the development team.","tokenUsage":{"total":72868,"input":{"total":65692,"cached":0},"output":{"total":7176,"reasoning":1856,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":5,"step":0,"created_at":"2025-08-15T04:01:00.448Z"},"tokenUsage":{"aggregate":{"total":627339,"input":{"total":518240,"cached":11648},"output":{"total":109099,"reasoning":40448,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":624555,"input":{"total":515903,"cached":11648},"output":{"total":108652,"reasoning":40064,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Provide clear, visual business flows for key processes to reduce ambiguity and align teams.","filename":"05-todoApp-user-flows.md","documentType":"user-flow","outline":["Flow Diagram Conventions","Authentication Flow (register, login, reset)","Todo Item Lifecycle Flow (create, update, complete, delete)","Error and Recovery Flow","State Model for Todo Items","Narrative Descriptions of Each Flow"],"audience":"development team","keyQuestions":["What are the step-by-step flows for core processes?","Where do decisions occur and what are the expected outcomes?"],"detailLevel":"moderate detail","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["All diagrams must follow the Mermaid rules provided (double quotes for labels, correct arrows)","Use graph LR orientation for readability","Do not include technical architecture diagrams or API sequence diagrams"],"content":"# todoApp User Flows and Business Process Diagrams\n\nThis document provides business requirements only. All technical implementation decisions (architecture, APIs, database design, and related choices) belong to the development team. The document describes WHAT the system should do, not HOW to build it.\n\n- Service prefix: todoApp\n- Roles referenced: user, admin\n- Related references for deeper context:\n  - See the [User Roles and Authentication Specification](./02-todoApp-user-roles-and-authentication.md) for complete role definitions and authentication behaviors.\n  - See the [Functional Requirements Specification](./03-todoApp-functional-requirements.md) for field-level validations and acceptance criteria.\n  - See the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md) for comprehensive error taxonomies and user recovery.\n\n## Flow Diagram Conventions\n\n- Orientation: Left-to-right (LR) for all flows.\n- Notation: Rectangles represent steps, diamonds represent decisions, rounded shapes represent states or outcomes.\n- Labels: All node and edge labels use double quotes; edge labels denote decision outcomes or key information.\n- Roles context:\n  - \"user\" refers to an authenticated end user managing their own todos and account.\n  - \"admin\" refers to an administrative user performing oversight or support activities.\n- Business semantics:\n  - “Create”, “Update”, “Complete”, “Reopen”, and “Delete” refer to user-visible actions and their business effects.\n  - “Verification” refers to email verification for account activation.\n- Performance expectations (user experience level):\n  - Simple actions (register, login, create todo, mark complete) should feel immediate. Where stated, response expectations are provided in seconds as testable criteria.\n\n## Authentication Flow (register, login, reset)\n\n### Diagram: Registration, Email Verification, Login, Logout, Password Reset\n\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A1[\"Open Registration\"] --> A2[\"Enter Email/Password\"]\n    A3[\"Open Login\"] --> A4[\"Enter Credentials\"]\n    A5[\"Open Password Reset\"] --> A6[\"Submit Reset Request(Email)\"]\n    A7[\"Open Logout\"] --> A8[\"Confirm Logout\"]\n    A9[\"Open Verification Link\"]\n  end\n\n  subgraph \"Business Processing\"\n    B1[\"Validate Registration Input\"] --> B2{\"Email Available?\"}\n    B2 -->|\"Yes\"| B3[\"Create Account(Pending Verification)\"]\n    B2 -->|\"No\"| E1[\"Inform Duplicate Email\"]\n    B3 --> B4[\"Send Verification Email\"]\n\n    B5[\"Validate Credentials\"] --> B6{\"Account Exists?\"}\n    B6 -->|\"No\"| E2[\"Inform Invalid Login\"]\n    B6 -->|\"Yes\"| B7{\"Email Verified?\"}\n    B7 -->|\"No\"| E3[\"Inform Verification Required\"]\n    B7 -->|\"Yes\"| B8[\"Establish Session\"]\n\n    B9[\"Validate Reset Request\"] --> B10{\"Account Exists?\"}\n    B10 -->|\"No\"| E4[\"Inform Unknown Email\"]\n    B10 -->|\"Yes\"| B11[\"Send Reset Instructions\"]\n\n    B12[\"Validate Verification Token\"] --> B13{\"Token Valid?\"}\n    B13 -->|\"Yes\"| B14[\"Activate Account(Verified)\"]\n    B13 -->|\"No\"| E5[\"Inform Invalid/Expired Link\"]\n\n    B15[\"Invalidate Session\"]\n  end\n\n  subgraph \"Outcomes\"\n    C1[\"Registration Pending\"]\n    C2[\"Registration Complete\"]\n    C3[\"Logged In\"]\n    C4[\"Password Reset Email Sent\"]\n    C5[\"Logged Out\"]\n  end\n\n  %% Flows\n  A2 --> B1\n  B1 --> B2\n  B3 --> B4 --> C1\n\n  A9 --> B12\n  B14 --> C2\n\n  A4 --> B5\n  B5 --> B6\n  B8 --> C3\n\n  A6 --> B9\n  B9 --> B10\n  B11 --> C4\n\n  A8 --> B15 --> C5\n\n  %% Errors\n  E1 -.->|\"Guidance: Use Different Email\"| A2\n  E2 -.->|\"Guidance: Retry or Reset\"| A3\n  E3 -.->|\"Guidance: Check Inbox\"| C1\n  E4 -.->|\"Guidance: Register First\"| A1\n  E5 -.->|\"Guidance: Request New Link\"| A5\n```\n\n### EARS Requirements — Authentication\n\n- WHEN a person submits valid registration details, THE authentication subsystem SHALL create an account in \"pending verification\" state and send a verification email within 60 seconds.\n- IF the registration email is already in use, THEN THE authentication subsystem SHALL reject the registration and present a message indicating the email is taken.\n- WHEN a person clicks a valid verification link, THE authentication subsystem SHALL activate the account immediately and allow login thereafter.\n- IF a verification link is invalid or expired, THEN THE authentication subsystem SHALL inform the user and provide a path to request a new link.\n- WHEN a verified account submits correct login credentials, THE authentication subsystem SHALL create an authenticated session and reflect the logged-in state within 2 seconds.\n- IF login fails due to unknown account or incorrect credentials, THEN THE authentication subsystem SHALL not reveal which field failed and SHALL encourage retry or password reset.\n- WHEN a user requests a password reset with an email of an existing account, THE authentication subsystem SHALL send reset instructions within 60 seconds.\n- IF a password reset request references a non-existent email, THEN THE authentication subsystem SHALL complete without disclosing account existence and SHALL present generic confirmation messaging.\n- WHEN a user initiates logout, THE authentication subsystem SHALL terminate the active session immediately and reflect the logged-out state.\n- WHERE the actor is an admin assisting a user, THE support process SHALL allow the admin to trigger re-verification or lock/unlock an account according to business policy defined in the role specification.\n\n## Todo Item Lifecycle Flow (create, update, complete, delete)\n\n### Diagram: Todo Item Lifecycle\n\n```mermaid\ngraph LR\n  subgraph \"User Actions\"\n    T1[\"Start Create Todo\"] --> T2[\"Enter Title(Optional: Description, Due Date)\"]\n    T3[\"Open Todo\"] --> T4[\"Edit Fields\"]\n    T5[\"Mark Complete\"]\n    T6[\"Reopen Item\"]\n    T7[\"Delete Item\"]\n  end\n\n  subgraph \"Business Rules\"\n    R1[\"Validate Title(Non-Empty, Max Length)\"]\n    R2[\"Validate Optional Fields(Description Length, Due Date Format)\"]\n    R3{\"Item Owned By User?\"}\n    R4{\"Item Editable?\"}\n    R5{\"Item In Active State?\"}\n    R6{\"Item In Completed State?\"}\n  end\n\n  subgraph \"Outcomes\"\n    O1[\"Item Created(Active)\"]\n    O2[\"Item Updated\"]\n    O3[\"Item Completed\"]\n    O4[\"Item Reopened(Active)\"]\n    O5[\"Item Deleted(Permanent)\"]\n  end\n\n  %% Creation\n  T2 --> R1 --> R2 --> O1\n\n  %% Update\n  T4 --> R3\n  R3 -->|\"Yes\"| R4\n  R3 -->|\"No\"| E1[\"Inform Access Denied\"]\n  R4 -->|\"Yes\"| O2\n  R4 -->|\"No\"| E2[\"Inform Not Editable\"]\n\n  %% Complete\n  T5 --> R3\n  R3 -->|\"Yes\"| R5\n  R5 -->|\"Yes\"| O3\n  R5 -->|\"No\"| E3[\"Inform Already Completed or Invalid State\"]\n\n  %% Reopen\n  T6 --> R3\n  R3 -->|\"Yes\"| R6\n  R6 -->|\"Yes\"| O4\n  R6 -->|\"No\"| E4[\"Inform Not Completed\"]\n\n  %% Delete\n  T7 --> R3\n  R3 -->|\"Yes\"| O5\n  R3 -->|\"No\"| E5[\"Inform Access Denied\"]\n\n  %% Guidance\n  E1 -.->|\"Guidance: Operate Only Own Items\"| T3\n  E2 -.->|\"Guidance: Check State/Fields\"| T3\n  E3 -.->|\"Guidance: No Duplicate Completion\"| T3\n  E4 -.->|\"Guidance: Reopen Only Completed\"| T3\n  E5 -.->|\"Guidance: Ownership Required\"| T3\n```\n\n### EARS Requirements — Todo Lifecycle\n\n- THE todo management subsystem SHALL require a non-empty title up to the maximum length defined in the functional specification.\n- WHERE a description is provided, THE todo management subsystem SHALL accept it up to the maximum length defined in the functional specification.\n- WHERE a due date is provided, THE todo management subsystem SHALL interpret it using the user’s locale and time zone settings as specified in the functional specification.\n- WHEN a user creates a valid todo, THE todo management subsystem SHALL place it in the \"active\" state and make it available in the user’s list immediately.\n- IF a user attempts to modify a todo they do not own, THEN THE todo management subsystem SHALL deny the action and present an authorization message without exposing other users’ data.\n- WHEN a user edits fields of an active todo, THE todo management subsystem SHALL apply the changes immediately if all validations pass.\n- WHEN a user marks an active todo as complete, THE todo management subsystem SHALL update its state to \"completed\" and display the completion timestamp according to the user’s time zone.\n- IF a user attempts to complete a todo already in \"completed\" state, THEN THE todo management subsystem SHALL inform that the item is already completed and SHALL not change state.\n- WHEN a user reopens a completed todo, THE todo management subsystem SHALL return it to the \"active\" state and clear any derived completion indicators while preserving historical metadata as defined in the business rules.\n- WHEN a user deletes their own todo, THE todo management subsystem SHALL remove it from the user’s list permanently for MVP scope.\n- WHERE an admin performs moderation, THE administrative process SHALL not alter user todo content except when enforcing policy; any such action SHALL be auditable according to the role specification.\n\n## Error and Recovery Flow\n\n### Diagram: Error Categories and Recovery Paths\n\n```mermaid\ngraph LR\n  subgraph \"Operation Context\"\n    U1[\"Attempt Operation\"] --> D1{\"Auth Error?\"}\n  end\n\n  subgraph \"Authentication/Authorization\"\n    D1 -->|\"Yes\"| A1[\"Show Auth Message\"]\n    A1 --> A2{\"User Intends to Recover?\"}\n    A2 -->|\"Yes\"| A3[\"Prompt Login or Verify Email\"]\n    A2 -->|\"No\"| A4[\"Abort Operation\"]\n  end\n\n  subgraph \"Validation\"\n    D1 -->|\"No\"| D2{\"Validation Error?\"}\n    D2 -->|\"Yes\"| V1[\"Show Field Guidance\"]\n    V1 --> V2{\"Can Retry Immediately?\"}\n    V2 -->|\"Yes\"| V3[\"Allow Correction and Resubmission\"]\n    V2 -->|\"No\"| V4[\"Provide Instructions\"]\n  end\n\n  subgraph \"Not Found / Conflict\"\n    D2 -->|\"No\"| D3{\"Not Found?\"}\n    D3 -->|\"Yes\"| N1[\"Inform Missing Resource\"]\n    D3 -->|\"No\"| D4{\"Conflict?\"}\n    D4 -->|\"Yes\"| C1[\"Inform Concurrent Update\"]\n    C1 --> C2[\"Offer Refresh or Retry\"]\n  end\n\n  subgraph \"Rate Limit / Service Unavailable\"\n    D4 -->|\"No\"| D5{\"Rate Limited?\"}\n    D5 -->|\"Yes\"| R1[\"Show Wait Guidance\"]\n    D5 -->|\"No\"| D6{\"Service Unavailable?\"}\n    D6 -->|\"Yes\"| S1[\"Show Retry Later Guidance\"]\n    D6 -->|\"No\"| S2[\"Proceed to Success\"]\n  end\n```\n\n### EARS Requirements — Error and Recovery\n\n- WHEN an action requires authentication and the user is not authenticated, THE system SHALL present a message to log in or verify and SHALL not proceed with the action.\n- IF a form submission contains invalid fields, THEN THE system SHALL highlight the specific fields and provide actionable guidance for correction.\n- WHEN a missing resource is referenced (e.g., deleted or non-existent todo), THE system SHALL inform the absence without exposing whether the resource ever existed for other users.\n- IF a concurrency conflict occurs due to simultaneous updates, THEN THE system SHALL prevent data loss by rejecting the later change and SHALL offer a path to refresh and retry.\n- WHEN a user exceeds allowed operation frequency, THE system SHALL inform that the rate limit has been reached and SHALL advise when to try again.\n- IF a transient service disruption prevents completing an action, THEN THE system SHALL inform the user and encourage retry after a short interval without blaming user input.\n\n## State Model for Todo Items\n\n### Diagram: States and Transitions (Business-Level)\n\n```mermaid\ngraph LR\n  S0[\"Nonexistent\"] -->|\"Create\"| S1[\"Active\"]\n  S1 -->|\"Update Fields\"| S1\n  S1 -->|\"Complete\"| S2[\"Completed\"]\n  S2 -->|\"Reopen\"| S1\n  S1 -->|\"Delete\"| S3[\"Deleted(Permanent)\"]\n  S2 -->|\"Delete\"| S3\n```\n\n### EARS Requirements — State Model\n\n- THE todo item lifecycle SHALL consist of \"active\", \"completed\", and \"deleted\" states for MVP.\n- WHEN a todo is created successfully, THE lifecycle SHALL enter the \"active\" state.\n- WHEN a todo is marked complete from the \"active\" state, THE lifecycle SHALL transition to \"completed\" without modifying non-edited fields.\n- WHEN a completed todo is reopened, THE lifecycle SHALL transition back to \"active\" and clear completion-specific indicators while keeping other fields intact.\n- WHEN a todo is deleted, THE lifecycle SHALL transition to \"deleted\" and SHALL not be available in the user’s list thereafter for MVP.\n\n## Narrative Descriptions of Each Flow\n\n### Authentication Flow Narrative\n\n- Registration and Verification\n  - Trigger: A person attempts to create an account with an email and password.\n  - Decision: If the email is already in use, the registration is rejected and guidance is provided to try another email. Otherwise, the account is created in a pending verification state, and a verification message is sent.\n  - Outcome: On clicking a valid verification link, the account becomes verified and eligible for login.\n  - Non-disclosure: In all flows, do not reveal whether a specific email exists to unauthorized parties.\n\n- Login and Session Establishment\n  - Trigger: A verified user enters credentials.\n  - Decision: If credentials are invalid or the account is unverified, the login is denied with appropriate guidance. Otherwise, a session is established.\n  - Outcome: The user reaches the authenticated state capable of performing todo operations.\n\n- Password Reset\n  - Trigger: A person submits a password reset request with an email.\n  - Decision: If the account exists, a reset instruction is sent. If not, a generic confirmation is presented without disclosing account existence.\n  - Outcome: The person is able to reset password via a secure link flow (details in authentication spec) and subsequently log in.\n\n- Logout\n  - Trigger: A logged-in user initiates logout.\n  - Outcome: The active session is terminated immediately.\n\n- Admin Support Notes\n  - Admins can enforce policies such as locking accounts or re-triggering verification within the constraints and audit expectations defined in the role specification.\n\n### Todo Item Lifecycle Narrative\n\n- Create\n  - Trigger: An authenticated user initiates creation.\n  - Validation: Title must be present and within allowed length; optional description and due date, when provided, must meet length and format rules.\n  - Outcome: A new todo is created in the active state and appears in the user’s list.\n\n- Read\n  - Trigger: A user views one of their todos.\n  - Authorization: Items are only visible to their owner. Admin oversight of content, when necessary for policy enforcement, is out-of-band and auditable.\n\n- Update\n  - Trigger: A user edits fields of their own todo.\n  - Decision: If the item is not owned by the user, the operation is denied. If the item is in a state that disallows the requested change (as per business rules), the operation is denied with guidance. Otherwise, the update is applied.\n\n- Complete\n  - Trigger: A user marks an active todo as complete.\n  - Decision: If already completed, the operation is rejected with guidance.\n  - Outcome: Item moves to completed state; completion timestamp is recorded for display based on the user’s time zone.\n\n- Reopen\n  - Trigger: A user reopens a completed item.\n  - Outcome: Item moves back to active state; completion-specific indicators are cleared while preserving other details.\n\n- Delete\n  - Trigger: A user deletes their own item.\n  - Outcome: Item is permanently removed from the user’s list for MVP. Business rule documents may define alternative retention in future phases.\n\n### Error and Recovery Narrative\n\n- Authentication and Authorization Errors\n  - Scenario: User attempts actions requiring authentication or proper authorization.\n  - Response: The system blocks the action and presents clear next steps: log in, verify email, or request access as appropriate. No sensitive details are disclosed.\n\n- Validation Errors\n  - Scenario: User submissions fail validations (e.g., missing title, invalid due date format, overly long text fields).\n  - Response: The system identifies specific fields and provides actionable guidance to correct and resubmit.\n\n- Not Found\n  - Scenario: A referenced todo does not exist or is no longer available.\n  - Response: The system informs that the resource is unavailable without exposing historical existence for other users.\n\n- Conflict (Concurrent Updates)\n  - Scenario: Two edits occur to the same todo in close succession.\n  - Response: The system prevents overwriting by rejecting the later change, guiding the user to refresh and retry.\n\n- Rate Limit\n  - Scenario: Excessive operations in a short period (e.g., repeated create/delete).\n  - Response: The system asks the user to slow down and to try again after a provided interval.\n\n- Service Unavailable\n  - Scenario: Temporary outage or degraded service prevents operation completion.\n  - Response: The system encourages retry after a short interval and provides reassurance without implying user error.\n\n## Additional EARS Requirements Spanning Flows\n\n- WHILE a user is authenticated, THE system SHALL maintain a valid session and reflect authorization according to the role’s business permissions.\n- WHERE the actor is \"admin\", THE system SHALL allow actions aligned with oversight and policy enforcement while maintaining auditability and minimal data exposure.\n- WHEN business limits are exceeded (such as rate limits), THE system SHALL communicate the limit and the time window for retry in user terms.\n- WHEN time-sensitive information is presented (such as due dates and completion timestamps), THE system SHALL align display and interpretation with the user’s configured time zone and locale rules defined in the functional specification.\n\n## Traceability and References\n\n- Authentication details and lifecycle expectations are defined in the [User Roles and Authentication Specification](./02-todoApp-user-roles-and-authentication.md).\n- Feature-level behaviors and validations are defined in the [Functional Requirements Specification](./03-todoApp-functional-requirements.md).\n- Error handling categories and user-facing guidance are detailed in the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md).\n\nEnd of document."},"plan":"Document: 05-todoApp-user-flows.md\nReason: Provide clear, visual business flows for key processes to reduce ambiguity and align teams.\nType: user-flow\nOutline:\n- Flow Diagram Conventions\n- Authentication Flow (register, login, reset)\n- Todo Item Lifecycle Flow (create, update, complete, delete)\n- Error and Recovery Flow\n- State Model for Todo Items\n- Narrative Descriptions of Each Flow\nAudience: development team\nKey Questions:\n- What are the step-by-step flows for core processes?\n- Where do decisions occur and what are the expected outcomes?\nDetail Level: moderate detail\nRelated Documents:\n- 02-todoApp-user-roles-and-authentication.md\n- 03-todoApp-functional-requirements.md\n- 07-todoApp-error-handling-and-exception-scenarios.md\nConstraints:\n- All diagrams must follow the Mermaid rules provided (double quotes for labels, correct arrows)\n- Use graph LR orientation for readability\n- Do not include technical architecture diagrams or API sequence diagrams\nService prefix: todoApp\nRoles: user, admin","review":"Enhance to production-ready business flows adhering to all constraints: minimum length 5,000+ characters; complete coverage of outline sections; all applicable requirements in EARS with English keywords (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL) and unambiguous, testable statements; business-only (no APIs, no database schemas, no technical architecture). Mermaid diagrams must use graph LR, double quotes around ALL labels (including subgraph titles), no spaces between brackets/braces and quotes, and correct arrow syntax (--> for solid, -.-> dotted, ==>, with labels as -->|\"Label\"|). Include comprehensive workflows for authentication (register, verify, login, logout, password reset), todo lifecycle (create, read, update, complete, reopen, delete), error/recovery, and state model. Add missing business processes and edge cases, expand narratives, specify role-based decision points, and maintain consistency with related documents. Ensure link text is descriptive, reference existing files only, and keep developer autonomy statements. Absolutely avoid frontend/UI details, API endpoints, or database schemas. Reject any inclusion of schemas/specs. Ensure performance expectations are in user terms where applicable and keep all content in en-US.","content":"# todoApp User Flows and Business Process Diagrams\n\nThis document provides business requirements only. All technical implementation decisions (architecture, APIs, database design, and related choices) belong to the development team. The content describes WHAT the system should do, not HOW to build it.\n\n- Service prefix: todoApp\n- Roles referenced: user, admin\n- Related references for deeper context:\n  - See the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md) for complete role definitions and authentication behaviors.\n  - See the [Functional Requirements (MVP)](./03-todoApp-functional-requirements.md) for field-level validations and acceptance criteria.\n  - See the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md) for comprehensive error taxonomies and user recovery.\n\n## Flow Diagram Conventions\n\n- Orientation: Left-to-right (LR) for all flows.\n- Notation: Rectangles represent steps, diamonds represent decisions, rounded shapes represent states or outcomes.\n- Labels: All node and edge labels use double quotes; edge labels denote decision outcomes or key information.\n- Roles context:\n  - \"user\" refers to an authenticated end user managing their own todos and account.\n  - \"admin\" refers to an administrative user performing oversight or support activities.\n- Business semantics:\n  - \"Create\", \"Update\", \"Complete\", \"Reopen\", and \"Delete\" refer to user-visible actions and their business effects.\n  - \"Verification\" refers to email verification for account activation.\n- Performance expectations (user experience level):\n  - Simple actions (register, login, create todo, mark complete) should feel immediate. Where stated, response expectations are provided in seconds as testable criteria.\n\n### Visual Legend (Business-Level)\n\n| Symbol | Meaning |\n|-------|---------|\n| Rectangle | Action or processing step |\n| Diamond | Decision point with labeled outcomes |\n| Rounded Rectangle | Outcome or state |\n| Dotted Arrow | Advisory or guidance path |\n\n## Authentication Flow (register, login, reset)\n\n### Diagram: Registration, Email Verification, Login, Logout, Password Reset (Request + Completion)\n\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A1[\"Open Registration\"] --> A2[\"Enter Email/Password\"]\n    A3[\"Open Login\"] --> A4[\"Enter Credentials\"]\n    A5[\"Open Password Reset\"] --> A6[\"Submit Reset Request(Email)\"]\n    A7[\"Open Logout\"] --> A8[\"Confirm Logout\"]\n    A9[\"Open Verification Link\"]\n    A10[\"Open Reset Link\"] --> A11[\"Enter New Password\"]\n  end\n\n  subgraph \"Business Processing\"\n    B1[\"Validate Registration Input\"] --> B2{\"Email Available?\"}\n    B2 -->|\"Yes\"| B3[\"Create Account(Pending Verification)\"]\n    B2 -->|\"No\"| E1[\"Inform Duplicate Email\"]\n    B3 --> B4[\"Send Verification Email\"]\n\n    B5[\"Validate Credentials\"] --> B6{\"Account Exists?\"}\n    B6 -->|\"No\"| E2[\"Inform Invalid Login\"]\n    B6 -->|\"Yes\"| B7{\"Email Verified?\"}\n    B7 -->|\"No\"| E3[\"Inform Verification Required\"]\n    B7 -->|\"Yes\"| B8[\"Establish Session\"]\n\n    B9[\"Validate Reset Request\"] --> B10{\"Account Exists?\"}\n    B10 -->|\"No\"| E4[\"Inform Generic Confirmation\"]\n    B10 -->|\"Yes\"| B11[\"Send Reset Instructions\"]\n\n    B12[\"Validate Verification Token\"] --> B13{\"Token Valid?\"}\n    B13 -->|\"Yes\"| B14[\"Activate Account(Verified)\"]\n    B13 -->|\"No\"| E5[\"Inform Invalid/Expired Link\"]\n\n    B15[\"Invalidate Session\"]\n\n    B16[\"Validate Reset Token\"] --> B17{\"Token Valid?\"}\n    B17 -->|\"Yes\"| B18[\"Validate New Password(Policy)\"]\n    B18 --> B19{\"Valid?\"}\n    B19 -->|\"Yes\"| B20[\"Set New Password & Revoke Sessions\"]\n    B19 -->|\"No\"| E6[\"Inform Password Policy Failure\"]\n    B17 -->|\"No\"| E7[\"Inform Invalid/Expired Reset Link\"]\n  end\n\n  subgraph \"Outcomes\"\n    C1[\"Registration Pending\"]\n    C2[\"Registration Complete\"]\n    C3[\"Logged In\"]\n    C4[\"Password Reset Email Sent\"]\n    C5[\"Logged Out\"]\n    C6[\"Password Reset Complete\"]\n  end\n\n  %% Flows\n  A2 --> B1 --> B2\n  B3 --> B4 --> C1\n\n  A9 --> B12 --> B13\n  B14 --> C2\n\n  A4 --> B5 --> B6\n  B8 --> C3\n\n  A6 --> B9 --> B10\n  B11 --> C4\n\n  A8 --> B15 --> C5\n\n  A10 --> B16 --> B17\n  B18 --> B19\n  B20 --> C6\n\n  %% Errors & Guidance\n  E1 -.->|\"Guidance: Use Different Email\"| A2\n  E2 -.->|\"Guidance: Retry or Reset\"| A3\n  E3 -.->|\"Guidance: Check Inbox\"| C1\n  E4 -.->|\"Guidance: If No Account, Register\"| A1\n  E5 -.->|\"Guidance: Request New Link\"| A5\n  E6 -.->|\"Guidance: Follow Password Rules\"| A11\n  E7 -.->|\"Guidance: Request New Reset Link\"| A5\n```\n\n### EARS Requirements — Authentication\n\n- WHEN a person submits valid registration details, THE authentication subsystem SHALL create an account in \"pending verification\" state and send a verification email within 60 seconds.\n- IF the registration email is already in use, THEN THE authentication subsystem SHALL reject the registration and present a message indicating the email is taken.\n- WHEN a person clicks a valid verification link, THE authentication subsystem SHALL activate the account immediately and allow login thereafter.\n- IF a verification link is invalid or expired, THEN THE authentication subsystem SHALL inform the user and provide a path to request a new link.\n- WHEN a verified account submits correct login credentials, THE authentication subsystem SHALL create an authenticated session and reflect the logged-in state within 2 seconds.\n- IF login fails due to unknown account or incorrect credentials, THEN THE authentication subsystem SHALL not reveal which field failed and SHALL encourage retry or password reset.\n- WHEN a user requests a password reset with an email of an existing account, THE authentication subsystem SHALL send reset instructions within 60 seconds and SHALL not disclose whether the email exists to unauthorized parties.\n- WHEN a user opens a valid reset link and enters a new password that meets policy, THE authentication subsystem SHALL set the new password and revoke existing sessions, allowing immediate login with the new password.\n- IF a reset link is invalid or expired, THEN THE authentication subsystem SHALL provide a path to request a new reset link without disclosing account existence.\n- WHEN a user initiates logout, THE authentication subsystem SHALL terminate the active session immediately and reflect the logged-out state.\n- WHERE the actor is an admin assisting a user, THE support process SHALL allow the admin to trigger re-verification or lock/unlock an account according to business policy defined in the role specification and record the reason for audit.\n- WHERE excessive failed login attempts occur, THE authentication subsystem SHALL throttle further attempts temporarily and present recovery guidance consistent with the error handling policy.\n\n## Todo Item Lifecycle Flow (create, update, complete, delete)\n\n### Diagram: Todo Item Lifecycle\n\n```mermaid\ngraph LR\n  subgraph \"User Actions\"\n    T1[\"Start Create Todo\"] --> T2[\"Enter Title(Optional: Description, Due Date)\"]\n    T3[\"Open Todo\"] --> T4[\"Edit Fields\"]\n    T5[\"Mark Complete\"]\n    T6[\"Reopen Item\"]\n    T7[\"Delete Item\"]\n    T8[\"List My Todos\"]\n  end\n\n  subgraph \"Business Rules\"\n    R1[\"Validate Title(Non-Empty, Max Length)\"]\n    R2[\"Validate Optional Fields(Description Length, Due Date Format)\"]\n    R3{\"Item Owned By User?\"}\n    R4{\"Item Editable?\"}\n    R5{\"Item In Active State?\"}\n    R6{\"Item In Completed State?\"}\n  end\n\n  subgraph \"Outcomes\"\n    O1[\"Item Created(Active)\"]\n    O2[\"Item Updated\"]\n    O3[\"Item Completed\"]\n    O4[\"Item Reopened(Active)\"]\n    O5[\"Item Deleted(Permanent)\"]\n    O6[\"User List Returned\"]\n  end\n\n  %% Creation\n  T2 --> R1 --> R2 --> O1\n\n  %% Read/List\n  T8 --> O6\n\n  %% Update\n  T4 --> R3\n  R3 -->|\"Yes\"| R4\n  R3 -->|\"No\"| E1[\"Inform Access Denied\"]\n  R4 -->|\"Yes\"| O2\n  R4 -->|\"No\"| E2[\"Inform Not Editable\"]\n\n  %% Complete\n  T5 --> R3\n  R3 -->|\"Yes\"| R5\n  R5 -->|\"Yes\"| O3\n  R5 -->|\"No\"| E3[\"Inform Already Completed or Invalid State\"]\n\n  %% Reopen\n  T6 --> R3\n  R3 -->|\"Yes\"| R6\n  R6 -->|\"Yes\"| O4\n  R6 -->|\"No\"| E4[\"Inform Not Completed\"]\n\n  %% Delete\n  T7 --> R3\n  R3 -->|\"Yes\"| O5\n  R3 -->|\"No\"| E5[\"Inform Access Denied\"]\n\n  %% Guidance\n  E1 -.->|\"Guidance: Operate Only Own Items\"| T3\n  E2 -.->|\"Guidance: Check State/Fields\"| T3\n  E3 -.->|\"Guidance: No Duplicate Completion\"| T3\n  E4 -.->|\"Guidance: Reopen Only Completed\"| T3\n  E5 -.->|\"Guidance: Ownership Required\"| T3\n```\n\n### EARS Requirements — Todo Lifecycle\n\n- THE todo management subsystem SHALL require a non-empty title up to the maximum length defined in the functional specification.\n- WHERE a description is provided, THE todo management subsystem SHALL accept it up to the maximum length defined in the functional specification.\n- WHERE a due date is provided, THE todo management subsystem SHALL interpret it using the user’s locale and time zone settings as specified in the functional specification.\n- WHEN a user creates a valid todo, THE todo management subsystem SHALL place it in the \"active\" state and make it available in the user’s list immediately.\n- WHEN a user requests to list their todos, THE todo management subsystem SHALL return only items owned by that user, ordered by the current business sorting rule.\n- IF a user attempts to modify a todo they do not own, THEN THE todo management subsystem SHALL deny the action and present an authorization message without exposing other users’ data.\n- WHEN a user edits fields of a todo, THE todo management subsystem SHALL apply the changes immediately if all validations pass and SHALL update the last-updated indicator.\n- WHEN a user marks an active todo as complete, THE todo management subsystem SHALL update its state to \"completed\" and display the completion timestamp according to the user’s time zone.\n- IF a user attempts to complete a todo already in \"completed\" state, THEN THE todo management subsystem SHALL inform that the item is already completed and SHALL not change state.\n- WHEN a user reopens a completed todo, THE todo management subsystem SHALL return it to the \"active\" state and clear any derived completion indicators while preserving historical metadata as defined in the business rules.\n- WHEN a user deletes their own todo, THE todo management subsystem SHALL remove it from the user’s list permanently for MVP scope.\n- WHERE an admin performs moderation, THE administrative process SHALL not alter user todo content except when enforcing policy; any such action SHALL be auditable according to the role specification.\n\n## Error and Recovery Flow\n\n### Diagram: Error Categories and Recovery Paths\n\n```mermaid\ngraph LR\n  subgraph \"Operation Context\"\n    U1[\"Attempt Operation\"] --> D1{\"Auth Error?\"}\n  end\n\n  subgraph \"Authentication/Authorization\"\n    D1 -->|\"Yes\"| A1[\"Show Auth Message\"]\n    A1 --> A2{\"User Intends to Recover?\"}\n    A2 -->|\"Yes\"| A3[\"Prompt Login or Verify Email\"]\n    A2 -->|\"No\"| A4[\"Abort Operation\"]\n  end\n\n  subgraph \"Validation\"\n    D1 -->|\"No\"| D2{\"Validation Error?\"}\n    D2 -->|\"Yes\"| V1[\"Show Field Guidance\"]\n    V1 --> V2{\"Can Retry Immediately?\"}\n    V2 -->|\"Yes\"| V3[\"Allow Correction and Resubmission\"]\n    V2 -->|\"No\"| V4[\"Provide Instructions\"]\n  end\n\n  subgraph \"Not Found / Conflict\"\n    D2 -->|\"No\"| D3{\"Not Found?\"}\n    D3 -->|\"Yes\"| N1[\"Inform Missing Resource\"]\n    D3 -->|\"No\"| D4{\"Conflict?\"}\n    D4 -->|\"Yes\"| C1[\"Inform Concurrent Update\"]\n    C1 --> C2[\"Offer Refresh or Retry\"]\n  end\n\n  subgraph \"Rate Limit / Service Unavailable\"\n    D4 -->|\"No\"| D5{\"Rate Limited?\"}\n    D5 -->|\"Yes\"| R1[\"Show Wait Guidance\"]\n    D5 -->|\"No\"| D6{\"Service Unavailable?\"}\n    D6 -->|\"Yes\"| S1[\"Show Retry Later Guidance\"]\n    D6 -->|\"No\"| S2[\"Proceed to Success\"]\n  end\n```\n\n### EARS Requirements — Error and Recovery\n\n- WHEN an action requires authentication and the user is not authenticated, THE system SHALL present a message to log in or verify and SHALL not proceed with the action.\n- IF a form submission contains invalid fields, THEN THE system SHALL highlight the specific fields and provide actionable guidance for correction.\n- WHEN a missing resource is referenced (e.g., deleted or non-existent todo), THE system SHALL inform the absence without exposing whether the resource ever existed for other users.\n- IF a concurrency conflict occurs due to simultaneous updates, THEN THE system SHALL prevent data loss by rejecting the later change and SHALL offer a path to refresh and retry.\n- WHEN a user exceeds allowed operation frequency, THE system SHALL inform that the rate limit has been reached and SHALL advise when to try again.\n- IF a transient service disruption prevents completing an action, THEN THE system SHALL inform the user and encourage retry after a short interval without blaming user input.\n- WHERE an account is suspended due to policy, THE system SHALL block protected actions and present suspension information upon next sign-in attempt.\n\n## State Model for Todo Items\n\n### Diagram: States and Transitions (Business-Level)\n\n```mermaid\ngraph LR\n  S0[\"Nonexistent\"] -->|\"Create\"| S1[\"Active\"]\n  S1 -->|\"Update Fields\"| S1\n  S1 -->|\"Complete\"| S2[\"Completed\"]\n  S2 -->|\"Reopen\"| S1\n  S1 -->|\"Delete\"| S3[\"Deleted(Permanent)\"]\n  S2 -->|\"Delete\"| S3\n```\n\n### EARS Requirements — State Model\n\n- THE todo item lifecycle SHALL consist of \"active\", \"completed\", and \"deleted\" states for MVP.\n- WHEN a todo is created successfully, THE lifecycle SHALL enter the \"active\" state.\n- WHEN a todo is marked complete from the \"active\" state, THE lifecycle SHALL transition to \"completed\" without modifying non-edited fields.\n- WHEN a completed todo is reopened, THE lifecycle SHALL transition back to \"active\" and clear completion-specific indicators while keeping other fields intact.\n- WHEN a todo is deleted, THE lifecycle SHALL transition to \"deleted\" and SHALL not be available in the user’s list thereafter for MVP.\n\n## Narrative Descriptions of Each Flow\n\n### Authentication Flow Narrative\n\n- Registration and Verification\n  - Trigger: A person attempts to create an account with an email and password.\n  - Decision: If the email is already in use, the registration is rejected and guidance is provided to try another email. Otherwise, the account is created in a pending verification state, and a verification message is sent.\n  - Outcome: On clicking a valid verification link, the account becomes verified and eligible for login.\n  - Non-disclosure: Do not reveal whether a specific email exists to unauthorized parties.\n  - Resend: If the verification link expires, a resend request is available within policy limits.\n\n- Login and Session Establishment\n  - Trigger: A verified user enters credentials.\n  - Decision: If credentials are invalid or the account is unverified, the login is denied with appropriate guidance. Otherwise, a session is established.\n  - Outcome: The user reaches the authenticated state capable of performing todo operations.\n  - Protection: Repeated failed attempts are throttled with clear recovery guidance.\n\n- Password Reset\n  - Request: Any person may initiate a reset request by providing an email; confirmation messaging does not disclose account existence.\n  - Completion: A person opening a valid reset link provides a new password that meets policy, resulting in session revocation and the ability to log in immediately.\n  - Recovery: Invalid or expired reset links result in guidance to request a new link.\n\n- Logout\n  - Trigger: A logged-in user initiates logout.\n  - Outcome: The active session is terminated immediately and the user returns to a non-authenticated state.\n\n- Admin Support Notes\n  - Admins can enforce policies such as locking accounts or re-triggering verification within the constraints and audit expectations defined in the role specification.\n\n### Todo Item Lifecycle Narrative\n\n- Create\n  - Trigger: An authenticated user initiates creation.\n  - Validation: Title must be present and within allowed length; optional description and due date, when provided, must meet length and format rules.\n  - Outcome: A new todo is created in the active state and appears in the user’s list.\n\n- Read\n  - Trigger: A user lists or views their todos.\n  - Authorization: Items are only visible to their owner. Admin oversight of content, when necessary for policy enforcement, is controlled and auditable.\n\n- Update\n  - Trigger: A user edits fields of their own todo.\n  - Decision: If the item is not owned by the user, the operation is denied. If the item is in a state that disallows the requested change (as per business rules), the operation is denied with guidance. Otherwise, the update is applied and the last-updated indicator changes.\n\n- Complete\n  - Trigger: A user marks an active todo as complete.\n  - Decision: If already completed, the operation is rejected with guidance.\n  - Outcome: Item moves to completed state; completion timestamp is recorded for display based on the user’s time zone.\n\n- Reopen\n  - Trigger: A user reopens a completed item.\n  - Outcome: Item moves back to active state; completion-specific indicators are cleared while preserving other details.\n\n- Delete\n  - Trigger: A user deletes their own item.\n  - Outcome: Item is permanently removed from the user’s list for MVP. Future phases may introduce trash/restore according to the business rules document versioning.\n\n### Error and Recovery Narrative\n\n- Authentication and Authorization Errors\n  - Scenario: User attempts actions requiring authentication or proper authorization.\n  - Response: The system blocks the action and presents clear next steps: log in, verify email, or request access as appropriate. No sensitive details are disclosed.\n\n- Validation Errors\n  - Scenario: User submissions fail validations (e.g., missing title, invalid due date format, overly long text fields).\n  - Response: The system identifies specific fields and provides actionable guidance to correct and resubmit while preserving valid inputs.\n\n- Not Found\n  - Scenario: A referenced todo does not exist or is no longer available.\n  - Response: The system informs that the resource is unavailable without exposing historical existence for other users.\n\n- Conflict (Concurrent Updates)\n  - Scenario: Two edits occur to the same todo in close succession.\n  - Response: The system prevents overwriting by rejecting the later change, guiding the user to refresh and retry; options for reconcile/overwrite/discard are governed by the error handling policy.\n\n- Rate Limit\n  - Scenario: Excessive operations in a short period (e.g., repeated create/delete).\n  - Response: The system asks the user to slow down and to try again after a provided interval, describing the applicable limit window in user terms.\n\n- Service Unavailable\n  - Scenario: Temporary outage or degraded service prevents operation completion.\n  - Response: The system encourages retry after a short interval and provides reassurance without implying user error; user-entered data is preserved when feasible for later submission.\n\n## Additional EARS Requirements Spanning Flows\n\n- WHILE a user is authenticated, THE system SHALL maintain a valid session and reflect authorization according to the role’s business permissions.\n- WHERE the actor is \"admin\", THE system SHALL allow actions aligned with oversight and policy enforcement while maintaining auditability and minimal data exposure.\n- WHEN business limits are exceeded (such as rate limits), THE system SHALL communicate the limit and the time window for retry in user terms.\n- WHEN time-sensitive information is presented (such as due dates and completion timestamps), THE system SHALL align display and interpretation with the user’s configured time zone and locale rules defined in the functional specification.\n- WHEN a user signs out voluntarily or due to security action, THE system SHALL invalidate the current session and require re-authentication for protected actions.\n- IF an account is suspended for policy reasons, THEN THE system SHALL block protected actions and present suspension messaging at the next sign-in attempt.\n\n## Traceability and References\n\n- Authentication details and lifecycle expectations: [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n- Feature-level behaviors and validations: [Functional Requirements (MVP)](./03-todoApp-functional-requirements.md).\n- Error handling categories and user-facing guidance: [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md).\n\nEnd of document.","tokenUsage":{"total":75147,"input":{"total":67179,"cached":0},"output":{"total":7968,"reasoning":2304,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":6,"step":0,"created_at":"2025-08-15T04:01:05.677Z"},"tokenUsage":{"aggregate":{"total":702486,"input":{"total":585419,"cached":11648},"output":{"total":117067,"reasoning":42752,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":699702,"input":{"total":583082,"cached":11648},"output":{"total":116620,"reasoning":42368,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Define complete authentication behaviors, role hierarchy, and permissions so access rules are unambiguous from a business perspective.","filename":"02-todoApp-user-roles-and-authentication.md","documentType":"requirement","outline":["Purpose and Scope","Authentication Requirements","Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)","User Role Structure","Role Definitions and Capabilities","Permission Matrix (actions by role)","Session and Token Management (business rules for token lifetimes and refresh)","Access Control Rules and Examples (EARS format)","Account Lifecycle (creation, verification, suspension, deletion)","Security and Privacy Considerations","Audit and Activity Logging (business expectations)"],"audience":"development team","keyQuestions":["What roles exist and what can each do?","What authentication features are available to users?","How are sessions and tokens managed from a business standpoint?","What are the access control rules and edge cases?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Include a clear permission matrix table by role","Write all applicable requirements in EARS format","Describe token management in business terms without API-level specifications","Do not include API endpoints, database schema, or technical architecture"],"content":"# todoApp User Roles and Authentication Requirements\n\nThis document defines business requirements only for authentication, authorization, and account lifecycle in the todoApp service. It specifies WHAT the system must do from a business perspective, not HOW to build it. All technical implementation decisions (architecture, APIs, database design, storage mechanisms) are at the discretion of the development team.\n\n## Purpose and Scope\n- Define complete authentication behaviors, role hierarchy, and permissions so access rules are unambiguous from a business perspective.\n- Establish session and token management principles, including lifetimes, rotation, and revocation.\n- Specify account lifecycle stages and business outcomes.\n- Provide EARS-formatted, testable requirements for core auth flows and access control.\n- Exclude technical implementation details such as API endpoints, database schemas, or infrastructure choices.\n\n## Authentication Requirements\n- The service must support email and password–based authentication for end users.\n- Email verification is required to establish account ownership and enable certain sensitive actions.\n- Sessions are represented by tokens issued upon successful authentication and renewed via refresh logic according to business rules defined in this document.\n- The system must prevent unauthorized access to user-owned resources (e.g., personal todo items and account settings) and ensure administrators can perform support and policy enforcement actions under strict accountability.\n\n### Visual Overview of Core Authentication Flows\n\n```mermaid\ngraph LR\n  subgraph \"Registration and Verification\"\n    A1[\"User Submits Registration(Email, Password)\"] --> A2[\"Validate Input(Format, Policy)\"]\n    A2 --> A3{\"Valid?\"}\n    A3 -->|\"Yes\"| A4[\"Create Account(Pending Verification)\"]\n    A3 -->|\"No\"| A5[\"Inform Validation Errors\"]\n    A4 --> A6[\"Send Verification Email(Link, 24h Expiry)\"]\n    A6 --> A7[\"User Clicks Verification Link\"]\n    A7 --> A8{\"Token Valid and Not Expired?\"}\n    A8 -->|\"Yes\"| A9[\"Mark Email Verified\"]\n    A8 -->|\"No\"| A10[\"Inform Link Invalid or Expired\"]\n  end\n\n  subgraph \"Login and Session Management\"\n    B1[\"User Submits Login(Email, Password)\"] --> B2[\"Validate Credentials\"]\n    B2 --> B3{\"Successful?\"}\n    B3 -->|\"Yes\"| B4[\"Issue Access Token(20m)\"]\n    B3 -->|\"Yes\"| B5[\"Issue Refresh Token(14d, Rotating)\"]\n    B3 -->|\"No\"| B6[\"Increment Failure Counter and Inform\"]\n    B4 --> B7[\"Authorized Access to Own Resources\"]\n    B5 -.-> B8[\"Refresh Flow: Rotate Refresh Token\"]\n    B8 -.-> B4\n  end\n```\n\n## Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)\nAll applicable requirements are expressed using EARS format.\n\n### Registration\n- WHEN 사용자가 등록 정보를 제출할 때(이메일, 비밀번호), THE todoApp SHALL 입력 형식을 검증하고 비밀번호 정책을 적용한다.\n- IF 입력이 정책에 부합하지 않을 때, THEN THE todoApp SHALL 구체적 검증 실패 사유를 사용자에게 알린다(민감 정보 노출 없이).\n- WHEN 등록이 유효할 때, THE todoApp SHALL 계정을 생성하고 이메일 검증 상태를 미검증으로 설정한다.\n- WHEN 계정이 생성될 때, THE todoApp SHALL 검증 링크가 포함된 이메일을 발송한다.\n- THE todoApp SHALL 검증 링크의 유효기간을 24시간으로 제한한다.\n- WHERE 검증 링크가 만료되었을 때, THE todoApp SHALL 재전송 요청을 허용하되 24시간 내 최대 3회로 제한한다.\n\n### Login\n- WHEN 사용자가 이메일과 비밀번호로 로그인할 때, THE todoApp SHALL 자격 증명을 검증하고 2초 이내에 성공 또는 실패 결과를 제공한다.\n- IF 자격 증명이 유효할 때, THEN THE todoApp SHALL 액세스 토큰(유효기간 20분)과 리프레시 토큰(유효기간 14일, 회전 방식)을 발급한다.\n- IF 자격 증명이 유효하지 않을 때, THEN THE todoApp SHALL 구체적 필드가 아닌 일반적인 실패 메시지를 제공한다.\n- WHILE 계정이 잠금 상태일 때(보안 정책에 의해), THE todoApp SHALL 로그인을 거부하고 잠금 해제 시간 또는 절차를 안내한다.\n\n### Logout\n- WHEN 사용자가 로그아웃을 요청할 때, THE todoApp SHALL 현재 세션의 액세스를 즉시 무효화한다.\n- WHERE 사용자가 모든 기기에서 로그아웃을 선택할 때, THE todoApp SHALL 해당 사용자의 모든 활성 세션과 리프레시 토큰을 즉시 폐기한다.\n\n### Email Verification\n- WHEN 사용자가 검증 링크를 클릭할 때, THE todoApp SHALL 링크의 유효성 및 만료 여부를 확인한다.\n- IF 링크가 유효하고 만료 전일 때, THEN THE todoApp SHALL 이메일을 검증 상태로 갱신한다.\n- IF 링크가 유효하지 않거나 만료되었을 때, THEN THE todoApp SHALL 검증 실패 사실과 재전송 절차를 안내한다.\n\n### Reset Password\n- WHEN 사용자가 비밀번호 재설정을 요청할 때(이메일 제공), THE todoApp SHALL 존재 여부를 노출하지 않는 표준 응답을 제공한다.\n- WHEN 재설정 링크를 발송할 때, THE todoApp SHALL 60초 이내에 이메일 전송을 시도한다.\n- THE todoApp SHALL 재설정 링크의 유효기간을 1시간으로 제한한다.\n- IF 재설정 토큰이 유효하고 만료 전일 때, THEN THE todoApp SHALL 새 비밀번호 정책을 검증하고 성공 시 모든 기존 세션을 폐기한다(현재 기기 유지 옵션 제공).\n\n### Change Password (Authenticated)\n- WHEN 인증된 사용자가 비밀번호 변경을 요청할 때, THE todoApp SHALL 현재 비밀번호와 새 비밀번호 정책을 검증한다.\n- IF 검증이 성공할 때, THEN THE todoApp SHALL 새 비밀번호로 갱신하고 기존 기기들의 세션을 모두 폐기하되 현재 기기는 유지할 수 있는 옵션을 제공한다.\n\n### Revoke Sessions\n- WHEN 사용자가 \"모든 세션 해지\"를 수행할 때, THE todoApp SHALL 해당 사용자의 모든 활성 액세스 토큰과 리프레시 토큰을 즉시 무효화한다.\n- WHEN 관리자가 특정 사용자의 세션 해지를 수행할 때, THE todoApp SHALL 즉시 모든 세션을 폐기하고 사용자에게 보안 알림을 제공한다(알림 수단은 환경에 따라 선택된다).\n\n## User Role Structure\n- Roles in scope: user, admin.\n- Role hierarchy: admin supersedes user in privilege but remains bound by accountability, privacy, and least-privilege business rules.\n- Non-authenticated state: unauthenticated user (guest) is not a role but a state with no access to protected resources.\n\n## Role Definitions and Capabilities\n\n### user\n- Primary audience: authenticated end user who manages only their own todo items and account.\n- Can: create, read, update, complete, and delete personal tasks; manage own account; view and revoke own sessions; export own data; delete own account subject to retention policy; request password reset; change password; verify email.\n- Cannot: access or modify any other user’s data or sessions; view audit logs; view aggregated analytics; change service-wide settings; assign roles.\n- JWT payload (business-level claims): userId, role=\"user\", permissions=[\"todo:own:read\",\"todo:own:write\",\"account:own:manage\",\"session:own:manage\",\"export:own\"].\n\n### admin\n- Primary audience: administrative user with authority to oversee the service for support and policy enforcement.\n- Can: suspend/reactivate user accounts with reason; reset user sessions; assist with account recovery through approved flows; access aggregated analytics; access audit trails; configure service-wide settings within policy; perform data export for a user upon verified lawful request.\n- Cannot: view or retrieve user passwords; access user content beyond what is necessary for support/policy enforcement and only under explicit justification; impersonate users without approved process.\n- JWT payload (business-level claims): userId, role=\"admin\", permissions=[\"user:any:manage\",\"session:any:manage\",\"analytics:aggregate:view\",\"audit:trail:view\",\"settings:service:manage\"].\n\n## Permission Matrix (actions by role)\nNote: \"Unauthenticated\" represents a state, not a role.\n\n| Action | Unauthenticated | user | admin |\n|-------|------------------|------|-------|\n| Register account | ✅ | ❌ | ❌ |\n| Login | ✅ | ❌ | ❌ |\n| Verify email | ✅ (via link) | ✅ | ✅ (support resend) |\n| View own todos | ❌ | ✅ | ✅ (only for support with justification) |\n| Create/update/delete own todos | ❌ | ✅ | ✅ (only for support with justification) |\n| View another user’s todos | ❌ | ❌ | ❌ (unless authorized support action) |\n| View own profile/account | ❌ | ✅ | ✅ |\n| Update own profile/account | ❌ | ✅ | ✅ (only for support with authorization) |\n| Change own password | ❌ | ✅ | ✅ |\n| Request password reset | ✅ | ✅ | ✅ (on behalf of user) |\n| List own sessions | ❌ | ✅ | ✅ |\n| Revoke own sessions | ❌ | ✅ | ✅ |\n| Revoke another user’s sessions | ❌ | ❌ | ✅ |\n| Suspend/reactivate user account | ❌ | ❌ | ✅ |\n| Delete own account | ❌ | ✅ | ✅ (upon lawful request) |\n| Access aggregated analytics | ❌ | ❌ | ✅ |\n| Access audit logs | ❌ | ❌ | ✅ |\n| Configure service-wide settings | ❌ | ❌ | ✅ |\n\n## Session and Token Management (business rules for token lifetimes and refresh)\n- THE todoApp SHALL use JWT for access and refresh tokens.\n- THE todoApp SHALL issue access tokens with a validity of 20 minutes.\n- THE todoApp SHALL issue refresh tokens with a validity of 14 days.\n- THE todoApp SHALL rotate refresh tokens upon each successful refresh and immediately invalidate the prior refresh token.\n- THE todoApp SHALL bind each session to a logical device/session identifier to enable session listing and revocation.\n- WHERE a user changes password, THE todoApp SHALL revoke all existing sessions and refresh tokens, with an option to preserve the current device session only when explicitly chosen by the user.\n- WHERE an administrator forces a password reset or security hold, THE todoApp SHALL revoke all sessions for that user without exception.\n- THE todoApp SHALL limit concurrent active sessions per user to 10; attempts to create the 11th session SHALL require the user to revoke at least one existing session or accept automatic revocation of the oldest idle session.\n- THE todoApp SHALL provide session metadata to the user for each session: creation time, last activity time, device label where available, and approximate location derived from coarse signals where permitted by policy.\n- THE todoApp SHALL treat token storage location as a technical decision of the development team and require that storage be secure and resistant to common attacks appropriate to the platform; preference for httpOnly cookies on the web is recommended at the policy level.\n- THE todoApp SHALL include in JWT payload at minimum: userId, role, and permissions array necessary for authorization decisions.\n\n## Access Control Rules and Examples (EARS format)\n- THE todoApp SHALL enforce least privilege so that users access only resources they own unless an administrative support action is justified and recorded.\n- WHEN 인증되지 않은 주체가 보호된 리소스에 접근하려 할 때, THE todoApp SHALL 접근을 거부하고 인증 절차를 안내한다.\n- WHEN 사용자가 다른 사용자의 리소스를 조회, 변경, 삭제하려 할 때, THE todoApp SHALL 접근을 거부한다.\n- WHEN 관리자가 사용자 계정 정지(또는 재활성화)를 수행할 때, THE todoApp SHALL 사유와 근거를 기록하고 해당 사용자에게 알림을 제공한다.\n- WHEN 관리자가 사용자 데이터를 열람해야 하는 지원 상황일 때, THE todoApp SHALL 승인된 프로세스 내에서 최소한의 범위로 접근을 허용하고 모든 활동을 감사 로그에 기록한다.\n- IF 이메일이 미검증 상태일 때, THEN THE todoApp SHALL 민감 기능(예: 데이터 내보내기, 계정 삭제)을 제한하고 검증 절차를 우선 안내한다.\n- WHERE 정책상 비정상 활동이 감지될 때(예: 다수 실패 로그인), THE todoApp SHALL 추가 인증 절차 또는 일시적 제한을 적용한다.\n\n## Account Lifecycle (creation, verification, suspension, deletion)\n\n### Creation\n- WHEN 계정을 생성할 때, THE todoApp SHALL 이메일을 유일 식별자로 사용하고 비밀번호 정책을 강제한다.\n- THE todoApp SHALL 허용 가능한 등록 시도 빈도를 제한하여 자동화된 남용을 방지한다(예: 동일 IP 또는 이메일 도메인 기준의 정책적 제한).\n\n### Verification\n- THE todoApp SHALL 요구되는 경우에 한해 검증 링크 재전송을 허용하되 24시간 내 3회로 제한한다.\n- IF 검증이 7일 내 완료되지 않을 때, THEN THE todoApp SHALL 다음 로그인 시 검증을 우선 수행하도록 요구한다.\n\n### Suspension\n- WHEN 사용자가 자발적 비활성화를 요청할 때, THE todoApp SHALL 로그인을 제한하고 데이터 보존 정책에 따라 복귀 가능 상태로 전환한다.\n- WHEN 관리자가 정책 위반으로 계정을 정지할 때, THE todoApp SHALL 모든 세션을 즉시 종료하고 정지 사유, 시작 시각, 재검토 일정을 기록한다.\n\n### Deletion\n- WHEN 사용자가 계정 삭제를 확인할 때, THE todoApp SHALL 30일 유예 기간(철회 가능)을 적용하고 이후 영구 삭제한다.\n- WHILE 유예 기간 동안, THE todoApp SHALL 로그인 시 삭제 철회 옵션을 제공한다.\n- IF 법적 보존 의무가 있는 데이터가 존재할 때, THEN THE todoApp SHALL 해당 데이터의 삭제를 보류하고 사유를 사용자에게 고지한다(허용 범위 내).\n\n## Security and Privacy Considerations\n\n### Password Policy\n- THE todoApp SHALL require minimum password length of 12 characters.\n- THE todoApp SHALL require at least three of the following: uppercase letters, lowercase letters, numbers, special characters.\n- THE todoApp SHALL prevent use of commonly compromised passwords using a banned list.\n- THE todoApp SHALL prevent reuse of the previous 5 passwords.\n\n### Rate Limiting and Lockouts\n- THE todoApp SHALL allow up to 5 consecutive failed login attempts before imposing a 5-minute cooldown.\n- IF 10 consecutive failures occur within 30 minutes, THEN THE todoApp SHALL temporarily lock the account for 15 minutes and notify the user of unusual activity.\n- THE todoApp SHALL throttle password reset requests to a maximum of 5 per 24 hours per account.\n\n### Privacy by Design\n- THE todoApp SHALL avoid revealing whether an email is registered in responses to registration and password reset requests.\n- THE todoApp SHALL record audit events without storing sensitive secrets (e.g., no plaintext passwords, no full tokens in logs).\n- THE todoApp SHALL store audit timestamps in UTC while displaying times to users in their locale settings where applicable.\n\n### Notifications and Messaging\n- THE todoApp SHALL send verification and reset emails within 60 seconds under normal operating conditions.\n- THE todoApp SHALL ensure messages avoid including sensitive data and provide clear next steps for recovery.\n\n### Administrative Safeguards\n- THE todoApp SHALL require admins to provide a reason when performing user-impacting actions (suspension, session revocation, role modification).\n- THE todoApp SHALL restrict access to aggregated analytics to admins only and ensure data is de-identified at the individual level.\n\n## Audit and Activity Logging (business expectations)\n- THE todoApp SHALL record the following event categories at minimum: registration, email verification, login success/failure, logout, password reset request, password reset completion, password change, session creation, session refresh, session revocation, account suspension/reactivation, account deletion request, account deletion completion, admin configuration changes, elevated data access by admin.\n- WHEN 감사 이벤트가 기록될 때, THE todoApp SHALL 포함 정보로 이벤트 유형, 주체(사용자 또는 관리자), 타임스탬프(UTC), 대상(해당 시), 결과(성공/실패), 사유(해당 시)를 저장한다.\n- WHERE 관리자가 사용자 데이터에 접근하는 경우, THE todoApp SHALL 해당 이벤트를 고위험으로 분류하고 별도 검토 큐에 포함한다.\n- THE todoApp SHALL provide users with access to their own audit history for security-relevant actions (e.g., logins, password changes, session revocations).\n\n## Related Documents\n- For service vision and business model, see the [Service Overview for todoApp](./01-todoApp-service-overview.md).\n- For end-to-end feature behaviors, see the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md).\n- For detailed failure behaviors and recovery, see the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md).\n- For performance, availability, and privacy expectations, see the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md).\n\n---\n\n## Appendix: Additional EARS Examples for Edge Cases\n- IF 비밀번호 재설정 토큰이 이미 사용되었을 때, THEN THE todoApp SHALL 해당 토큰을 무효로 처리하고 재요청 절차를 안내한다.\n- IF 동일한 기기에서 비정상적인 세션 갱신 빈도가 관찰될 때, THEN THE todoApp SHALL 세션을 강제로 종료하고 재인증을 요구한다.\n- WHERE 사용자가 장치 라벨을 제공하는 기능을 사용 중일 때, THE todoApp SHALL 세션 목록에 라벨을 함께 표시한다.\n- WHEN 삭제 유예 기간이 종료될 때, THE todoApp SHALL 영구 삭제를 수행하고 사용자에게 결과를 통지한다.\n- WHILE 계정이 정지 상태일 때, THE todoApp SHALL 로그인 및 데이터 접근을 차단하고 정지 사유와 재검토 일정을 안내한다.\n"},"plan":"Follow the provided outline as the skeleton: Purpose and Scope; Authentication Requirements (convert to EARS); Visual Flow (Mermaid, LR); Core Authentication Functions in EARS; User Role Structure; Role Definitions/Capabilities; Permission Matrix; Session and Token Management (JWT, lifetimes, rotation, re‑auth for sensitive actions, concurrency limits); Access Control Rules in EARS with examples; Account Lifecycle (creation, verification, suspension, deletion) aligned with data lifecycle; Security and Privacy Considerations (password policy, rate limits, privacy by design, notifications, admin safeguards) aligned with NFR; Audit and Activity Logging expectations; Related Documents; Appendix with additional EARS edge cases. Ensure all sections are expanded, consistent, and fully in en‑US.","review":"Enhance to a complete, implementation‑ready business requirements document in en‑US with strict EARS usage for all applicable requirements; ensure consistency with related documents. Fix Mermaid diagrams to comply with mandatory rules: all labels in double quotes, no spaces between brackets/braces and quotes, proper arrows (-->), LR orientation. Enforce clarity, measurability, and testability: include response time expectations only in business terms where relevant, avoid API/database/architecture details. Include comprehensive authentication workflows, role hierarchy, permissions, permission matrix, token/session management (JWT required), account lifecycle, security/privacy, and audit logging. Align cross‑document policies: password policy (minimum 8 chars, ban common passwords, passphrase‑friendly), login lockout (10 failures/10 minutes → 5‑minute cooldown), refresh token lifetime 30 days to match session expectations, account deletion grace 14 days. Translate all non‑English text to en‑US. Keep links descriptive with relative paths. No developer notes except in 00‑toc (not applicable here).","content":"# todoApp User Roles and Authentication Requirements\n\nBusiness requirements only. Technical implementation decisions (architecture, APIs, database design, storage, libraries) belong to the development team. Content specifies WHAT the service must do in business terms.\n\n## Purpose and Scope\n- Define authentication behaviors, role hierarchy, and permissions so access rules are unambiguous in business terms.\n- Establish session and token management principles, including lifetimes, rotation, revocation, re‑authentication for sensitive actions, and session listing.\n- Specify account lifecycle stages and expected business outcomes (creation, verification, suspension, deletion and restoration windows).\n- Provide EARS‑formatted, testable requirements for core auth flows and access control.\n- Exclude technical implementation details such as API endpoints, database schemas, or infrastructure choices.\n\n## Authentication Requirements (EARS)\n- THE todoApp SHALL support end‑user authentication with email and password.\n- THE todoApp SHALL require email verification to unlock sensitive account actions and data export.\n- WHEN a person authenticates successfully, THE todoApp SHALL establish a session represented by issued tokens according to token management rules.\n- WHEN a subject without a valid session attempts to access protected resources, THE todoApp SHALL deny access and guide the subject to sign in or verify email as applicable.\n- WHEN administrative assistance is necessary, THE todoApp SHALL allow authorized administrators to perform limited support actions under least‑privilege and full audit.\n\n### Visual Overview of Core Authentication Flows\n```mermaid\ngraph LR\n  subgraph \"Registration and Verification\"\n    A1[\"User Submits Registration(Email, Password)\"] --> A2[\"Validate Input(Format, Policy)\"]\n    A2 --> A3{\"Valid?\"}\n    A3 -->|\"Yes\"| A4[\"Create Account(Pending Verification)\"]\n    A3 -->|\"No\"| A5[\"Inform Validation Errors\"]\n    A4 --> A6[\"Send Verification Email(Link, 24h Expiry)\"]\n    A6 --> A7[\"User Clicks Verification Link\"]\n    A7 --> A8{\"Token Valid and Not Expired?\"}\n    A8 -->|\"Yes\"| A9[\"Mark Email Verified\"]\n    A8 -->|\"No\"| A10[\"Inform Link Invalid or Expired\"]\n  end\n\n  subgraph \"Login and Session Management\"\n    B1[\"User Submits Login(Email, Password)\"] --> B2[\"Validate Credentials\"]\n    B2 --> B3{\"Successful?\"}\n    B3 -->|\"Yes\"| B4[\"Issue Access Token(20m)\"]\n    B3 -->|\"Yes\"| B5[\"Issue Refresh Token(30d, Rotating)\"]\n    B3 -->|\"No\"| B6[\"Increment Failure Counter and Inform\"]\n    B4 --> B7[\"Authorized Access to Own Resources\"]\n    B5 -.-> B8[\"Refresh Flow: Rotate Refresh Token\"]\n    B8 -.-> B4\n  end\n```\n\n## Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)\nAll applicable requirements use EARS.\n\n### Registration\n- WHEN a person submits registration details (email, password), THE todoApp SHALL validate format and enforce password policy.\n- IF registration input violates policy, THEN THE todoApp SHALL present the specific validation reason without exposing sensitive checks.\n- WHEN registration is valid, THE todoApp SHALL create the account in unverified status.\n- WHEN an account is created, THE todoApp SHALL send a verification message containing a time‑limited link.\n- THE todoApp SHALL set verification link validity to 24 hours from issuance.\n- WHERE a verification link expires, THE todoApp SHALL allow resend requests up to 3 times within 24 hours.\n\n### Login\n- WHEN a person submits email and password, THE todoApp SHALL validate credentials and provide success or failure within 2 seconds perceived by the user.\n- IF credentials are valid and the account is eligible, THEN THE todoApp SHALL issue an access token (valid 20 minutes) and a refresh token (valid 30 days, rotating on use).\n- IF credentials are invalid, THEN THE todoApp SHALL present a generic failure message that does not disclose which field failed and SHALL encourage secure recovery.\n- WHILE an account is locked under security policy, THE todoApp SHALL deny login and present the unlock time or procedure.\n\n### Logout\n- WHEN a signed‑in user requests logout, THE todoApp SHALL immediately invalidate the active session for that device.\n- WHERE a user chooses “log out from all devices”, THE todoApp SHALL immediately revoke all active sessions and refresh tokens for that user.\n\n### Email Verification\n- WHEN a person clicks a verification link, THE todoApp SHALL validate token integrity and expiry.\n- IF the link is valid and not expired, THEN THE todoApp SHALL mark the account email as verified.\n- IF the link is invalid or expired, THEN THE todoApp SHALL inform verification failure and provide a resend path.\n\n### Reset Password\n- WHEN a person requests password reset by providing an email, THE todoApp SHALL return a standard confirmation that does not disclose whether the email is registered.\n- WHEN reset instructions are dispatched, THE todoApp SHALL attempt delivery within 60 seconds under normal conditions.\n- THE todoApp SHALL limit password reset link validity to 1 hour from issuance.\n- IF a reset token is valid and unexpired, THEN THE todoApp SHALL enforce the current password policy on the new password and, on success, SHALL revoke all existing sessions with an option to preserve the current device session at the user’s choice.\n\n### Change Password (Authenticated)\n- WHEN a signed‑in user requests a password change, THE todoApp SHALL validate the current password and the new password against policy.\n- IF validation succeeds, THEN THE todoApp SHALL update the password and revoke existing device sessions with an option to preserve the current device session at the user’s choice.\n\n### Revoke Sessions\n- WHEN a user performs “revoke all sessions”, THE todoApp SHALL immediately invalidate all active access and refresh tokens for that user.\n- WHEN an administrator revokes a specific user’s sessions for safety or policy reasons, THE todoApp SHALL immediately invalidate all of that user’s sessions and notify the user through an approved communication channel.\n\n## User Role Structure\n- Roles in scope: user, admin.\n- Role hierarchy: admin has elevated privileges relative to user but remains bound by accountability, privacy, and least‑privilege rules.\n- Unauthenticated: a state (guest) with no access to protected resources; not a role.\n\n## Role Definitions and Capabilities\n\n### user\n- Purpose: authenticated end user managing only their own todo items and account.\n- Can: create, read, update, complete, and delete personal items; manage own profile and security; list and revoke own sessions; export own data; delete own account subject to lifecycle policy; request password reset; change password; verify email.\n- Cannot: access or modify other users’ data or sessions; view audit logs; view aggregated analytics; change service‑wide settings; assign roles.\n- Business‑level JWT claims: userId; role=\"user\"; permissions=[\"todo:own:read\", \"todo:own:write\", \"account:own:manage\", \"session:own:manage\", \"export:own\"].\n\n### admin\n- Purpose: administrative user performing oversight for support and policy enforcement.\n- Can: suspend or reactivate user accounts with recorded reason; revoke user sessions; assist with account recovery via approved flows; access aggregated analytics; access audit trails; configure service‑wide settings within policy; trigger user data export upon verified lawful request.\n- Cannot: view or retrieve user passwords; access user content beyond the minimum necessary for support/policy enforcement without explicit justification; impersonate users without an approved process.\n- Business‑level JWT claims: userId; role=\"admin\"; permissions=[\"user:any:manage\", \"session:any:manage\", \"analytics:aggregate:view\", \"audit:trail:view\", \"settings:service:manage\"].\n\n## Permission Matrix (actions by role)\nNote: “Unauthenticated” is a state, not a role.\n\n| Action | Unauthenticated | user | admin |\n|-------|------------------|------|-------|\n| Register account | ✅ | ❌ | ❌ |\n| Login | ✅ | ❌ | ❌ |\n| Verify email | ✅ (via link) | ✅ | ✅ (resend support) |\n| View own todos | ❌ | ✅ | ✅ (for support with justification) |\n| Create/update/delete own todos | ❌ | ✅ | ✅ (for support with justification) |\n| View another user’s todos | ❌ | ❌ | ❌ (unless authorized support action) |\n| View own profile/account | ❌ | ✅ | ✅ |\n| Update own profile/account | ❌ | ✅ | ✅ (for support with authorization) |\n| Change own password | ❌ | ✅ | ✅ |\n| Request password reset | ✅ | ✅ | ✅ (on behalf of user) |\n| List own sessions | ❌ | ✅ | ✅ |\n| Revoke own sessions | ❌ | ✅ | ✅ |\n| Revoke another user’s sessions | ❌ | ❌ | ✅ |\n| Suspend/reactivate user account | ❌ | ❌ | ✅ |\n| Delete own account | ❌ | ✅ | ✅ (upon lawful request) |\n| Access aggregated analytics | ❌ | ❌ | ✅ |\n| Access audit logs | ❌ | ❌ | ✅ |\n| Configure service‑wide settings | ❌ | ❌ | ✅ |\n\n## Session and Token Management (business rules)\n- THE todoApp SHALL use JWT for access and refresh tokens for session representation.\n- THE todoApp SHALL issue access tokens with a validity of 20 minutes.\n- THE todoApp SHALL issue refresh tokens with a validity of 30 days and rotate them on each successful refresh, immediately invalidating the prior refresh token.\n- THE todoApp SHALL bind each session to a logical device/session identifier to enable session listing and selective revocation.\n- WHERE a user changes password, THE todoApp SHALL revoke all existing sessions and refresh tokens, with an option to preserve the current device session only when explicitly chosen by the user.\n- WHERE an administrator enforces a password reset or security hold, THE todoApp SHALL revoke all sessions for that user without exception.\n- THE todoApp SHALL limit concurrent active sessions per user to 10; attempts to establish an 11th SHALL require the user to revoke at least one existing session or accept automatic revocation of the oldest idle session.\n- THE todoApp SHALL provide session metadata for user viewing: creation time, last activity time, device label (if provided by the user), and approximate location derived from coarse signals where permitted by policy.\n- THE todoApp SHALL require recent re‑authentication (within the last 15 minutes) before sensitive actions such as password change, email change, account deletion, or export of personal data.\n- THE todoApp SHALL treat token storage location as a developer decision, requiring that storage be resistant to common attacks appropriate to the platform.\n- THE todoApp SHALL include in each JWT at minimum: userId, role, and a permissions array sufficient for authorization decisions.\n\n## Access Control Rules and Examples (EARS)\n- THE todoApp SHALL enforce least privilege so users access only resources they own unless an administrative support action is justified and recorded.\n- WHEN an unauthenticated subject requests a protected resource, THE todoApp SHALL deny access and guide the subject to authenticate or verify email.\n- WHEN a user attempts to read, modify, or delete another user’s resources, THE todoApp SHALL deny access without revealing resource existence.\n- WHEN an administrator suspends or reactivates an account, THE todoApp SHALL record the reason and notify the affected user.\n- WHEN an administrator must view user data for support, THE todoApp SHALL permit the minimum necessary access within an approved process and SHALL record all actions in audit logs.\n- IF an account email is unverified, THEN THE todoApp SHALL restrict sensitive features (for example, export or account deletion) and guide the user to complete verification first.\n- WHERE abnormal activity is detected by policy (for example, repeated failed logins), THE todoApp SHALL apply additional checks or temporary limits such as cooldowns or step‑up verification.\n\n## Account Lifecycle (creation, verification, suspension, deletion)\n\n### Creation\n- WHEN creating an account, THE todoApp SHALL use email as the unique contact identifier and enforce the current password policy.\n- THE todoApp SHALL limit registration attempt frequency to prevent automated abuse using policy‑based thresholds (for example, per IP or per domain).\n\n### Verification\n- THE todoApp SHALL allow verification link resend subject to 3 requests within any 24‑hour window.\n- IF verification is not completed within 7 days, THEN THE todoApp SHALL require verification at the next login before granting access to sensitive features.\n- WHERE an account remains unverified for 14 days, THE todoApp SHALL purge the unverified account and associated artifacts during the next scheduled purge cycle.\n\n### Suspension\n- WHEN a user requests voluntary deactivation, THE todoApp SHALL restrict sign‑in and convert the account to a reversible inactive state according to retention policy.\n- WHEN an administrator suspends an account for policy violations, THE todoApp SHALL terminate all active sessions immediately and record suspension reason, start time, and review schedule.\n- WHILE an account is suspended, THE todoApp SHALL block write operations and sensitive actions and MAY allow read access to security pages sufficient to complete recovery.\n\n### Deletion\n- WHEN a verified user confirms account deletion, THE todoApp SHALL initiate a 14‑day grace period during which the user may cancel deletion.\n- WHILE the grace period is active, THE todoApp SHALL present a deletion‑cancellation option at sign‑in and restrict normal write operations.\n- IF legal retention obligations apply to specific records, THEN THE todoApp SHALL defer deletion of those records while deleting all other user data and SHALL inform the user within policy limits.\n\n## Security and Privacy Considerations\n\n### Password Policy\n- THE todoApp SHALL require a minimum password length of 8 characters and SHALL accept long passphrases without requiring special characters.\n- THE todoApp SHALL prevent use of commonly compromised passwords using a banned list.\n- THE todoApp SHALL prevent reuse of the previous 5 passwords.\n\n### Rate Limiting and Lockouts\n- THE todoApp SHALL impose a cooldown after 10 failed login attempts within 10 minutes for an account or from a single source; cooldown duration SHALL be at least 5 minutes with clear guidance.\n- THE todoApp SHALL throttle password reset requests to a maximum of 5 per 24 hours per account.\n\n### Privacy by Design\n- THE todoApp SHALL avoid revealing whether an email is registered in responses to registration and password reset requests.\n- THE todoApp SHALL record audit events without storing sensitive secrets (for example, no plaintext passwords, no full tokens in logs).\n- THE todoApp SHALL store audit timestamps in UTC while displaying times to users according to their locale settings where applicable.\n\n### Notifications and Messaging\n- THE todoApp SHALL send verification and password reset emails within 60 seconds under normal operating conditions.\n- THE todoApp SHALL ensure messages avoid sensitive data and provide clear next steps for recovery.\n\n### Administrative Safeguards\n- THE todoApp SHALL require administrators to provide a reason when performing user‑impacting actions (suspension, session revocation, role modification).\n- THE todoApp SHALL restrict access to aggregated analytics to administrators only and ensure data is de‑identified at the individual level.\n\n## Audit and Activity Logging (business expectations)\n- THE todoApp SHALL record at minimum the following categories: registration, email verification initiation/completion, login success/failure, logout, password reset request/completion, password change, session creation/refresh/revocation, account suspension/reactivation, account deletion request/completion, admin configuration changes, and elevated user‑data access by administrators.\n- WHEN an audit event is recorded, THE todoApp SHALL include event type, actor (user or admin), timestamp (UTC), target (if applicable), outcome (success/failure), and reason (if applicable).\n- WHERE an administrator accesses user data, THE todoApp SHALL classify the event as high‑risk and route it to a review queue.\n- THE todoApp SHALL provide each user with access to their own audit history for security‑relevant actions (for example, logins, password changes, session revocations).\n\n## Related Documents\n- Service vision and business model: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- End‑to‑end feature behaviors: [todoApp Functional Requirements](./03-todoApp-functional-requirements.md)\n- Failure behaviors and recovery: [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance, availability, and privacy expectations: [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md)\n\n---\n\n## Appendix: Additional EARS Examples for Edge Cases\n- IF a password reset token was already used, THEN THE todoApp SHALL treat the token as invalid and guide the user to request a new one.\n- IF abnormal refresh activity is observed from the same device/session, THEN THE todoApp SHALL terminate the session and require re‑authentication.\n- WHERE a user saves a custom label for a device, THE todoApp SHALL display the label in the session list.\n- WHEN an account deletion grace period ends, THE todoApp SHALL complete permanent deletion and notify the user through the configured channel.\n- WHILE an account is suspended, THE todoApp SHALL block authentication to protected features and present suspension reason and review schedule at the next sign‑in attempt.\n","tokenUsage":{"total":74295,"input":{"total":66804,"cached":0},"output":{"total":7491,"reasoning":3264,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":7,"step":0,"created_at":"2025-08-15T04:01:09.216Z"},"tokenUsage":{"aggregate":{"total":776781,"input":{"total":652223,"cached":11648},"output":{"total":124558,"reasoning":46016,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":773997,"input":{"total":649886,"cached":11648},"output":{"total":124111,"reasoning":45632,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Codify validation rules, constraints, and state logic to ensure consistent handling across all features.","filename":"06-todoApp-business-rules.md","documentType":"requirement","outline":["Purpose and Scope","Terminology and States","Todo Item Validation Rules","Ownership and Access Rules","Rate Limits and Operational Constraints (business-level)","Retention and Deletion Rules","Time Zone and Date Handling Rules","Rule Conflict Resolution and Precedence","Traceability to Functional Requirements"],"audience":"development team","keyQuestions":["What validations apply to todo items and accounts?","What limits, if any, exist for operations?","How are conflicts in rules resolved?"],"detailLevel":"detailed specification","relatedDocuments":["03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md"],"constraints":["Express rules in testable, measurable terms (use EARS where applicable)","Avoid any database, API, or technical design details"],"content":"# todoApp Business Rules and Constraints\n\n## Purpose and Scope\nThis document codifies the business rules, validations, constraints, and state logic for todoApp to ensure consistent behavior across all features and scenarios. It provides business requirements only; it defines WHAT the system should do, not HOW to build it. All technical implementation decisions (architecture, APIs, database design, etc.) are at the discretion of the development team.\n\nScope includes: todo item field validations, item state transitions, ownership and access rules, rate limits and operational constraints, retention/deletion behaviors, time zone and date handling, conflict resolution principles, and traceability to related documents. This document applies to the roles defined for todoApp: user and admin.\n\nOut of scope: UI/UX layouts, API endpoint specifications, database schema design, and infrastructure choices.\n\nRelated documents for broader context:\n- See the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for end-to-end feature behaviors and acceptance criteria.\n- See the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance, security, and reliability expectations.\n- See the [Data Lifecycle and Privacy Requirements for todoApp](./09-todoApp-data-lifecycle-and-privacy.md) for conceptual data handling and privacy constraints.\n\n## Terminology and States\n- Owner: The authenticated account that created a todo item. Each todo item has exactly one Owner.\n- Todo Item (Item): A task record consisting minimally of a required title and optional attributes such as description and due date.\n- Active: The normal working state of an Item that is not completed and not in trash.\n- Completed: The state indicating the Item has been marked done.\n- Trashed: The state indicating the Item has been deleted by the Owner but is recoverable within the trash retention period.\n- Purged: The state indicating the Item has been irreversibly removed following retention rules.\n- Suspension: An account-level restriction under which write operations are blocked.\n\n### State Model and Allowed Transitions\nThe todoApp Item states and transitions are constrained to the following flow:\n\n```mermaid\ngraph LR\n  subgraph \"Todo Item States\"\n    A[\"Active\"] --> B[\"Completed\"]\n    B --> A\n    A --> C[\"Trashed\"]\n    B --> C\n    C --> A\n    C --> D[\"Purged (Irreversible)\"]\n  end\n```\n\n- Allowed transitions: Active → Completed, Completed → Active (reopen), Active → Trashed, Completed → Trashed, Trashed → Active (restore), Trashed → Purged.\n- Disallowed transitions: Any direct transition to Purged other than from Trashed; Purged has no outgoing transitions.\n\nEARS requirements:\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n\n## Todo Item Validation Rules\nThis section defines required and optional fields, permitted value ranges, and behavioral validations for creation, updates, completion, reopening, and deletion.\n\n### Field-Level Constraints\n- Title (required):\n  - Length: 1 to 120 Unicode characters after trimming leading/trailing whitespace.\n  - Content: No control characters; line breaks permitted but normalized to a single newline character.\n  - Uniqueness: Not required; duplicate titles are allowed for convenience.\n- Description (optional):\n  - Length: 0 to 2,000 Unicode characters after trimming.\n  - Content: May include line breaks; no active scripts or executable content.\n- Due Date (optional):\n  - Type: Either date-only (no time) or date-time (includes time and timezone implicit as user-local).\n  - Range: Not earlier than 1 January 1970 in user-local time; not later than 10 years from the current date in user-local time.\n  - Date-only Semantics: Treated as due at 23:59:59 in the user’s local time zone on the specified date.\n  - Date-time Semantics: Interpreted as an exact clock time in the user’s local time zone.\n\nEARS requirements (creation/update validation):\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 2,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 user-local on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values more than 10 years in the future or earlier than 1 January 1970 (user-local).\n- IF a field contains control characters, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n\n### Behavioral Validations\n- Completion and Reopening:\n  - An Item can be marked Completed only from Active.\n  - A Completed Item can be reopened only back to Active.\n- Deletion (Trash) and Purge:\n  - Only Items in Active or Completed can be moved to Trashed.\n  - Purge is only permitted from Trashed per retention rules.\n\nEARS requirements (state validations):\n- WHEN a user attempts to mark an Active Item as Completed, THE todoApp SHALL mark it Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n\n### Concurrency and Integrity (business perspective)\n- Edit Consistency:\n  - Edits should not silently overwrite more recent changes made by the Owner in another session.\n\nEARS requirements (concurrency):\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n\n## Ownership and Access Rules\nRoles: user (standard account), admin (administrative oversight under policy). All access rules are expressed from a business and privacy standpoint.\n\n### Core Ownership Rules\n- Each Item has exactly one Owner, which is the creating user account.\n- Owners can create, read, update, complete/reopen, trash, restore, and purge their own Items subject to other rules herein.\n- Cross-user access is not permitted for users.\n\n### Administrative Access (Support and Policy)\n- Admins can access any user’s Items only for legitimate support, security, or policy enforcement, with audit logging requirements.\n- Admin operations follow least-privilege: only the minimum actions necessary for the case and only for the minimum time required.\n\nEARS requirements (access control):\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or has an active administrative support scope.\n- IF a user attempts to modify an Item that they do not own, THEN THE todoApp SHALL deny the operation without revealing Item existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin read and write actions limited to the scope duration and case context.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n\n## Rate Limits and Operational Constraints (business-level)\nThe following limits exist to protect system integrity, reduce abuse, and provide predictable performance. Limits are measured per user account unless stated otherwise.\n\n### Per-Operation Frequency Limits\n- Create Item: up to 30 Items per minute, measured in rolling windows.\n- Update Item: up to 60 Item updates per minute.\n- Complete/Reopen: up to 120 state-change operations per minute.\n- Trash/Restore: up to 60 operations per minute.\n- Purge: up to 30 purges per minute.\n\n### Inventory and Size Limits\n- Maximum active (non-Trashed) Items per user: 5,000.\n- Maximum Trashed Items retained per user: 5,000 (older trashed Items purge sooner if this cap is exceeded).\n- Maximum total Items (all states except Purged) per user: 10,000.\n\n### Validation Response Expectations (business-level; detailed targets in NFR)\n- Single-field validation feedback is expected to be perceived as immediate for typical inputs.\n\nEARS requirements (limits):\n- WHERE a user exceeds the create rate limit, THE todoApp SHALL temporarily throttle further creates until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 5,000 active Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHEN a user purges Items, THE todoApp SHALL enforce the purge rate limit and queue excess purges for later or require retry.\n\n## Retention and Deletion Rules\nThese rules govern how Items are retained, restored, and permanently removed.\n\n### Trash Retention\n- Trashed Items are retained for 30 calendar days from the time of trashing.\n- Restoration returns the Item to Active with its previous content intact.\n\n### Purging\n- Automatic Purge: Items in Trashed are automatically purged after 30 days.\n- Manual Purge: The Owner may manually purge a Trashed Item at any time before automatic purge.\n- Purge is irreversible and removes the Item from user-accessible views and recovery.\n\n### Account Deletion and Suspension\n- Account Deletion: All Items owned by the account enter Trashed immediately and follow a shortened retention of 7 days before automatic purge.\n- Legal Hold: Admins may place a legal or policy hold that prevents purge until the hold is cleared.\n- Suspension: Suspended accounts cannot modify Items; retention timelines continue to elapse normally.\n\nEARS requirements (retention & deletion):\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of Trashed Items exceeds 5,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n\n## Time Zone and Date Handling Rules\nThese rules ensure consistent user-local behavior for dates and times in todoApp while avoiding reliance on device-specific interpretations.\n\n### User-Local Semantics\n- Date-Only Due Dates: Treated as due at 23:59:59 on that calendar date in the user’s selected time zone.\n- Date-Time Due Dates: Interpreted as exact local times in the user’s selected time zone.\n- Default Time Zone: If a user has not set a preferred time zone, the system uses a reasonable default aligned to the user’s locale.\n\n### Daylight Saving Time (DST) and Calendar Rules\n- DST Transition Forward (e.g., 01:59:59 → 03:00:00): A local time that does not exist shall be adjusted to the next valid local time on that date.\n- DST Transition Backward (hour repeats): A local time in the repeated hour is interpreted as the first occurrence unless the user specifies otherwise.\n- Leap Years and Month Length: Invalid calendar dates are rejected.\n\nEARS requirements (time zone & calendar):\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n\n## Account-Level Validation Rules (Business)\nThese constraints apply to account data relevant to using todoApp features.\n\n- Display Name (optional): 1 to 80 Unicode characters after trimming; no control characters.\n- Email (required for registration): Must be unique per account under todoApp policies.\n- Password (required for registration): Minimum 8 characters, at least one letter and one number; no spaces at either end after trimming.\n- Email Verification: Accounts may create and manage Items immediately after registration; however, recovery communications and sensitive account changes require a verified email.\n\nEARS requirements (account-level):\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 8 characters or lacking at least one letter and one number.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications until verification is completed.\n\n## Rule Conflict Resolution and Precedence\nTo resolve conflicts between rules or between rules and context-specific conditions, todoApp follows a defined precedence.\n\n### Precedence Order\n1. Legal/Compliance obligations (e.g., legal holds, court orders)\n2. Security and Privacy policies (e.g., least-privilege, non-disclosure of existence)\n3. Account status constraints (e.g., suspension, deletion)\n4. Ownership rules\n5. Retention and deletion rules\n6. Rate limits and operational constraints\n7. User preferences (e.g., time zone selection)\n\nEARS requirements (precedence):\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n### Examples\n- Privacy vs. Access Inquiry: If a user tries to open another user’s Item by ID, do not reveal whether it exists; respond as if inaccessible.\n- Rate Limit vs. Urgent Purge: If a purge request exceeds the allowed rate, queue or require retry while ensuring the user can eventually complete the purge.\n\n## Traceability to Functional Requirements\nThis section links rule groups in this document to relevant sections of related documents to ensure testability and cross-reference.\n\n| Business Rule Area | Related Functional Section | Notes |\n|---|---|---|\n| Field validations (title, description, due date) | [Todo Item Management in Functional Requirements](./03-todoApp-functional-requirements.md) | Aligns with create/update acceptance criteria |\n| State transitions (complete, reopen, trash, restore, purge) | [Completion and Reopening in Functional Requirements](./03-todoApp-functional-requirements.md) | Transitions must mirror acceptance tests |\n| Ownership and access | [Data Ownership and Privacy Rules in Functional Requirements](./03-todoApp-functional-requirements.md) | Must be consistent with role capabilities |\n| Rate limits and item caps | [Business Constraints and Limits in Functional Requirements](./03-todoApp-functional-requirements.md) | Limits are measurable and enforceable |\n| Retention and deletion | [Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md) | Trash retention and purge windows |\n| Time zone and date handling | [Non-Functional Requirements](./08-todoApp-non-functional-requirements.md) | Perceived immediacy and correctness in local time |\n| Account-level rules | [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md) | Password and email uniqueness behaviors |\n\n## Consolidated EARS Index (For Test Design)\nThis index consolidates EARS statements for ease of reference during test planning.\n\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 2,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 user-local on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values more than 10 years in the future or earlier than 1 January 1970 (user-local).\n- IF a field contains control characters, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n- WHEN a user attempts to mark an Active Item as Completed, THE todoApp SHALL mark it Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or has an active administrative support scope.\n- IF a user attempts to modify an Item that they do not own, THEN THE todoApp SHALL deny the operation without revealing Item existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin read and write actions limited to the scope duration and case context.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n- WHERE a user exceeds the create rate limit, THE todoApp SHALL temporarily throttle further creates until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 5,000 active Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHEN a user purges Items, THE todoApp SHALL enforce the purge rate limit and queue excess purges for later or require retry.\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of Trashed Items exceeds 5,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 8 characters or lacking at least one letter and one number.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications until verification is completed.\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n## Success Criteria\nThe rules in this document are considered implemented successfully when:\n- All EARS statements herein pass acceptance tests defined in the related documents.\n- Item state transitions are exactly as modeled and enforced in all features.\n- Validation and limit rules produce consistent, user-understandable outcomes across the system.\n- Retention and purge behaviors match specified timelines, including account deletion variations and legal holds.\n- Time zone and DST handling lead to correct, predictable due date semantics in user-local time.\n\nEnd of document."},"plan":"Write a single comprehensive requirement document for the todoApp service with the following structure and intent:\n\n- Title: todoApp Business Rules and Constraints\n- Sections aligning to outline:\n  1) Purpose and Scope — business-only statement of intent and applicability to roles (user, admin)\n  2) Terminology and States — precise definitions; state model with Mermaid diagram; allowed transitions\n  3) Todo Item Validation Rules — field-level constraints aligned to Functional Requirements; creation/update behaviors; concurrency and integrity\n  4) Ownership and Access Rules — role-based permissions in business terms; least-privilege admin scope\n  5) Rate Limits and Operational Constraints — business-level frequency limits, list pagination, bulk operations, idempotency and duplicate submission rules; align with Non-Functional Requirements\n  6) Retention and Deletion Rules — trash retention and purge, account deletion effects, legal hold, restoration semantics; align with Data Lifecycle\n  7) Time Zone and Date Handling Rules — user-local semantics; DST and invalid date rules; overdue evaluation in local time\n  8) Rule Conflict Resolution and Precedence — explicit precedence ladder; examples\n  9) Traceability to Functional Requirements — table mapping rule areas to related documents\n  10) Consolidated EARS Index — full list of EARS statements for QA/test design\n  11) Success Criteria — clear, measurable completion indicators\n\n- Audience: development team needing unambiguous business requirements.\n- Constraints: Express rules in measurable terms; avoid technical implementation details; ensure EARS compliance; align with related documents (03 Functional, 08 Non-Functional, 09 Data Lifecycle).\n- Role references: user, admin.\n- Service prefix: todoApp.\n","review":"Enhance the requirement document to be complete, implementation-ready, and fully compliant with the following criteria:\n\n- Length and completeness: 5,000–30,000+ characters; all sections fully developed with no placeholders.\n- Language: en-US; business requirements only; avoid technical implementation details, database schemas, or API specs.\n- EARS compliance: Convert all applicable rules to EARS (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL), using precise, measurable language.\n- Consistency: Align cross-document constraints with related specs:\n  • Title length: 1–120 chars.\n  • Description length: up to 1,000 chars (align with Functional Requirements).\n  • Due date range: not earlier than item creation date; not more than 5 years in the future (align with Functional Requirements).\n  • Password policy: minimum 12 characters; at least three of four character classes; banned list; prevent reuse (align with User Roles & Authentication).\n  • Rate limits (business level): write actions up to 60 per minute; read actions up to 120 per minute (align with Non-Functional Requirements).\n  • Items per user: up to 10,000 items concurrently (align with Functional and Non-Functional Requirements).\n- Mermaid diagrams: Ensure all labels use double quotes, no spaces between brackets/braces and quotes, proper arrow syntax (--> or with labels -->|\"Label\"| ).\n- Prohibited content: No API endpoints, database schemas, or infra details.\n- Add missing business rules: idempotency, bulk operations bounds, pagination bounds, audit expectations at business level, content policy basics (no executable content), and concurrency conflict policies.\n- Error handling: Include user-facing outcomes and recovery in business terms (cross-reference Error Handling doc implicitly via business phrasing without technical codes).\n- Time zone and DST: Keep end-of-day semantics for date-only; declare DST gap/backwards handling.\n- Access & privacy: Enforce least privilege, non-disclosure of resource existence when unauthorized.\n- Document style: Write as the document itself, avoid meta phrases like \"This document ...\"; include the standard statement that content describes WHAT, not HOW.\n- Links: Use descriptive relative links to existing documents only.\n\nReject any database schema or API specification. Ensure final output is a single, production-ready markdown document with all enhancements applied directly.","content":"# todoApp Business Rules and Constraints\n\n## Purpose and Scope\nProvides business rules, validations, constraints, and state logic for todoApp to ensure consistent behavior across all features and scenarios. Describes WHAT must happen from a business perspective; technical implementation details (architecture, APIs, database design, storage, libraries) are at the discretion of the development team.\n\nScope includes: todo item field validations, item state transitions, ownership and access rules, rate limits and operational constraints, retention and deletion behaviors, time zone and date handling, idempotency and concurrency policies, conflict resolution principles, and traceability to related specifications. Applies to roles: user and admin.\n\nRelated documents for broader context:\n- Refer to the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for end-to-end feature behaviors and acceptance criteria.\n- Refer to the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance, security, and reliability expectations.\n- Refer to the [Data Lifecycle and Privacy Requirements for todoApp](./09-todoApp-data-lifecycle-and-privacy.md) for conceptual lifecycle and privacy constraints.\n\n## Terminology and States\n- Owner: The authenticated account that created a todo item. Each item has exactly one Owner.\n- Todo Item (Item): A task record with a required title and optional attributes such as description and due date.\n- Active: The normal state of an Item that is not completed and not in trash.\n- Completed: The state indicating the Item has been marked done.\n- Trashed: The state indicating the Item has been deleted by the Owner but is recoverable within the trash retention period.\n- Purged: The state indicating the Item has been irreversibly removed following retention rules.\n- Suspension: An account-level restriction under which write operations are blocked.\n\n### State Model and Allowed Transitions\nItem states and transitions follow the flow below.\n\n```mermaid\ngraph LR\n  subgraph \"Todo Item States\"\n    A[\"Active\"] --> B[\"Completed\"]\n    B --> A\n    A --> C[\"Trashed\"]\n    B --> C\n    C --> A\n    C --> D[\"Purged(Irreversible)\"]\n  end\n```\n\n- Allowed transitions: Active → Completed; Completed → Active (reopen); Active → Trashed; Completed → Trashed; Trashed → Active (restore); Trashed → Purged.\n- Disallowed transitions: Any direct transition to Purged except from Trashed; Purged has no outgoing transitions.\n\nEARS:\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n\n## Todo Item Validation Rules\nDefines required and optional fields, permitted value ranges, and behavioral validations for creation, updates, completion, reopening, and deletion. All limits are measured after trimming leading and trailing whitespace where applicable.\n\n### Field-Level Constraints\n- Title (required):\n  - Length: 1 to 120 Unicode characters after trimming.\n  - Content: No control characters; line breaks permitted and normalized.\n  - Uniqueness: Not required; duplicate titles are allowed.\n- Description (optional):\n  - Length: 0 to 1,000 Unicode characters after trimming.\n  - Content: May include line breaks; no active scripts or executable content; no embedded markup execution.\n- Due Date (optional):\n  - Type: Either date-only (no time) or date-time (explicit local time semantics).\n  - Range: Not earlier than the Item’s creation date in the user’s local time; not later than 5 years from the current date in the user’s local time.\n  - Date-only semantics: Interpreted as due at 23:59:59 in the user’s time zone on that calendar date.\n  - Date-time semantics: Interpreted as an exact clock time in the user’s time zone.\n\nEARS (creation/update validation):\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 1,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 in the user’s time zone on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values earlier than the Item’s creation date or more than 5 years in the future (user-local).\n- IF a field contains control characters or executable content, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n\n### Behavioral Validations\n- Completion and Reopening:\n  - An Item can be marked Completed only from Active.\n  - A Completed Item can be reopened only back to Active.\n- Deletion (Trash) and Purge:\n  - Only Items in Active or Completed can be moved to Trashed.\n  - Purge is allowed only from Trashed per retention rules.\n\nEARS (state validations):\n- WHEN a user marks an Active Item as Completed, THE todoApp SHALL set it to Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n\n### Concurrency, Integrity, and Idempotency (business perspective)\n- Edit consistency: Edits must not silently overwrite more recent changes made by the Owner in another session.\n- Idempotency: Repeated submissions of the same action within a short interval should not create duplicated Items or double-apply state transitions.\n\nEARS (concurrency & idempotency):\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n- WHERE a create action is retried due to transient conditions, THE todoApp SHALL avoid duplicate Items resulting from the same user action.\n- WHERE a state-change action (complete/reopen) is repeated without intervening changes, THE todoApp SHALL keep the Item’s state consistent and avoid double application.\n\n## Ownership and Access Rules\nRoles: user (standard account) and admin (administrative oversight under policy). Access rules are expressed from a business and privacy standpoint.\n\n### Core Ownership Rules\n- Each Item has exactly one Owner, which is the creating user account.\n- Owners can create, read, update, complete/reopen, trash, restore, and purge their own Items subject to other rules herein.\n- Cross-user access is not permitted for users.\n\n### Administrative Access (Support and Policy)\n- Admins may access a user’s Items only for legitimate support, security, or policy enforcement, with justification and audit logging.\n- Admin operations follow least-privilege: minimum actions necessary for the case and only for the minimum time required.\n\nEARS (access control):\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or an admin has an active support scope for that user.\n- IF a user attempts to read or modify an Item that they do not own, THEN THE todoApp SHALL deny the operation without revealing the Item’s existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin read and write actions limited to the scope duration and case context and SHALL record justification in audit data.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n\n## Rate Limits and Operational Constraints (business-level)\nLimits protect system integrity, reduce abuse, and ensure predictable performance. Limits are measured per user account unless stated otherwise and align to non-functional targets.\n\n### Per-Operation and Aggregate Frequency Limits\n- Aggregate write operations (create/update/complete/reopen/trash/restore/purge): up to 60 actions per minute in rolling windows.\n- Aggregate read operations (list/detail/filter): up to 120 actions per minute in rolling windows.\n- Optional finer bounds for user experience consistency:\n  - Create Item: up to 30 per minute.\n  - Complete/Reopen: up to 60 per minute.\n  - Purge: up to 30 per minute.\n\n### Inventory and Size Limits\n- Maximum concurrent Items per user (all states except Purged): 10,000.\n- Pagination sizes: 10, 20, 50, or 100 items per page; default 20.\n- Bulk operations (interactive): up to 50 Items per action (e.g., bulk complete/reopen/purge) to preserve responsiveness.\n\n### Validation and Responsiveness Expectations (business-level)\n- Single-field validation feedback should be perceived as immediate for typical inputs and SHALL align with non-functional performance targets.\n\nEARS (limits & operational constraints):\n- WHERE a user exceeds aggregate write limits, THE todoApp SHALL throttle further writes until the window resets and inform the user of the limit.\n- WHERE a user exceeds aggregate read limits, THE todoApp SHALL throttle further reads until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 10,000 non-Purged Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHERE a bulk operation exceeds the interactive limit of 50 Items, THE todoApp SHALL process the excess via an alternative path or require the user to split the operation.\n\n## Retention and Deletion Rules\nGoverns how Items are retained, restored, and permanently removed (see also the [Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md)).\n\n### Trash Retention\n- Trashed Items are retained for 30 calendar days from the time of trashing.\n- Restoration returns the Item to Active with its previous content intact.\n\n### Purging\n- Automatic purge: Items in Trashed are automatically purged after 30 days.\n- Manual purge: The Owner may manually purge a Trashed Item at any time before automatic purge.\n- Purge is irreversible and removes the Item from user-accessible views and recovery.\n\n### Account Deletion and Suspension\n- Account deletion: All Items owned by the account enter Trashed immediately and follow a shortened retention of 7 days before automatic purge.\n- Legal hold: Admins may place a legal or policy hold that prevents purge until the hold is cleared.\n- Suspension: Suspended accounts cannot modify Items; retention timelines continue to elapse normally.\n\nEARS (retention & deletion):\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of non-Purged Items exceeds 10,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n\n## Time Zone and Date Handling Rules\nEnsures consistent user-local behavior for dates and times while avoiding reliance on device-specific interpretations.\n\n### User-Local Semantics\n- Date-only due dates: Treated as due at 23:59:59 on that calendar date in the user’s selected time zone.\n- Date-time due dates: Interpreted as exact local times in the user’s selected time zone.\n- Default time zone: When no preferred time zone is set, use a reasonable default aligned with the user’s locale; for MVP, Asia/Seoul (KST, UTC+9) is the default baseline.\n\n### Daylight Saving Time (DST) and Calendar Rules\n- DST forward transition (e.g., 01:59:59 → 03:00:00): A local time that does not exist is adjusted to the next valid local time on that date.\n- DST backward transition (hour repeats): A local time in the repeated hour is interpreted as the first occurrence unless the user specifies otherwise.\n- Leap years and month length: Invalid calendar dates are rejected.\n\nEARS (time zone & calendar):\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n\n## Account-Level Validation Rules (business)\nConstraints for account data relevant to using todoApp features.\n\n- Display Name (optional): 1 to 80 Unicode characters after trimming; no control characters.\n- Email (required for registration): Must be unique per account under todoApp policies.\n- Password (required for registration): Minimum 12 characters; at least three of the following categories: uppercase letters, lowercase letters, numbers, special characters; banned-password list enforced; prevent reuse of the last 5 passwords; no spaces at either end after trimming.\n- Email Verification: Accounts may create and manage Items according to policy; sensitive account changes and recovery communications require a verified email.\n\nEARS (account-level):\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 12 characters or lacking at least three of the four required character categories.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications and sensitive account actions until verification is completed.\n- WHERE a new password matches one of the previous 5 passwords, THE todoApp SHALL reject the change and require a different password.\n\n## Rule Conflict Resolution and Precedence\nResolves conflicts between rules or between rules and context-specific conditions via defined precedence.\n\n### Precedence Order\n1. Legal/Compliance obligations (e.g., legal holds, court orders)\n2. Security and Privacy policies (e.g., least-privilege, non-disclosure of existence)\n3. Account status constraints (e.g., suspension, deletion)\n4. Ownership rules\n5. Retention and deletion rules\n6. Rate limits and operational constraints\n7. User preferences (e.g., time zone selection)\n\nEARS (precedence):\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n### Examples\n- Privacy vs. Access Inquiry: If a user tries to open another user’s Item by ID, do not reveal whether it exists; respond as if inaccessible.\n- Rate Limit vs. Urgent Purge: If a purge request exceeds the allowed rate, queue or require retry while ensuring the user can eventually complete the purge.\n- Ownership vs. Admin Oversight: Allow admin access only with explicit, time-limited support scope and justification recorded in audit data.\n\n## Traceability to Functional Requirements\nLinks rule groups to relevant sections of related documents to ensure testability and cross-reference.\n\n| Business Rule Area | Related Functional Section | Notes |\n|---|---|---|\n| Field validations (title, description, due date) | [Todo Item Management in Functional Requirements](./03-todoApp-functional-requirements.md) | Create/update acceptance criteria must align |\n| State transitions (complete, reopen, trash, restore, purge) | [Completion and Reopening in Functional Requirements](./03-todoApp-functional-requirements.md) | Transitions mirror acceptance tests; retention aligns with data lifecycle |\n| Ownership and access | [Data Ownership and Privacy Rules in Functional Requirements](./03-todoApp-functional-requirements.md) | Must be consistent with role capabilities |\n| Rate limits and item caps | [Business Constraints and Limits in Functional Requirements](./03-todoApp-functional-requirements.md) | Limits are measurable and enforceable |\n| Retention and deletion | [Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md) | Trash retention and purge windows |\n| Time zone and date handling | [Non-Functional Requirements](./08-todoApp-non-functional-requirements.md) | Local-time correctness and perceived responsiveness |\n| Account-level rules | [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md) | Password and email uniqueness behaviors |\n\n## Consolidated EARS Index (for test design)\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 1,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 in the user’s time zone on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values earlier than the Item’s creation date or more than 5 years in the future (user-local).\n- IF a field contains control characters or executable content, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n- WHEN a user marks an Active Item as Completed, THE todoApp SHALL set it to Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n- WHERE a create action is retried due to transient conditions, THE todoApp SHALL avoid duplicate Items resulting from the same user action.\n- WHERE a state-change action is repeated without intervening changes, THE todoApp SHALL keep the Item’s state consistent and avoid double application.\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or an admin has an active support scope for that user.\n- IF a user attempts to read or modify an Item they do not own, THEN THE todoApp SHALL deny the operation without revealing the Item’s existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin actions limited to scope and duration and SHALL record justification in audit data.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n- WHERE a user exceeds aggregate write limits, THE todoApp SHALL throttle writes until the window resets and inform the user of the limit.\n- WHERE a user exceeds aggregate read limits, THE todoApp SHALL throttle reads until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 10,000 non-Purged Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHERE a bulk operation exceeds 50 Items, THE todoApp SHALL process the excess via an alternative path or require the user to split the operation.\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of non-Purged Items exceeds 10,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 12 characters or lacking at least three of the four character categories.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications and sensitive account actions until verification is completed.\n- WHERE a new password matches one of the previous 5 passwords, THE todoApp SHALL reject the change and require a different password.\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n## Success Criteria\nImplementation is considered successful when:\n- All EARS statements herein pass acceptance tests defined in related documents.\n- Item state transitions are exactly as modeled and enforced in all features.\n- Validation and limit rules produce consistent, user-understandable outcomes across the system.\n- Retention and purge behaviors match specified timelines, including account deletion variations and legal holds.\n- Time zone and DST handling provide correct, predictable due date semantics in user-local time.\n- Idempotency prevents duplicated effects from repeated user submissions.\n\nEnd of document.","tokenUsage":{"total":76026,"input":{"total":67323,"cached":0},"output":{"total":8703,"reasoning":2752,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":8,"step":0,"created_at":"2025-08-15T04:01:21.151Z"},"tokenUsage":{"aggregate":{"total":852807,"input":{"total":719546,"cached":11648},"output":{"total":133261,"reasoning":48768,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":850023,"input":{"total":717209,"cached":11648},"output":{"total":132814,"reasoning":48384,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Define go-live readiness, measurable acceptance criteria, and success metrics to align delivery and evaluation.","filename":"10-todoApp-acceptance-criteria-and-success-metrics.md","documentType":"requirement","outline":["Release Readiness Checklist","MVP Acceptance Criteria (EARS)","Post-Launch Monitoring Plan (business-level)","User Satisfaction and Support Plan","Success Metrics and Reporting Cadence","Risks and Mitigations"],"audience":"business stakeholders","keyQuestions":["What constitutes acceptance for MVP release?","How will success be measured after launch?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md"],"constraints":["Acceptance criteria must be specific, measurable, and testable (EARS)","No technical implementation details or API specifications"],"content":"# todoApp – Acceptance Criteria and Success Metrics\n\nDocument date: 2025-08-15 (Asia/Seoul)\n\nThis document defines business acceptance criteria, release readiness, and post‑launch success metrics for the todoApp MVP. It describes WHAT must be satisfied to release and operate successfully from a business perspective. It does not prescribe HOW to implement. This document provides business requirements only; all technical implementation decisions (architecture, APIs, database design, libraries, infrastructure) belong to the development team.\n\n## Related Reading\n- Refer to the Service Overview in the [todoApp Service Overview](./01-todoApp-service-overview.md) for vision, scope, and business model context.\n- Functional scope and behaviors are described in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md).\n- System‑wide performance, security, and availability expectations are set in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n\n## 1) Release Readiness Checklist\nAll items in this checklist must be satisfied before declaring the MVP “Go‑Live Ready.” Items are written in business terms with measurable completion criteria.\n\n1. Scope and Feature Completeness\n   - Feature scope matches MVP defined in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md): account registration/login/logout, email verification, password reset/change, todo item create/read/update/delete, mark complete/reopen, optional attributes (description, due date), filtering/sorting, timezone handling, ownership/privacy rules.\n   - No open P0/P1 defects impacting core flows: register, login, create todo, mark complete, edit, delete, filter/search.\n   - All acceptance tests below (Section 2) pass with documented evidence.\n\n2. Non‑Functional Readiness\n   - Performance sampling over representative load shows 95th percentile response perceived by users within 2 seconds for core actions (register, login, view list, add item, mark complete, edit, delete, filter/sort), aligning to the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n   - Availability plan and on‑call schedule established for the first 4 weeks of launch.\n   - Monitoring dashboards for core KPIs and error rates configured and shared with stakeholders.\n\n3. Security, Privacy, and Compliance Readiness\n   - User data handling aligns with privacy guidelines in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n   - Account lifecycle behaviors (creation, verification, suspension, deletion) validated against role and ownership rules (see functional and roles specs).\n   - Audit trail expectations (business level) met for significant account and todo changes.\n\n4. Operational Readiness\n   - Incident management workflow established: severity definitions, escalation contacts, communication templates.\n   - Support processes prepared: FAQ/knowledge base draft published; response SLAs defined in Section 4.\n   - Rollback/disable plan documented in business terms (feature toggles or revert path available without data loss from user perspective).\n\n5. Documentation and Training\n   - This document is reviewed by stakeholders; QA test cases trace to acceptance criteria.\n   - User‑facing help content for common tasks and recovery scenarios (login issues, password reset, duplicate todos, date/time misunderstandings) prepared.\n\n6. Launch Logistics\n   - Launch window scheduled with stakeholder sign‑off; monitoring coverage for the first 72 hours confirmed.\n   - Communication plan drafted (release notes and internal updates) describing MVP scope and known limitations.\n\n### Go/No‑Go Decision Flow (Business View)\n```mermaid\ngraph LR\n  A[\"All Readiness Items Evaluated\"] --> B{\"All P0/P1 Defects Closed?\"}\n  B -->|\"Yes\"| C{\"Acceptance Tests Passed?\"}\n  B -->|\"No\"| H[\"No‑Go: Fix Critical Defects\"]\n  C -->|\"Yes\"| D{\"Monitoring & Support Ready?\"}\n  C -->|\"No\"| I[\"No‑Go: Complete Tests\"]\n  D -->|\"Yes\"| E{\"Stakeholder Sign‑Off Complete?\"}\n  D -->|\"No\"| J[\"No‑Go: Finalize Ops & Support\"]\n  E -->|\"Yes\"| F[\"Go: Launch Window\"]\n  E -->|\"No\"| G[\"No‑Go: Obtain Approvals\"]\n```\n\n## 2) MVP Acceptance Criteria (EARS)\nAll acceptance criteria below use EARS. Keywords WHEN, WHILE, IF, THEN, WHERE, THE, SHALL remain in English; descriptions are in en‑US.\n\n### 2.1 Authentication and Account Lifecycle\n- WHEN a person registers with valid email and password, THE todoApp SHALL create a new account and send an email verification within 1 minute.\n- IF a person attempts to register with an email already in use, THEN THE todoApp SHALL reject the registration and instruct the person to reset password or use another email.\n- WHEN a person verifies the email within 24 hours, THE todoApp SHALL activate the account and allow login.\n- IF an email verification link is expired, THEN THE todoApp SHALL present a method to request a new verification link.\n- WHEN a user logs in with correct credentials for an active account, THE todoApp SHALL grant access within 2 seconds perceived by the user.\n- IF a user enters incorrect credentials, THEN THE todoApp SHALL deny access and provide actionable guidance to recover (e.g., reset password).\n- WHEN a user logs out, THE todoApp SHALL end the active session immediately from the user perspective.\n- WHEN a user initiates password reset with a registered email, THE todoApp SHALL send reset instructions within 1 minute.\n- IF a password reset token is invalid or expired, THEN THE todoApp SHALL prevent password change and provide a method to request a new reset.\n- WHERE an account is suspended by an admin for policy reasons, THE todoApp SHALL prevent access to protected features and communicate suspension status at next sign‑in attempt.\n- WHEN a user requests account deletion, THE todoApp SHALL schedule deletion in accordance with data lifecycle requirements and confirm request receipt to the user.\n\n### 2.2 Todo Item Core Operations\n- WHEN a logged‑in user submits a new todo with a non‑empty title up to the allowed length, THE todoApp SHALL create the todo and show it in the user’s list immediately.\n- IF a user attempts to create a todo without a title or exceeding the maximum length, THEN THE todoApp SHALL reject creation and display validation guidance.\n- WHEN a user updates title, description, or due date of their own todo with valid values, THE todoApp SHALL persist the changes and reflect them in the list within 2 seconds perceived by the user.\n- IF a user attempts to update a todo they do not own, THEN THE todoApp SHALL deny the action and retain the original state.\n- WHEN a user marks their own todo as complete, THE todoApp SHALL set the completion state and update list indicators within 2 seconds perceived by the user.\n- WHEN a user reopens a completed todo, THE todoApp SHALL remove the completion state and update the list accordingly within 2 seconds perceived by the user.\n- WHEN a user deletes their own todo, THE todoApp SHALL remove it from the list and confirm deletion within 2 seconds perceived by the user.\n- IF a user attempts to delete a todo they do not own, THEN THE todoApp SHALL deny the action and provide an ownership restriction message.\n\n### 2.3 Filtering, Sorting, and Timezone Behaviors\n- WHEN a user filters todos by status (all, active, completed), THE todoApp SHALL return a filtered list consistent with the selected status within 2 seconds perceived by the user.\n- WHEN a user sorts todos by created time or due date, THE todoApp SHALL present results ordered according to the selected sort within 2 seconds perceived by the user.\n- WHILE a user’s timezone preference is set, THE todoApp SHALL display due dates and times in that timezone consistently in lists and details.\n- IF a due date is provided without time, THEN THE todoApp SHALL interpret it as end‑of‑day in the user’s timezone.\n- IF a due date is invalid or in an unsupported format from the user’s perspective, THEN THE todoApp SHALL reject it and provide clear correction guidance.\n\n### 2.4 Data Ownership and Privacy\n- THE todoApp SHALL restrict todos so that users can view and modify only their own items.\n- IF an unauthenticated person attempts to access protected todo features, THEN THE todoApp SHALL require authentication before continuing.\n- WHERE an admin needs to assist for support or policy enforcement, THE todoApp SHALL allow admin‑level access to the minimum necessary information for the task and log the access for audit.\n- WHEN a user exports their todo data (if enabled in MVP), THE todoApp SHALL provide a complete, human‑readable export within a reasonable timeframe communicated to the user.\n\n### 2.5 Error Handling and Recovery (Business View)\n- IF an operation fails due to validation errors, THEN THE todoApp SHALL not change data and SHALL present actionable messages enabling the user to correct and retry immediately.\n- IF an operation fails due to conflicting concurrent updates on the same todo, THEN THE todoApp SHALL preserve data integrity and inform the user how to proceed (e.g., refresh to load the latest and reapply changes).\n- IF a temporary service issue prevents completion of a core action, THEN THE todoApp SHALL encourage retry and avoid duplicate creations or updates from a single user action.\n\n### 2.6 Performance and Responsiveness\n- THE todoApp SHALL complete core interactions (login, list load, add, edit, complete, delete, filter/sort) within 2 seconds perceived by the user for the 95th percentile under expected MVP load.\n- WHERE larger lists are present (e.g., 500 todos), THE todoApp SHALL allow the user to access and interact with a subset without undue delay and provide a predictable way to navigate additional items.\n\n### 2.7 Administration (Business Controls)\n- WHEN an admin suspends an account for policy reasons, THE todoApp SHALL prevent further protected actions by that account and record the action for audit.\n- WHEN an admin reinstates a suspended account, THE todoApp SHALL restore access to protected features.\n- WHEN an admin needs to view a user’s account for support, THE todoApp SHALL limit visibility to the minimum necessary data and record the access for audit.\n\n## 3) Post‑Launch Monitoring Plan (Business‑Level)\nThe following monitoring is required from day 0. All metrics are business‑level and observable via dashboards available to stakeholders.\n\n1. Availability and Performance (User‑Perceived)\n   - Track percentage of successful core actions: login, view list, create, update, complete, delete.\n   - Track 95th percentile perceived completion time for core actions, target ≤ 2 seconds.\n   - Track error rate by category: authentication failures, authorization denials, validation errors, conflicts, temporary service issues.\n\n2. Adoption and Engagement\n   - New accounts created per day and percentage verified within 24 hours.\n   - Time‑to‑first‑todo: median time from account creation to first successful todo creation; target ≤ 5 minutes.\n   - Daily Active Users (DAU), 7‑day Active Users (WAU), Monthly Active Users (MAU).\n   - Task completion ratio: completed todos / created todos per cohort.\n\n3. Data Quality and Privacy Indicators\n   - Number of ownership violations prevented (should be zero successful violations; denials are counted but expected for attempted access to others’ data).\n   - Volume of admin support accesses with justification logs.\n\n4. Stability and Support Load\n   - Volume of support contacts per 1,000 active users per week; target ≤ 10 in the first month.\n   - Top 5 user‑reported issues and their time‑to‑resolution.\n\nAlerting Thresholds (Business View)\n- WHEN the 95th percentile perceived completion time for any core action exceeds 2 seconds for 15 continuous minutes, THE operations process SHALL initiate an incident response and prioritize restoration to target performance.\n- WHEN the success rate of any core action drops below 99% for 15 continuous minutes, THE operations process SHALL begin an investigation and user communication steps.\n- WHEN verification completion within 24 hours drops below 80% for two consecutive days, THE product process SHALL review onboarding guidance and potential friction points.\n\n## 4) User Satisfaction and Support Plan\n1. User Feedback Collection\n   - In‑product lightweight CSAT prompt for key actions (create todo, complete todo) shown non‑intrusively after action completion no more than once per 30 days per user.\n   - Quarterly NPS and qualitative survey distributed to verified users.\n   - Feedback channels: help center form and email address monitored during business hours.\n\n2. Support SLAs (Business Commitments)\n   - Severity 1 (core actions unavailable for many users): initial acknowledgement within 15 minutes; user‑facing update every 60 minutes until resolution.\n   - Severity 2 (significant degradation or feature impairment): acknowledgement within 2 business hours; updates every business day until resolution.\n   - Severity 3 (minor issues or guidance requests): acknowledgement within 2 business days; resolution targeted within 5 business days.\n\n3. Knowledge Resources\n   - Self‑service articles: account creation and verification, password reset, creating and managing todos, due date/timezone behavior, data privacy basics, account deletion.\n   - Release notes summarizing changes and known limitations for MVP.\n\n4. Post‑Incident Review\n   - For Severity 1 or Severity 2 incidents, a business‑readable post‑incident summary is circulated within 5 business days, including impact, user communication, and prevention actions.\n\n## 5) Success Metrics and Reporting Cadence\nThis section defines quantitative targets for the first 90 days post‑launch. Targets are set to be ambitious yet feasible for MVP.\n\n1. Activation and Onboarding\n   - Email verification completion within 24 hours ≥ 85% of new accounts by day 30, ≥ 90% by day 90.\n   - Time‑to‑first‑todo median ≤ 5 minutes by day 30, ≤ 3 minutes by day 90.\n\n2. Engagement\n   - D7 retention ≥ 25% by day 30; ≥ 30% by day 90.\n   - Task completion ratio (completed/created) ≥ 70% by day 30; ≥ 75% by day 90.\n   - Median todos created per active user per week ≥ 5 by day 90.\n\n3. Satisfaction and Support\n   - CSAT on key actions ≥ 4.3/5 by day 30; ≥ 4.5/5 by day 90.\n   - NPS ≥ +20 by quarter end.\n   - Support contacts ≤ 10 per 1,000 active users per week by day 30; ≤ 7 by day 90.\n\n4. Reliability and Performance (User‑Perceived)\n   - 95th percentile completion time for core actions ≤ 2 seconds sustained.\n   - Core action success rate ≥ 99.5% sustained (user‑perceived success not blocked by validation errors initiated by the user).\n\nReporting Cadence\n- Weekly: activation, engagement, reliability summary to stakeholders; highlight deltas vs. targets and top issues.\n- Monthly: deep dive report with cohort analysis, retention, satisfaction trends, and prioritized improvements.\n- Quarterly: strategic review against Service Overview KPIs with recommendations for roadmap adjustments.\n\n## 6) Risks and Mitigations\nThis section names major risks relevant to acceptance and sustained success, with business mitigations.\n\n1. Performance Risk (User‑Perceived Latency)\n   - Risk: Perceived delays above 2 seconds degrade satisfaction and retention.\n   - Mitigation: Performance budget tracked in monitoring; phased exposure if needed; prioritize optimization of list load and write actions; temporarily disable non‑critical features during incidents to preserve core actions.\n\n2. Onboarding Friction\n   - Risk: Low email verification rates and complex password resets reduce activation.\n   - Mitigation: Clear messaging for verification; resend links flow; simple reset guidance; monitor verification funnel and test copy improvements.\n\n3. Data Integrity and Concurrency Conflicts\n   - Risk: Lost updates or conflicting edits cause user confusion.\n   - Mitigation: Conflict detection behaviors and user guidance; encourage refresh and reapply; emphasize integrity in acceptance tests.\n\n4. Privacy and Access Control\n   - Risk: Improper access to another user’s data erodes trust.\n   - Mitigation: Strict ownership rules, minimum‑necessary admin access, and audit expectations; periodic review of admin support accesses.\n\n5. Support Overload at Launch\n   - Risk: High contact volume overwhelms support.\n   - Mitigation: Proactive FAQ, clear in‑product guidance for common errors, temporary extended support window during first 2 weeks, incident communication templates prepared.\n\n6. Scope Creep Before Go‑Live\n   - Risk: Unplanned features jeopardize schedule and quality.\n   - Mitigation: Enforce scope freeze for MVP; place additional requests into post‑MVP backlog with business justification and capacity planning.\n\n7. Insufficient Monitoring or Alert Fatigue\n   - Risk: Missed issues or slow response to degradations.\n   - Mitigation: Focus alerts on user‑perceived metrics (success rate, p95 time); define actionable thresholds; periodic tuning based on signal‑to‑noise.\n\n---\n\n## Traceability to Acceptance and Success\n- Each acceptance criterion maps to features defined in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md) and quality targets in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n- Release readiness and monitoring targets align with the go‑to‑market plan and KPIs stated in the [todoApp Service Overview](./01-todoApp-service-overview.md).\n\nEnd of document."},"plan":"Create a single comprehensive requirement document for \"10-todoApp-acceptance-criteria-and-success-metrics.md\" aligned to the outline: 1) Release Readiness Checklist; 2) MVP Acceptance Criteria (EARS); 3) Post-Launch Monitoring Plan (business-level); 4) User Satisfaction and Support Plan; 5) Success Metrics and Reporting Cadence; 6) Risks and Mitigations. Integrate the todoApp prefix and roles (user, admin). Expand each section with measurable acceptance gates, role-aware rules, and business validation. Include at least one valid Mermaid decision flow (Go/No-Go). Ensure all acceptance criteria are EARS-formatted, performance and privacy expectations are measurable, and cross-reference related documents with descriptive links. Remove meta-commentary and start directly with the title and content. End with traceability statements linking to related documents.","review":"Enhance to production-ready quality with the following mandatory criteria: 1) Length and completeness: 5,000–30,000+ characters as needed; no placeholders. 2) EARS compliance: All applicable requirements must use EARS (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL). Convert any vague statements to measurable requirements. 3) Business-only scope: Absolutely no API specs, database schemas, or technical architecture. 4) Mermaid rules: Use graph LR; all node and edge labels in double quotes; no spaces between brackets/braces and quotes; correct arrow syntax (--> for edges; -->|\"Label\"| for labeled edges). 5) Document structure must follow the provided outline; expand each section with specific, testable criteria and examples; include error and recovery scenarios, performance expectations, role-based controls, audit/monitoring expectations. 6) Link text must be descriptive and in en-US; use relative paths. 7) Include a clear autonomy statement without meta commentary phrased as \"Business requirements only; all technical implementation decisions are at the discretion of the development team.\" 8) Ensure consistency with related documents, roles (user, admin), and service prefix (todoApp). 9) No questions to readers; no developer notes outside 00-toc.md.","content":"# todoApp – Acceptance Criteria and Success Metrics\n\nDocument date: 2025-08-15 (Asia/Seoul)\n\nBusiness requirements only; all technical implementation decisions (architecture, APIs, database design, libraries, infrastructure) are at the discretion of the development team. Content defines WHAT must be satisfied for go‑live and post‑launch success in business terms, not HOW to build it.\n\n## Related Reading\n- Vision, scope, and model context: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Feature scope and behaviors: [todoApp Functional Requirements](./03-todoApp-functional-requirements.md)\n- Quality targets and constraints: [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md)\n\n## 1) Release Readiness Checklist\nAll items must be satisfied before declaring the MVP “Go‑Live Ready.” Items are business‑measurable and auditable.\n\n1. Scope and Feature Completeness\n   - MVP feature set matches the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md): account registration/login/logout, email verification, password reset/change, session revocation, todo item create/read/update/delete, completion/reopen, optional description and due date, filtering/sorting, timezone handling, data ownership/privacy rules, and optional export.\n   - No open P0/P1 defects affecting core flows: register, verify, login, view list, create todo, edit, complete/reopen, delete, filter/sort.\n   - All acceptance tests in Section 2 pass with documented evidence and traceability to requirements.\n   - Known limitations are documented with mitigation or deferral notes; no hidden scope gaps remain for MVP.\n\n2. Non‑Functional Readiness\n   - Performance sampling under representative load meets p95 ≤ 2 seconds user‑perceived for core actions (register, login, list, add, edit, complete, delete, filter/sort) and aligns with the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n   - Availability plan, on‑call schedule, and escalation matrix prepared for the first 4 weeks; coverage confirmed for the first 72 hours post‑launch.\n   - Monitoring dashboards for KPIs and error categories configured and accessible to stakeholders; alert thresholds tested.\n   - Read‑after‑write and cross‑device visibility behaviors validated against non‑functional targets.\n\n3. Security, Privacy, and Compliance Readiness\n   - Password, rate‑limit, and session policies validated as per [Roles and Authentication] and NFR expectations.\n   - Privacy notices, Terms of Service, and data lifecycle policies published and consistent with [todoApp Data Lifecycle and Privacy Requirements] if applicable.\n   - Audit trail coverage validated for significant account events and todo changes; sampling demonstrates integrity and minimal sensitive exposure.\n   - Access control checks validated for user/admin roles with least‑privilege and justification requirements for admin support access.\n\n4. Operational Readiness\n   - Incident management runbooks completed: severity definitions, triage steps, escalation contacts, user communication templates, and status update cadence.\n   - Backup/restore drill executed successfully within business RTO/RPO expectations defined in NFRs; outcomes documented.\n   - Rollback/disable plan defined at business level: reversible feature toggles or clear revert path available without user‑visible data loss.\n   - Capacity and rate‑limit policies exercised via dry runs; system behavior under throttling meets user‑guidance expectations.\n\n5. Documentation and Training\n   - Stakeholder review of this acceptance set complete; QA test cases trace to EARS acceptance criteria.\n   - User‑facing help content prepared for common tasks and recovery scenarios: registration and verification, login issues, password reset/change, creating and managing todos, completion/reopen, due date/timezone behavior, privacy basics, account deletion, export (if enabled).\n   - Internal support playbooks available for first‑line and admin support actions, including session revocation and account suspension/reinstatement.\n\n6. Launch Logistics\n   - Launch window scheduled with stakeholder sign‑off, including freeze period and change control policy for the launch week.\n   - Pre‑launch dry run executed (day‑in‑the‑life) covering registration‑to‑completion flows with monitoring active; issues resolved.\n   - Communication plan finalized (release notes, internal updates) including MVP scope, known limitations, and support contact channels.\n\n### Go/No‑Go Decision Flow (Business View)\n```mermaid\ngraph LR\n  A[\"All Readiness Items Evaluated\"] --> B{\"All P0/P1 Defects Closed?\"}\n  B -->|\"Yes\"| C{\"Acceptance Tests Passed?\"}\n  B -->|\"No\"| H[\"No‑Go: Fix Critical Defects\"]\n  C -->|\"Yes\"| D{\"Monitoring & Support Ready?\"}\n  C -->|\"No\"| I[\"No‑Go: Complete Tests\"]\n  D -->|\"Yes\"| E{\"Stakeholder Sign‑Off Complete?\"}\n  D -->|\"No\"| J[\"No‑Go: Finalize Ops & Support\"]\n  E -->|\"Yes\"| F[\"Go: Launch Window\"]\n  E -->|\"No\"| G[\"No‑Go: Obtain Approvals\"]\n```\n\n## 2) MVP Acceptance Criteria (EARS)\nKeywords WHEN, WHILE, IF, THEN, WHERE, THE, SHALL remain in English; descriptions are in en‑US.\n\n### 2.1 Authentication and Account Lifecycle\n- WHEN a person registers with valid email and password, THE todoApp SHALL create a new account and send an email verification within 1 minute.\n- IF a person attempts to register with an email already in use, THEN THE todoApp SHALL reject the registration and instruct the person to reset password or use another email.\n- WHEN a person verifies the email within 24 hours, THE todoApp SHALL activate the account and allow login.\n- IF an email verification link is expired, THEN THE todoApp SHALL present a method to request a new verification link.\n- WHEN a user logs in with correct credentials for an active account, THE todoApp SHALL grant access within 2 seconds perceived by the user.\n- IF a user enters incorrect credentials, THEN THE todoApp SHALL deny access and provide actionable guidance to recover (e.g., reset password).\n- WHEN a user logs out, THE todoApp SHALL end the active session immediately from the user perspective.\n- WHEN a user initiates password reset with a registered email, THE todoApp SHALL send reset instructions within 1 minute.\n- IF a password reset token is invalid or expired, THEN THE todoApp SHALL prevent password change and provide a method to request a new reset.\n- WHERE an account is suspended by an admin for policy reasons, THE todoApp SHALL prevent access to protected features and communicate suspension status at next sign‑in attempt.\n- WHEN a user requests account deletion, THE todoApp SHALL schedule deletion in accordance with data lifecycle requirements and confirm request receipt to the user.\n- WHERE a user chooses “revoke all sessions,” THE todoApp SHALL invalidate existing sessions within 60 seconds and require re‑authentication on all devices.\n\n### 2.2 Todo Item Core Operations\n- WHEN a logged‑in user submits a new todo with a non‑empty title up to the allowed length, THE todoApp SHALL create the todo and show it in the user’s list immediately.\n- IF a user attempts to create a todo without a title or exceeding the maximum length, THEN THE todoApp SHALL reject creation and display validation guidance.\n- WHEN a user updates title, description, or due date of their own todo with valid values, THE todoApp SHALL persist the changes and reflect them in the list within 2 seconds perceived by the user.\n- IF a user attempts to update a todo they do not own, THEN THE todoApp SHALL deny the action and retain the original state.\n- WHEN a user marks their own todo as complete, THE todoApp SHALL set the completion state and update list indicators within 2 seconds perceived by the user.\n- WHEN a user reopens a completed todo, THE todoApp SHALL remove the completion state and update the list accordingly within 2 seconds perceived by the user.\n- WHEN a user deletes their own todo, THE todoApp SHALL remove it from the list and confirm deletion within 2 seconds perceived by the user.\n- IF a user attempts to delete a todo they do not own, THEN THE todoApp SHALL deny the action and provide an ownership restriction message.\n\n### 2.3 Filtering, Sorting, and Timezone Behaviors\n- WHEN a user filters todos by status (all, active, completed), THE todoApp SHALL return a filtered list consistent with the selected status within 2 seconds perceived by the user.\n- WHEN a user sorts todos by created time or due date, THE todoApp SHALL present results ordered according to the selected sort within 2 seconds perceived by the user.\n- WHILE a user’s timezone preference is set, THE todoApp SHALL display due dates and times in that timezone consistently in lists and details.\n- IF a due date is provided without time, THEN THE todoApp SHALL interpret it as end‑of‑day in the user’s timezone.\n- IF a due date is invalid or in an unsupported format from the user’s perspective, THEN THE todoApp SHALL reject it and provide clear correction guidance.\n\n### 2.4 Data Ownership, Privacy, and Export\n- THE todoApp SHALL restrict todos so that users can view and modify only their own items.\n- IF an unauthenticated person attempts to access protected todo features, THEN THE todoApp SHALL require authentication before continuing.\n- WHERE an admin needs to assist for support or policy enforcement, THE todoApp SHALL allow admin‑level access to the minimum necessary information for the task and log the access for audit.\n- WHEN a user requests export of their todo data (if enabled in MVP), THE todoApp SHALL provide a complete, human‑readable or machine‑readable export within a timeframe communicated to the user and within 24 hours under normal conditions.\n\n### 2.5 Error Handling and Recovery (Business View)\n- IF an operation fails due to validation errors, THEN THE todoApp SHALL not change data and SHALL present actionable messages enabling the user to correct and retry immediately.\n- IF an operation fails due to conflicting concurrent updates on the same todo, THEN THE todoApp SHALL preserve data integrity and inform the user how to proceed (e.g., refresh to load the latest and reapply changes).\n- IF a temporary service issue prevents completion of a core action, THEN THE todoApp SHALL encourage retry and avoid duplicate creations or updates from a single user action.\n- IF a rate limit is reached, THEN THE todoApp SHALL inform the user in natural language and indicate when they may try again.\n\n### 2.6 Performance and Responsiveness\n- THE todoApp SHALL complete core interactions (login, list load, add, edit, complete, delete, filter/sort) within 2 seconds perceived by the user for the 95th percentile under expected MVP load.\n- WHERE larger lists are present (e.g., 500 todos), THE todoApp SHALL allow the user to access and interact with a subset without undue delay and provide a predictable way to navigate additional items.\n- WHERE a bulk action affects up to 50 items, THE todoApp SHALL complete the action within targets set in NFRs or process asynchronously with clear notification.\n\n### 2.7 Administration (Business Controls)\n- WHEN an admin suspends an account for policy reasons, THE todoApp SHALL prevent further protected actions by that account and record the action for audit.\n- WHEN an admin reinstates a suspended account, THE todoApp SHALL restore access to protected features.\n- WHEN an admin needs to view a user’s account for support, THE todoApp SHALL limit visibility to the minimum necessary data and record the access for audit.\n- WHEN an admin revokes a user’s sessions, THE todoApp SHALL require the user to sign in again on subsequent actions and record the event for audit.\n\n### 2.8 Audit and Activity Logging (Acceptance)\n- THE todoApp SHALL record business‑relevant audit entries for: registration, email verification, login success/failure, logout, password reset request/completion, password change, session creation/refresh/revocation, account suspension/reactivation, account deletion request/completion, admin support access to user data, and modification of more than 20 items in a bulk action.\n- WHEN an audit event is recorded, THE todoApp SHALL capture event type, actor role (user/admin), timestamp (UTC), target (where relevant), outcome (success/failure), and justification (where required) without storing sensitive secrets.\n\n## 3) Post‑Launch Monitoring Plan (Business‑Level)\nMonitoring begins day 0 and relies on dashboards accessible to stakeholders; thresholds initiate incident processes.\n\n1. Availability and Performance (User‑Perceived)\n   - Track success percentage of core actions: login, list, create, update, complete, delete.\n   - Track p95 completion time for core actions; target ≤ 2 seconds; track p99 for regression signals.\n   - Track error rate by category: authentication failures, authorization denials, validation errors, conflicts, rate‑limit denials, temporary service issues.\n   - Track read‑after‑write visibility latency and cross‑device propagation latency per NFR targets.\n\n2. Adoption and Engagement\n   - New accounts per day and percentage verified within 24 hours.\n   - Time‑to‑first‑todo: median ≤ 5 minutes; distribution by cohort.\n   - DAU/WAU/MAU with week‑over‑week growth; engagement distribution across create, update, complete actions.\n   - Task completion ratio: completed/created per cohort; overdue ratio.\n\n3. Data Quality and Privacy Indicators\n   - Ownership violations prevented (successful violations must be zero); denials are counted as attempts and triaged if anomalous.\n   - Admin support accesses with justification logs; outliers flagged for review.\n   - Export delivery success within target windows; export volume trends.\n\n4. Stability and Support Load\n   - Support contacts per 1,000 active users per week; first‑contact resolution rate.\n   - Top 5 user‑reported issues and time‑to‑resolution; recurring themes tracked.\n   - Incident count and duration by severity; availability vs. SLO error budget.\n\nAlerting Thresholds (Business View)\n- WHEN p95 completion time for any core action exceeds 2 seconds for 15 continuous minutes, THE operations process SHALL initiate an incident response and prioritize restoration to target performance.\n- WHEN success rate of any core action drops below 99% for 15 continuous minutes, THE operations process SHALL begin investigation and user communication steps.\n- WHEN verification completion within 24 hours drops below 80% for 2 consecutive days, THE product process SHALL review onboarding guidance and friction points.\n- WHEN rate‑limit denials spike above 2% of attempts in a 10‑minute window, THE product process SHALL evaluate guidance and potential abuse patterns.\n\n## 4) User Satisfaction and Support Plan\n1. Feedback Collection\n   - In‑product lightweight CSAT prompt for key actions (create/complete todo) shown non‑intrusively after completion, no more than once per 30 days per user.\n   - Quarterly NPS and qualitative survey to verified users; open‑ended improvement prompts collected and categorized.\n   - Feedback channels: help center form and dedicated email monitored during business hours; triage categorization aligned to error taxonomy.\n\n2. Support SLAs (Business Commitments)\n   - Severity 1 (core actions unavailable for many users): acknowledgement within 15 minutes; user‑facing update every 60 minutes until resolution.\n   - Severity 2 (significant degradation or feature impairment): acknowledgement within 2 business hours; updates every business day until resolution.\n   - Severity 3 (minor issues or guidance requests): acknowledgement within 2 business days; resolution targeted within 5 business days.\n   - Post‑incident summaries for Sev‑1/Sev‑2 incidents circulated within 5 business days, including user impact and prevention actions.\n\n3. Knowledge and Enablement\n   - Self‑service articles: account creation/verification, login troubleshooting, password reset/change, creating/managing todos, completion/reopen, due date/timezone semantics, privacy/data lifecycle, account deletion, export.\n   - Internal playbooks: admin session revocation and account suspension/reinstatement with justification logging.\n\n4. Launch Support Posture\n   - First 2 weeks: extended support window and increased staffing; proactive monitoring of onboarding funnel and verification completion.\n   - Communication templates ready for common errors and incidents; tone consistent and user‑centric.\n\n## 5) Success Metrics and Reporting Cadence\nTargets for the first 90 days post‑launch; ambitious yet feasible for MVP.\n\n1. Activation and Onboarding\n   - Email verification completion within 24 hours ≥ 85% by day 30; ≥ 90% by day 90.\n   - Time‑to‑first‑todo median ≤ 5 minutes by day 30; ≤ 3 minutes by day 90.\n\n2. Engagement\n   - D7 retention ≥ 25% by day 30; ≥ 30% by day 90.\n   - Task completion ratio (completed/created) ≥ 70% by day 30; ≥ 75% by day 90.\n   - Median todos created per active user per week ≥ 5 by day 90.\n\n3. Satisfaction and Support\n   - CSAT on key actions ≥ 4.3/5 by day 30; ≥ 4.5/5 by day 90.\n   - NPS ≥ +20 by quarter end.\n   - Support contacts ≤ 10 per 1,000 active users per week by day 30; ≤ 7 by day 90; first‑contact resolution ≥ 70% by day 90.\n\n4. Reliability and Performance (User‑Perceived)\n   - p95 completion time for core actions ≤ 2 seconds sustained.\n   - Core action success rate ≥ 99.5% sustained (excluding user‑initiated validation denials).\n   - Zero Sev‑1 incidents in the first 14 days; ≤ 1 Sev‑1 and ≤ 3 Sev‑2 incidents by day 90.\n\nReporting Cadence\n- Weekly: activation, engagement, reliability summary with deltas vs. targets and top issues; action items for the next week.\n- Monthly: cohort analysis, retention and satisfaction trends, export usage, and prioritized improvements.\n- Quarterly: strategic review against Service Overview KPIs and recommendations for roadmap adjustments.\n\n## 6) Risks and Mitigations\nMajor risks relevant to acceptance and sustained success with business mitigations.\n\n1. Performance Risk (User‑Perceived Latency)\n   - Risk: Perceived delays above 2 seconds degrade satisfaction and retention.\n   - Mitigation: Performance budget tracking; phased exposure if needed; prioritize optimization of list load and write actions; temporarily disable non‑critical features during incidents to preserve core actions.\n\n2. Onboarding Friction\n   - Risk: Low email verification rates and complex password resets reduce activation.\n   - Mitigation: Clear messaging for verification; resend link flow; simple reset guidance; monitor verification funnel and test copy improvements.\n\n3. Data Integrity and Concurrency Conflicts\n   - Risk: Lost updates or conflicting edits cause user confusion.\n   - Mitigation: Conflict detection behaviors and user guidance; encourage refresh and reapply; emphasize integrity in acceptance tests.\n\n4. Privacy and Access Control\n   - Risk: Improper access to another user’s data erodes trust.\n   - Mitigation: Strict ownership rules, minimum‑necessary admin access with justification, and audit expectations; periodic review of admin support accesses.\n\n5. Support Overload at Launch\n   - Risk: High contact volume overwhelms support.\n   - Mitigation: Proactive FAQ, clear in‑product guidance for common errors, temporary extended support during first 2 weeks, incident communication templates prepared.\n\n6. Scope Creep Before Go‑Live\n   - Risk: Unplanned features jeopardize schedule and quality.\n   - Mitigation: Enforce MVP scope freeze; redirect additions to post‑MVP backlog with business justification.\n\n7. Insufficient Monitoring or Alert Fatigue\n   - Risk: Missed issues or slow response to degradations.\n   - Mitigation: Focus alerts on user‑perceived metrics (success rate, p95 time); define actionable thresholds; tune based on signal‑to‑noise.\n\n8. Legal/Compliance Changes\n   - Risk: Regulatory changes or regional policies affect privacy, retention, or consent.\n   - Mitigation: Periodic policy reviews; update notices and flows; maintain documented exceptions (e.g., legal hold) as business rules.\n\n9. Dependency Outages\n   - Risk: Email delivery or other third‑party services degrade onboarding or recovery flows.\n   - Mitigation: Transparent user messaging and retry guidance; contingency plans for delayed emails; operational escalation with providers.\n\n---\n\n## Traceability to Acceptance and Success\n- Each acceptance criterion maps to features in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md) and quality targets in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n- Release readiness, monitoring, and KPI targets align with the go‑to‑market plan and KPIs in the [todoApp Service Overview](./01-todoApp-service-overview.md).\n\nEnd of document.","tokenUsage":{"total":73645,"input":{"total":66550,"cached":0},"output":{"total":7095,"reasoning":1984,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":9,"step":0,"created_at":"2025-08-15T04:01:29.353Z"},"tokenUsage":{"aggregate":{"total":926452,"input":{"total":786096,"cached":11648},"output":{"total":140356,"reasoning":50752,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":923668,"input":{"total":783759,"cached":11648},"output":{"total":139909,"reasoning":50368,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Capture the minimum functional scope for a Todo list and write testable business requirements for developers.","filename":"03-todoApp-functional-requirements.md","documentType":"requirement","outline":["Overview of Minimal Feature Set","Todo Item Management (Create, Read, Update, Delete)","Completion and Reopening of Items","Optional Attributes (description, due date)","Filtering and Sorting (business expectations)","Time Zone and Localization Behaviors","Data Ownership and Privacy Rules","Import/Export and Data Portability (optional)","Business Constraints and Limits","Acceptance Criteria (EARS format)"],"audience":"development team","keyQuestions":["What minimum features must the Todo service support?","What fields are required for a todo item and what validations apply?","How should filtering and sorting work from a business perspective?","What are the acceptance criteria for the MVP scope?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS format wherever applicable","Do not define any API endpoints or database schemas","Keep scope minimal while ensuring a complete, usable product"],"content":"# todoApp Functional Requirements (MVP)\n\nThis document defines the complete, testable business requirements for the minimal viable todoApp. It specifies WHAT the system must do in business terms so developers can implement with autonomy. This document provides business requirements only. All technical implementation decisions (architecture, APIs, data storage, indexing, libraries) are at the full discretion of the development team.\n\n## Overview of Minimal Feature Set\n\n- Personal Todo Lists for authenticated users (\"user\" role) with item ownership and privacy by default.\n- Core CRUD operations on todo items: create, read (list and detail), update, delete.\n- Completion and reopening of items with clear state transitions.\n- Optional attributes: description and due date.\n- Business-level filtering and sorting for lists.\n- Business rules for time zone handling and localization of dates.\n- Role-aware access control at the business level, consistent with the authentication document.\n- Optional export of a user’s todos for portability.\n- Measurable constraints and limits to bound MVP scope.\n\nWHEN reading this document, refer to the following related specifications for context and deeper coverage of adjacent topics:\n- See the [todoApp Service Overview](./01-todoApp-service-overview.md) for problem context, scope, and KPIs.\n- See the [User Roles and Authentication for todoApp](./02-todoApp-user-roles-and-authentication.md) for role definitions, permissions, and authentication behaviors.\n- See the [Business Rules for todoApp](./06-todoApp-business-rules.md) for cross-cutting validation and state logic details.\n- See the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md) for user-facing error behaviors and recovery.\n- See the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance, security, reliability, and compliance expectations.\n\n## Principles and Scope Notes\n\n- Minimal Scope: Focus on a single, personal Todo list per user with item-level operations. No sharing, collaboration, tags, subtasks, or reminders in MVP.\n- Business Only: Requirements use natural language and EARS formatting, avoiding any API, database schema, or architecture prescriptions.\n- Role Context: Two roles exist and influence business behavior: \"user\" (personal ownership) and \"admin\" (support and policy enforcement).\n\n## User Roles and Access Context (Business perspective)\n\n- \"user\": Authenticated end user managing only their own todo items and account. Cannot access or modify other users’ data.\n- \"admin\": Administrative user with authority to access any user’s account when necessary for support or policy enforcement; may view aggregated analytics and configure service-wide settings.\n\nEARS Requirements:\n- THE todoApp SHALL restrict access to todo items by ownership, allowing the creator (\"user\") to manage only their own items.\n- WHERE administrative oversight is required for support or policy enforcement, THE todoApp SHALL allow \"admin\" role to access necessary user items in a controlled manner aligned with privacy rules.\n\n## Todo Item Management (Create, Read, Update, Delete)\n\n### Data Elements (Business-Level)\n- Title (required): Short text identifying the item.\n- Description (optional): Extended text elaborating the task.\n- Due Date (optional): The date by which the task is intended to be completed, interpreted in the user’s time zone.\n- Status (system-managed): \"open\" or \"completed\".\n- Created Time / Updated Time (system-managed): Timestamps recorded in business terms and displayed in the user’s time zone.\n- Owner (system-managed): The user who created the item.\n\n### Validation Rules (Business-Level)\n- Title length: 1 to 120 characters (printable characters; leading/trailing whitespace ignored for validation).\n- Description length: 0 to 1,000 characters.\n- Due Date range: Not earlier than the calendar date of item creation; not more than 5 years in the future, based on user’s time zone.\n\nEARS Requirements:\n- WHEN a \"user\" submits a new todo with a title, THE todoApp SHALL create the item and set status to \"open\".\n- IF a title is missing or its trimmed length is 0, THEN THE todoApp SHALL reject creation and instruct the user to provide a valid title of 1–120 characters.\n- IF a title exceeds 120 characters, THEN THE todoApp SHALL reject creation and instruct the user to shorten the title to 120 characters or fewer.\n- IF a description exceeds 1,000 characters, THEN THE todoApp SHALL reject creation and instruct the user to reduce the description to 1,000 characters or fewer.\n- IF a due date is provided earlier than the item’s creation date in the user’s time zone, THEN THE todoApp SHALL reject the due date and prompt the user to choose a valid date.\n- IF a due date is provided more than 5 years in the future, THEN THE todoApp SHALL reject the due date and prompt the user to choose a date within 5 years.\n- THE todoApp SHALL set Created Time at creation and Updated Time whenever any editable field changes.\n- THE todoApp SHALL allow a \"user\" to read (list and detail) only items that they own.\n- WHERE an \"admin\" views a user’s items for support, THE todoApp SHALL display the items with clear indication of the acting role and subject user.\n- WHEN a \"user\" updates an item’s title, description, or due date, THE todoApp SHALL validate all fields using the same rules as creation and update Updated Time upon success.\n- WHEN a \"user\" deletes an item, THE todoApp SHALL remove the item from their list immediately and irreversibly within MVP scope.\n- IF a \"user\" attempts to access, update, or delete an item not owned by them, THEN THE todoApp SHALL deny the operation and inform the user that access is not permitted.\n\n### Pagination and List Size (Business Expectations)\n- THE todoApp SHALL present lists in pages of up to 20 items by default, ordered by default sorting (see Filtering and Sorting).\n- WHERE a user prefers different page sizes, THE todoApp SHALL allow selection of 10, 20, 50, or 100 items per page, remembered per user.\n\n## Completion and Reopening of Items\n\nDefinitions:\n- Complete: Transition an item’s status from \"open\" to \"completed\" and record a Completion Time.\n- Reopen: Transition an item’s status from \"completed\" to \"open\" and clear Completion Time.\n\nEARS Requirements:\n- WHEN a \"user\" marks an \"open\" item as completed, THE todoApp SHALL set status to \"completed\" and record Completion Time.\n- IF an item is already \"completed\" and the user attempts to complete it again, THEN THE todoApp SHALL keep the status unchanged and inform the user that the item is already completed.\n- WHEN a \"user\" reopens a \"completed\" item, THE todoApp SHALL set status to \"open\" and clear Completion Time.\n- IF a \"user\" completes an item with a due date in the past, THEN THE todoApp SHALL still allow completion and retain the past due date for historical accuracy.\n- THE todoApp SHALL allow editing of title, description, and due date regardless of status, unless restricted by policy.\n\n## Optional Attributes (description, due date)\n\nEARS Requirements:\n- WHERE a description is provided, THE todoApp SHALL store and display it with the item.\n- WHERE a due date is provided, THE todoApp SHALL interpret it in the user’s current time zone and treat it as due by the end of that calendar day.\n- IF a due date is removed by the user, THEN THE todoApp SHALL persist the item without a due date and update Updated Time.\n- WHERE no due date is provided, THE todoApp SHALL treat the item as having no scheduling constraint.\n\n## Filtering and Sorting (business expectations)\n\nSupported Filters (combinable):\n- Status: open, completed.\n- Due Date Window: today, tomorrow, this week (Mon–Sun in user’s locale), next week, overdue (due date earlier than today), no due date.\n- Text Match: case-insensitive contains match over title and description.\n- Created/Updated Date ranges: calendar-based, using user’s time zone.\n\nSupported Sorting:\n- Default: due date ascending, with items without due date ordered last; ties by created time descending.\n- Alternative orders: due date descending; created time descending; updated time descending; title ascending.\n\nEARS Requirements:\n- THE todoApp SHALL allow a \"user\" to filter their list by status, due date window, and text match simultaneously.\n- THE todoApp SHALL apply the default sorting when no explicit sort is chosen: due date ascending, items without due date last, ties by created time descending.\n- WHERE a user selects a different sort order, THE todoApp SHALL apply the selected order consistently across pages.\n- IF filters yield zero results, THEN THE todoApp SHALL present an empty result with guidance to adjust filters.\n- WHILE filters are active, THE todoApp SHALL maintain the filter set when the user navigates between pages of results.\n\n## Time Zone and Localization Behaviors\n\nBusiness Baseline for MVP:\n- Default Service Time Zone: Asia/Seoul (KST, UTC+9) for users who have not set a profile time zone.\n- User Time Zone Preference: Each user may have a profile time zone; all date evaluations and displays use the user’s profile time zone if set.\n- Calendar Day Semantics: Due date represents obligation by the end of the calendar day in the user’s time zone.\n\nEARS Requirements:\n- THE todoApp SHALL store and display Created Time, Updated Time, and Completion Time in the user’s profile time zone where available, otherwise in Asia/Seoul (KST, UTC+9).\n- WHEN evaluating whether an item is overdue, THE todoApp SHALL compare the due date’s end-of-day boundary against the current date in the user’s time zone.\n- WHERE a user changes their profile time zone, THE todoApp SHALL re-interpret and display existing due dates and timestamps in the new time zone without altering the original calendar date values.\n- IF a due date falls on a day affected by daylight saving time in the chosen time zone, THEN THE todoApp SHALL still treat the due by end-of-day semantics consistently.\n\n## Data Ownership and Privacy Rules\n\nEARS Requirements:\n- THE todoApp SHALL associate each item with exactly one owner (the creating user) and treat it as private by default.\n- IF a \"user\" attempts to view or modify another user’s items, THEN THE todoApp SHALL deny access and communicate that the content is private.\n- WHERE an \"admin\" performs support actions on a user’s items, THE todoApp SHALL record the acting role context and restrict visibility to the minimum necessary data for the task.\n- THE todoApp SHALL permanently remove a deleted item from the owner’s list in MVP, with no recovery workflow.\n\n## Import/Export and Data Portability (optional)\n\nScope: Export is in scope for MVP; Import is out of scope for MVP.\n\nEARS Requirements:\n- WHERE a \"user\" requests an export of their items, THE todoApp SHALL provide a file containing all of the user’s items and their attributes (title, description, due date if present, status, Created/Updated/Completion Times) in a commonly portable format.\n- IF an export is requested while no items exist, THEN THE todoApp SHALL produce a valid export file containing zero items and an indication that the list is empty.\n- WHERE an export is in progress, THE todoApp SHALL notify the user upon completion using available communication channels defined in the authentication and notification policies.\n\n## Business Constraints and Limits\n\nEARS Requirements:\n- THE todoApp SHALL limit title length to 120 characters and description length to 1,000 characters.\n- THE todoApp SHALL limit due dates to within 5 years from the creation date and not earlier than the creation date in the user’s time zone.\n- THE todoApp SHALL limit the number of items returned per page to one of the supported sizes: 10, 20, 50, or 100.\n- WHERE operational stability requires, THE todoApp SHALL limit item creation to no more than 60 new items per user per minute.\n- WHERE operational stability requires, THE todoApp SHALL limit update and delete actions to no more than 120 operations per user per minute in aggregate.\n- THE todoApp SHALL allow each user to maintain up to 10,000 items concurrently in MVP; beyond this threshold, creation is denied with guidance to archive or delete items.\n\n## Process Flows (Business-Level)\n\nThe following diagrams illustrate end-to-end business flows. They do not prescribe any technical implementation.\n\n### Create Todo Item\n```mermaid\ngraph LR\n  A[\"User Initiates Create\"] --> B[\"Enter Title/Optional Fields\"]\n  B --> C[\"Validate Business Rules\"]\n  C --> D{\"Valid?\"}\n  D -->|\"Yes\"| E[\"Create Item(Status=open)\"]\n  E --> F[\"Set Created/Updated Times\"]\n  F --> G[\"Show Item in List\"]\n  D -->|\"No\"| H[\"Show Validation Guidance\"]\n```\n\n### Complete and Reopen Flow\n```mermaid\ngraph LR\n  A[\"User Selects Item\"] --> B{\"Current Status?\"}\n  B -->|\"open\"| C[\"Mark Completed\"]\n  C --> D[\"Record Completion Time\"]\n  D --> E[\"Reflect Status=completed\"]\n  B -->|\"completed\"| F[\"Reopen Item\"]\n  F --> G[\"Clear Completion Time\"]\n  G --> H[\"Reflect Status=open\"]\n```\n\n### Filtering and Sorting Flow\n```mermaid\ngraph LR\n  A[\"User Opens List\"] --> B[\"Apply Default Sort\"]\n  B --> C[\"User Sets Filters\"]\n  C --> D[\"Combine Filters\"]\n  D --> E[\"Fetch Page(Size per Preference)\"]\n  E --> F{\"Any Results?\"}\n  F -->|\"Yes\"| G[\"Display Items\"]\n  F -->|\"No\"| H[\"Display Empty State Guidance\"]\n```\n\n## Acceptance Criteria (EARS format)\n\nCreation\n- WHEN a \"user\" submits a new item with a valid title (1–120 chars), THE todoApp SHALL create the item with status \"open\" and show it at the appropriate position according to current sorting.\n- IF the title is invalid (missing or >120 chars), THEN THE todoApp SHALL block creation and present guidance to correct the title without losing entered data.\n- WHERE a description up to 1,000 chars is provided, THE todoApp SHALL save it verbatim.\n- IF a due date is provided and is earlier than the creation date or beyond 5 years, THEN THE todoApp SHALL reject the due date with clear guidance.\n\nReading\n- THE todoApp SHALL present items in pages using the user’s preferred page size (default 20), sorted per the active sort rule.\n- WHEN a \"user\" filters by status=\"open\" and due date window=\"today\", THE todoApp SHALL return only the user’s open items due today in their time zone.\n- IF a filter combination results in no matches, THEN THE todoApp SHALL display an empty state with guidance to adjust filters.\n\nUpdating\n- WHEN a \"user\" edits the title, THE todoApp SHALL validate the new title against the same rules as creation and update Updated Time upon success.\n- WHEN a \"user\" edits the description or due date, THE todoApp SHALL validate lengths and date ranges and update Updated Time upon success.\n- IF validation fails on update, THEN THE todoApp SHALL preserve existing data and present guidance to correct inputs.\n\nDeletion\n- WHEN a \"user\" deletes an item they own, THE todoApp SHALL remove it from their list immediately and it SHALL no longer appear in any filter or search.\n- IF a \"user\" attempts to delete an item they do not own, THEN THE todoApp SHALL deny the request and inform the user that access is not permitted.\n\nCompletion/Reopen\n- WHEN a \"user\" completes an open item, THE todoApp SHALL set status to \"completed\" and record Completion Time; the item SHALL still appear according to filters and sorting.\n- WHEN a \"user\" reopens a completed item, THE todoApp SHALL set status to \"open\" and clear Completion Time; the item SHALL re-enter lists according to filters and sorting.\n\nFiltering and Sorting\n- THE todoApp SHALL support filters: status (open/completed), due date windows (today/tomorrow/this week/next week/overdue/no due date), text match, and created/updated date ranges.\n- THE todoApp SHALL support sorts: due date ascending (default, none last; tie by created time desc), due date descending, created time desc, updated time desc, title asc.\n\nTime Zone\n- THE todoApp SHALL treat due dates as end-of-day obligations in the user’s time zone and compute \"overdue\" accordingly.\n- WHERE no profile time zone is set, THE todoApp SHALL default to Asia/Seoul (KST, UTC+9) for all date/time calculations and displays.\n\nOwnership & Privacy\n- THE todoApp SHALL ensure a user can access only their own items; admin may access items for support per policy.\n- IF cross-user access is attempted by a non-admin, THEN THE todoApp SHALL deny and present a privacy message.\n\nExport\n- WHERE a user requests export, THE todoApp SHALL produce a portable file containing all owned items and attributes, including timestamps and status, consistent with current time zone display rules.\n- IF no items exist, THEN THE todoApp SHALL produce a valid export file with zero items and a clear indication of emptiness.\n\nLimits\n- THE todoApp SHALL enforce per-user maximum of 10,000 concurrent items and SHALL present a guidance message when the limit is reached.\n- THE todoApp SHALL enforce per-minute operation limits for creation and update/delete as stated, presenting user-friendly guidance upon reaching limits.\n\n## Traceability and Related Documents\n\n- Business vision and KPIs: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Roles, permissions, and authentication: [User Roles and Authentication for todoApp](./02-todoApp-user-roles-and-authentication.md)\n- Cross-cutting rules and validations: [Business Rules for todoApp](./06-todoApp-business-rules.md)\n- Error responses and recovery: [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance, availability, and security targets: [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md)\n\nEnd of document."},"plan":"Document type: requirement for todoApp (service prefix)\nAudience: development team\nPurpose: Capture minimal functional scope for a Todo list and provide testable business requirements for developers\nOutline to satisfy:\n1) Overview of Minimal Feature Set\n2) Todo Item Management (Create, Read, Update, Delete)\n   - Data elements, validation, ownership, concurrency/conflict, deletion/restoration/purge\n3) Completion and Reopening of Items\n4) Optional Attributes (description, due date)\n5) Filtering and Sorting (business expectations)\n6) Time Zone and Localization Behaviors\n7) Data Ownership and Privacy Rules\n8) Import/Export and Data Portability (optional)\n9) Business Constraints and Limits\n10) Acceptance Criteria (EARS format)\nCross-references: service overview, roles & authentication, business rules, error handling, non-functional requirements\nConstraints: Use EARS where applicable; keep scope minimal and business-only; no API or schema details; maintain mermaid correctness","review":"Enhance to a production-ready, implementation-focused requirements document with the following enforced criteria:\n- Length: 5,000–30,000+ characters; fully developed sections per outline\n- EARS compliance: Convert all applicable statements to EARS (WHEN/WHILE/IF/THEN/WHERE/THE/SHALL)\n- Specificity: Measurable, testable requirements; no vague language; business terms only\n- Scope purity: Business requirements only; no API endpoints, database schemas, or technical architecture\n- Role alignment: Permissions and ownership in business terms consistent with roles (user, admin)\n- Cross-doc consistency: Align deletion behavior, limits, and validations with business rules and NFRs\n- Mermaid correctness: All labels in double quotes, no spaces between brackets/braces and quotes, proper arrows (--> or -->|\"Label\"|), LR orientation\n- Links: Use descriptive link text with relative paths\n- Error handling and edge cases: Include user-facing recovery behaviors in business terms\n- Time zone and localization: Clear rules (user time zone priority, DST handling) in natural language\n- Prohibited: Any database schema, API specification, or technical implementation detail\n- Acceptance criteria: Comprehensive EARS section covering all MVP behaviors\n- Completeness: Add missing workflows (trash/restore/purge, conflicts) and unify constraints (description length, due-date ranges, rate limits)\n- Language: en-US professional tone","content":"# todoApp Functional Requirements (MVP)\n\n## Overview of Minimal Feature Set\n\n- Personal Todo lists scoped to authenticated users with strict item ownership and privacy by default.\n- Core item operations: create, read (list and detail), update, delete to trash, restore, and purge per retention policy.\n- State transitions for completion and reopening with timestamp semantics.\n- Optional attributes: description and due date (date-only semantics by default).\n- Business-level filtering and sorting for lists with stable defaults and user-selected variations.\n- Time zone and localization rules: user’s profile time zone governs evaluation and display; DST-safe semantics.\n- Role-aware access control in business terms aligned with the roles and authentication specification.\n- Optional data export for portability (import out-of-scope for MVP).\n- Explicit constraints and limits on fields, inventory, and operation frequency.\n\nRelated references:\n- Business context and KPIs: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Roles, authentication, and permissions: [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n- Cross-cutting rules and state logic: [todoApp Business Rules and Constraints](./06-todoApp-business-rules.md)\n- Error behavior and recovery: [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance, security, and availability targets: [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n\n## Principles and Scope Notes\n\n- Minimal scope focuses on personal task management with item-level operations. No collaboration, tags, subtasks, reminders, or external integrations in MVP.\n- Business-only specification: requirements expressed in natural language using EARS where applicable; no API endpoints, data schemas, or technology choices.\n- Roles in scope: \"user\" (owns personal items) and \"admin\" (limited oversight for support/policy with audit and least privilege).\n\n## User Roles and Access Context (Business Perspective)\n\n- \"user\": Authenticated end user who can manage only owned items and personal account.\n- \"admin\": Administrative actor who may access a user’s items only for legitimate support or policy enforcement with strict accountability.\n\nEARS requirements:\n- THE todoApp SHALL restrict access to todo items by ownership so that a \"user\" can create, read, update, complete/reopen, trash/restore, and purge only their own items.\n- WHERE administrative oversight is justified for support or policy enforcement, THE todoApp SHALL allow \"admin\" to access the minimum necessary user items for the task under audit.\n\n## Todo Item Management (Create, Read, Update, Delete/Trash/Restore/Purge)\n\n### Data Elements (Business-Level)\n- Title (required): Short text identifying the item.\n- Description (optional): Extended text elaborating the task.\n- Due Date (optional): Target completion date interpreted in the user’s time zone; default date-only semantics (end-of-day).\n- Status (system-managed): \"open\" or \"completed\".\n- Created Time / Updated Time (system-managed): Timestamps captured on create and on each successful edit.\n- Completion Time (system-managed): Timestamp captured when status becomes \"completed\" and cleared on reopen.\n- Owner (system-managed): The user who created the item.\n- Deletion State (system-managed): \"active\" (not trashed), \"trashed\" (soft-deleted), or \"purged\" (irreversible).\n\n### Validation Rules (Business-Level)\n- Title length: 1 to 120 Unicode characters after trimming leading/trailing whitespace; control characters not allowed.\n- Description length: 0 to 2,000 Unicode characters after trimming; control characters not allowed.\n- Due Date range: Not earlier than 1 January 1970 in the user’s time zone; not more than 10 years in the future.\n\nEARS requirements (creation and update):\n- WHEN a \"user\" submits a new todo with a valid title, THE todoApp SHALL create the item with status \"open\" and set Created Time and Updated Time.\n- IF a title is missing or its trimmed length is 0, THEN THE todoApp SHALL reject creation and instruct to provide a valid title of 1–120 characters without control characters.\n- IF a title exceeds 120 characters, THEN THE todoApp SHALL reject creation and instruct to shorten the title to 120 characters or fewer.\n- IF a description exceeds 2,000 characters, THEN THE todoApp SHALL reject creation or update and instruct to reduce the description to 2,000 characters or fewer.\n- IF a due date is provided earlier than 1 January 1970 (user-local) or more than 10 years in the future, THEN THE todoApp SHALL reject the due date and prompt selection of a valid date.\n- THE todoApp SHALL update Updated Time on any successful edit of title, description, due date, or status.\n- THE todoApp SHALL allow a \"user\" to read (list and detail) only items owned by that user.\n- WHERE an \"admin\" views a user’s items for support, THE todoApp SHALL indicate the acting role and subject user context.\n\n### Concurrency and Conflict Handling\n\nEARS requirements:\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent silent overwrite and require the user to refresh or reconcile prior to saving.\n- WHEN reconciliation is required after a conflict, THE todoApp SHALL present guidance that enables retry with the latest version without losing the user’s attempted edits.\n\n### Deletion, Restoration, and Purging\n\nDefinitions:\n- Trash (soft-delete): Move an item from active/completed to trashed; hidden from normal listings; restorable within retention window.\n- Restore: Return an item from trashed to active state; retain prior fields other than deletion metadata.\n- Purge (hard delete): Irreversibly remove a trashed item after retention or upon explicit user purge.\n\nEARS requirements:\n- WHEN a \"user\" deletes an item they own, THE todoApp SHALL move the item to \"trashed\" and exclude it from normal lists while starting a 30-day retention countdown.\n- WHILE an item is \"trashed\" within retention, THE todoApp SHALL allow the owner to restore it to the \"open\" status with all fields preserved and clear deletion metadata.\n- WHEN a \"trashed\" item reaches the retention deadline, THE todoApp SHALL purge it automatically in the next scheduled purge cycle.\n- WHEN a \"user\" explicitly purges a \"trashed\" item, THE todoApp SHALL remove it irreversibly and exclude it from all user-accessible views.\n- IF a \"user\" attempts to view or modify another user’s trashed items, THEN THE todoApp SHALL deny access and avoid revealing existence.\n\n### Pagination and List Size (Business Expectations)\n\nEARS requirements:\n- THE todoApp SHALL present lists in pages of up to 20 items by default, ordered by the default sort policy.\n- WHERE a user chooses a different page size, THE todoApp SHALL support 10, 20, 50, or 100 items per page and remember the preference per user.\n\n## Completion and Reopening of Items\n\nDefinitions:\n- Complete: Transition status from \"open\" to \"completed\" and record Completion Time.\n- Reopen: Transition status from \"completed\" to \"open\" and clear Completion Time.\n\nEARS requirements:\n- WHEN a \"user\" marks an \"open\" item as completed, THE todoApp SHALL set status to \"completed\" and record Completion Time.\n- IF an item is already \"completed\" and a user attempts to complete it again, THEN THE todoApp SHALL keep status unchanged and inform that the item is already completed.\n- WHEN a \"user\" reopens a \"completed\" item, THE todoApp SHALL set status to \"open\" and clear Completion Time.\n- IF a \"user\" completes an item with a due date in the past, THEN THE todoApp SHALL allow completion and retain the past due date for historical accuracy.\n- THE todoApp SHALL allow editing of title, description, and due date regardless of status unless restricted by policy.\n\n## Optional Attributes (description, due date)\n\nEARS requirements:\n- WHERE a description is provided, THE todoApp SHALL store and present it with the item.\n- WHERE a due date is provided as a date-only value, THE todoApp SHALL interpret it as due by end-of-day in the user’s time zone.\n- IF a due date is removed by the user, THEN THE todoApp SHALL persist the item without a due date and update Updated Time.\n- WHERE no due date is provided, THE todoApp SHALL treat the item as having no scheduling constraint.\n\n## Filtering and Sorting (business expectations)\n\nSupported filters (combinable):\n- Status: open, completed, trashed (optional view), or all non-trashed.\n- Due date window: today, tomorrow, this week (Mon–Sun in user’s locale), next week, overdue (due date earlier than today), or no due date.\n- Text match: case-insensitive contains over title and description.\n- Created/Updated date ranges: calendar-based, using the user’s time zone.\n\nSupported sorting:\n- Default: due date ascending, items without due date ordered last; ties by created time descending.\n- Alternatives: due date descending; created time descending; updated time descending; title ascending.\n\nEARS requirements:\n- THE todoApp SHALL allow a \"user\" to filter by status, due date window, text match, and date ranges simultaneously.\n- THE todoApp SHALL apply the default sorting when no explicit sort is chosen: due date ascending with items without due date last and ties by created time descending.\n- WHERE a user selects a different sort, THE todoApp SHALL apply the selected order consistently across pages.\n- IF filters yield zero results, THEN THE todoApp SHALL present an empty result with guidance to adjust filters.\n- WHILE filters are active, THE todoApp SHALL maintain the active filter set when a user navigates between pages of results.\n\n## Time Zone and Localization Behaviors\n\nBusiness baseline for MVP:\n- Default service time zone: Asia/Seoul (KST, UTC+9) when a profile time zone is not set.\n- User time zone preference: Every date evaluation and display uses the user’s profile time zone if available.\n- Calendar day semantics: Due date represents obligation by the end of the calendar day in the user’s time zone.\n\nEARS requirements:\n- THE todoApp SHALL display Created Time, Updated Time, and Completion Time in the user’s profile time zone where available, otherwise in Asia/Seoul (KST, UTC+9).\n- WHEN determining whether an item is overdue, THE todoApp SHALL compare the due date’s end-of-day boundary to the current date in the user’s time zone.\n- WHERE a user changes the profile time zone, THE todoApp SHALL re-interpret and display existing due dates and timestamps in the new time zone without altering original calendar date values.\n- IF a due date falls on a day affected by DST in the chosen time zone, THEN THE todoApp SHALL maintain end-of-day semantics consistently and adjust non-existent local times to the next valid time.\n\n## Data Ownership and Privacy Rules\n\nEARS requirements:\n- THE todoApp SHALL associate each item with exactly one owner (the creator) and treat it as private by default.\n- IF a \"user\" attempts to view or modify another user’s items (including trashed items), THEN THE todoApp SHALL deny access and avoid revealing existence.\n- WHERE an \"admin\" performs support actions on a user’s items, THE todoApp SHALL record the acting role context and restrict visibility to the minimum necessary data.\n\n## Import/Export and Data Portability (optional)\n\nScope: Export in scope; import out of scope for MVP.\n\nEARS requirements:\n- WHERE a \"user\" requests an export, THE todoApp SHALL provide a file containing all owned items and attributes (title, description, due date if present, status, Created/Updated/Completion Times, deletion state where applicable) in a commonly portable format.\n- IF an export is requested while no items exist, THEN THE todoApp SHALL produce a valid export file containing zero items and an indication that the list is empty.\n- WHERE an export is processed asynchronously, THE todoApp SHALL notify the user upon completion using available communication channels defined in policy.\n\n## Business Constraints and Limits\n\nEARS requirements:\n- THE todoApp SHALL limit title length to 120 characters and description length to 2,000 characters.\n- THE todoApp SHALL limit due dates to within 10 years into the future and not earlier than 1 January 1970 in the user’s time zone.\n- THE todoApp SHALL limit items per page to 10, 20, 50, or 100 with a default of 20.\n- THE todoApp SHALL allow up to 5,000 active (non-trashed) items per user; attempts to exceed this SHALL be denied with guidance to archive, delete, or purge.\n- THE todoApp SHALL allow up to 5,000 trashed items retained per user; where this cap is exceeded, older trashed items SHALL be purged first.\n- THE todoApp SHALL limit total items per user (all states except purged) to 10,000.\n- WHERE operational stability requires, THE todoApp SHALL throttle per-user operation frequency as follows: create up to 30 items/minute; update up to 60 items/minute; complete/reopen up to 120 state changes/minute; trash/restore up to 60 operations/minute; purge up to 30 operations/minute.\n\n## Process Flows (Business-Level)\n\nThe following Mermaid diagrams visualize end-to-end business flows in LR orientation; they express business behavior, not technical design.\n\n### Create Todo Item\n```mermaid\ngraph LR\n  A[\"User Initiates Create\"] --> B[\"Enter Title/Optional Fields\"]\n  B --> C[\"Validate Business Rules\"]\n  C --> D{\"Valid?\"}\n  D -->|\"Yes\"| E[\"Create Item(Status=open)\"]\n  E --> F[\"Set Created/Updated Times\"]\n  F --> G[\"Show Item in List\"]\n  D -->|\"No\"| H[\"Show Validation Guidance\"]\n```\n\n### Complete and Reopen Flow\n```mermaid\ngraph LR\n  A[\"User Selects Item\"] --> B{\"Current Status?\"}\n  B -->|\"open\"| C[\"Mark Completed\"]\n  C --> D[\"Record Completion Time\"]\n  D --> E[\"Reflect Status=completed\"]\n  B -->|\"completed\"| F[\"Reopen Item\"]\n  F --> G[\"Clear Completion Time\"]\n  G --> H[\"Reflect Status=open\"]\n```\n\n### Delete, Restore, and Purge Flow\n```mermaid\ngraph LR\n  A[\"User Selects Item\"] --> B{\"Delete?\"}\n  B -->|\"Yes\"| C[\"Move To Trashed\"]\n  C --> D[\"Hide From Normal Lists\"]\n  C --> E{\"Restore Within Retention?\"}\n  E -->|\"Yes\"| F[\"Restore To Open\"]\n  F --> G[\"Clear Deletion Metadata\"]\n  E -->|\"No\"| H[\"Eligible For Automatic Purge\"]\n  H --> I[\"Purge Irreversibly\"]\n```\n\n### Filtering and Sorting Flow\n```mermaid\ngraph LR\n  A[\"User Opens List\"] --> B[\"Apply Default Sort\"]\n  B --> C[\"User Sets Filters\"]\n  C --> D[\"Combine Filters\"]\n  D --> E[\"Fetch Page(Size per Preference)\"]\n  E --> F{\"Any Results?\"}\n  F -->|\"Yes\"| G[\"Display Items\"]\n  F -->|\"No\"| H[\"Display Empty State Guidance\"]\n```\n\n## Acceptance Criteria (EARS format)\n\nCreation\n- WHEN a \"user\" submits a new item with a valid title (1–120 chars), THE todoApp SHALL create the item with status \"open\" and display it in the list according to current sorting.\n- IF the title is invalid (missing, zero-length after trim, or >120 chars), THEN THE todoApp SHALL block creation and present guidance to correct the title without losing entered data.\n- WHERE a description up to 2,000 chars is provided, THE todoApp SHALL save it verbatim subject to control character restrictions.\n- IF a due date is earlier than 1970-01-01 (user-local) or more than 10 years in the future, THEN THE todoApp SHALL reject the due date with clear guidance.\n\nReading\n- THE todoApp SHALL present items in pages using the user’s preferred page size (default 20), sorted per the active sort rule.\n- WHEN a \"user\" filters by status=\"open\" and due date window=\"today\", THE todoApp SHALL return only the user’s open items due today in the user’s time zone.\n- IF a filter combination results in no matches, THEN THE todoApp SHALL display an empty state with guidance to adjust filters.\n\nUpdating and Conflicts\n- WHEN a \"user\" edits fields, THE todoApp SHALL validate against creation rules and update Updated Time upon success.\n- IF validation fails on update, THEN THE todoApp SHALL preserve existing data and present guidance to correct inputs.\n- IF a concurrent modification is detected, THEN THE todoApp SHALL prevent silent overwrite and require refresh or reconciliation before saving.\n\nDeletion, Restoration, and Purge\n- WHEN a \"user\" deletes an owned item, THE todoApp SHALL move it to \"trashed\" and hide it from normal lists while starting the retention window.\n- WHILE an item is in \"trashed\" state and within retention, THE todoApp SHALL allow restoration to the \"open\" status with prior content intact.\n- WHEN the retention period elapses, THE todoApp SHALL purge the item in the next scheduled purge and remove it irreversibly.\n- WHEN a \"user\" explicitly purges a \"trashed\" item, THE todoApp SHALL remove it irreversibly and it SHALL not appear in any listing or filter thereafter.\n\nCompletion/Reopen\n- WHEN a \"user\" completes an open item, THE todoApp SHALL set status to \"completed\" and record Completion Time; the item SHALL still appear according to filters and sorting.\n- WHEN a \"user\" reopens a completed item, THE todoApp SHALL set status to \"open\" and clear Completion Time; the item SHALL re-enter lists according to filters and sorting.\n\nFiltering and Sorting\n- THE todoApp SHALL support filters: status (open/completed/trashed or non-trashed), due date windows (today/tomorrow/this week/next week/overdue/no due date), text match, and created/updated date ranges.\n- THE todoApp SHALL support sorts: due date ascending (default, none last; tie by created time desc), due date descending, created time desc, updated time desc, title asc.\n\nTime Zone\n- THE todoApp SHALL treat date-only due dates as end-of-day obligations in the user’s time zone and compute overdue accordingly.\n- WHERE no profile time zone is set, THE todoApp SHALL default to Asia/Seoul (KST, UTC+9) for time calculations and displays.\n- IF a due date falls within a DST gap, THEN THE todoApp SHALL adjust to the next valid local time and maintain end-of-day semantics for date-only values.\n\nOwnership & Privacy\n- THE todoApp SHALL ensure a user can access only their own items; admin may access items for support per policy with audit.\n- IF cross-user access is attempted by a non-admin, THEN THE todoApp SHALL deny and present a privacy message.\n\nExport\n- WHERE a user requests export, THE todoApp SHALL produce a portable file containing all owned items and attributes, including timestamps, status, and deletion state, consistent with current time zone display rules.\n- IF no items exist, THEN THE todoApp SHALL produce a valid export file with zero items and a clear indication of emptiness.\n\nLimits and Rate Controls\n- THE todoApp SHALL enforce per-user maxima of 5,000 active items, 5,000 trashed items (purging oldest first when exceeded), and 10,000 total items excluding purged.\n- THE todoApp SHALL enforce per-minute operation limits for create (30), update (60), complete/reopen (120), trash/restore (60), and purge (30), presenting user-friendly guidance when limits are reached.\n\n## Traceability and Related Documents\n\n- Business vision and KPIs: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Roles, permissions, and authentication: [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n- Cross-cutting validations, state logic, and retention: [todoApp Business Rules and Constraints](./06-todoApp-business-rules.md)\n- User-facing failures and recovery: [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance and availability targets: [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n","tokenUsage":{"total":75309,"input":{"total":66743,"cached":0},"output":{"total":8566,"reasoning":3392,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":10,"step":0,"created_at":"2025-08-15T04:02:04.526Z"},"tokenUsage":{"aggregate":{"total":1001761,"input":{"total":852839,"cached":11648},"output":{"total":148922,"reasoning":54144,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":998977,"input":{"total":850502,"cached":11648},"output":{"total":148475,"reasoning":53760,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeReview","file":{"reason":"Set performance, security, privacy, reliability, and compliance expectations in user terms.","filename":"08-todoApp-non-functional-requirements.md","documentType":"requirement","outline":["Performance and Responsiveness Expectations","Security and Privacy Principles","Availability and Reliability Expectations","Scalability Expectations","Compliance and Legal Considerations","Operational Monitoring and Alerting (business expectations)","Non-Functional Acceptance Criteria (EARS)"],"audience":"development team","keyQuestions":["What performance is expected for core operations?","What security and privacy standards must be met?","What availability and reliability targets apply?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["State measurable targets in user terms (e.g., within N seconds)","Avoid technology choices or architectural prescriptions","Use EARS for acceptance criteria"],"content":"# 08 — todoApp Non-Functional Requirements\n\n## Document Purpose\nThis document defines the business-level non-functional requirements for todoApp. It specifies measurable expectations for performance, security, privacy, availability, reliability, scalability, compliance, and operational monitoring. The document describes WHAT outcomes the system must deliver from a user and business perspective and deliberately avoids prescribing HOW to implement them. No API specifications, database schemas, or technology choices are included.\n\n## Related Documents\n- Refer to the Service Vision and Scope in the [Service Overview for todoApp](./01-todoApp-service-overview.md) for business objectives and success metrics.\n- Role and access expectations are defined in the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n- Error categories, user messaging, and recovery guidance are defined in the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md).\n\n## Definitions and Assumptions\n- “Interactive action” refers to user-triggered operations with immediate feedback (e.g., viewing list, creating/updating/completing/deleting a todo item, logging in/out).\n- Time references are expressed in seconds (s) or milliseconds (ms) and percentiles (p50, p95, p99) measured at the boundary where the user perceives completion.\n- “Business day” refers to 09:00–18:00 in Asia/Seoul (KST) unless stated otherwise. Scheduled maintenance references local time in KST.\n- “Sensitive action” refers to operations that affect account control or privacy (e.g., password change, email change, account deletion, session revocation).\n- “Peak period” denotes high-usage windows typical of 19:00–23:00 KST on weekdays and 10:00–23:00 KST on weekends.\n- Confidential and personal data include identifiers (e.g., email), authentication factors, and any user-generated content in todo items or metadata.\n\n---\n\n## Performance and Responsiveness Expectations\nThe following targets are user-perceived. All targets are for the 95th percentile unless otherwise noted and must be met under the defined scale and concurrency assumptions in this document.\n\n### Core Interaction Targets\n- List my todos (paginated up to 50 items): p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Create a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Update a todo (title/description/due date/priority): p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Complete or reopen a todo: p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Delete a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Bulk complete/reopen up to 50 items: p95 ≤ 1,000 ms; p99 ≤ 2,000 ms.\n- Authentication (enter credentials to signed-in state): p95 ≤ 2,000 ms; p99 ≤ 4,000 ms.\n- Email-based actions (verification or password reset): email dispatched within 60 s p95.\n- Admin lookups for a single user account (non-invasive read): p95 ≤ 800 ms.\n\n### Payload and Result Size Expectations\n- Pagination size for interactive list retrieval: up to 50 items per request; results include minimal fields necessary for the list view.\n- Todo description length supported up to 1,000 characters without truncation in storage; if longer content is allowed by product policy, interactive viewing and editing must still meet targets above for up to 1,000 characters.\n- Import/export operations that exceed interactive targets SHALL be processed asynchronously with progress or completion notification.\n\n### Throughput and Concurrency Targets (Business-Level)\n- MVP load: sustain 100 requests per second (RPS) aggregate with short bursts up to 300 RPS for 5 minutes without violating p95 targets.\n- Concurrency: support at least 1,000 concurrently active signed-in sessions during peak periods with no degradation beyond the p95 targets.\n- Growth headroom: maintain stable performance up to 3× the MVP sustained load without user-visible regressions greater than 20% of stated targets.\n\n### Rate Limiting (User-Centric)\n- Write operations (create/update/complete/delete) per account: up to 60 actions per minute without throttling; above this threshold may be rate-limited to protect system availability.\n- Read operations (list/search/filter) per account: up to 120 actions per minute without throttling; above this threshold may be rate-limited.\n- Authentication attempts: see Security section for protections and lockout expectations.\n\n### Time Zone and Consistency\n- Read-after-write for a user’s own content: changes made by the user appear in subsequent reads immediately p95 ≤ 1,000 ms and p99 ≤ 2,000 ms.\n- Cross-device visibility for a user’s own changes: p95 ≤ 3,000 ms.\n\n---\n\n## Security and Privacy Principles\nSecurity requirements ensure confidentiality, integrity, and proper access control. Privacy requirements ensure minimal collection, transparent use, and user control over personal data. These principles align with role definitions and session behaviors defined in the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n\n### Authentication and Session Management\n- Only verified accounts may perform non-public actions. Unverified accounts have strictly limited capabilities per the roles document.\n- Sessions expire after 30 days of inactivity; sensitive actions always require recent re-authentication (within the last 15 minutes).\n- Users can revoke all active sessions immediately from an account security control.\n\n### Credential and Account Protection\n- Password policy: minimum 8 characters; acceptance of long passphrases (≥12 characters) without special-character requirements; rejection of top 10,000 common passwords.\n- Login protection: after 10 failed attempts within 10 minutes for an account or from a single source, impose a cooling period of 5 minutes with user-facing guidance for secure recovery.\n- Sensitive changes (email/password) require confirmation through a second factor channel (e.g., a one-time confirmation code via the verified email channel) without prescribing specific technologies.\n\n### Authorization and Least Privilege\n- Users may only access their own content. Admin actions are logged and limited to the minimum necessary for support and policy enforcement.\n- Admins cannot view or edit user content marked as private notes that include sensitive information beyond what is necessary for policy enforcement.\n\n### Data Minimization and Purpose Limitation\n- Collect only data necessary to operate todoApp and provide the service.\n- Prohibit storage of special categories of personal data in system-managed fields (e.g., national ID numbers) and discourage sensitive content in todo text through policy and guidance.\n\n### Data Protection\n- Data in transit and data at rest must be protected using strong, industry-accepted cryptographic safeguards without specifying particular ciphers or libraries.\n- Encryption keys and secrets must be protected by processes that enforce least privilege, dual control for changes, and auditability.\n\n### Audit Logging and Access Transparency\n- Log security-relevant events: authentication successes/failures, password changes, email changes, session revocations, account deletions, admin support actions, and mass/bulk operations affecting more than 20 items.\n- Provide user-accessible activity history for their own account, retaining at least 90 days of entries.\n\n### Privacy Controls and User Rights\n- Provide accessible Privacy Policy and Terms of Service before account creation and within account settings.\n- Provide self-service account deletion with clear warnings about irreversible effects and data retention timelines.\n- Provide export of user-owned data in a commonly used, machine-readable format within reasonable size limits.\n\n---\n\n## Availability and Reliability Expectations\nThese expectations define uptime, recovery, and continuity behaviors visible to users and administrators.\n\n### Availability Targets\n- Service-level objective (SLO) for user-facing availability: 99.9% monthly.\n- Planned maintenance windows: default window Sundays 02:00–04:00 KST, announced at least 72 hours in advance. Emergency maintenance is allowed with immediate notice and clear user messaging.\n\n### Reliability and Continuity\n- RTO (Recovery Time Objective): critical user operations recover within 60 minutes following an outage under the assumed deployment and operational model.\n- RPO (Recovery Point Objective): no more than 5 minutes of data for committed operations is lost in a disaster scenario.\n- Durability expectation: once a user receives a success confirmation for a write, that data persists and remains retrievable after any transient fault.\n\n### Degradation and Failover Behavior\n- Graceful degradation: non-critical features (e.g., bulk operations, optional analytics) may be temporarily disabled to preserve core CRUD functionality.\n- Read-only mode: during partial outages, the system may enter read-only mode with clear user messaging; write attempts should be queued or safely rejected with recovery guidance per the error handling document.\n\n### Consistency and Ordering\n- For a single user’s data, operations that depend on ordering (e.g., marking complete, then deleting) must reflect the most recent committed action in subsequent reads.\n- Conflict handling during concurrent updates follows the business rules in the relevant documents, ensuring users receive clear guidance without exposing technical details.\n\n---\n\n## Scalability Expectations\nScalability requirements ensure predictable behavior as usage grows.\n\n### Baseline and Growth Assumptions\n- MVP baseline: 50,000 monthly active users (MAU), 5,000 daily active users (DAU), 1,000 peak concurrent sessions, 100 sustained RPS with 300 RPS bursts.\n- Growth: targets must be maintainable up to 3× baseline without user-visible regressions beyond 20% of stated p95 targets and without service downtime for capacity increases.\n\n### Business Limits\n- Maximum todos per user: 10,000 active items. Archival or export workflows should be encouraged beyond this threshold.\n- Bulk operations: up to 100 items per interactive bulk action; larger sets are processed asynchronously with user notification upon completion.\n\n### Elasticity and Resource Management\n- Capacity increases and decreases should be transparent to users and must not cause outages or data loss.\n\n---\n\n## Compliance and Legal Considerations\nThese expectations align with common privacy frameworks without asserting jurisdiction-specific legal advice.\n\n- Privacy by design: default to the minimum data necessary; privacy settings default to the most protective reasonable option.\n- Notice and consent: obtain user consent for optional data uses such as marketing communications; provide easy opt-out.\n- Data subject rights: enable access, rectification, export, and deletion of user data within 30 days of verified request.\n- Child safety: the service is intended for users aged 13+ unless local law imposes a higher age; when required, obtain guardian consent consistent with applicable law.\n- Data retention: business records (e.g., audit logs) retained for 90 days minimum; user data retention after account deletion follows the data lifecycle policy in the relevant document.\n- Cross-border data transfer: disclose data processing locations and ensure transfers comply with applicable cross-border transfer requirements.\n\n---\n\n## Operational Monitoring and Alerting (Business Expectations)\nMonitoring ensures the stated objectives are continuously met and regressions are detected promptly.\n\n### Key Performance Indicators (KPIs)\n- Latency: p50/p95/p99 across core interactions (list, create, update, complete, delete, login).\n- Error rate: percentage of failed interactions per category (authentication, authorization, validation, conflict, not found, service unavailable) as defined in the error handling document.\n- Throughput: sustained and peak RPS; concurrency of active sessions.\n- Availability: monthly uptime against the 99.9% SLO and error budget consumption.\n- Security signals: failed login spikes, password reset spikes, session revocations, admin privileged operations.\n- Data integrity: periodic checks that ensure committed writes are retrievable and uncorrupted.\n\n### Alerting Thresholds and Response Expectations\n- Critical user operation latency breach: if p95 for list/create/update/complete/delete exceeds target by 25% for 5 consecutive minutes, generate a critical alert.\n- Availability breach: if rolling 5-minute availability falls below 99%, generate a critical alert.\n- Error spike: if failed interactions exceed 2% over 10 minutes for any core operation, generate a high-severity alert with categorization.\n- Security anomaly: if there are more than 50 failed logins for a single account or 500 across the service within 10 minutes, generate a high-severity alert and apply protective measures consistent with lockout policy.\n- On-call responsiveness: acknowledge critical alerts within 5 minutes 24/7; initiate mitigation within 15 minutes; communicate user-facing status within 30 minutes of incident start.\n\n### Incident Management Flow\n```mermaid\ngraph LR\n  subgraph \"Detection\"\n    A[\"Monitoring Detects Breach\"] --> B[\"Alert Generated\"]\n  end\n  subgraph \"Triage\"\n    C[\"On-call Acknowledges\"] --> D[\"Severity Classification\"]\n    D --> E[\"User Impact Assessment\"]\n  end\n  subgraph \"Mitigation\"\n    F[\"Apply Safeguards(Degrade/Throttle/Read-only)\"] --> G[\"Restore Core Functions\"]\n  end\n  subgraph \"Communication\"\n    H[\"Post Status Update(KST Time)\"] --> I[\"Customer Support Briefing\"]\n  end\n  subgraph \"Recovery\"\n    J[\"Validate Data Integrity\"] --> K[\"Confirm SLO Recovery\"]\n  end\n  subgraph \"Postmortem\"\n    L[\"Root Cause Analysis\"] --> M[\"Action Items&Owners\"]\n  end\n  B --> C\n  E --> F\n  G --> H\n  H -.-> I\n  G --> J\n  K --> L\n```\n\n---\n\n## Non-Functional Acceptance Criteria (EARS)\nThe following acceptance criteria are expressed in EARS format. Keywords WHEN/WHILE/IF/THEN/WHERE/THE/SHALL remain in English; all descriptions are in business terms.\n\n### Performance\n- WHEN a user retrieves a page of their todo list up to 50 items during peak period, THE todoApp SHALL deliver the response within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user creates a todo with title and optional description up to 1,000 characters, THE todoApp SHALL confirm creation within 400 ms at p95 and within 800 ms at p99.\n- WHEN a user completes or reopens a todo, THE todoApp SHALL reflect the change within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user logs in with valid credentials, THE todoApp SHALL transition to a signed-in state within 2,000 ms at p95 and within 4,000 ms at p99.\n- WHERE a bulk action affects up to 50 items, THE todoApp SHALL complete the action within 1,000 ms at p95 and within 2,000 ms at p99.\n- WHERE an operation exceeds interactive thresholds due to size or complexity, THE todoApp SHALL process it asynchronously and notify the user upon completion.\n\n### Consistency and Cross-Device\n- WHEN a user modifies their own todo items, THE todoApp SHALL provide read-after-write consistency for that user with visibility of the change within 1,000 ms at p95 and 2,000 ms at p99.\n- WHILE a user is signed in on multiple devices, THE todoApp SHALL propagate the user’s own changes across devices within 3,000 ms at p95.\n\n### Rate Limiting and Protection\n- WHERE an account issues more than 60 write actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance without blocking critical security actions.\n- WHERE an account issues more than 120 read actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance.\n\n### Security and Sessions\n- THE todoApp SHALL require account verification before granting non-public capabilities.\n- WHERE a session has been inactive for 30 days, THE todoApp SHALL require re-authentication before any further non-public actions.\n- IF there are 10 failed login attempts within 10 minutes for an account, THEN THE todoApp SHALL impose a 5-minute cooldown and provide secure recovery guidance to the user.\n- IF a user invokes “revoke all sessions”, THEN THE todoApp SHALL invalidate all existing sessions within 60 seconds and require re-authentication on all devices.\n- WHERE a user initiates a sensitive action, THE todoApp SHALL require recent re-authentication within the last 15 minutes.\n\n### Data Protection and Privacy\n- THE todoApp SHALL protect personal data in transit and at rest using strong safeguards and shall prevent unauthorized access by design and policy.\n- WHERE audit logs contain personal data, THE todoApp SHALL minimize and redact sensitive fields and retain logs for at least 90 days.\n- WHEN a verified user requests export of their data, THE todoApp SHALL provide a machine-readable export within 7 days for accounts smaller than 1 GB.\n- WHEN a verified user requests account deletion, THE todoApp SHALL remove user-accessible content promptly and complete deletion workflows within 30 days except where legal retention is required.\n\n### Availability and Reliability\n- THE todoApp SHALL achieve 99.9% monthly availability for core user operations under the defined load assumptions.\n- WHEN a service incident impacts users, THE todoApp SHALL publish a status update within 30 minutes of detection and provide subsequent updates at least every 60 minutes until resolution.\n- WHERE core functionality is impaired, THE todoApp SHALL prioritize read access and safe queuing or rejection of writes with clear guidance.\n- WHEN service is restored after an outage, THE todoApp SHALL meet the stated p95 performance targets within 15 minutes of recovery.\n- THE todoApp SHALL meet an RTO of 60 minutes and an RPO of 5 minutes for committed user operations.\n\n### Monitoring and Alerts\n- WHEN p95 latency for any core operation exceeds its target by 25% for 5 consecutive minutes, THE todoApp SHALL generate a critical alert for the on-call responder.\n- WHEN failed user interactions exceed 2% of attempts over a 10-minute window for any core operation, THE todoApp SHALL generate a high-severity alert with categorization.\n- WHEN security anomalies occur (e.g., more than 50 failed logins for an account or 500 service-wide within 10 minutes), THE todoApp SHALL generate a high-severity alert and apply protective measures.\n- WHERE a critical alert is generated, THE todoApp SHALL ensure on-call acknowledgment within 5 minutes and user-facing communication within 30 minutes.\n\n### Compliance and Legal\n- THE todoApp SHALL present accessible Terms of Service and Privacy Policy before account creation and within settings.\n- WHEN receiving a verified data subject request, THE todoApp SHALL fulfill access, rectification, export, or deletion within 30 days.\n- WHERE local law requires consent for optional data uses, THE todoApp SHALL capture, honor, and provide revocation of such consent.\n\n---\n\n## Appendices\n\n### A. Target Summary Tables\n\n| Category | Target |\n|---------|--------|\n| List todos (p95 | p99) | 300 ms | 600 ms |\n| Create/Update/Delete (p95 | p99) | 400 ms | 800 ms |\n| Complete/Reopen (p95 | p99) | 300 ms | 600 ms |\n| Bulk (≤50 items) (p95 | p99) | 1,000 ms | 2,000 ms |\n| Login (p95 | p99) | 2,000 ms | 4,000 ms |\n| Email dispatch (verification/reset) | ≤ 60 s p95 |\n| Availability (monthly) | 99.9% |\n| RTO | 60 minutes |\n| RPO | 5 minutes |\n| Session inactivity expiry | 30 days |\n| Sensitive action re-auth window | 15 minutes |\n| Audit log retention | ≥ 90 days |\n\n### B. Glossary\n- p95/p99: 95th and 99th percentile of response time distribution.\n- RTO: Maximum target time to restore service after an incident.\n- RPO: Maximum target window of data loss measured in time.\n- SLO: Service Level Objective, internal target for reliability.\n- Availability: Percentage of time the service is fully usable by users.\n\n---\n\nScope Clarification: This document provides business requirements only. All technical implementation decisions, including architecture, APIs, and data design, are at the discretion of the development team. The content here defines the outcomes and constraints that must be met from the user and business perspective."},"plan":"Structure according to the provided outline: 1) Performance and Responsiveness Expectations; 2) Security and Privacy Principles; 3) Availability and Reliability Expectations; 4) Scalability Expectations; 5) Compliance and Legal Considerations; 6) Operational Monitoring and Alerting; 7) Non-Functional Acceptance Criteria (EARS); plus supporting Definitions/Assumptions and Appendices. Maintain todoApp prefix, roles (user, admin), en-US language, and cross-reference related documents with descriptive links. Incorporate measurable, testable requirements with user-perceived performance budgets, privacy and security behaviors, availability/RTO/RPO, scalability baselines, monitoring thresholds, and EARS-formatted acceptance criteria. Ensure Mermaid diagrams satisfy syntax rules and tables render correctly.","review":"Enhance to implementation-ready business requirements using EARS; ensure 5,000+ chars; eliminate meta-commentary (“This document…”); ensure descriptive relative links; align cross-document constraints; validate Mermaid syntax (double quotes on all labels, no spaces between bracket/quote, proper arrows); state measurable targets in user terms; avoid API/DB/architecture details; include acceptance criteria in EARS; correct tables to valid Markdown; ensure consistency with Roles/Auth (password policy >=12 chars, complexity) and Data Lifecycle (export within 24 hours); no developer notes except ToC doc.","content":"# 08 — todoApp Non-Functional Requirements\n\n## Document Purpose\nBusiness-level non-functional requirements for todoApp specifying measurable expectations for performance, security, privacy, availability, reliability, scalability, compliance, and operational monitoring. Content describes WHAT outcomes must be achieved from user and business perspectives without prescribing HOW to implement them. No API specifications, database schemas, or technology choices are included.\n\n## Related Documents\n- Service objectives and KPIs: [Service Overview for todoApp](./01-todoApp-service-overview.md)\n- Roles, permissions, and session behaviors: [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n- User-facing failure behaviors and recovery: [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n\n## Definitions and Assumptions\n- “Interactive action”: user-triggered operations with immediate feedback (e.g., viewing list, creating/updating/completing/deleting a todo item, logging in/out).\n- Time references: seconds (s) or milliseconds (ms) and percentiles (p50, p95, p99) measured at the boundary where the user perceives completion.\n- “Business day”: 09:00–18:00 in Asia/Seoul (KST) unless stated otherwise. Scheduled maintenance references local time in KST.\n- “Sensitive action”: operations that affect account control or privacy (e.g., password change, email change, account deletion, session revocation).\n- “Peak period”: high-usage windows typical of 19:00–23:00 KST on weekdays and 10:00–23:00 KST on weekends.\n- Confidential and personal data: identifiers (e.g., email), authentication factors, and any user-generated content in todo items or metadata.\n\n---\n\n## Performance and Responsiveness Expectations\nTargets are user-perceived. Unless otherwise noted, targets apply to the 95th percentile and must be met under the scale and concurrency assumptions defined in this document.\n\n### Core Interaction Targets\n- List own todos (paginated up to 50 items): p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Create a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Update a todo (title/description/due date): p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Complete or reopen a todo: p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Delete a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Bulk complete/reopen up to 50 items: p95 ≤ 1,000 ms; p99 ≤ 2,000 ms.\n- Authentication (enter credentials to signed-in state): p95 ≤ 2,000 ms; p99 ≤ 4,000 ms.\n- Email-based actions (verification or password reset): email dispatched within 60 s p95.\n- Admin lookups for a single user account (non-invasive read): p95 ≤ 800 ms.\n\n### Payload and Result Size Expectations\n- Interactive list retrieval pagination: up to 50 items per request; results include only fields necessary for list view.\n- Todo description length supported up to 1,000 characters without truncation in storage; interactive viewing and editing meet targets above for up to 1,000 characters.\n- Import/export operations that exceed interactive targets SHALL be processed asynchronously with progress or completion notification.\n\n### Throughput and Concurrency Targets (Business-Level)\n- MVP load: sustain 100 requests per second (RPS) aggregate with short bursts up to 300 RPS for 5 minutes without violating p95 targets.\n- Concurrency: support at least 1,000 concurrently active signed-in sessions during peak periods with no degradation beyond p95 targets.\n- Growth headroom: maintain stable performance up to 3× MVP sustained load without user-visible regressions greater than 20% of stated targets.\n\n### Rate Limiting (User-Centric)\n- Write operations (create/update/complete/delete) per account: up to 60 actions per minute without throttling; above this threshold may be rate-limited to protect availability.\n- Read operations (list/search/filter) per account: up to 120 actions per minute without throttling; above this threshold may be rate-limited.\n- Authentication attempts: protections and lockout expectations appear in Security and Privacy.\n\n### Time Zone and Consistency\n- Read-after-write for a user’s own content: subsequent reads reflect changes immediately p95 ≤ 1,000 ms and p99 ≤ 2,000 ms.\n- Cross-device visibility for a user’s own changes: p95 ≤ 3,000 ms.\n\n---\n\n## Security and Privacy Principles\nBusiness-aligned controls for confidentiality, integrity, and proper access, consistent with role definitions and session behaviors in the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n\n### Authentication and Session Management\n- Only verified accounts may perform non-public actions; unverified accounts have strictly limited capabilities per roles policy.\n- Sessions expire after 30 days of inactivity; sensitive actions require recent re-authentication (within the last 15 minutes).\n- Users can revoke all active sessions immediately from an account security control.\n\n### Credential and Account Protection\n- Password policy: minimum 12 characters; acceptance of long passphrases; require at least three of the following: uppercase, lowercase, numbers, special characters; reject top 10,000 common passwords; prevent reuse of the previous 5 passwords.\n- Login protection: after 10 failed attempts within 10 minutes for an account or from a single source, impose a cooling period of 5 minutes with user-facing guidance for secure recovery.\n- Sensitive changes (email/password) require confirmation through a second-factor channel (e.g., a one-time confirmation code via the verified email channel) without prescribing specific technologies.\n\n### Authorization and Least Privilege\n- Users may only access their own content. Admin actions are logged and limited to the minimum necessary for support and policy enforcement.\n- Administrative access is governed by justification and auditability; access beyond minimum necessary is prohibited.\n\n### Data Minimization and Purpose Limitation\n- Collect only data necessary to operate todoApp and provide the service.\n- Prohibit storage of special categories of personal data in system-managed fields (e.g., national ID numbers) and discourage sensitive content in todo text through policy and guidance.\n\n### Data Protection\n- Protect personal data in transit and at rest using strong, industry-accepted safeguards without specifying particular ciphers or libraries.\n- Protect encryption keys and secrets via processes that enforce least privilege, dual control for changes, and auditability.\n\n### Audit Logging and Access Transparency\n- Log security-relevant events: authentication successes/failures, password changes, email changes, session revocations, account deletions, admin support actions, and mass/bulk operations affecting more than 20 items.\n- Provide user-accessible activity history for their own account, retaining at least 90 days of entries.\n\n### Privacy Controls and User Rights\n- Provide accessible Privacy Policy and Terms of Service before account creation and within account settings.\n- Provide self-service account deletion with clear warnings about irreversible effects and data retention timelines.\n- Provide export of user-owned data in a commonly used, machine-readable format within reasonable size limits.\n\n---\n\n## Availability and Reliability Expectations\nUptime, recovery, and continuity behaviors visible to users and administrators.\n\n### Availability Targets\n- Service-level objective (SLO) for user-facing availability: 99.9% monthly.\n- Planned maintenance windows: default window Sundays 02:00–04:00 KST, announced at least 72 hours in advance. Emergency maintenance is allowed with immediate notice and clear user messaging.\n\n### Reliability and Continuity\n- RTO (Recovery Time Objective): critical user operations recover within 60 minutes following an outage.\n- RPO (Recovery Point Objective): no more than 5 minutes of data for committed operations is lost in a disaster scenario.\n- Durability expectation: once a user receives a success confirmation for a write, that data persists and remains retrievable after any transient fault.\n\n### Degradation and Failover Behavior\n- Graceful degradation: non-critical features (e.g., bulk operations, optional analytics) may be temporarily disabled to preserve core CRUD functionality.\n- Read-only mode: during partial outages, the system may enter read-only mode with clear user messaging; write attempts are queued or safely rejected with recovery guidance per the error handling document.\n\n### Consistency and Ordering\n- For a single user’s data, operations that depend on ordering (e.g., marking complete, then deleting) reflect the most recent committed action in subsequent reads.\n- Conflict handling during concurrent updates follows the business rules in the related documents, ensuring users receive clear guidance without exposing technical details.\n\n---\n\n## Scalability Expectations\nPredictable behavior as usage grows.\n\n### Baseline and Growth Assumptions\n- MVP baseline: 50,000 monthly active users (MAU), 5,000 daily active users (DAU), 1,000 peak concurrent sessions, 100 sustained RPS with 300 RPS bursts.\n- Growth: maintain targets up to 3× baseline without user-visible regressions beyond 20% of stated p95 targets and without service downtime for capacity increases.\n\n### Business Limits\n- Maximum todos per user: 10,000 total items across states. Align active-item guidance and caps with the [Business Rules and Constraints](./06-todoApp-business-rules.md) where an active cap of 5,000 may apply.\n- Bulk operations: up to 100 items per interactive bulk action; larger sets are processed asynchronously with user notification upon completion.\n\n### Elasticity and Resource Management\n- Capacity increases and decreases are transparent to users and must not cause outages or data loss.\n\n---\n\n## Compliance and Legal Considerations\nAligned with common privacy frameworks without asserting jurisdiction-specific legal advice.\n\n- Privacy by design: default to the minimum data necessary; privacy-related defaults are the most protective reasonable option.\n- Notice and consent: obtain user consent for optional data uses such as marketing communications; provide easy opt-out.\n- Data subject rights: enable access, rectification, export, and deletion of user data within 30 days of verified request.\n- Child safety: intended for users aged 13+ unless local law imposes a higher age; when required, obtain guardian consent consistent with applicable law.\n- Data retention: business records (e.g., audit logs) retained for 90 days minimum; user data retention after account deletion follows policy in the data lifecycle document.\n- Cross-border data transfer: disclose data processing locations and ensure transfers comply with applicable cross-border requirements.\n\n---\n\n## Operational Monitoring and Alerting (Business Expectations)\nContinuous verification that objectives are met and regressions detected promptly.\n\n### Key Performance Indicators (KPIs)\n- Latency: p50/p95/p99 across core interactions (list, create, update, complete, delete, login).\n- Error rate: percentage of failed interactions per category (authentication, authorization, validation, conflict, not found, service unavailable) as defined in the error handling document.\n- Throughput: sustained and peak RPS; concurrency of active sessions.\n- Availability: monthly uptime against the 99.9% SLO and error budget consumption.\n- Security signals: failed login spikes, password reset spikes, session revocations, admin privileged operations.\n- Data integrity: periodic checks that ensure committed writes are retrievable and uncorrupted.\n\n### Alerting Thresholds and Response Expectations\n- Critical user operation latency breach: if p95 for list/create/update/complete/delete exceeds target by 25% for 5 consecutive minutes, generate a critical alert.\n- Availability breach: if rolling 5-minute availability falls below 99%, generate a critical alert.\n- Error spike: if failed interactions exceed 2% over 10 minutes for any core operation, generate a high-severity alert with categorization.\n- Security anomaly: if there are more than 50 failed logins for a single account or 500 across the service within 10 minutes, generate a high-severity alert and apply protective measures consistent with lockout policy.\n- On-call responsiveness: acknowledge critical alerts within 5 minutes 24/7; initiate mitigation within 15 minutes; communicate user-facing status within 30 minutes of incident start.\n\n### Incident Management Flow\n```mermaid\ngraph LR\n  subgraph \"Detection\"\n    A[\"Monitoring Detects Breach\"] --> B[\"Alert Generated\"]\n  end\n  subgraph \"Triage\"\n    C[\"On-call Acknowledges\"] --> D[\"Severity Classification\"]\n    D --> E[\"User Impact Assessment\"]\n  end\n  subgraph \"Mitigation\"\n    F[\"Apply Safeguards(Degrade/Throttle/Read-only)\"] --> G[\"Restore Core Functions\"]\n  end\n  subgraph \"Communication\"\n    H[\"Post Status Update(KST Time)\"] --> I[\"Customer Support Briefing\"]\n  end\n  subgraph \"Recovery\"\n    J[\"Validate Data Integrity\"] --> K[\"Confirm SLO Recovery\"]\n  end\n  subgraph \"Postmortem\"\n    L[\"Root Cause Analysis\"] --> M[\"Action Items&Owners\"]\n  end\n  B --> C\n  E --> F\n  G --> H\n  H -.-> I\n  G --> J\n  K --> L\n```\n\n---\n\n## Non-Functional Acceptance Criteria (EARS)\nEARS keywords WHEN/WHILE/IF/THEN/WHERE/THE/SHALL remain in English; descriptions are in business terms.\n\n### Performance\n- WHEN a user retrieves a page of their todo list up to 50 items during peak period, THE todoApp SHALL deliver the response within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user creates a todo with title and optional description up to 1,000 characters, THE todoApp SHALL confirm creation within 400 ms at p95 and within 800 ms at p99.\n- WHEN a user completes or reopens a todo, THE todoApp SHALL reflect the change within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user logs in with valid credentials, THE todoApp SHALL transition to a signed-in state within 2,000 ms at p95 and within 4,000 ms at p99.\n- WHERE a bulk action affects up to 50 items, THE todoApp SHALL complete the action within 1,000 ms at p95 and within 2,000 ms at p99.\n- WHERE an operation exceeds interactive thresholds due to size or complexity, THE todoApp SHALL process it asynchronously and notify the user upon completion.\n\n### Consistency and Cross-Device\n- WHEN a user modifies their own todo items, THE todoApp SHALL provide read-after-write consistency for that user with visibility of the change within 1,000 ms at p95 and 2,000 ms at p99.\n- WHILE a user is signed in on multiple devices, THE todoApp SHALL propagate the user’s own changes across devices within 3,000 ms at p95.\n\n### Rate Limiting and Protection\n- WHERE an account issues more than 60 write actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance without blocking critical security actions.\n- WHERE an account issues more than 120 read actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance.\n\n### Security and Sessions\n- THE todoApp SHALL require account verification before granting non-public capabilities.\n- WHERE a session has been inactive for 30 days, THE todoApp SHALL require re-authentication before any further non-public actions.\n- IF there are 10 failed login attempts within 10 minutes for an account, THEN THE todoApp SHALL impose a 5-minute cooldown and provide secure recovery guidance to the user.\n- IF a user invokes “revoke all sessions”, THEN THE todoApp SHALL invalidate all existing sessions within 60 seconds and require re-authentication on all devices.\n- WHERE a user initiates a sensitive action, THE todoApp SHALL require recent re-authentication within the last 15 minutes.\n- THE todoApp SHALL enforce a password policy with minimum 12 characters and at least three character classes; banned password list and recent-password reuse prevention apply.\n\n### Data Protection and Privacy\n- THE todoApp SHALL protect personal data in transit and at rest using strong safeguards and prevent unauthorized access by design and policy.\n- WHERE audit logs contain personal data, THE todoApp SHALL minimize and redact sensitive fields and retain logs for at least 90 days.\n- WHEN a verified user requests export of their data up to 1 GB in size, THE todoApp SHALL provide a machine-readable export within 24 hours under normal operating conditions.\n- WHERE a verified user’s export exceeds typical size, THE todoApp SHALL communicate progress and deliver the export as soon as preparation completes.\n- WHEN a verified user requests account deletion, THE todoApp SHALL remove user-accessible content promptly and complete deletion workflows within 30 days except where legal retention is required.\n\n### Availability and Reliability\n- THE todoApp SHALL achieve 99.9% monthly availability for core user operations under the defined load assumptions.\n- WHEN a service incident impacts users, THE todoApp SHALL publish a status update within 30 minutes of detection and provide subsequent updates at least every 60 minutes until resolution.\n- WHERE core functionality is impaired, THE todoApp SHALL prioritize read access and safe queuing or rejection of writes with clear guidance.\n- WHEN service is restored after an outage, THE todoApp SHALL meet the stated p95 performance targets within 15 minutes of recovery.\n- THE todoApp SHALL meet an RTO of 60 minutes and an RPO of 5 minutes for committed user operations.\n\n### Monitoring and Alerts\n- WHEN p95 latency for any core operation exceeds its target by 25% for 5 consecutive minutes, THE todoApp SHALL generate a critical alert for the on-call responder.\n- WHEN failed user interactions exceed 2% of attempts over a 10-minute window for any core operation, THE todoApp SHALL generate a high-severity alert with categorization.\n- WHEN security anomalies occur (e.g., more than 50 failed logins for an account or 500 service-wide within 10 minutes), THE todoApp SHALL generate a high-severity alert and apply protective measures.\n- WHERE a critical alert is generated, THE todoApp SHALL ensure on-call acknowledgment within 5 minutes and user-facing communication within 30 minutes.\n\n### Compliance and Legal\n- THE todoApp SHALL present accessible Terms of Service and Privacy Policy before account creation and within settings.\n- WHEN receiving a verified data subject request, THE todoApp SHALL fulfill access, rectification, export, or deletion within 30 days.\n- WHERE local law requires consent for optional data uses, THE todoApp SHALL capture, honor, and provide revocation of such consent.\n\n---\n\n## Appendices\n\n### A. p95/p99 Target Summary\n\n| Category | p95 | p99 |\n|---|---:|---:|\n| List todos (≤50 items) | 300 ms | 600 ms |\n| Create todo | 400 ms | 800 ms |\n| Update todo | 400 ms | 800 ms |\n| Complete/Reopen todo | 300 ms | 600 ms |\n| Bulk action (≤50 items) | 1,000 ms | 2,000 ms |\n| Login (valid credentials) | 2,000 ms | 4,000 ms |\n\n### B. Additional Non-Functional Targets\n\n| Target | Value |\n|---|---|\n| Email dispatch (verification/reset) | ≤ 60 s at p95 |\n| Availability (monthly) | 99.9% |\n| RTO | 60 minutes |\n| RPO | 5 minutes |\n| Session inactivity expiry | 30 days |\n| Sensitive action re-auth window | 15 minutes |\n| Audit log retention | ≥ 90 days |\n| Export SLA (≤1 GB) | ≤ 24 hours under normal conditions |\n\n---\n\nBusiness-requirements-only scope applies. All technical implementation decisions, including architecture, APIs, and data design, belong to the development team. The content defines outcomes and constraints to be met from user and business perspectives.","tokenUsage":{"total":75387,"input":{"total":67114,"cached":0},"output":{"total":8273,"reasoning":3584,"accepted_prediction":0,"rejected_prediction":0}},"total":11,"completed":11,"step":0,"created_at":"2025-08-15T04:02:24.764Z"},"tokenUsage":{"aggregate":{"total":1077148,"input":{"total":919953,"cached":11648},"output":{"total":157195,"reasoning":57728,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":1074364,"input":{"total":917616,"cached":11648},"output":{"total":156748,"reasoning":57344,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}},{"event":{"type":"analyzeComplete","roles":[{"name":"user","description":"Authenticated end user who manages only their own todo items and account. Can create, read, update, complete, and delete personal tasks. Cannot access or modify other users’ data."},{"name":"admin","description":"Administrative user with full authority to oversee the service. Can manage any user account when necessary for support or policy enforcement, access aggregated analytics, enforce content policies, and configure service-wide settings."}],"prefix":"todoApp","files":[{"reason":"Provide a single entry point that lists and links all planning documents. Sets reading order and ensures navigation consistency across the project.","filename":"00-toc.md","documentType":"service-overview","outline":["Document Purpose","How to Use This Documentation","Table of Contents (with descriptive links)","Document Maintenance Policy"],"audience":"general","keyQuestions":["What documents exist for this project?","How should readers navigate them in the correct order?"],"detailLevel":"high-level overview","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","04-todoApp-user-stories-and-personas.md","05-todoApp-user-flows.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Must include descriptive relative links to each listed document using the document title as link text","Must place the specified Developer Note blockquote at the very end exactly as provided","Must not include technical implementation details, API specs, or database schemas"],"content":"# todoApp Planning Documentation - Table of Contents\n\nLast updated: 2025-08-15 (KST)\n\n## Document Purpose\nSingle entry point for all planning artifacts of the todoApp service. Establishes the recommended reading order, provides descriptive links to each document, and aligns stakeholders on navigation across the documentation set. Defines business requirements, user scenarios, and process flows in natural language so backend developers can implement with clarity while retaining full autonomy over technical decisions.\n\n## How to Use This Documentation\n- Begin with the service overview to understand vision, scope, and business model. Proceed to roles and authentication to ground access control concepts before diving into the functional scope.\n- Follow the reading order below to reduce ambiguity and ensure terms, rules, and flows are interpreted consistently across teams.\n- Each link uses the document’s title as link text and points to a relative file in this folder for portability.\n- Focus remains on what the system must do from a business perspective. All architectural choices, API designs, and data modeling decisions remain with the development team.\n\n## Table of Contents (with descriptive links)\n1. [todoApp Service Overview](./01-todoApp-service-overview.md)\n   - Establishes vision, scope, and business model for the minimal Todo service; clarifies value proposition, target users, and success metrics.\n2. [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n   - Defines complete authentication behaviors, role hierarchy, and permissions in business terms; includes session and token management expectations and EARS-formatted access rules.\n3. [todoApp Functional Requirements (MVP)](./03-todoApp-functional-requirements.md)\n   - Captures the minimum functional scope for a Todo list with testable business requirements; covers CRUD for items, completion/reopening, filtering/sorting, localization, and acceptance criteria in EARS.\n4. [todoApp User Stories and Personas](./04-todoApp-user-stories-and-personas.md)\n   - Describes personas and primary/secondary scenarios to guide prioritization and testing; includes role-based scenarios and acceptance statements.\n5. [todoApp User Flows and Process Diagrams](./05-todoApp-user-flows.md)\n   - Provides visual business flows for core processes (authentication, item lifecycle, error and recovery) using Mermaid with LR orientation, plus narrative explanations.\n6. [todoApp Business Rules Specification](./06-todoApp-business-rules.md)\n   - Codifies validation rules, constraints, ownership rules, rate limits, retention, time zone handling, and rule precedence in measurable terms (EARS where applicable).\n7. [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n   - Defines user-facing error conditions, guidance, and recovery paths; covers conflicts, retries, monitoring expectations, and EARS-formatted error requirements.\n8. [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n   - Sets measurable expectations for performance, security, privacy, availability, scalability, compliance, and operational monitoring; includes EARS-based acceptance criteria.\n9. [todoApp Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md)\n   - Describes conceptual information lifecycle, retention and purging policies, portability options, privacy-by-design principles, and right-to-erasure behaviors.\n10. [todoApp Acceptance Criteria and Success Metrics](./10-todoApp-acceptance-criteria-and-success-metrics.md)\n    - Defines go-live readiness, MVP acceptance criteria (EARS), post-launch monitoring plan, user satisfaction approach, KPIs, and risk mitigations.\n\n### Recommended Reading Order and Rationale\n- Foundation: Service overview → roles and authentication → functional requirements. Builds shared context, clarifies permissions, then defines scope.\n- Behavior Details: User stories/personas → user flows → business rules. Translate scope into concrete scenarios, visual flows, and enforceable rules.\n- Quality and Safety: Error handling → non-functional requirements. Define predictable failure behavior and measurable experience goals.\n- Lifecycle and Acceptance: Data lifecycle and privacy → acceptance criteria and success metrics. Cover responsible data handling and evaluation of delivery.\n\n### Role-Based Quick Paths\n- Business stakeholders: Service overview → acceptance criteria and success metrics.\n- Product managers: Service overview → functional requirements → user stories and personas → user flows.\n- Development team: Roles and authentication → functional requirements → business rules → error handling → non-functional requirements → data lifecycle and privacy.\n- QA and compliance: Business rules → error handling → non-functional requirements → data lifecycle and privacy → acceptance criteria and success metrics.\n\n## Document Maintenance Policy\n- Ownership: Product team curates business content; development team may propose clarifications via change requests. A designated documentation owner is accountable for approvals and publication.\n- Update cadence: Update whenever scope, rules, or acceptance criteria change. Update this table of contents immediately when documents are added, renamed, or deprecated.\n- Versioning and change log: Maintain a change log section or commit history within each document describing what changed and why in business terms.\n- Link conventions: Use descriptive link text matching each document title in en-US; keep relative paths within this folder. Do not link to non-existent files.\n- Consistency and traceability: Keep terminology, states, and rule names consistent across documents. Cross-reference related sections using descriptive links where helpful.\n- Decommissioning: If a document is retired, remove its link here and record the successor or reason for removal in the project change log.\n\n> *Developer Note: This document defines **business requirements only**. All technical implementations (architecture, APIs, database design, etc.) are at the discretion of the development team.*"},{"reason":"Establish vision, scope, and business model for the minimal Todo service to align stakeholders before detailing requirements.","filename":"01-todoApp-service-overview.md","documentType":"service-overview","outline":["Executive Summary","Problem Definition and Market Gap","Target Users","Core Value Proposition","Service Scope and Out-of-Scope","Business Model","Why This Service Exists","Revenue Strategy","Growth Plan","Success Metrics and KPIs","Assumptions and Dependencies","Glossary of Terms"],"audience":"business stakeholders","keyQuestions":["Why should this service exist and what problem does it solve?","Who is the target user and what value is delivered?","What scope is included for the minimal viable Todo service?","How will success be measured?"],"detailLevel":"high-level overview","relatedDocuments":["00-toc.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","10-todoApp-acceptance-criteria-and-success-metrics.md"],"constraints":["Focus on business goals and outcomes only","Avoid technical implementation details entirely","Define clear success metrics aligned with business value"],"content":"# todoApp Service Overview\n\n## Executive Summary\nA minimal, reliable, and privacy‑respecting personal task management service enabling individuals to quickly capture, organize, and complete tasks without distraction. The MVP emphasizes core value: todo creation, editing, completion/reopening, and deletion for authenticated users, with explicit ownership and predictable behavior across time zones.\n\nKey outcomes for MVP:\n- Accelerate time‑to‑first‑value: users create their first todo within one minute of registration (median).\n- Establish daily habit loops centered on completion and review.\n- Build trust through privacy‑first defaults and deterministic date/time handling.\n\nEARS guiding objectives:\n- THE todoApp SHALL enable a newly registered user to create a first todo within 60 seconds (median) from completing registration.\n- THE todoApp SHALL keep each user’s todos private by default, with no sharing in MVP.\n- WHEN a user records or modifies a due date, THE todoApp SHALL display and process that due date in the user’s preferred local time consistently.\n- WHEN a user filters their todos, THE todoApp SHALL present results within user‑perceived expectations aligned with the non‑functional targets.\n\nFor deeper specifications, see the [Table of Contents and Navigation Guide](./00-toc.md), the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md), the [Non‑Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md), and the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Problem Definition and Market Gap\nMany task tools try to satisfy both simple and complex workflows, burdening users who only need essentials. Observed pain points:\n- Over‑featured products delaying time‑to‑first‑value due to configuration overhead.\n- Privacy risk and unclear ownership in team‑oriented tools.\n- Inconsistent due‑date handling across time zones, creating missed or premature deadlines.\n- Reliability gaps in core actions (create, complete, find) that erode trust.\n- Pricing complexity that discourages early adoption.\n\nCompetitor landscape (business characterization):\n- Team‑centric platforms: optimized for collaboration; often complex for personal use; unclear privacy defaults.\n- Power‑user task managers: rich features with steeper learning curves; slower activation for minimal needs.\n- Simple list apps: fast but often lack rigorous ownership rules, retention clarity, and predictable date semantics.\n\nDifferentiation:\n- Purposeful minimalism tied directly to value delivery.\n- Privacy clarity and least‑privilege oversight.\n- Deterministic time and date semantics across locales.\n\n## Target Users\nPrimary audiences:\n- Individual professionals, students, and early‑career knowledge workers who prefer predictability over breadth.\n- Privacy‑conscious individuals seeking control and ownership of personal task data.\n\nSecondary audience:\n- Service administrators who provide user support and enforce policies under least‑privilege constraints.\n\nRoles in service context:\n- User: authenticated end user managing only their own todo items and account.\n- Admin: administrative user performing limited oversight for support/policy enforcement with auditability.\n\n## Core Value Proposition\n- Minimalism with purpose: only capabilities that directly support capture and completion.\n- Predictability: deterministic rules for ownership, visibility, and time semantics.\n- Trust and privacy: personal data is private; no default sharing or exposure in MVP.\n- Fast first value: immediate utility on first login.\n\nBusiness value loop (conceptual):\n\n```mermaid\ngraph LR\n  A[\"Register\"] --> B[\"Create First Todo(≤60s median)\"]\n  B --> C[\"Daily Review & Complete\"]\n  C --> D[\"Completion Satisfaction\"]\n  D --> E[\"Habit & Retention\"]\n  E --> F[\"Sustained Engagement\"]\n```\n\nEARS commitments reinforcing value delivery:\n- WHEN a newly verified account first signs in, THE todoApp SHALL make task capture immediately accessible without mandatory configuration.\n- THE todoApp SHALL avoid features that do not materially improve capture, review, and completion during MVP.\n- WHERE a user lacks a configured time zone, THE todoApp SHALL default to a reasonable locale‑aligned time zone (see non‑functional expectations) and communicate the default in context.\n\n## Service Scope and Out‑of‑Scope\n\n### In Scope (MVP)\n- User accounts: registration, login, logout, email verification, password reset, session revocation (business perspective only).\n- Todo item management: create, read, update, complete, reopen, delete personal items.\n- Optional attributes: description and due date.\n- Filtering and sorting: by completion status and due date; ordering by creation time or due date.\n- Ownership and privacy: strict separation; users access only their data; admins act only for support under audit.\n- Time zone semantics: consistent date/time handling per user preference.\n- Data lifecycle basics: user‑initiated deletion; account deletion with retention policy adherence.\n\n### Out of Scope (MVP)\n- Collaboration: sharing, assignments, comments, team workspaces, mentions.\n- Complex structures: subtasks, tags/labels, priorities, recurring tasks.\n- Media: file/image attachments.\n- Integrations: calendar sync, third‑party automations, external identity providers.\n- Notifications/reminders: push/SMS/email reminders.\n- Advanced analytics dashboards for end users.\n- Public APIs or developer platform guarantees.\n- Client platform specifics (no UI/UX or native app prescriptions).\n\nBoundary EARS:\n- THE todoApp SHALL exclude sharing and collaboration features in MVP.\n- IF a feature introduces privacy ambiguity or increases time‑to‑first‑value beyond 60 seconds (median), THEN THE todoApp SHALL defer it beyond MVP.\n\n## Business Model\nEmphasizes a trust‑first entry with a minimal product, followed by value‑based monetization once habit and trust are validated.\n\nValue creation and capture:\n- Reliable, distraction‑free personal task management that improves completion rate and reduces anxiety.\n- Free tier at launch to maximize adoption and learning; subscription options post‑MVP for power users and small teams while keeping core personal use free.\n\nCost structure (business level):\n- Customer support and content for onboarding and guidance.\n- Operations and compliance appropriate to geography and scale.\n- Privacy and security program proportional to risk and data footprint.\n\nDifferentiation:\n- Privacy clarity and least‑privilege operations.\n- Deterministic time zone semantics and predictable behavior.\n- Purposeful minimalism avoiding feature sprawl.\n\nGuardrails (EARS):\n- THE todoApp SHALL not introduce monetization that blocks basic personal task creation, completion, or deletion during MVP.\n- WHERE monetization is later introduced, THE todoApp SHALL ensure continuity of access to existing data for users who downgrade.\n\n## Why This Service Exists\nMarket need: a simple, dependable system without team constructs or heavy configuration.\nOpportunity: competitors optimize for breadth and collaboration, underserving users seeking speed, clarity, and privacy.\nStrategic fit: a minimal, high‑trust core creates a durable foundation for optional premium extensions without compromising simplicity.\n\nEARS business objectives:\n- THE todoApp SHALL minimize time‑to‑first‑value, targeting first‑todo creation ≤60 seconds (median) after registration.\n- THE todoApp SHALL maintain privacy by default; no exposure of personal tasks to others in MVP.\n- WHERE a free tier is offered, THE todoApp SHALL retain full personal task functionality in that tier during MVP.\n\n## Revenue Strategy\nPhased monetization to follow demonstrated engagement and retention.\n- MVP to early traction: free tier for personal use to maximize adoption and learn from usage patterns.\n- Post‑MVP (contingent on traction):\n  - Individual Pro: advanced filters, export options, and optional productivity insights.\n  - Teams (future): oversight and policy tools only if simplicity is preserved.\n- Pricing principles: transparent, predictable, and free from hidden limits that undermine personal use.\n\nEARS monetization ethics:\n- THE todoApp SHALL avoid paywalls on core personal task operations during MVP.\n- IF a user downgrades from paid to free, THEN THE todoApp SHALL preserve access to all existing personal tasks without data loss.\n\n## Growth Plan\nAcquisition: content marketing on productivity fundamentals; referrals; distribution via student and early‑career communities.\nActivation: frictionless onboarding oriented to first task creation; contextual, minimal guidance.\nRetention: habit loops centered on completion; simple in‑product prompts within MVP scope; weekly reflection content.\nExpansion: optional premium features introduced only after healthy retention; core remains uncluttered.\n\nEARS growth targets:\n- THE todoApp SHALL achieve a median time‑to‑first‑task of ≤60 seconds for newly registered users during MVP.\n- THE todoApp SHALL target 7‑day retention ≥25% within 90 days post‑launch.\n- WHERE a referral mechanism is offered, THE todoApp SHALL allow invitation flows that do not introduce sharing features.\n\n## Success Metrics and KPIs\nDefinitions (business level):\n- Activation rate: % of new registrants creating a todo within 24 hours.\n- Time‑to‑first‑task (median): time from registration to first todo creation.\n- Weekly engaged users: users who created, updated, or completed at least one todo in a 7‑day window.\n- Completion ratio: completed todos / created todos within a period.\n- Churn rate: % of active users who become inactive over 30 days.\n- Support ticket volume per 1,000 MAU: proxy for usability and reliability.\n\nTargets (EARS):\n- THE todoApp SHALL achieve activation rate ≥70% within 90 days post‑launch.\n- THE todoApp SHALL maintain median time‑to‑first‑task ≤60 seconds during MVP.\n- THE todoApp SHALL achieve weekly completion ratio ≥50% for active users within 90 days post‑launch.\n- WHERE support is provided, THE todoApp SHALL keep support ticket volume ≤20 per 1,000 MAU related to core operations.\n\nIllustrative KPI table:\n\n| KPI | Definition | MVP Target |\n|-----|------------|------------|\n| Activation rate | % new users with ≥1 todo in 24h | ≥ 70% |\n| Time‑to‑first‑task | Median time to first todo | ≤ 60 s |\n| Weekly completion ratio | Completed / created (active users) | ≥ 50% |\n| 7‑day retention | Users returning within 7 days | ≥ 25% |\n| Support volume | Tickets per 1,000 MAU | ≤ 20 |\n\n## Assumptions and Dependencies\nAssumptions:\n- Email channel availability for verification and password resets.\n- Baseline compliance (privacy/legal) for operating regions; documented consent for data processing.\n- Stable time zone rules and consistent business semantics for due dates.\n- English‑language product framing for MVP; broader localization later.\n- Reasonable baseline of user devices and connectivity.\n- Administrative oversight limited to support/policy enforcement with least‑privilege principles.\n\nDependencies:\n- Content and onboarding materials to reduce activation friction.\n- Support capacity for early launch weeks to handle inquiries.\n- Monitoring and analytics to measure activation, retention, and completion.\n\nConstraints (EARS):\n- IF email verification is not completed within a defined grace period, THEN THE todoApp SHALL limit access to functions requiring verified identity until verification is complete.\n- WHILE account deletion is in progress, THE todoApp SHALL prevent new content creation to avoid data inconsistency.\n- WHERE privacy policy prohibits data sharing, THE todoApp SHALL avoid features that expose personal content to others during MVP.\n\n## Linkage to Detailed Requirements\nBusiness behavior and acceptance details are elaborated in the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md). User‑perceived reliability, performance, security, and privacy expectations are set in the [Non‑Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md). Release readiness and measurable acceptance criteria are defined in the [Acceptance Criteria and Success Metrics for MVP](./10-todoApp-acceptance-criteria-and-success-metrics.md).\n\n## Glossary of Terms\n- Activation: point at which a newly registered user creates the first todo.\n- Admin: role authorized to perform limited oversight for support and policy enforcement with auditability.\n- Completion ratio: completed todos divided by created todos over the same period.\n- Due date: optional date attached to a todo indicating a target completion day in the user’s local time.\n- Habit loop: recurring cycle of capture, review, and completion that fosters retention.\n- MVP: minimal set of features delivering core value and validating the product hypothesis.\n- Ownership: principle that a user’s todos belong exclusively to that user and are not visible to others in MVP.\n- Retention: rate at which users return and interact with the service over time.\n- Time‑to‑first‑task: elapsed time between account registration and first todo creation.\n- User: authenticated end user who manages only their own todo items and account.\n\nBusiness scope statement: This document provides business requirements and outcomes only. All technical implementation decisions (architecture, APIs, database design, infrastructure) are at the discretion of the development team; the content defines WHAT the system should do, not HOW to build it."},{"reason":"Define complete authentication behaviors, role hierarchy, and permissions so access rules are unambiguous from a business perspective.","filename":"02-todoApp-user-roles-and-authentication.md","documentType":"requirement","outline":["Purpose and Scope","Authentication Requirements","Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)","User Role Structure","Role Definitions and Capabilities","Permission Matrix (actions by role)","Session and Token Management (business rules for token lifetimes and refresh)","Access Control Rules and Examples (EARS format)","Account Lifecycle (creation, verification, suspension, deletion)","Security and Privacy Considerations","Audit and Activity Logging (business expectations)"],"audience":"development team","keyQuestions":["What roles exist and what can each do?","What authentication features are available to users?","How are sessions and tokens managed from a business standpoint?","What are the access control rules and edge cases?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Include a clear permission matrix table by role","Write all applicable requirements in EARS format","Describe token management in business terms without API-level specifications","Do not include API endpoints, database schema, or technical architecture"],"content":"# todoApp User Roles and Authentication Requirements\n\nBusiness requirements only. Technical implementation decisions (architecture, APIs, database design, storage, libraries) belong to the development team. Content specifies WHAT the service must do in business terms.\n\n## Purpose and Scope\n- Define authentication behaviors, role hierarchy, and permissions so access rules are unambiguous in business terms.\n- Establish session and token management principles, including lifetimes, rotation, revocation, re‑authentication for sensitive actions, and session listing.\n- Specify account lifecycle stages and expected business outcomes (creation, verification, suspension, deletion and restoration windows).\n- Provide EARS‑formatted, testable requirements for core auth flows and access control.\n- Exclude technical implementation details such as API endpoints, database schemas, or infrastructure choices.\n\n## Authentication Requirements (EARS)\n- THE todoApp SHALL support end‑user authentication with email and password.\n- THE todoApp SHALL require email verification to unlock sensitive account actions and data export.\n- WHEN a person authenticates successfully, THE todoApp SHALL establish a session represented by issued tokens according to token management rules.\n- WHEN a subject without a valid session attempts to access protected resources, THE todoApp SHALL deny access and guide the subject to sign in or verify email as applicable.\n- WHEN administrative assistance is necessary, THE todoApp SHALL allow authorized administrators to perform limited support actions under least‑privilege and full audit.\n\n### Visual Overview of Core Authentication Flows\n```mermaid\ngraph LR\n  subgraph \"Registration and Verification\"\n    A1[\"User Submits Registration(Email, Password)\"] --> A2[\"Validate Input(Format, Policy)\"]\n    A2 --> A3{\"Valid?\"}\n    A3 -->|\"Yes\"| A4[\"Create Account(Pending Verification)\"]\n    A3 -->|\"No\"| A5[\"Inform Validation Errors\"]\n    A4 --> A6[\"Send Verification Email(Link, 24h Expiry)\"]\n    A6 --> A7[\"User Clicks Verification Link\"]\n    A7 --> A8{\"Token Valid and Not Expired?\"}\n    A8 -->|\"Yes\"| A9[\"Mark Email Verified\"]\n    A8 -->|\"No\"| A10[\"Inform Link Invalid or Expired\"]\n  end\n\n  subgraph \"Login and Session Management\"\n    B1[\"User Submits Login(Email, Password)\"] --> B2[\"Validate Credentials\"]\n    B2 --> B3{\"Successful?\"}\n    B3 -->|\"Yes\"| B4[\"Issue Access Token(20m)\"]\n    B3 -->|\"Yes\"| B5[\"Issue Refresh Token(30d, Rotating)\"]\n    B3 -->|\"No\"| B6[\"Increment Failure Counter and Inform\"]\n    B4 --> B7[\"Authorized Access to Own Resources\"]\n    B5 -.-> B8[\"Refresh Flow: Rotate Refresh Token\"]\n    B8 -.-> B4\n  end\n```\n\n## Core Authentication Functions (register, login, logout, verify email, reset password, change password, revoke sessions)\nAll applicable requirements use EARS.\n\n### Registration\n- WHEN a person submits registration details (email, password), THE todoApp SHALL validate format and enforce password policy.\n- IF registration input violates policy, THEN THE todoApp SHALL present the specific validation reason without exposing sensitive checks.\n- WHEN registration is valid, THE todoApp SHALL create the account in unverified status.\n- WHEN an account is created, THE todoApp SHALL send a verification message containing a time‑limited link.\n- THE todoApp SHALL set verification link validity to 24 hours from issuance.\n- WHERE a verification link expires, THE todoApp SHALL allow resend requests up to 3 times within 24 hours.\n\n### Login\n- WHEN a person submits email and password, THE todoApp SHALL validate credentials and provide success or failure within 2 seconds perceived by the user.\n- IF credentials are valid and the account is eligible, THEN THE todoApp SHALL issue an access token (valid 20 minutes) and a refresh token (valid 30 days, rotating on use).\n- IF credentials are invalid, THEN THE todoApp SHALL present a generic failure message that does not disclose which field failed and SHALL encourage secure recovery.\n- WHILE an account is locked under security policy, THE todoApp SHALL deny login and present the unlock time or procedure.\n\n### Logout\n- WHEN a signed‑in user requests logout, THE todoApp SHALL immediately invalidate the active session for that device.\n- WHERE a user chooses “log out from all devices”, THE todoApp SHALL immediately revoke all active sessions and refresh tokens for that user.\n\n### Email Verification\n- WHEN a person clicks a verification link, THE todoApp SHALL validate token integrity and expiry.\n- IF the link is valid and not expired, THEN THE todoApp SHALL mark the account email as verified.\n- IF the link is invalid or expired, THEN THE todoApp SHALL inform verification failure and provide a resend path.\n\n### Reset Password\n- WHEN a person requests password reset by providing an email, THE todoApp SHALL return a standard confirmation that does not disclose whether the email is registered.\n- WHEN reset instructions are dispatched, THE todoApp SHALL attempt delivery within 60 seconds under normal conditions.\n- THE todoApp SHALL limit password reset link validity to 1 hour from issuance.\n- IF a reset token is valid and unexpired, THEN THE todoApp SHALL enforce the current password policy on the new password and, on success, SHALL revoke all existing sessions with an option to preserve the current device session at the user’s choice.\n\n### Change Password (Authenticated)\n- WHEN a signed‑in user requests a password change, THE todoApp SHALL validate the current password and the new password against policy.\n- IF validation succeeds, THEN THE todoApp SHALL update the password and revoke existing device sessions with an option to preserve the current device session at the user’s choice.\n\n### Revoke Sessions\n- WHEN a user performs “revoke all sessions”, THE todoApp SHALL immediately invalidate all active access and refresh tokens for that user.\n- WHEN an administrator revokes a specific user’s sessions for safety or policy reasons, THE todoApp SHALL immediately invalidate all of that user’s sessions and notify the user through an approved communication channel.\n\n## User Role Structure\n- Roles in scope: user, admin.\n- Role hierarchy: admin has elevated privileges relative to user but remains bound by accountability, privacy, and least‑privilege rules.\n- Unauthenticated: a state (guest) with no access to protected resources; not a role.\n\n## Role Definitions and Capabilities\n\n### user\n- Purpose: authenticated end user managing only their own todo items and account.\n- Can: create, read, update, complete, and delete personal items; manage own profile and security; list and revoke own sessions; export own data; delete own account subject to lifecycle policy; request password reset; change password; verify email.\n- Cannot: access or modify other users’ data or sessions; view audit logs; view aggregated analytics; change service‑wide settings; assign roles.\n- Business‑level JWT claims: userId; role=\"user\"; permissions=[\"todo:own:read\", \"todo:own:write\", \"account:own:manage\", \"session:own:manage\", \"export:own\"].\n\n### admin\n- Purpose: administrative user performing oversight for support and policy enforcement.\n- Can: suspend or reactivate user accounts with recorded reason; revoke user sessions; assist with account recovery via approved flows; access aggregated analytics; access audit trails; configure service‑wide settings within policy; trigger user data export upon verified lawful request.\n- Cannot: view or retrieve user passwords; access user content beyond the minimum necessary for support/policy enforcement without explicit justification; impersonate users without an approved process.\n- Business‑level JWT claims: userId; role=\"admin\"; permissions=[\"user:any:manage\", \"session:any:manage\", \"analytics:aggregate:view\", \"audit:trail:view\", \"settings:service:manage\"].\n\n## Permission Matrix (actions by role)\nNote: “Unauthenticated” is a state, not a role.\n\n| Action | Unauthenticated | user | admin |\n|-------|------------------|------|-------|\n| Register account | ✅ | ❌ | ❌ |\n| Login | ✅ | ❌ | ❌ |\n| Verify email | ✅ (via link) | ✅ | ✅ (resend support) |\n| View own todos | ❌ | ✅ | ✅ (for support with justification) |\n| Create/update/delete own todos | ❌ | ✅ | ✅ (for support with justification) |\n| View another user’s todos | ❌ | ❌ | ❌ (unless authorized support action) |\n| View own profile/account | ❌ | ✅ | ✅ |\n| Update own profile/account | ❌ | ✅ | ✅ (for support with authorization) |\n| Change own password | ❌ | ✅ | ✅ |\n| Request password reset | ✅ | ✅ | ✅ (on behalf of user) |\n| List own sessions | ❌ | ✅ | ✅ |\n| Revoke own sessions | ❌ | ✅ | ✅ |\n| Revoke another user’s sessions | ❌ | ❌ | ✅ |\n| Suspend/reactivate user account | ❌ | ❌ | ✅ |\n| Delete own account | ❌ | ✅ | ✅ (upon lawful request) |\n| Access aggregated analytics | ❌ | ❌ | ✅ |\n| Access audit logs | ❌ | ❌ | ✅ |\n| Configure service‑wide settings | ❌ | ❌ | ✅ |\n\n## Session and Token Management (business rules)\n- THE todoApp SHALL use JWT for access and refresh tokens for session representation.\n- THE todoApp SHALL issue access tokens with a validity of 20 minutes.\n- THE todoApp SHALL issue refresh tokens with a validity of 30 days and rotate them on each successful refresh, immediately invalidating the prior refresh token.\n- THE todoApp SHALL bind each session to a logical device/session identifier to enable session listing and selective revocation.\n- WHERE a user changes password, THE todoApp SHALL revoke all existing sessions and refresh tokens, with an option to preserve the current device session only when explicitly chosen by the user.\n- WHERE an administrator enforces a password reset or security hold, THE todoApp SHALL revoke all sessions for that user without exception.\n- THE todoApp SHALL limit concurrent active sessions per user to 10; attempts to establish an 11th SHALL require the user to revoke at least one existing session or accept automatic revocation of the oldest idle session.\n- THE todoApp SHALL provide session metadata for user viewing: creation time, last activity time, device label (if provided by the user), and approximate location derived from coarse signals where permitted by policy.\n- THE todoApp SHALL require recent re‑authentication (within the last 15 minutes) before sensitive actions such as password change, email change, account deletion, or export of personal data.\n- THE todoApp SHALL treat token storage location as a developer decision, requiring that storage be resistant to common attacks appropriate to the platform.\n- THE todoApp SHALL include in each JWT at minimum: userId, role, and a permissions array sufficient for authorization decisions.\n\n## Access Control Rules and Examples (EARS)\n- THE todoApp SHALL enforce least privilege so users access only resources they own unless an administrative support action is justified and recorded.\n- WHEN an unauthenticated subject requests a protected resource, THE todoApp SHALL deny access and guide the subject to authenticate or verify email.\n- WHEN a user attempts to read, modify, or delete another user’s resources, THE todoApp SHALL deny access without revealing resource existence.\n- WHEN an administrator suspends or reactivates an account, THE todoApp SHALL record the reason and notify the affected user.\n- WHEN an administrator must view user data for support, THE todoApp SHALL permit the minimum necessary access within an approved process and SHALL record all actions in audit logs.\n- IF an account email is unverified, THEN THE todoApp SHALL restrict sensitive features (for example, export or account deletion) and guide the user to complete verification first.\n- WHERE abnormal activity is detected by policy (for example, repeated failed logins), THE todoApp SHALL apply additional checks or temporary limits such as cooldowns or step‑up verification.\n\n## Account Lifecycle (creation, verification, suspension, deletion)\n\n### Creation\n- WHEN creating an account, THE todoApp SHALL use email as the unique contact identifier and enforce the current password policy.\n- THE todoApp SHALL limit registration attempt frequency to prevent automated abuse using policy‑based thresholds (for example, per IP or per domain).\n\n### Verification\n- THE todoApp SHALL allow verification link resend subject to 3 requests within any 24‑hour window.\n- IF verification is not completed within 7 days, THEN THE todoApp SHALL require verification at the next login before granting access to sensitive features.\n- WHERE an account remains unverified for 14 days, THE todoApp SHALL purge the unverified account and associated artifacts during the next scheduled purge cycle.\n\n### Suspension\n- WHEN a user requests voluntary deactivation, THE todoApp SHALL restrict sign‑in and convert the account to a reversible inactive state according to retention policy.\n- WHEN an administrator suspends an account for policy violations, THE todoApp SHALL terminate all active sessions immediately and record suspension reason, start time, and review schedule.\n- WHILE an account is suspended, THE todoApp SHALL block write operations and sensitive actions and MAY allow read access to security pages sufficient to complete recovery.\n\n### Deletion\n- WHEN a verified user confirms account deletion, THE todoApp SHALL initiate a 14‑day grace period during which the user may cancel deletion.\n- WHILE the grace period is active, THE todoApp SHALL present a deletion‑cancellation option at sign‑in and restrict normal write operations.\n- IF legal retention obligations apply to specific records, THEN THE todoApp SHALL defer deletion of those records while deleting all other user data and SHALL inform the user within policy limits.\n\n## Security and Privacy Considerations\n\n### Password Policy\n- THE todoApp SHALL require a minimum password length of 8 characters and SHALL accept long passphrases without requiring special characters.\n- THE todoApp SHALL prevent use of commonly compromised passwords using a banned list.\n- THE todoApp SHALL prevent reuse of the previous 5 passwords.\n\n### Rate Limiting and Lockouts\n- THE todoApp SHALL impose a cooldown after 10 failed login attempts within 10 minutes for an account or from a single source; cooldown duration SHALL be at least 5 minutes with clear guidance.\n- THE todoApp SHALL throttle password reset requests to a maximum of 5 per 24 hours per account.\n\n### Privacy by Design\n- THE todoApp SHALL avoid revealing whether an email is registered in responses to registration and password reset requests.\n- THE todoApp SHALL record audit events without storing sensitive secrets (for example, no plaintext passwords, no full tokens in logs).\n- THE todoApp SHALL store audit timestamps in UTC while displaying times to users according to their locale settings where applicable.\n\n### Notifications and Messaging\n- THE todoApp SHALL send verification and password reset emails within 60 seconds under normal operating conditions.\n- THE todoApp SHALL ensure messages avoid sensitive data and provide clear next steps for recovery.\n\n### Administrative Safeguards\n- THE todoApp SHALL require administrators to provide a reason when performing user‑impacting actions (suspension, session revocation, role modification).\n- THE todoApp SHALL restrict access to aggregated analytics to administrators only and ensure data is de‑identified at the individual level.\n\n## Audit and Activity Logging (business expectations)\n- THE todoApp SHALL record at minimum the following categories: registration, email verification initiation/completion, login success/failure, logout, password reset request/completion, password change, session creation/refresh/revocation, account suspension/reactivation, account deletion request/completion, admin configuration changes, and elevated user‑data access by administrators.\n- WHEN an audit event is recorded, THE todoApp SHALL include event type, actor (user or admin), timestamp (UTC), target (if applicable), outcome (success/failure), and reason (if applicable).\n- WHERE an administrator accesses user data, THE todoApp SHALL classify the event as high‑risk and route it to a review queue.\n- THE todoApp SHALL provide each user with access to their own audit history for security‑relevant actions (for example, logins, password changes, session revocations).\n\n## Related Documents\n- Service vision and business model: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- End‑to‑end feature behaviors: [todoApp Functional Requirements](./03-todoApp-functional-requirements.md)\n- Failure behaviors and recovery: [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance, availability, and privacy expectations: [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md)\n\n---\n\n## Appendix: Additional EARS Examples for Edge Cases\n- IF a password reset token was already used, THEN THE todoApp SHALL treat the token as invalid and guide the user to request a new one.\n- IF abnormal refresh activity is observed from the same device/session, THEN THE todoApp SHALL terminate the session and require re‑authentication.\n- WHERE a user saves a custom label for a device, THE todoApp SHALL display the label in the session list.\n- WHEN an account deletion grace period ends, THE todoApp SHALL complete permanent deletion and notify the user through the configured channel.\n- WHILE an account is suspended, THE todoApp SHALL block authentication to protected features and present suspension reason and review schedule at the next sign‑in attempt.\n"},{"reason":"Capture the minimum functional scope for a Todo list and write testable business requirements for developers.","filename":"03-todoApp-functional-requirements.md","documentType":"requirement","outline":["Overview of Minimal Feature Set","Todo Item Management (Create, Read, Update, Delete)","Completion and Reopening of Items","Optional Attributes (description, due date)","Filtering and Sorting (business expectations)","Time Zone and Localization Behaviors","Data Ownership and Privacy Rules","Import/Export and Data Portability (optional)","Business Constraints and Limits","Acceptance Criteria (EARS format)"],"audience":"development team","keyQuestions":["What minimum features must the Todo service support?","What fields are required for a todo item and what validations apply?","How should filtering and sorting work from a business perspective?","What are the acceptance criteria for the MVP scope?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","06-todoApp-business-rules.md","07-todoApp-error-handling-and-exception-scenarios.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS format wherever applicable","Do not define any API endpoints or database schemas","Keep scope minimal while ensuring a complete, usable product"],"content":"# todoApp Functional Requirements (MVP)\n\n## Overview of Minimal Feature Set\n\n- Personal Todo lists scoped to authenticated users with strict item ownership and privacy by default.\n- Core item operations: create, read (list and detail), update, delete to trash, restore, and purge per retention policy.\n- State transitions for completion and reopening with timestamp semantics.\n- Optional attributes: description and due date (date-only semantics by default).\n- Business-level filtering and sorting for lists with stable defaults and user-selected variations.\n- Time zone and localization rules: user’s profile time zone governs evaluation and display; DST-safe semantics.\n- Role-aware access control in business terms aligned with the roles and authentication specification.\n- Optional data export for portability (import out-of-scope for MVP).\n- Explicit constraints and limits on fields, inventory, and operation frequency.\n\nRelated references:\n- Business context and KPIs: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Roles, authentication, and permissions: [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n- Cross-cutting rules and state logic: [todoApp Business Rules and Constraints](./06-todoApp-business-rules.md)\n- Error behavior and recovery: [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance, security, and availability targets: [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n\n## Principles and Scope Notes\n\n- Minimal scope focuses on personal task management with item-level operations. No collaboration, tags, subtasks, reminders, or external integrations in MVP.\n- Business-only specification: requirements expressed in natural language using EARS where applicable; no API endpoints, data schemas, or technology choices.\n- Roles in scope: \"user\" (owns personal items) and \"admin\" (limited oversight for support/policy with audit and least privilege).\n\n## User Roles and Access Context (Business Perspective)\n\n- \"user\": Authenticated end user who can manage only owned items and personal account.\n- \"admin\": Administrative actor who may access a user’s items only for legitimate support or policy enforcement with strict accountability.\n\nEARS requirements:\n- THE todoApp SHALL restrict access to todo items by ownership so that a \"user\" can create, read, update, complete/reopen, trash/restore, and purge only their own items.\n- WHERE administrative oversight is justified for support or policy enforcement, THE todoApp SHALL allow \"admin\" to access the minimum necessary user items for the task under audit.\n\n## Todo Item Management (Create, Read, Update, Delete/Trash/Restore/Purge)\n\n### Data Elements (Business-Level)\n- Title (required): Short text identifying the item.\n- Description (optional): Extended text elaborating the task.\n- Due Date (optional): Target completion date interpreted in the user’s time zone; default date-only semantics (end-of-day).\n- Status (system-managed): \"open\" or \"completed\".\n- Created Time / Updated Time (system-managed): Timestamps captured on create and on each successful edit.\n- Completion Time (system-managed): Timestamp captured when status becomes \"completed\" and cleared on reopen.\n- Owner (system-managed): The user who created the item.\n- Deletion State (system-managed): \"active\" (not trashed), \"trashed\" (soft-deleted), or \"purged\" (irreversible).\n\n### Validation Rules (Business-Level)\n- Title length: 1 to 120 Unicode characters after trimming leading/trailing whitespace; control characters not allowed.\n- Description length: 0 to 2,000 Unicode characters after trimming; control characters not allowed.\n- Due Date range: Not earlier than 1 January 1970 in the user’s time zone; not more than 10 years in the future.\n\nEARS requirements (creation and update):\n- WHEN a \"user\" submits a new todo with a valid title, THE todoApp SHALL create the item with status \"open\" and set Created Time and Updated Time.\n- IF a title is missing or its trimmed length is 0, THEN THE todoApp SHALL reject creation and instruct to provide a valid title of 1–120 characters without control characters.\n- IF a title exceeds 120 characters, THEN THE todoApp SHALL reject creation and instruct to shorten the title to 120 characters or fewer.\n- IF a description exceeds 2,000 characters, THEN THE todoApp SHALL reject creation or update and instruct to reduce the description to 2,000 characters or fewer.\n- IF a due date is provided earlier than 1 January 1970 (user-local) or more than 10 years in the future, THEN THE todoApp SHALL reject the due date and prompt selection of a valid date.\n- THE todoApp SHALL update Updated Time on any successful edit of title, description, due date, or status.\n- THE todoApp SHALL allow a \"user\" to read (list and detail) only items owned by that user.\n- WHERE an \"admin\" views a user’s items for support, THE todoApp SHALL indicate the acting role and subject user context.\n\n### Concurrency and Conflict Handling\n\nEARS requirements:\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent silent overwrite and require the user to refresh or reconcile prior to saving.\n- WHEN reconciliation is required after a conflict, THE todoApp SHALL present guidance that enables retry with the latest version without losing the user’s attempted edits.\n\n### Deletion, Restoration, and Purging\n\nDefinitions:\n- Trash (soft-delete): Move an item from active/completed to trashed; hidden from normal listings; restorable within retention window.\n- Restore: Return an item from trashed to active state; retain prior fields other than deletion metadata.\n- Purge (hard delete): Irreversibly remove a trashed item after retention or upon explicit user purge.\n\nEARS requirements:\n- WHEN a \"user\" deletes an item they own, THE todoApp SHALL move the item to \"trashed\" and exclude it from normal lists while starting a 30-day retention countdown.\n- WHILE an item is \"trashed\" within retention, THE todoApp SHALL allow the owner to restore it to the \"open\" status with all fields preserved and clear deletion metadata.\n- WHEN a \"trashed\" item reaches the retention deadline, THE todoApp SHALL purge it automatically in the next scheduled purge cycle.\n- WHEN a \"user\" explicitly purges a \"trashed\" item, THE todoApp SHALL remove it irreversibly and exclude it from all user-accessible views.\n- IF a \"user\" attempts to view or modify another user’s trashed items, THEN THE todoApp SHALL deny access and avoid revealing existence.\n\n### Pagination and List Size (Business Expectations)\n\nEARS requirements:\n- THE todoApp SHALL present lists in pages of up to 20 items by default, ordered by the default sort policy.\n- WHERE a user chooses a different page size, THE todoApp SHALL support 10, 20, 50, or 100 items per page and remember the preference per user.\n\n## Completion and Reopening of Items\n\nDefinitions:\n- Complete: Transition status from \"open\" to \"completed\" and record Completion Time.\n- Reopen: Transition status from \"completed\" to \"open\" and clear Completion Time.\n\nEARS requirements:\n- WHEN a \"user\" marks an \"open\" item as completed, THE todoApp SHALL set status to \"completed\" and record Completion Time.\n- IF an item is already \"completed\" and a user attempts to complete it again, THEN THE todoApp SHALL keep status unchanged and inform that the item is already completed.\n- WHEN a \"user\" reopens a \"completed\" item, THE todoApp SHALL set status to \"open\" and clear Completion Time.\n- IF a \"user\" completes an item with a due date in the past, THEN THE todoApp SHALL allow completion and retain the past due date for historical accuracy.\n- THE todoApp SHALL allow editing of title, description, and due date regardless of status unless restricted by policy.\n\n## Optional Attributes (description, due date)\n\nEARS requirements:\n- WHERE a description is provided, THE todoApp SHALL store and present it with the item.\n- WHERE a due date is provided as a date-only value, THE todoApp SHALL interpret it as due by end-of-day in the user’s time zone.\n- IF a due date is removed by the user, THEN THE todoApp SHALL persist the item without a due date and update Updated Time.\n- WHERE no due date is provided, THE todoApp SHALL treat the item as having no scheduling constraint.\n\n## Filtering and Sorting (business expectations)\n\nSupported filters (combinable):\n- Status: open, completed, trashed (optional view), or all non-trashed.\n- Due date window: today, tomorrow, this week (Mon–Sun in user’s locale), next week, overdue (due date earlier than today), or no due date.\n- Text match: case-insensitive contains over title and description.\n- Created/Updated date ranges: calendar-based, using the user’s time zone.\n\nSupported sorting:\n- Default: due date ascending, items without due date ordered last; ties by created time descending.\n- Alternatives: due date descending; created time descending; updated time descending; title ascending.\n\nEARS requirements:\n- THE todoApp SHALL allow a \"user\" to filter by status, due date window, text match, and date ranges simultaneously.\n- THE todoApp SHALL apply the default sorting when no explicit sort is chosen: due date ascending with items without due date last and ties by created time descending.\n- WHERE a user selects a different sort, THE todoApp SHALL apply the selected order consistently across pages.\n- IF filters yield zero results, THEN THE todoApp SHALL present an empty result with guidance to adjust filters.\n- WHILE filters are active, THE todoApp SHALL maintain the active filter set when a user navigates between pages of results.\n\n## Time Zone and Localization Behaviors\n\nBusiness baseline for MVP:\n- Default service time zone: Asia/Seoul (KST, UTC+9) when a profile time zone is not set.\n- User time zone preference: Every date evaluation and display uses the user’s profile time zone if available.\n- Calendar day semantics: Due date represents obligation by the end of the calendar day in the user’s time zone.\n\nEARS requirements:\n- THE todoApp SHALL display Created Time, Updated Time, and Completion Time in the user’s profile time zone where available, otherwise in Asia/Seoul (KST, UTC+9).\n- WHEN determining whether an item is overdue, THE todoApp SHALL compare the due date’s end-of-day boundary to the current date in the user’s time zone.\n- WHERE a user changes the profile time zone, THE todoApp SHALL re-interpret and display existing due dates and timestamps in the new time zone without altering original calendar date values.\n- IF a due date falls on a day affected by DST in the chosen time zone, THEN THE todoApp SHALL maintain end-of-day semantics consistently and adjust non-existent local times to the next valid time.\n\n## Data Ownership and Privacy Rules\n\nEARS requirements:\n- THE todoApp SHALL associate each item with exactly one owner (the creator) and treat it as private by default.\n- IF a \"user\" attempts to view or modify another user’s items (including trashed items), THEN THE todoApp SHALL deny access and avoid revealing existence.\n- WHERE an \"admin\" performs support actions on a user’s items, THE todoApp SHALL record the acting role context and restrict visibility to the minimum necessary data.\n\n## Import/Export and Data Portability (optional)\n\nScope: Export in scope; import out of scope for MVP.\n\nEARS requirements:\n- WHERE a \"user\" requests an export, THE todoApp SHALL provide a file containing all owned items and attributes (title, description, due date if present, status, Created/Updated/Completion Times, deletion state where applicable) in a commonly portable format.\n- IF an export is requested while no items exist, THEN THE todoApp SHALL produce a valid export file containing zero items and an indication that the list is empty.\n- WHERE an export is processed asynchronously, THE todoApp SHALL notify the user upon completion using available communication channels defined in policy.\n\n## Business Constraints and Limits\n\nEARS requirements:\n- THE todoApp SHALL limit title length to 120 characters and description length to 2,000 characters.\n- THE todoApp SHALL limit due dates to within 10 years into the future and not earlier than 1 January 1970 in the user’s time zone.\n- THE todoApp SHALL limit items per page to 10, 20, 50, or 100 with a default of 20.\n- THE todoApp SHALL allow up to 5,000 active (non-trashed) items per user; attempts to exceed this SHALL be denied with guidance to archive, delete, or purge.\n- THE todoApp SHALL allow up to 5,000 trashed items retained per user; where this cap is exceeded, older trashed items SHALL be purged first.\n- THE todoApp SHALL limit total items per user (all states except purged) to 10,000.\n- WHERE operational stability requires, THE todoApp SHALL throttle per-user operation frequency as follows: create up to 30 items/minute; update up to 60 items/minute; complete/reopen up to 120 state changes/minute; trash/restore up to 60 operations/minute; purge up to 30 operations/minute.\n\n## Process Flows (Business-Level)\n\nThe following Mermaid diagrams visualize end-to-end business flows in LR orientation; they express business behavior, not technical design.\n\n### Create Todo Item\n```mermaid\ngraph LR\n  A[\"User Initiates Create\"] --> B[\"Enter Title/Optional Fields\"]\n  B --> C[\"Validate Business Rules\"]\n  C --> D{\"Valid?\"}\n  D -->|\"Yes\"| E[\"Create Item(Status=open)\"]\n  E --> F[\"Set Created/Updated Times\"]\n  F --> G[\"Show Item in List\"]\n  D -->|\"No\"| H[\"Show Validation Guidance\"]\n```\n\n### Complete and Reopen Flow\n```mermaid\ngraph LR\n  A[\"User Selects Item\"] --> B{\"Current Status?\"}\n  B -->|\"open\"| C[\"Mark Completed\"]\n  C --> D[\"Record Completion Time\"]\n  D --> E[\"Reflect Status=completed\"]\n  B -->|\"completed\"| F[\"Reopen Item\"]\n  F --> G[\"Clear Completion Time\"]\n  G --> H[\"Reflect Status=open\"]\n```\n\n### Delete, Restore, and Purge Flow\n```mermaid\ngraph LR\n  A[\"User Selects Item\"] --> B{\"Delete?\"}\n  B -->|\"Yes\"| C[\"Move To Trashed\"]\n  C --> D[\"Hide From Normal Lists\"]\n  C --> E{\"Restore Within Retention?\"}\n  E -->|\"Yes\"| F[\"Restore To Open\"]\n  F --> G[\"Clear Deletion Metadata\"]\n  E -->|\"No\"| H[\"Eligible For Automatic Purge\"]\n  H --> I[\"Purge Irreversibly\"]\n```\n\n### Filtering and Sorting Flow\n```mermaid\ngraph LR\n  A[\"User Opens List\"] --> B[\"Apply Default Sort\"]\n  B --> C[\"User Sets Filters\"]\n  C --> D[\"Combine Filters\"]\n  D --> E[\"Fetch Page(Size per Preference)\"]\n  E --> F{\"Any Results?\"}\n  F -->|\"Yes\"| G[\"Display Items\"]\n  F -->|\"No\"| H[\"Display Empty State Guidance\"]\n```\n\n## Acceptance Criteria (EARS format)\n\nCreation\n- WHEN a \"user\" submits a new item with a valid title (1–120 chars), THE todoApp SHALL create the item with status \"open\" and display it in the list according to current sorting.\n- IF the title is invalid (missing, zero-length after trim, or >120 chars), THEN THE todoApp SHALL block creation and present guidance to correct the title without losing entered data.\n- WHERE a description up to 2,000 chars is provided, THE todoApp SHALL save it verbatim subject to control character restrictions.\n- IF a due date is earlier than 1970-01-01 (user-local) or more than 10 years in the future, THEN THE todoApp SHALL reject the due date with clear guidance.\n\nReading\n- THE todoApp SHALL present items in pages using the user’s preferred page size (default 20), sorted per the active sort rule.\n- WHEN a \"user\" filters by status=\"open\" and due date window=\"today\", THE todoApp SHALL return only the user’s open items due today in the user’s time zone.\n- IF a filter combination results in no matches, THEN THE todoApp SHALL display an empty state with guidance to adjust filters.\n\nUpdating and Conflicts\n- WHEN a \"user\" edits fields, THE todoApp SHALL validate against creation rules and update Updated Time upon success.\n- IF validation fails on update, THEN THE todoApp SHALL preserve existing data and present guidance to correct inputs.\n- IF a concurrent modification is detected, THEN THE todoApp SHALL prevent silent overwrite and require refresh or reconciliation before saving.\n\nDeletion, Restoration, and Purge\n- WHEN a \"user\" deletes an owned item, THE todoApp SHALL move it to \"trashed\" and hide it from normal lists while starting the retention window.\n- WHILE an item is in \"trashed\" state and within retention, THE todoApp SHALL allow restoration to the \"open\" status with prior content intact.\n- WHEN the retention period elapses, THE todoApp SHALL purge the item in the next scheduled purge and remove it irreversibly.\n- WHEN a \"user\" explicitly purges a \"trashed\" item, THE todoApp SHALL remove it irreversibly and it SHALL not appear in any listing or filter thereafter.\n\nCompletion/Reopen\n- WHEN a \"user\" completes an open item, THE todoApp SHALL set status to \"completed\" and record Completion Time; the item SHALL still appear according to filters and sorting.\n- WHEN a \"user\" reopens a completed item, THE todoApp SHALL set status to \"open\" and clear Completion Time; the item SHALL re-enter lists according to filters and sorting.\n\nFiltering and Sorting\n- THE todoApp SHALL support filters: status (open/completed/trashed or non-trashed), due date windows (today/tomorrow/this week/next week/overdue/no due date), text match, and created/updated date ranges.\n- THE todoApp SHALL support sorts: due date ascending (default, none last; tie by created time desc), due date descending, created time desc, updated time desc, title asc.\n\nTime Zone\n- THE todoApp SHALL treat date-only due dates as end-of-day obligations in the user’s time zone and compute overdue accordingly.\n- WHERE no profile time zone is set, THE todoApp SHALL default to Asia/Seoul (KST, UTC+9) for time calculations and displays.\n- IF a due date falls within a DST gap, THEN THE todoApp SHALL adjust to the next valid local time and maintain end-of-day semantics for date-only values.\n\nOwnership & Privacy\n- THE todoApp SHALL ensure a user can access only their own items; admin may access items for support per policy with audit.\n- IF cross-user access is attempted by a non-admin, THEN THE todoApp SHALL deny and present a privacy message.\n\nExport\n- WHERE a user requests export, THE todoApp SHALL produce a portable file containing all owned items and attributes, including timestamps, status, and deletion state, consistent with current time zone display rules.\n- IF no items exist, THEN THE todoApp SHALL produce a valid export file with zero items and a clear indication of emptiness.\n\nLimits and Rate Controls\n- THE todoApp SHALL enforce per-user maxima of 5,000 active items, 5,000 trashed items (purging oldest first when exceeded), and 10,000 total items excluding purged.\n- THE todoApp SHALL enforce per-minute operation limits for create (30), update (60), complete/reopen (120), trash/restore (60), and purge (30), presenting user-friendly guidance when limits are reached.\n\n## Traceability and Related Documents\n\n- Business vision and KPIs: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Roles, permissions, and authentication: [todoApp User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n- Cross-cutting validations, state logic, and retention: [todoApp Business Rules and Constraints](./06-todoApp-business-rules.md)\n- User-facing failures and recovery: [todoApp Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n- Performance and availability targets: [todoApp Non-Functional Requirements](./08-todoApp-non-functional-requirements.md)\n"},{"reason":"Describe who uses the system and the primary/secondary scenarios to guide requirement prioritization and testing.","filename":"04-todoApp-user-stories-and-personas.md","documentType":"user-story","outline":["Personas","Primary Scenarios (Happy Paths)","Secondary Scenarios and Edge Cases","Role-based Scenarios (user, admin)","Acceptance Tests in Natural Language (EARS where applicable)","Success Indicators per Scenario"],"audience":"product managers","keyQuestions":["Who are the typical users of this service?","What scenarios are most critical to support?","What edge cases must be considered for MVP?"],"detailLevel":"moderate detail","relatedDocuments":["03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["Avoid UI/UX design details and screen layouts","Use natural language and business logic only","Write acceptance tests in EARS where possible"],"content":"# todoApp User Stories and Personas\n\n## Personas\n\n### Persona 1: Focused Professional (User)\n- Profile: Employed knowledge worker balancing multiple projects and deadlines.\n- Goals: Capture tasks quickly, prioritize by urgency, complete tasks on schedule, review what’s done.\n- Motivations: Reduce mental load, maintain reliability, demonstrate progress.\n- Pain Points: Task sprawl across tools, forgetting deadlines, difficulty filtering by status.\n- Environment: Desktop during work hours; mobile on the go. Intermittent connectivity possible.\n- Success Measures: Can capture a task in under 10 seconds; can find any task within 5 seconds via filtering or search-like mechanisms; misses no critical due date over a week.\n\n### Persona 2: Organized Student (User)\n- Profile: University student juggling classes, assignments, and part-time work.\n- Goals: Track assignments by due dates, mark completed work, reopen items when requirements change.\n- Motivations: Stay ahead of deadlines, visualize workload by due date, avoid penalties.\n- Pain Points: Overdue tracking confusion, accidental deletions, unclear item states.\n- Environment: Mobile-first; occasional desktop sessions in labs or dorm.\n- Success Measures: Keeps assignment list current daily; can see upcoming items due this week within 2 seconds; can undo a completion or correct a mistake without data loss.\n\n### Persona 3: Casual Planner (User)\n- Profile: Non-technical individual using the app occasionally for personal reminders.\n- Goals: Add simple reminders, check off completed items, clear clutter periodically.\n- Motivations: Minimal friction, clarity of state (open vs completed), confidence items aren’t lost.\n- Pain Points: Complexity overload, needlessly required fields, confusing error messages.\n- Environment: Mobile with variable connectivity.\n- Success Measures: Zero confusion about item state; never blocked by optional fields; can delete or archive clutter quickly.\n\n### Persona 4: Support Administrator (Admin)\n- Profile: Service operator ensuring policy compliance and user support.\n- Goals: Assist users with account issues, enforce content and safety policies, monitor basic health indicators at a business level.\n- Motivations: Maintain trust and safety, minimize support burden, resolve issues quickly.\n- Pain Points: Ambiguity around user permissions, incomplete audit trails, difficulty revoking sessions when necessary.\n- Environment: Desktop in secure environment.\n- Success Measures: Can locate a user account within seconds; can revoke sessions and suspend/restore accounts swiftly with clear outcomes; minimal escalations.\n\n## User Stories per Persona\n\n### Focused Professional\n- As a focused professional, I want to capture a new task with only a title so that I can record intent without friction.\n- As a focused professional, I want to filter my list by status and due window so that I can focus on what is actionable today.\n- As a focused professional, I want to complete and later reopen a task so that I can correct mistakes without losing history.\n- As a focused professional, I want to find a specific task quickly so that I can resume work within seconds.\n\nAcceptance intent (business expectations):\n- WHEN a title-only todo is submitted, THE system SHALL create it within 2 seconds and show it in the list.\n- WHEN filters for status and due window are applied, THE system SHALL display only matching items consistently within the session.\n- WHEN a completed task is reopened, THE system SHALL revert the state and remove completion timestamp immediately.\n- WHEN a search-like filter is used, THE system SHALL locate a target item within 5 seconds as perceived by the user.\n\n### Organized Student\n- As an organized student, I want to add a due date to assignments so that I can plan ahead.\n- As an organized student, I want to see items due this week so that I can balance workload.\n- As an organized student, I want to undo a completion so that I can reflect changing requirements.\n- As an organized student, I want to avoid losing data on accidental edits or deletions so that I maintain confidence in the system.\n\nAcceptance intent (business expectations):\n- WHEN a due date is added, THE system SHALL display the due date according to the user’s time zone.\n- WHEN a “this week” filter is set, THE system SHALL return items due within the current week.\n- WHEN a completion is undone, THE system SHALL restore state to open and clear the completion timestamp.\n- IF a deletion or edit is attempted on another user’s item, THEN THE system SHALL deny and provide a permission message.\n\n### Casual Planner\n- As a casual planner, I want minimal required fields so that adding reminders is effortless.\n- As a casual planner, I want clear status labels so that I always know whether an item is open or completed.\n- As a casual planner, I want to remove clutter quickly so that my list stays manageable.\n\nAcceptance intent (business expectations):\n- WHEN only a title is given, THE system SHALL accept it and create the item without requiring optional fields.\n- WHEN I mark an item complete, THE system SHALL indicate completion immediately and allow easy reversal.\n- WHEN I delete an item, THE system SHALL remove it from active lists right away.\n\n### Support Administrator\n- As a support administrator, I want to revoke a user’s sessions so that security incidents can be mitigated quickly.\n- As a support administrator, I want to suspend and restore accounts so that policy compliance is enforced.\n- As a support administrator, I want visibility into account-level activity so that I can resolve support requests efficiently.\n\nAcceptance intent (business expectations):\n- WHEN revoke-all-sessions is executed for a user, THE system SHALL require re-authentication on that user’s devices within 1 minute.\n- WHEN an account suspension is applied, THE system SHALL block protected actions until restored.\n- WHEN administrative actions occur, THE system SHALL record them for audit.\n\n## Primary Scenarios (Happy Paths)\n\n### Scenario A: First-Time Registration and Email Verification (User)\n- Objective: Enable a new user to register and verify ownership of email to start using todoApp.\n- Steps (business flow):\n  1. User provides required registration information (email and password).\n  2. System records a new account in unverified state and initiates email verification.\n  3. User opens the verification link within its validity window.\n  4. System transitions account to verified state; user can sign in and use features.\n- Success Criteria: Verification instruction dispatched within 1 minute; account verified within minutes; user can sign in immediately after verification.\n\n### Scenario B: Create a New Todo (User)\n- Objective: Allow rapid creation of a minimal todo with optional enrichment.\n- Steps (business flow):\n  1. User initiates creation and supplies a title (mandatory), may add description and due date (optional).\n  2. System validates inputs and saves the item as \"open\".\n  3. System associates the item with the creator’s account and sets timestamps.\n- Success Criteria: Item appears in the user’s list immediately; optional fields remain optional without blocking.\n\n### Scenario C: Review and Filter Todos (User)\n- Objective: View own items and limit the list by status and due date expectations.\n- Steps (business flow):\n  1. User requests their todo list.\n  2. System returns items owned by the user with default ordering and business-level filtering controls (e.g., open vs completed).\n  3. User applies filters (e.g., show open only, or items due within next 7 days).\n- Success Criteria: User finds the intended item within 5 seconds; list reflects filter choices consistently.\n\n### Scenario D: Complete and Reopen a Todo (User)\n- Objective: Mark work done, with ability to reverse if needed.\n- Steps (business flow):\n  1. User marks an open item as completed.\n  2. System records completion timestamp and sets state to \"completed\".\n  3. If reopened, system removes the completion timestamp and returns state to \"open\".\n- Success Criteria: State changes are instant; history is consistent.\n\n### Scenario E: Edit a Todo (User)\n- Objective: Adjust details without causing confusion or loss.\n- Steps (business flow):\n  1. User updates title and/or optional fields.\n  2. System validates edits, saves changes, updates last-updated timestamp.\n- Success Criteria: Edits reflect immediately and persist across sessions.\n\n### Scenario F: Delete a Todo (User)\n- Objective: Remove clutter intentionally and safely.\n- Steps (business flow):\n  1. User requests deletion of one of their items.\n  2. System validates ownership and removes the item from active lists.\n- Success Criteria: Item no longer appears in active lists; user cannot access deleted item through normal navigation.\n\n### Scenario G: Administrative Session Revocation (Admin)\n- Objective: End a user’s active sessions for safety or policy reasons.\n- Steps (business flow):\n  1. Admin identifies the relevant user account.\n  2. Admin initiates revoke-all-sessions for that user.\n  3. System invalidates active user sessions.\n- Success Criteria: User’s devices require re-authentication; action is auditable.\n\n### Scenario H: Bulk Complete and Reopen (User)\n- Objective: Update the state of multiple items efficiently.\n- Steps (business flow):\n  1. User selects up to 50 items.\n  2. User triggers bulk complete or bulk reopen.\n  3. System applies state changes to all selected items that are eligible.\n- Success Criteria: Bulk operation completes within 2 seconds perceived by the user for up to 50 items; partial ineligibility is reported with clear guidance.\n\n### Scenario I: Export My Data (User)\n- Objective: Obtain a portable copy of owned todos.\n- Steps (business flow):\n  1. User requests export of own data.\n  2. System prepares a complete package of the user’s items and attributes.\n  3. System notifies the user when the export is ready.\n- Success Criteria: Export includes all owned items and attributes; delivery within a reasonable window as defined in requirements.\n\n### Scenario J: Change Time Zone Preference (User)\n- Objective: Ensure dates and times reflect local expectations after a time zone change.\n- Steps (business flow):\n  1. User changes profile time zone.\n  2. System reinterprets and displays due dates and timestamps in the new time zone.\n- Success Criteria: Intended due calendar dates remain unchanged; timestamps display consistently in the new time zone.\n\n```mermaid\ngraph LR\n  A[\"User Starts\"] --> B[\"Register Account\"]\n  B --> C[\"Email Verification Sent\"]\n  C --> D{\"Verification Link Opened?\"}\n  D -->|\"Yes\"| E[\"Account Verified\"]\n  D -->|\"No\"| F[\"Reminder/Resend Option\"]\n  E --> G[\"Create First Todo\"]\n  G --> H[\"Review & Filter List\"]\n  H --> I[\"Complete Item\"]\n  I --> J{\"Need To Reopen?\"}\n  J -->|\"Yes\"| K[\"Reopen Item\"]\n  J -->|\"No\"| L[\"Continue Working\"]\n```\n\nAdditional lifecycle overview:\n\n```mermaid\ngraph LR\n  U1[\"Start Authenticated Session\"] --> T1[\"Create Todo\"]\n  T1 --> T2[\"Edit Todo\"]\n  T2 --> T3[\"Complete Todo\"]\n  T3 --> Q1{\"Reopen Needed?\"}\n  Q1 -->|\"Yes\"| T5[\"Reopen Todo\"]\n  Q1 -->|\"No\"| T6[\"Proceed\"]\n  T5 --> T2\n  T3 --> T7[\"Delete Todo\"]\n  T7 --> T8[\"Removed from Active Views\"]\n```\n\n## Secondary Scenarios and Edge Cases\n\n- Duplicate Titles:\n  - Business Rule: Titles need not be unique; disambiguation is by context and timestamps.\n- Title Whitespace and Length:\n  - Business Rule: Leading/trailing whitespace is ignored; trimmed length must be within allowed bounds.\n- Description Length and Multi-line Text:\n  - Business Rule: Long descriptions up to the allowed limit are accepted; line breaks are preserved; executable content is not permitted.\n- Due Dates in the Past:\n  - Business Rule: Acceptable for historical capture; system reflects overdue status without blocking.\n- Daylight Saving Time (DST) and Leap Days:\n  - Business Rule: Non-existent times adjust to the next valid time; invalid calendar dates are rejected; due dates represent end-of-day obligations for date-only entries.\n- Time Zone Handling:\n  - Business Rule: Due date interpretation follows the user’s current time zone; changing time zone re-renders dates without altering intended calendar days.\n- Large Lists and Navigation:\n  - Business Expectation: Lists are responsive with pagination; ordering defaults are predictable; filters persist during navigation.\n- Concurrent Edits and Deletes:\n  - Business Rule: Prevent silent overwrites; provide guidance to refresh, reconcile, or retry when conflicts occur; if an item is deleted during edit, inform the user gracefully.\n- Session Expiration During Use:\n  - Business Rule: Persisted data remains; subsequent protected actions require re-authentication.\n- Account Suspension:\n  - Business Rule: Suspended accounts cannot perform protected actions; read-only access may be allowed per policy.\n- Rate Limiting and Abuse Prevention:\n  - Business Rule: Excessive operation frequency may be throttled; communicate limits and retry expectations clearly.\n- Export Size and Frequency:\n  - Business Rule: Exports may be rate-limited; large exports may be processed asynchronously with notification on completion.\n- Accessibility and Clarity:\n  - Business Rule: Messages use unambiguous, plain language that directs users toward successful recovery actions.\n\n## Role-based Scenarios (user, admin)\n\n### User Role: Owned-Data Operations\n- Create Todo: Creates items with required title and optional fields; items belong exclusively to the creator.\n- Read Own Todos: Views only owned items; no leakage of other users’ data.\n- Update Own Todos: Edits only owned items; state transitions are controlled (open ⇄ completed).\n- Delete Own Todos: Removes only owned items from active lists.\n- Export Own Data: Requests export of owned items subject to capacity limits.\n- Account Management: Verifies email, signs in/out, changes password, revokes own sessions.\n\n### Admin Role: Support and Policy Enforcement\n- Locate and Review User Profile: Finds accounts and reviews business-level details needed for support.\n- Revoke User Sessions: Ends all sessions for a user when safety or policy requires; action is auditable.\n- Suspend/Restore Account: Changes account status to restrict or restore access as warranted.\n- Access Aggregated Indicators: Reviews aggregate-level health indicators without exposing personal content beyond the minimum necessary for support.\n- Enforce Policy on Content: Performs support actions on items where justified (e.g., immediate removal of clearly violating content) with audit trail.\n\n## Acceptance Tests in Natural Language (EARS where applicable)\n\n### Registration and Verification\n- WHEN a new user submits valid registration information, THE system SHALL create an unverified account and send a verification instruction within 1 minute.\n- IF a user opens a valid verification link within its validity window, THEN THE system SHALL mark the account as verified immediately.\n- IF a user attempts to sign in before verifying, THEN THE system SHALL prevent access to todo features and direct the user to verify.\n\n### Create Todo\n- WHEN a verified user provides a title and submits a new todo, THE system SHALL create the item as \"open\" and associate it with that user within 2 seconds.\n- IF the user omits description and due date, THEN THE system SHALL still create the item without error.\n- IF the title length exceeds the business-defined limit, THEN THE system SHALL reject the creation with a clear message referencing the limit.\n\n### Review and Filter\n- WHEN a user requests their todo list, THE system SHALL return only items owned by that user ordered by last updated, newest first.\n- WHERE a user applies a filter to show only \"open\" items, THE system SHALL display only items with state \"open\" consistently across navigation within the same session.\n- WHERE a user filters by a due window (today, this week), THE system SHALL compute the window using the user’s time zone and display matching items only.\n\n### Complete and Reopen\n- WHEN a user marks an open item as completed, THE system SHALL set the item state to \"completed\" and record a completion timestamp.\n- IF a user reopens a completed item, THEN THE system SHALL remove the completion timestamp and set state to \"open\".\n- IF a user attempts to complete an already completed item, THEN THE system SHALL keep the state unchanged and provide guidance that it is already completed.\n\n### Edit Todo\n- WHEN a user updates the title of their own item to a valid value, THE system SHALL save the change and update the last-updated timestamp.\n- IF a user attempts to edit another user’s item, THEN THE system SHALL deny the action and inform the user they lack permission.\n\n### Delete Todo\n- WHEN a user requests deletion of their own item, THE system SHALL remove the item from active views.\n- IF a user attempts to delete an item they do not own, THEN THE system SHALL deny the action and provide a clear permission error message.\n\n### Bulk Operations\n- WHEN a user selects up to 50 items and triggers bulk complete, THE system SHALL complete all eligible items within 2 seconds perceived by the user and report any ineligible selections.\n- WHEN a user selects up to 50 items and triggers bulk reopen, THE system SHALL reopen all eligible items within 2 seconds perceived by the user and report any ineligible selections.\n\n### Export\n- WHEN a user requests export of their own items, THE system SHALL prepare a complete, portable package and notify the user upon completion within a reasonable window.\n- IF a user requests export when no items exist, THEN THE system SHALL provide a valid export package indicating zero items.\n\n### Time Zone and Due Dates\n- WHILE the user’s time zone setting differs from the time zone at item creation, THE system SHALL preserve the intended due calendar date when displaying the item.\n- IF a due date is set in the past, THEN THE system SHALL mark the item as overdue without blocking save operations.\n- IF a due date falls into a DST gap in the selected time zone, THEN THE system SHALL adjust to the next valid local time and inform the user.\n\n### Concurrency and Conflicts\n- IF two sessions attempt to update the same item concurrently, THEN THE system SHALL prevent silent overwrite and instruct the user to refresh or reconcile.\n- IF an item is deleted in another session during an edit attempt, THEN THE system SHALL inform that the item is no longer available and preserve the user’s input locally where feasible.\n\n### Administrative Controls\n- WHEN an admin executes revoke-all-sessions for a user, THE system SHALL end the user’s active sessions so that the next action requires re-authentication.\n- WHEN an admin suspends a user account, THE system SHALL block access to todo features for that account until restored and record the action for audit.\n\n### Rate Limiting and Recovery\n- WHERE a user exceeds defined write operation limits, THE system SHALL throttle further writes temporarily and provide guidance on when to retry.\n- WHEN a transient service issue prevents completion of an action, THE system SHALL encourage retry and avoid duplicated creations or updates from a single submitted intent.\n\n## Success Indicators per Scenario\n\n| Scenario | Primary KPI | Target for MVP | Measurement Method |\n|---------|-------------|----------------|--------------------|\n| Registration & Verification | Verification completion rate within 24 hours | ≥ 80% | Ratio of verified/registered within 24h |\n| Create Todo | Median time from intent to saved item | ≤ 10 seconds | Time from create action start to item persistence |\n| Review & Filter | Time-to-find (specific item) | ≤ 5 seconds | Time from list request to visibility of targeted item via filters |\n| Complete/Reopen | State change latency | ≤ 2 seconds | Time from user action to list reflecting new state |\n| Edit Todo | Edit persistence success rate | ≥ 99% | Successful saves / attempts |\n| Delete Todo | Erroneous deletions rate | ≤ 0.1% | Confirmed mistaken deletions / deletions |\n| Admin Session Revocation | Time to invalidate sessions | ≤ 1 minute | Time from revocation to enforced re-authentication |\n| Bulk Complete/Reopen | Completion of eligible items | 100% eligible within 2 seconds | Operation timing and eligibility reporting |\n| Export | Export readiness window | ≤ 24 hours (typical) | Time from request to availability notification |\n| Time Zone Change | Consistency of due calendar day | 100% preserved | Audit sample of items before/after change |\n\n## References to Related Documents\n- See the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for field validations, ownership rules, and acceptance criteria.\n- Review the [User Flows for todoApp](./05-todoApp-user-flows.md) for visual flow details complementing these scenarios.\n- Consult the [Error Handling and Exception Scenarios for todoApp](./07-todoApp-error-handling-and-exception-scenarios.md) for recovery paths and user-facing guidance.\n\n## Scope Clarification\nThis content provides business requirements, personas, stories, and scenarios for todoApp. It focuses on what the system must do from a user and business perspective and does not prescribe technical implementation. All architecture, API design, and database decisions are at the discretion of the development team."},{"reason":"Provide clear, visual business flows for key processes to reduce ambiguity and align teams.","filename":"05-todoApp-user-flows.md","documentType":"user-flow","outline":["Flow Diagram Conventions","Authentication Flow (register, login, reset)","Todo Item Lifecycle Flow (create, update, complete, delete)","Error and Recovery Flow","State Model for Todo Items","Narrative Descriptions of Each Flow"],"audience":"development team","keyQuestions":["What are the step-by-step flows for core processes?","Where do decisions occur and what are the expected outcomes?"],"detailLevel":"moderate detail","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["All diagrams must follow the Mermaid rules provided (double quotes for labels, correct arrows)","Use graph LR orientation for readability","Do not include technical architecture diagrams or API sequence diagrams"],"content":"# todoApp User Flows and Business Process Diagrams\n\nThis document provides business requirements only. All technical implementation decisions (architecture, APIs, database design, and related choices) belong to the development team. The content describes WHAT the system should do, not HOW to build it.\n\n- Service prefix: todoApp\n- Roles referenced: user, admin\n- Related references for deeper context:\n  - See the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md) for complete role definitions and authentication behaviors.\n  - See the [Functional Requirements (MVP)](./03-todoApp-functional-requirements.md) for field-level validations and acceptance criteria.\n  - See the [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md) for comprehensive error taxonomies and user recovery.\n\n## Flow Diagram Conventions\n\n- Orientation: Left-to-right (LR) for all flows.\n- Notation: Rectangles represent steps, diamonds represent decisions, rounded shapes represent states or outcomes.\n- Labels: All node and edge labels use double quotes; edge labels denote decision outcomes or key information.\n- Roles context:\n  - \"user\" refers to an authenticated end user managing their own todos and account.\n  - \"admin\" refers to an administrative user performing oversight or support activities.\n- Business semantics:\n  - \"Create\", \"Update\", \"Complete\", \"Reopen\", and \"Delete\" refer to user-visible actions and their business effects.\n  - \"Verification\" refers to email verification for account activation.\n- Performance expectations (user experience level):\n  - Simple actions (register, login, create todo, mark complete) should feel immediate. Where stated, response expectations are provided in seconds as testable criteria.\n\n### Visual Legend (Business-Level)\n\n| Symbol | Meaning |\n|-------|---------|\n| Rectangle | Action or processing step |\n| Diamond | Decision point with labeled outcomes |\n| Rounded Rectangle | Outcome or state |\n| Dotted Arrow | Advisory or guidance path |\n\n## Authentication Flow (register, login, reset)\n\n### Diagram: Registration, Email Verification, Login, Logout, Password Reset (Request + Completion)\n\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A1[\"Open Registration\"] --> A2[\"Enter Email/Password\"]\n    A3[\"Open Login\"] --> A4[\"Enter Credentials\"]\n    A5[\"Open Password Reset\"] --> A6[\"Submit Reset Request(Email)\"]\n    A7[\"Open Logout\"] --> A8[\"Confirm Logout\"]\n    A9[\"Open Verification Link\"]\n    A10[\"Open Reset Link\"] --> A11[\"Enter New Password\"]\n  end\n\n  subgraph \"Business Processing\"\n    B1[\"Validate Registration Input\"] --> B2{\"Email Available?\"}\n    B2 -->|\"Yes\"| B3[\"Create Account(Pending Verification)\"]\n    B2 -->|\"No\"| E1[\"Inform Duplicate Email\"]\n    B3 --> B4[\"Send Verification Email\"]\n\n    B5[\"Validate Credentials\"] --> B6{\"Account Exists?\"}\n    B6 -->|\"No\"| E2[\"Inform Invalid Login\"]\n    B6 -->|\"Yes\"| B7{\"Email Verified?\"}\n    B7 -->|\"No\"| E3[\"Inform Verification Required\"]\n    B7 -->|\"Yes\"| B8[\"Establish Session\"]\n\n    B9[\"Validate Reset Request\"] --> B10{\"Account Exists?\"}\n    B10 -->|\"No\"| E4[\"Inform Generic Confirmation\"]\n    B10 -->|\"Yes\"| B11[\"Send Reset Instructions\"]\n\n    B12[\"Validate Verification Token\"] --> B13{\"Token Valid?\"}\n    B13 -->|\"Yes\"| B14[\"Activate Account(Verified)\"]\n    B13 -->|\"No\"| E5[\"Inform Invalid/Expired Link\"]\n\n    B15[\"Invalidate Session\"]\n\n    B16[\"Validate Reset Token\"] --> B17{\"Token Valid?\"}\n    B17 -->|\"Yes\"| B18[\"Validate New Password(Policy)\"]\n    B18 --> B19{\"Valid?\"}\n    B19 -->|\"Yes\"| B20[\"Set New Password & Revoke Sessions\"]\n    B19 -->|\"No\"| E6[\"Inform Password Policy Failure\"]\n    B17 -->|\"No\"| E7[\"Inform Invalid/Expired Reset Link\"]\n  end\n\n  subgraph \"Outcomes\"\n    C1[\"Registration Pending\"]\n    C2[\"Registration Complete\"]\n    C3[\"Logged In\"]\n    C4[\"Password Reset Email Sent\"]\n    C5[\"Logged Out\"]\n    C6[\"Password Reset Complete\"]\n  end\n\n  %% Flows\n  A2 --> B1 --> B2\n  B3 --> B4 --> C1\n\n  A9 --> B12 --> B13\n  B14 --> C2\n\n  A4 --> B5 --> B6\n  B8 --> C3\n\n  A6 --> B9 --> B10\n  B11 --> C4\n\n  A8 --> B15 --> C5\n\n  A10 --> B16 --> B17\n  B18 --> B19\n  B20 --> C6\n\n  %% Errors & Guidance\n  E1 -.->|\"Guidance: Use Different Email\"| A2\n  E2 -.->|\"Guidance: Retry or Reset\"| A3\n  E3 -.->|\"Guidance: Check Inbox\"| C1\n  E4 -.->|\"Guidance: If No Account, Register\"| A1\n  E5 -.->|\"Guidance: Request New Link\"| A5\n  E6 -.->|\"Guidance: Follow Password Rules\"| A11\n  E7 -.->|\"Guidance: Request New Reset Link\"| A5\n```\n\n### EARS Requirements — Authentication\n\n- WHEN a person submits valid registration details, THE authentication subsystem SHALL create an account in \"pending verification\" state and send a verification email within 60 seconds.\n- IF the registration email is already in use, THEN THE authentication subsystem SHALL reject the registration and present a message indicating the email is taken.\n- WHEN a person clicks a valid verification link, THE authentication subsystem SHALL activate the account immediately and allow login thereafter.\n- IF a verification link is invalid or expired, THEN THE authentication subsystem SHALL inform the user and provide a path to request a new link.\n- WHEN a verified account submits correct login credentials, THE authentication subsystem SHALL create an authenticated session and reflect the logged-in state within 2 seconds.\n- IF login fails due to unknown account or incorrect credentials, THEN THE authentication subsystem SHALL not reveal which field failed and SHALL encourage retry or password reset.\n- WHEN a user requests a password reset with an email of an existing account, THE authentication subsystem SHALL send reset instructions within 60 seconds and SHALL not disclose whether the email exists to unauthorized parties.\n- WHEN a user opens a valid reset link and enters a new password that meets policy, THE authentication subsystem SHALL set the new password and revoke existing sessions, allowing immediate login with the new password.\n- IF a reset link is invalid or expired, THEN THE authentication subsystem SHALL provide a path to request a new reset link without disclosing account existence.\n- WHEN a user initiates logout, THE authentication subsystem SHALL terminate the active session immediately and reflect the logged-out state.\n- WHERE the actor is an admin assisting a user, THE support process SHALL allow the admin to trigger re-verification or lock/unlock an account according to business policy defined in the role specification and record the reason for audit.\n- WHERE excessive failed login attempts occur, THE authentication subsystem SHALL throttle further attempts temporarily and present recovery guidance consistent with the error handling policy.\n\n## Todo Item Lifecycle Flow (create, update, complete, delete)\n\n### Diagram: Todo Item Lifecycle\n\n```mermaid\ngraph LR\n  subgraph \"User Actions\"\n    T1[\"Start Create Todo\"] --> T2[\"Enter Title(Optional: Description, Due Date)\"]\n    T3[\"Open Todo\"] --> T4[\"Edit Fields\"]\n    T5[\"Mark Complete\"]\n    T6[\"Reopen Item\"]\n    T7[\"Delete Item\"]\n    T8[\"List My Todos\"]\n  end\n\n  subgraph \"Business Rules\"\n    R1[\"Validate Title(Non-Empty, Max Length)\"]\n    R2[\"Validate Optional Fields(Description Length, Due Date Format)\"]\n    R3{\"Item Owned By User?\"}\n    R4{\"Item Editable?\"}\n    R5{\"Item In Active State?\"}\n    R6{\"Item In Completed State?\"}\n  end\n\n  subgraph \"Outcomes\"\n    O1[\"Item Created(Active)\"]\n    O2[\"Item Updated\"]\n    O3[\"Item Completed\"]\n    O4[\"Item Reopened(Active)\"]\n    O5[\"Item Deleted(Permanent)\"]\n    O6[\"User List Returned\"]\n  end\n\n  %% Creation\n  T2 --> R1 --> R2 --> O1\n\n  %% Read/List\n  T8 --> O6\n\n  %% Update\n  T4 --> R3\n  R3 -->|\"Yes\"| R4\n  R3 -->|\"No\"| E1[\"Inform Access Denied\"]\n  R4 -->|\"Yes\"| O2\n  R4 -->|\"No\"| E2[\"Inform Not Editable\"]\n\n  %% Complete\n  T5 --> R3\n  R3 -->|\"Yes\"| R5\n  R5 -->|\"Yes\"| O3\n  R5 -->|\"No\"| E3[\"Inform Already Completed or Invalid State\"]\n\n  %% Reopen\n  T6 --> R3\n  R3 -->|\"Yes\"| R6\n  R6 -->|\"Yes\"| O4\n  R6 -->|\"No\"| E4[\"Inform Not Completed\"]\n\n  %% Delete\n  T7 --> R3\n  R3 -->|\"Yes\"| O5\n  R3 -->|\"No\"| E5[\"Inform Access Denied\"]\n\n  %% Guidance\n  E1 -.->|\"Guidance: Operate Only Own Items\"| T3\n  E2 -.->|\"Guidance: Check State/Fields\"| T3\n  E3 -.->|\"Guidance: No Duplicate Completion\"| T3\n  E4 -.->|\"Guidance: Reopen Only Completed\"| T3\n  E5 -.->|\"Guidance: Ownership Required\"| T3\n```\n\n### EARS Requirements — Todo Lifecycle\n\n- THE todo management subsystem SHALL require a non-empty title up to the maximum length defined in the functional specification.\n- WHERE a description is provided, THE todo management subsystem SHALL accept it up to the maximum length defined in the functional specification.\n- WHERE a due date is provided, THE todo management subsystem SHALL interpret it using the user’s locale and time zone settings as specified in the functional specification.\n- WHEN a user creates a valid todo, THE todo management subsystem SHALL place it in the \"active\" state and make it available in the user’s list immediately.\n- WHEN a user requests to list their todos, THE todo management subsystem SHALL return only items owned by that user, ordered by the current business sorting rule.\n- IF a user attempts to modify a todo they do not own, THEN THE todo management subsystem SHALL deny the action and present an authorization message without exposing other users’ data.\n- WHEN a user edits fields of a todo, THE todo management subsystem SHALL apply the changes immediately if all validations pass and SHALL update the last-updated indicator.\n- WHEN a user marks an active todo as complete, THE todo management subsystem SHALL update its state to \"completed\" and display the completion timestamp according to the user’s time zone.\n- IF a user attempts to complete a todo already in \"completed\" state, THEN THE todo management subsystem SHALL inform that the item is already completed and SHALL not change state.\n- WHEN a user reopens a completed todo, THE todo management subsystem SHALL return it to the \"active\" state and clear any derived completion indicators while preserving historical metadata as defined in the business rules.\n- WHEN a user deletes their own todo, THE todo management subsystem SHALL remove it from the user’s list permanently for MVP scope.\n- WHERE an admin performs moderation, THE administrative process SHALL not alter user todo content except when enforcing policy; any such action SHALL be auditable according to the role specification.\n\n## Error and Recovery Flow\n\n### Diagram: Error Categories and Recovery Paths\n\n```mermaid\ngraph LR\n  subgraph \"Operation Context\"\n    U1[\"Attempt Operation\"] --> D1{\"Auth Error?\"}\n  end\n\n  subgraph \"Authentication/Authorization\"\n    D1 -->|\"Yes\"| A1[\"Show Auth Message\"]\n    A1 --> A2{\"User Intends to Recover?\"}\n    A2 -->|\"Yes\"| A3[\"Prompt Login or Verify Email\"]\n    A2 -->|\"No\"| A4[\"Abort Operation\"]\n  end\n\n  subgraph \"Validation\"\n    D1 -->|\"No\"| D2{\"Validation Error?\"}\n    D2 -->|\"Yes\"| V1[\"Show Field Guidance\"]\n    V1 --> V2{\"Can Retry Immediately?\"}\n    V2 -->|\"Yes\"| V3[\"Allow Correction and Resubmission\"]\n    V2 -->|\"No\"| V4[\"Provide Instructions\"]\n  end\n\n  subgraph \"Not Found / Conflict\"\n    D2 -->|\"No\"| D3{\"Not Found?\"}\n    D3 -->|\"Yes\"| N1[\"Inform Missing Resource\"]\n    D3 -->|\"No\"| D4{\"Conflict?\"}\n    D4 -->|\"Yes\"| C1[\"Inform Concurrent Update\"]\n    C1 --> C2[\"Offer Refresh or Retry\"]\n  end\n\n  subgraph \"Rate Limit / Service Unavailable\"\n    D4 -->|\"No\"| D5{\"Rate Limited?\"}\n    D5 -->|\"Yes\"| R1[\"Show Wait Guidance\"]\n    D5 -->|\"No\"| D6{\"Service Unavailable?\"}\n    D6 -->|\"Yes\"| S1[\"Show Retry Later Guidance\"]\n    D6 -->|\"No\"| S2[\"Proceed to Success\"]\n  end\n```\n\n### EARS Requirements — Error and Recovery\n\n- WHEN an action requires authentication and the user is not authenticated, THE system SHALL present a message to log in or verify and SHALL not proceed with the action.\n- IF a form submission contains invalid fields, THEN THE system SHALL highlight the specific fields and provide actionable guidance for correction.\n- WHEN a missing resource is referenced (e.g., deleted or non-existent todo), THE system SHALL inform the absence without exposing whether the resource ever existed for other users.\n- IF a concurrency conflict occurs due to simultaneous updates, THEN THE system SHALL prevent data loss by rejecting the later change and SHALL offer a path to refresh and retry.\n- WHEN a user exceeds allowed operation frequency, THE system SHALL inform that the rate limit has been reached and SHALL advise when to try again.\n- IF a transient service disruption prevents completing an action, THEN THE system SHALL inform the user and encourage retry after a short interval without blaming user input.\n- WHERE an account is suspended due to policy, THE system SHALL block protected actions and present suspension information upon next sign-in attempt.\n\n## State Model for Todo Items\n\n### Diagram: States and Transitions (Business-Level)\n\n```mermaid\ngraph LR\n  S0[\"Nonexistent\"] -->|\"Create\"| S1[\"Active\"]\n  S1 -->|\"Update Fields\"| S1\n  S1 -->|\"Complete\"| S2[\"Completed\"]\n  S2 -->|\"Reopen\"| S1\n  S1 -->|\"Delete\"| S3[\"Deleted(Permanent)\"]\n  S2 -->|\"Delete\"| S3\n```\n\n### EARS Requirements — State Model\n\n- THE todo item lifecycle SHALL consist of \"active\", \"completed\", and \"deleted\" states for MVP.\n- WHEN a todo is created successfully, THE lifecycle SHALL enter the \"active\" state.\n- WHEN a todo is marked complete from the \"active\" state, THE lifecycle SHALL transition to \"completed\" without modifying non-edited fields.\n- WHEN a completed todo is reopened, THE lifecycle SHALL transition back to \"active\" and clear completion-specific indicators while keeping other fields intact.\n- WHEN a todo is deleted, THE lifecycle SHALL transition to \"deleted\" and SHALL not be available in the user’s list thereafter for MVP.\n\n## Narrative Descriptions of Each Flow\n\n### Authentication Flow Narrative\n\n- Registration and Verification\n  - Trigger: A person attempts to create an account with an email and password.\n  - Decision: If the email is already in use, the registration is rejected and guidance is provided to try another email. Otherwise, the account is created in a pending verification state, and a verification message is sent.\n  - Outcome: On clicking a valid verification link, the account becomes verified and eligible for login.\n  - Non-disclosure: Do not reveal whether a specific email exists to unauthorized parties.\n  - Resend: If the verification link expires, a resend request is available within policy limits.\n\n- Login and Session Establishment\n  - Trigger: A verified user enters credentials.\n  - Decision: If credentials are invalid or the account is unverified, the login is denied with appropriate guidance. Otherwise, a session is established.\n  - Outcome: The user reaches the authenticated state capable of performing todo operations.\n  - Protection: Repeated failed attempts are throttled with clear recovery guidance.\n\n- Password Reset\n  - Request: Any person may initiate a reset request by providing an email; confirmation messaging does not disclose account existence.\n  - Completion: A person opening a valid reset link provides a new password that meets policy, resulting in session revocation and the ability to log in immediately.\n  - Recovery: Invalid or expired reset links result in guidance to request a new link.\n\n- Logout\n  - Trigger: A logged-in user initiates logout.\n  - Outcome: The active session is terminated immediately and the user returns to a non-authenticated state.\n\n- Admin Support Notes\n  - Admins can enforce policies such as locking accounts or re-triggering verification within the constraints and audit expectations defined in the role specification.\n\n### Todo Item Lifecycle Narrative\n\n- Create\n  - Trigger: An authenticated user initiates creation.\n  - Validation: Title must be present and within allowed length; optional description and due date, when provided, must meet length and format rules.\n  - Outcome: A new todo is created in the active state and appears in the user’s list.\n\n- Read\n  - Trigger: A user lists or views their todos.\n  - Authorization: Items are only visible to their owner. Admin oversight of content, when necessary for policy enforcement, is controlled and auditable.\n\n- Update\n  - Trigger: A user edits fields of their own todo.\n  - Decision: If the item is not owned by the user, the operation is denied. If the item is in a state that disallows the requested change (as per business rules), the operation is denied with guidance. Otherwise, the update is applied and the last-updated indicator changes.\n\n- Complete\n  - Trigger: A user marks an active todo as complete.\n  - Decision: If already completed, the operation is rejected with guidance.\n  - Outcome: Item moves to completed state; completion timestamp is recorded for display based on the user’s time zone.\n\n- Reopen\n  - Trigger: A user reopens a completed item.\n  - Outcome: Item moves back to active state; completion-specific indicators are cleared while preserving other details.\n\n- Delete\n  - Trigger: A user deletes their own item.\n  - Outcome: Item is permanently removed from the user’s list for MVP. Future phases may introduce trash/restore according to the business rules document versioning.\n\n### Error and Recovery Narrative\n\n- Authentication and Authorization Errors\n  - Scenario: User attempts actions requiring authentication or proper authorization.\n  - Response: The system blocks the action and presents clear next steps: log in, verify email, or request access as appropriate. No sensitive details are disclosed.\n\n- Validation Errors\n  - Scenario: User submissions fail validations (e.g., missing title, invalid due date format, overly long text fields).\n  - Response: The system identifies specific fields and provides actionable guidance to correct and resubmit while preserving valid inputs.\n\n- Not Found\n  - Scenario: A referenced todo does not exist or is no longer available.\n  - Response: The system informs that the resource is unavailable without exposing historical existence for other users.\n\n- Conflict (Concurrent Updates)\n  - Scenario: Two edits occur to the same todo in close succession.\n  - Response: The system prevents overwriting by rejecting the later change, guiding the user to refresh and retry; options for reconcile/overwrite/discard are governed by the error handling policy.\n\n- Rate Limit\n  - Scenario: Excessive operations in a short period (e.g., repeated create/delete).\n  - Response: The system asks the user to slow down and to try again after a provided interval, describing the applicable limit window in user terms.\n\n- Service Unavailable\n  - Scenario: Temporary outage or degraded service prevents operation completion.\n  - Response: The system encourages retry after a short interval and provides reassurance without implying user error; user-entered data is preserved when feasible for later submission.\n\n## Additional EARS Requirements Spanning Flows\n\n- WHILE a user is authenticated, THE system SHALL maintain a valid session and reflect authorization according to the role’s business permissions.\n- WHERE the actor is \"admin\", THE system SHALL allow actions aligned with oversight and policy enforcement while maintaining auditability and minimal data exposure.\n- WHEN business limits are exceeded (such as rate limits), THE system SHALL communicate the limit and the time window for retry in user terms.\n- WHEN time-sensitive information is presented (such as due dates and completion timestamps), THE system SHALL align display and interpretation with the user’s configured time zone and locale rules defined in the functional specification.\n- WHEN a user signs out voluntarily or due to security action, THE system SHALL invalidate the current session and require re-authentication for protected actions.\n- IF an account is suspended for policy reasons, THEN THE system SHALL block protected actions and present suspension messaging at the next sign-in attempt.\n\n## Traceability and References\n\n- Authentication details and lifecycle expectations: [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n- Feature-level behaviors and validations: [Functional Requirements (MVP)](./03-todoApp-functional-requirements.md).\n- Error handling categories and user-facing guidance: [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md).\n\nEnd of document."},{"reason":"Codify validation rules, constraints, and state logic to ensure consistent handling across all features.","filename":"06-todoApp-business-rules.md","documentType":"requirement","outline":["Purpose and Scope","Terminology and States","Todo Item Validation Rules","Ownership and Access Rules","Rate Limits and Operational Constraints (business-level)","Retention and Deletion Rules","Time Zone and Date Handling Rules","Rule Conflict Resolution and Precedence","Traceability to Functional Requirements"],"audience":"development team","keyQuestions":["What validations apply to todo items and accounts?","What limits, if any, exist for operations?","How are conflicts in rules resolved?"],"detailLevel":"detailed specification","relatedDocuments":["03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md","09-todoApp-data-lifecycle-and-privacy.md"],"constraints":["Express rules in testable, measurable terms (use EARS where applicable)","Avoid any database, API, or technical design details"],"content":"# todoApp Business Rules and Constraints\n\n## Purpose and Scope\nProvides business rules, validations, constraints, and state logic for todoApp to ensure consistent behavior across all features and scenarios. Describes WHAT must happen from a business perspective; technical implementation details (architecture, APIs, database design, storage, libraries) are at the discretion of the development team.\n\nScope includes: todo item field validations, item state transitions, ownership and access rules, rate limits and operational constraints, retention and deletion behaviors, time zone and date handling, idempotency and concurrency policies, conflict resolution principles, and traceability to related specifications. Applies to roles: user and admin.\n\nRelated documents for broader context:\n- Refer to the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md) for end-to-end feature behaviors and acceptance criteria.\n- Refer to the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md) for performance, security, and reliability expectations.\n- Refer to the [Data Lifecycle and Privacy Requirements for todoApp](./09-todoApp-data-lifecycle-and-privacy.md) for conceptual lifecycle and privacy constraints.\n\n## Terminology and States\n- Owner: The authenticated account that created a todo item. Each item has exactly one Owner.\n- Todo Item (Item): A task record with a required title and optional attributes such as description and due date.\n- Active: The normal state of an Item that is not completed and not in trash.\n- Completed: The state indicating the Item has been marked done.\n- Trashed: The state indicating the Item has been deleted by the Owner but is recoverable within the trash retention period.\n- Purged: The state indicating the Item has been irreversibly removed following retention rules.\n- Suspension: An account-level restriction under which write operations are blocked.\n\n### State Model and Allowed Transitions\nItem states and transitions follow the flow below.\n\n```mermaid\ngraph LR\n  subgraph \"Todo Item States\"\n    A[\"Active\"] --> B[\"Completed\"]\n    B --> A\n    A --> C[\"Trashed\"]\n    B --> C\n    C --> A\n    C --> D[\"Purged(Irreversible)\"]\n  end\n```\n\n- Allowed transitions: Active → Completed; Completed → Active (reopen); Active → Trashed; Completed → Trashed; Trashed → Active (restore); Trashed → Purged.\n- Disallowed transitions: Any direct transition to Purged except from Trashed; Purged has no outgoing transitions.\n\nEARS:\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n\n## Todo Item Validation Rules\nDefines required and optional fields, permitted value ranges, and behavioral validations for creation, updates, completion, reopening, and deletion. All limits are measured after trimming leading and trailing whitespace where applicable.\n\n### Field-Level Constraints\n- Title (required):\n  - Length: 1 to 120 Unicode characters after trimming.\n  - Content: No control characters; line breaks permitted and normalized.\n  - Uniqueness: Not required; duplicate titles are allowed.\n- Description (optional):\n  - Length: 0 to 1,000 Unicode characters after trimming.\n  - Content: May include line breaks; no active scripts or executable content; no embedded markup execution.\n- Due Date (optional):\n  - Type: Either date-only (no time) or date-time (explicit local time semantics).\n  - Range: Not earlier than the Item’s creation date in the user’s local time; not later than 5 years from the current date in the user’s local time.\n  - Date-only semantics: Interpreted as due at 23:59:59 in the user’s time zone on that calendar date.\n  - Date-time semantics: Interpreted as an exact clock time in the user’s time zone.\n\nEARS (creation/update validation):\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 1,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 in the user’s time zone on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values earlier than the Item’s creation date or more than 5 years in the future (user-local).\n- IF a field contains control characters or executable content, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n\n### Behavioral Validations\n- Completion and Reopening:\n  - An Item can be marked Completed only from Active.\n  - A Completed Item can be reopened only back to Active.\n- Deletion (Trash) and Purge:\n  - Only Items in Active or Completed can be moved to Trashed.\n  - Purge is allowed only from Trashed per retention rules.\n\nEARS (state validations):\n- WHEN a user marks an Active Item as Completed, THE todoApp SHALL set it to Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n\n### Concurrency, Integrity, and Idempotency (business perspective)\n- Edit consistency: Edits must not silently overwrite more recent changes made by the Owner in another session.\n- Idempotency: Repeated submissions of the same action within a short interval should not create duplicated Items or double-apply state transitions.\n\nEARS (concurrency & idempotency):\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n- WHERE a create action is retried due to transient conditions, THE todoApp SHALL avoid duplicate Items resulting from the same user action.\n- WHERE a state-change action (complete/reopen) is repeated without intervening changes, THE todoApp SHALL keep the Item’s state consistent and avoid double application.\n\n## Ownership and Access Rules\nRoles: user (standard account) and admin (administrative oversight under policy). Access rules are expressed from a business and privacy standpoint.\n\n### Core Ownership Rules\n- Each Item has exactly one Owner, which is the creating user account.\n- Owners can create, read, update, complete/reopen, trash, restore, and purge their own Items subject to other rules herein.\n- Cross-user access is not permitted for users.\n\n### Administrative Access (Support and Policy)\n- Admins may access a user’s Items only for legitimate support, security, or policy enforcement, with justification and audit logging.\n- Admin operations follow least-privilege: minimum actions necessary for the case and only for the minimum time required.\n\nEARS (access control):\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or an admin has an active support scope for that user.\n- IF a user attempts to read or modify an Item that they do not own, THEN THE todoApp SHALL deny the operation without revealing the Item’s existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin read and write actions limited to the scope duration and case context and SHALL record justification in audit data.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n\n## Rate Limits and Operational Constraints (business-level)\nLimits protect system integrity, reduce abuse, and ensure predictable performance. Limits are measured per user account unless stated otherwise and align to non-functional targets.\n\n### Per-Operation and Aggregate Frequency Limits\n- Aggregate write operations (create/update/complete/reopen/trash/restore/purge): up to 60 actions per minute in rolling windows.\n- Aggregate read operations (list/detail/filter): up to 120 actions per minute in rolling windows.\n- Optional finer bounds for user experience consistency:\n  - Create Item: up to 30 per minute.\n  - Complete/Reopen: up to 60 per minute.\n  - Purge: up to 30 per minute.\n\n### Inventory and Size Limits\n- Maximum concurrent Items per user (all states except Purged): 10,000.\n- Pagination sizes: 10, 20, 50, or 100 items per page; default 20.\n- Bulk operations (interactive): up to 50 Items per action (e.g., bulk complete/reopen/purge) to preserve responsiveness.\n\n### Validation and Responsiveness Expectations (business-level)\n- Single-field validation feedback should be perceived as immediate for typical inputs and SHALL align with non-functional performance targets.\n\nEARS (limits & operational constraints):\n- WHERE a user exceeds aggregate write limits, THE todoApp SHALL throttle further writes until the window resets and inform the user of the limit.\n- WHERE a user exceeds aggregate read limits, THE todoApp SHALL throttle further reads until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 10,000 non-Purged Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHERE a bulk operation exceeds the interactive limit of 50 Items, THE todoApp SHALL process the excess via an alternative path or require the user to split the operation.\n\n## Retention and Deletion Rules\nGoverns how Items are retained, restored, and permanently removed (see also the [Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md)).\n\n### Trash Retention\n- Trashed Items are retained for 30 calendar days from the time of trashing.\n- Restoration returns the Item to Active with its previous content intact.\n\n### Purging\n- Automatic purge: Items in Trashed are automatically purged after 30 days.\n- Manual purge: The Owner may manually purge a Trashed Item at any time before automatic purge.\n- Purge is irreversible and removes the Item from user-accessible views and recovery.\n\n### Account Deletion and Suspension\n- Account deletion: All Items owned by the account enter Trashed immediately and follow a shortened retention of 7 days before automatic purge.\n- Legal hold: Admins may place a legal or policy hold that prevents purge until the hold is cleared.\n- Suspension: Suspended accounts cannot modify Items; retention timelines continue to elapse normally.\n\nEARS (retention & deletion):\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of non-Purged Items exceeds 10,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n\n## Time Zone and Date Handling Rules\nEnsures consistent user-local behavior for dates and times while avoiding reliance on device-specific interpretations.\n\n### User-Local Semantics\n- Date-only due dates: Treated as due at 23:59:59 on that calendar date in the user’s selected time zone.\n- Date-time due dates: Interpreted as exact local times in the user’s selected time zone.\n- Default time zone: When no preferred time zone is set, use a reasonable default aligned with the user’s locale; for MVP, Asia/Seoul (KST, UTC+9) is the default baseline.\n\n### Daylight Saving Time (DST) and Calendar Rules\n- DST forward transition (e.g., 01:59:59 → 03:00:00): A local time that does not exist is adjusted to the next valid local time on that date.\n- DST backward transition (hour repeats): A local time in the repeated hour is interpreted as the first occurrence unless the user specifies otherwise.\n- Leap years and month length: Invalid calendar dates are rejected.\n\nEARS (time zone & calendar):\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n\n## Account-Level Validation Rules (business)\nConstraints for account data relevant to using todoApp features.\n\n- Display Name (optional): 1 to 80 Unicode characters after trimming; no control characters.\n- Email (required for registration): Must be unique per account under todoApp policies.\n- Password (required for registration): Minimum 12 characters; at least three of the following categories: uppercase letters, lowercase letters, numbers, special characters; banned-password list enforced; prevent reuse of the last 5 passwords; no spaces at either end after trimming.\n- Email Verification: Accounts may create and manage Items according to policy; sensitive account changes and recovery communications require a verified email.\n\nEARS (account-level):\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 12 characters or lacking at least three of the four required character categories.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications and sensitive account actions until verification is completed.\n- WHERE a new password matches one of the previous 5 passwords, THE todoApp SHALL reject the change and require a different password.\n\n## Rule Conflict Resolution and Precedence\nResolves conflicts between rules or between rules and context-specific conditions via defined precedence.\n\n### Precedence Order\n1. Legal/Compliance obligations (e.g., legal holds, court orders)\n2. Security and Privacy policies (e.g., least-privilege, non-disclosure of existence)\n3. Account status constraints (e.g., suspension, deletion)\n4. Ownership rules\n5. Retention and deletion rules\n6. Rate limits and operational constraints\n7. User preferences (e.g., time zone selection)\n\nEARS (precedence):\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n### Examples\n- Privacy vs. Access Inquiry: If a user tries to open another user’s Item by ID, do not reveal whether it exists; respond as if inaccessible.\n- Rate Limit vs. Urgent Purge: If a purge request exceeds the allowed rate, queue or require retry while ensuring the user can eventually complete the purge.\n- Ownership vs. Admin Oversight: Allow admin access only with explicit, time-limited support scope and justification recorded in audit data.\n\n## Traceability to Functional Requirements\nLinks rule groups to relevant sections of related documents to ensure testability and cross-reference.\n\n| Business Rule Area | Related Functional Section | Notes |\n|---|---|---|\n| Field validations (title, description, due date) | [Todo Item Management in Functional Requirements](./03-todoApp-functional-requirements.md) | Create/update acceptance criteria must align |\n| State transitions (complete, reopen, trash, restore, purge) | [Completion and Reopening in Functional Requirements](./03-todoApp-functional-requirements.md) | Transitions mirror acceptance tests; retention aligns with data lifecycle |\n| Ownership and access | [Data Ownership and Privacy Rules in Functional Requirements](./03-todoApp-functional-requirements.md) | Must be consistent with role capabilities |\n| Rate limits and item caps | [Business Constraints and Limits in Functional Requirements](./03-todoApp-functional-requirements.md) | Limits are measurable and enforceable |\n| Retention and deletion | [Data Lifecycle and Privacy Requirements](./09-todoApp-data-lifecycle-and-privacy.md) | Trash retention and purge windows |\n| Time zone and date handling | [Non-Functional Requirements](./08-todoApp-non-functional-requirements.md) | Local-time correctness and perceived responsiveness |\n| Account-level rules | [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md) | Password and email uniqueness behaviors |\n\n## Consolidated EARS Index (for test design)\n- THE todoApp SHALL constrain Item transitions to those shown in the state model.\n- IF an Item is in \"Purged\", THEN THE todoApp SHALL prevent any further operations on that Item.\n- WHEN an Item is created, THE todoApp SHALL reject titles that are fewer than 1 or greater than 120 characters after trimming.\n- WHEN an Item is created or updated, THE todoApp SHALL reject descriptions longer than 1,000 characters after trimming.\n- WHEN a Due Date is provided, THE todoApp SHALL interpret date-only values as due at 23:59:59 in the user’s time zone on that date.\n- WHEN a Due Date is provided, THE todoApp SHALL reject values earlier than the Item’s creation date or more than 5 years in the future (user-local).\n- IF a field contains control characters or executable content, THEN THE todoApp SHALL reject the operation and indicate the invalid field.\n- WHEN a user marks an Active Item as Completed, THE todoApp SHALL set it to Completed and record the completion timestamp.\n- IF a user attempts to mark a Completed Item as Completed again, THEN THE todoApp SHALL take no state change and inform the user the Item is already Completed.\n- WHEN a user reopens a Completed Item, THE todoApp SHALL move it to Active and clear the completion timestamp.\n- IF a user attempts to purge an Item not in Trashed, THEN THE todoApp SHALL deny the operation.\n- IF a concurrent modification is detected during update, THEN THE todoApp SHALL prevent the overwrite and require the user to retry with the latest version.\n- WHEN an Item is restored from Trashed, THE todoApp SHALL ensure it re-enters Active with all fields preserved as of the time of trashing.\n- WHERE a create action is retried due to transient conditions, THE todoApp SHALL avoid duplicate Items resulting from the same user action.\n- WHERE a state-change action is repeated without intervening changes, THE todoApp SHALL keep the Item’s state consistent and avoid double application.\n- WHEN a user requests to read an Item, THE todoApp SHALL allow access only if the user is the Owner or an admin has an active support scope for that user.\n- IF a user attempts to read or modify an Item they do not own, THEN THE todoApp SHALL deny the operation without revealing the Item’s existence.\n- WHERE an admin has an active support scope for a user, THE todoApp SHALL allow admin actions limited to scope and duration and SHALL record justification in audit data.\n- WHILE an account is under Suspension, THE todoApp SHALL block write operations for that account and allow reads of owned Items.\n- IF an account is deleted, THEN THE todoApp SHALL prevent any further access to Items previously owned by that account and apply retention rules.\n- WHERE a user exceeds aggregate write limits, THE todoApp SHALL throttle writes until the window resets and inform the user of the limit.\n- WHERE a user exceeds aggregate read limits, THE todoApp SHALL throttle reads until the window resets and inform the user of the limit.\n- IF a user attempts to create an Item when they already have 10,000 non-Purged Items, THEN THE todoApp SHALL reject the creation and indicate the capacity limit.\n- WHERE a bulk operation exceeds 50 Items, THE todoApp SHALL process the excess via an alternative path or require the user to split the operation.\n- WHEN an Item enters Trashed, THE todoApp SHALL set a purge-after timestamp of 30 calendar days from the time of trashing.\n- IF the number of non-Purged Items exceeds 10,000 for a user, THEN THE todoApp SHALL purge the oldest Trashed Items first until the cap is satisfied.\n- WHEN an account is deleted, THE todoApp SHALL move all owned Items to Trashed and set a purge-after timestamp of 7 calendar days.\n- IF a legal hold exists on an Item, THEN THE todoApp SHALL prevent purge until the hold is removed.\n- WHEN a user restores a Trashed Item, THE todoApp SHALL remove the purge-after timestamp and return the Item to Active.\n- WHEN interpreting a date-only due date, THE todoApp SHALL treat it as due at 23:59:59 in the user’s time zone on that date.\n- IF a provided local time falls into a DST gap, THEN THE todoApp SHALL adjust it to the next valid local time on the same date and inform the user.\n- IF a provided date is not a valid calendar date, THEN THE todoApp SHALL reject it and indicate the invalid field.\n- WHEN registering, THE todoApp SHALL reject passwords shorter than 12 characters or lacking at least three of the four character categories.\n- WHEN registering with an email already in use, THE todoApp SHALL reject the registration and indicate that the email is taken.\n- WHERE an account email is unverified, THE todoApp SHALL restrict recovery communications and sensitive account actions until verification is completed.\n- WHERE a new password matches one of the previous 5 passwords, THE todoApp SHALL reject the change and require a different password.\n- IF a legal hold conflicts with a retention rule, THEN THE todoApp SHALL honor the legal hold and defer purge.\n- IF a suspension conflicts with a user’s attempt to modify an Item, THEN THE todoApp SHALL enforce the suspension and deny the modification.\n- WHERE a privacy policy conflicts with an error message that would reveal existence of another user’s Item, THE todoApp SHALL prioritize privacy and not disclose existence.\n\n## Success Criteria\nImplementation is considered successful when:\n- All EARS statements herein pass acceptance tests defined in related documents.\n- Item state transitions are exactly as modeled and enforced in all features.\n- Validation and limit rules produce consistent, user-understandable outcomes across the system.\n- Retention and purge behaviors match specified timelines, including account deletion variations and legal holds.\n- Time zone and DST handling provide correct, predictable due date semantics in user-local time.\n- Idempotency prevents duplicated effects from repeated user submissions.\n\nEnd of document."},{"reason":"Define user-facing error conditions and recovery paths to create predictable behavior under failure.","filename":"07-todoApp-error-handling-and-exception-scenarios.md","documentType":"requirement","outline":["Error Taxonomy (Authentication, Authorization, Validation, Not Found, Conflict, Rate Limit, Service Unavailable)","User-Facing Messages and Guidance","Recovery and Retry Policies","Conflict Resolution for Concurrent Updates (business perspective)","Audit and Monitoring Expectations (business-level)","EARS-Formatted Error Requirements and Acceptance Criteria"],"audience":"development team","keyQuestions":["What errors can occur and how should the system respond for the user?","How can users recover or proceed after an error?","What monitoring is expected from a business standpoint?"],"detailLevel":"detailed specification","relatedDocuments":["02-todoApp-user-roles-and-authentication.md","03-todoApp-functional-requirements.md","05-todoApp-user-flows.md","08-todoApp-non-functional-requirements.md"],"constraints":["Use EARS for all error and exception requirements","Do not reference HTTP codes or API responses; keep user-focused","No technical implementation details"],"content":"# todoApp Error Handling and Exception Scenarios\n\n## Introduction and Scope\nBusiness-level error handling and exception scenarios govern how todoApp behaves under failure from the user’s perspective. Responses include clear messages, actionable guidance, and safe recovery paths that protect user intent and data. Policies below set auditing and monitoring expectations in business terms. Content describes WHAT the system must do in failure conditions, not HOW to implement it.\n\nRelated references for context:\n- [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md)\n- [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md)\n- [User Flows for todoApp](./05-todoApp-user-flows.md)\n- [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md)\n\n## Error Taxonomy\nErrors are grouped into seven user-facing categories. Each category includes representative scenarios, causes, and business expectations for messaging and recovery.\n\n### 1) Authentication Errors\nDefinition: Failures related to verifying identity or session validity.\nExamples:\n- Invalid email or password during sign-in.\n- Attempt to sign in while email remains unverified where verification is required.\n- Expired or invalid session when accessing protected features.\n- Global logout invoked by the same user resulting in session revocation.\nBusiness expectations:\n- Provide neutral, clear messaging without exposing sensitive details.\n- Guide immediate next steps such as retrying, verifying email, or signing in again.\n\n### 2) Authorization Errors\nDefinition: Authenticated identity lacks permission for the requested action.\nExamples:\n- Attempt to access another user’s todo item.\n- Attempt to perform administrative actions without the admin role.\nBusiness expectations:\n- State that the action is not permitted without confirming whether the resource exists.\n- Offer safe alternatives (e.g., return to the user’s list, contact support via approved channels).\n\n### 3) Validation Errors\nDefinition: Submitted input fails business rules.\nRepresentative rules (aligned with functional and business rules):\n- Title: required, 1–120 characters (trimmed).\n- Description: optional, up to 1,000 characters.\n- Due date: optional; if present, must be a valid calendar date-time and not earlier than the creation date in the user’s time zone; not more than 5 years in the future.\n- Completion actions: only allowed on existing, owned items in a valid state for the transition.\nBusiness expectations:\n- Identify each invalid field with a specific reason and a concrete correction.\n- Preserve valid portions of user input where safe.\n\n### 4) Not Found Errors\nDefinition: Requested resource does not exist or is not available to the requesting user.\nExamples:\n- Todo item was deleted or is owned by someone else.\n- Link to an item after the owner’s account was deleted.\nBusiness expectations:\n- Communicate unavailability without confirming ownership or prior existence.\n- Offer navigation to a safe context (e.g., the user’s list) or a refresh suggestion.\n\n### 5) Conflict Errors\nDefinition: Requested change conflicts with the current resource state.\nExamples:\n- Concurrent update: another session or device modified the item between read and write.\n- State conflict: attempting a transition inconsistent with the latest state.\nBusiness expectations:\n- Prevent silent overwrites and provide a guided reconciliation path.\n- Offer clear options that minimize unintended data loss.\n\n### 6) Rate Limit Errors\nDefinition: Action frequency exceeds business-defined safe thresholds.\nExamples:\n- Excessive create/update/delete operations within a short period.\n- Excessive sign-in attempts.\nBusiness expectations:\n- Communicate that limits have been reached, the approximate wait before retry, and safe alternatives.\n\n### 7) Service Unavailable / Degraded Errors\nDefinition: Temporary unavailability or degraded capability of part or all of the service.\nExamples:\n- Planned maintenance window.\n- Transient upstream issue or partial feature outage.\nBusiness expectations:\n- Provide a concise status message and retry guidance.\n- Preserve user-entered data when feasible so users can retry later.\n\n## User-Facing Messages and Guidance\nMessages are short, neutral, and action-oriented. Each includes a succinct title or first sentence, a brief explanation, and a specific next step. Messages avoid technical jargon and do not disclose security-sensitive details. Tone remains consistent across categories.\n\nCanonical message examples (business-level, localization-ready):\n- Authentication (invalid credentials): \"We couldn’t sign you in. Check your email and password and try again.\"\n- Authentication (verification required): \"Please verify your email to continue. We’ve sent a verification message to your inbox.\"\n- Authentication (session expired): \"Your session has ended. Sign in again to continue.\"\n- Authorization: \"You don’t have permission to do that.\"\n- Validation (title missing): \"Title is required and must be between 1 and 120 characters.\"\n- Validation (due date): \"Due date must be valid and not earlier than the creation date.\"\n- Not Found: \"This item is no longer available.\"\n- Conflict: \"This item changed elsewhere. Review updates before saving.\"\n- Rate Limit: \"You’ve reached the limit for this action. Please wait a moment and try again.\"\n- Service Unavailable: \"We’re having trouble right now. Please try again shortly.\"\n\nGuidance patterns:\n- Offer safe navigation (e.g., return to my list) rather than exposing internal details.\n- Preserve unsaved input locally where feasible to honor user intent after recovery.\n- Indicate approximate wait times in natural language (e.g., \"about a minute\") when limits or maintenance apply.\n\n## Recovery and Retry Policies\nBehavior under failure aims to preserve user intent and minimize repeated effort.\n\nGeneral recovery principles:\n- Preserve user intent by maintaining entered data locally where safe.\n- Encourage low-effort retries; if an action is safe to retry, provide a one-step retry affordance.\n- Spread retries to avoid repeated failures and improve success likelihood.\n- Ensure that repeated submissions do not create duplicates or repeated side effects from the user’s perspective.\n\nCategory-specific expectations:\n- Authentication\n  - Invalid credentials: allow immediate retry after correction.\n  - Unverified email: guide to verification; allow retry after verification completes.\n  - Session expired: prompt sign-in; upon success, return the user to the prior action context.\n- Authorization\n  - Do not retry until permissions change; route the user to a safe context.\n- Validation\n  - Allow immediate retry after correcting invalid fields; preserve all valid entries.\n- Not Found\n  - Do not encourage retry; guide to a safe context. If the user expects the item to exist (e.g., just created), suggest refreshing the list.\n- Conflict\n  - Offer reconciliation as described in the conflict section.\n- Rate Limit\n  - Communicate the minimum wait before the next attempt, using natural language.\n- Service Unavailable/Degraded\n  - Suggest retry after a short interval; if planned maintenance is in progress, indicate general timing. Preserve user-entered data for later submission.\n\n### Error Handling Flow (Business-Level)\n```mermaid\ngraph LR\n  subgraph \"User Experience\"\n    A[\"User Attempts Action\"] --> B[\"Evaluate Request State\"]\n    B --> C{\"Is User Authenticated?\"}\n    C -->|\"No\"| D[\"Guide to Sign In or Verify Email\"]\n    C -->|\"Yes\"| E{\"Has Permission?\"}\n    E -->|\"No\"| F[\"Show Not Permitted Message\"]\n    E -->|\"Yes\"| G{\"Is Input Valid?\"}\n    G -->|\"No\"| H[\"Show Field-Specific Guidance\"]\n    G -->|\"Yes\"| I{\"Resource State OK?\"}\n    I -->|\"No\"| J[\"Handle Not Found or Conflict\"]\n    I -->|\"Yes\"| K{\"Service Healthy?\"}\n    K -->|\"No\"| L[\"Show Retry Guidance and Preserve Input\"]\n    K -->|\"Yes\"| M[\"Perform Action Successfully\"]\n  end\n```\n\n## Conflict Resolution for Concurrent Updates (Business Perspective)\nConcurrent edits occur when the same item is open on multiple devices or sessions. Behavior protects user data and ensures clarity.\n\nPrinciples:\n- No silent overwrites; inform users when the item changed elsewhere.\n- Provide options with safe defaults to minimize unintended data loss.\n- Communicate that the item changed and the user’s pending edits may conflict.\n\nResolution options (business-level; not UI design):\n- Review and Merge: update the draft to reflect the latest version and reapply the user’s edits.\n- Overwrite with My Changes: overwrite the current item with the user’s edits.\n- Discard My Edits: discard the user’s edits and accept the latest item state.\n\nExpected behaviors:\n- Pause the save operation upon detecting a conflict and present the options above.\n- For Review and Merge, provide the latest version while retaining the user’s attempted changes for manual reconciliation.\n- For Overwrite, apply the user’s edits and record that overwrite was chosen for audit purposes.\n- For Discard My Edits, revert to the latest version and confirm completion to the user.\n\n### Conflict Handling Flow (Business-Level)\n```mermaid\ngraph LR\n  A[\"User Submits Changes\"] --> B[\"Detect Version Mismatch\"]\n  B --> C{\"Conflict Detected?\"}\n  C -->|\"No\"| D[\"Save Changes\"]\n  C -->|\"Yes\"| E[\"Inform and Offer Options\"]\n  E --> F{\"User Choice\"}\n  F -->|\"Review and Merge\"| G[\"Load Latest and Retain Edits\"]\n  F -->|\"Overwrite\"| H[\"Apply Edits and Mark Overwrite\"]\n  F -->|\"Discard My Edits\"| I[\"Show Latest and Discard Attempt\"]\n  G --> J[\"Complete Reconciliation and Save\"]\n  H --> J\n  I --> K[\"Return to Item View\"]\n```\n\n## Audit and Monitoring Expectations (Business-Level)\nAudit and monitoring provide accountability, security, and service quality without exposing sensitive content.\n\nAudit scope (business events):\n- Sign-in successes and failures (no sensitive secrets retained).\n- Email verification initiation and completion.\n- Session terminations, including user-initiated global logout.\n- Authorization denials for protected actions.\n- Validation denials with categorical reasons (e.g., \"title length\").\n- Not found attempts on protected resources.\n- Conflict detections and chosen resolutions (merge, overwrite, discard).\n- Rate limit denials by action category.\n- Service unavailable or degraded events affecting user actions.\n\nMonitoring scope (business indicators):\n- Error rate by category and action (e.g., percentage of failed creates due to validation).\n- Retry success rates after guidance.\n- Time-to-recovery for transient failures.\n- Distribution of conflict resolution choices.\n- Rate limit incidents per user segment.\n\nPrivacy expectations:\n- Exclude sensitive secrets and private todo text from audit entries; use categorical labels (e.g., \"validation: title length exceeded\").\n- Aggregated, non-identifying analytics may be used to improve service quality.\n\nRetention expectations:\n- Maintain audit records for a period consistent with business and legal requirements. Summarized metrics may be retained longer than raw events where permissible.\n\n## EARS-Formatted Error Requirements and Acceptance Criteria\nAll requirements appear in EARS format to ensure clarity and testability.\n\n### Authentication (EARS)\n- WHEN a user submits invalid credentials, THE todoApp SHALL show the message \"We couldn’t sign you in. Check your email and password and try again.\" and guide immediate retry.\n- WHEN a user attempts to sign in with an unverified email, THE todoApp SHALL present an email verification required message and allow retry after verification completes.\n- WHEN a user’s session has expired, THE todoApp SHALL prompt the user to sign in again and, upon success, return to the prior action context.\n- IF the same user triggers sign out from all devices, THEN THE todoApp SHALL terminate existing sessions and require re-authentication for further actions.\n\nAcceptance criteria (Authentication):\n- THE todoApp SHALL use standard, consistent phrasing for the same situations across the service.\n- THE todoApp SHALL record sign-in failures as auditable, non-sensitive events suitable for monitoring.\n\n### Authorization (EARS)\n- WHEN a user attempts an action without permission, THE todoApp SHALL display \"You don’t have permission to do that.\" and suggest a safe navigation path.\n- IF a user attempts to access another user’s item, THEN THE todoApp SHALL deny access without revealing the item’s existence or ownership.\n\nAcceptance criteria (Authorization):\n- THE todoApp SHALL apply a consistent tone for permission denials.\n- THE todoApp SHALL categorize permission denials in audit logs for monitoring.\n\n### Validation (EARS)\n- WHEN a user attempts to create an item without a title, THE todoApp SHALL present guidance that a title is required and must be 1–120 characters.\n- WHEN a user provides a description longer than 1,000 characters, THE todoApp SHALL indicate the limit and prompt the user to shorten it.\n- WHEN a user provides a due date earlier than the creation date or more than 5 years in the future (user’s time zone), THE todoApp SHALL prompt for a valid due date.\n- WHEN some fields are valid and others are not, THE todoApp SHALL preserve valid inputs and ask the user to correct only the invalid fields.\n\nAcceptance criteria (Validation):\n- THE todoApp SHALL present a single, concrete reason per invalid field.\n- THE todoApp SHALL preserve all valid inputs during correction.\n\n### Not Found (EARS)\n- WHEN a user requests an item that does not exist or is no longer available, THE todoApp SHALL show an unavailability message and suggest returning to the user’s list or refreshing.\n- IF a user follows an outdated link to an item, THEN THE todoApp SHALL suggest refreshing or navigating back to the list without revealing ownership information.\n\nAcceptance criteria (Not Found):\n- THE todoApp SHALL avoid disclosing existence or ownership of resources the user cannot access.\n- THE todoApp SHALL always provide a safe navigation path.\n\n### Conflict (EARS)\n- WHEN concurrent modification is detected, THE todoApp SHALL pause the save and present the options \"Review and Merge\", \"Overwrite\", and \"Discard My Edits\".\n- WHEN the user selects \"Review and Merge\", THE todoApp SHALL load the latest version and retain the user’s attempted changes for manual reconciliation.\n- WHEN the user selects \"Overwrite\", THE todoApp SHALL apply the user’s edits and record the overwrite choice for audit purposes.\n- WHEN the user selects \"Discard My Edits\", THE todoApp SHALL show the latest version and discard the user’s attempted changes.\n\nAcceptance criteria (Conflict):\n- THE todoApp SHALL prevent silent overwrites when a save is in conflict.\n- THE todoApp SHALL make no state change unless the user chooses one of the provided resolution options.\n\n### Rate Limit (EARS)\n- WHERE a single user performs more than 60 write actions (create/update/delete) within 1 minute, THE todoApp SHALL inform the user \"You’ve reached the limit for this action. Please wait a moment and try again.\" and allow retry after approximately 1 minute.\n- WHERE sign-in attempts exceed 10 within 10 minutes for a user, THE todoApp SHALL temporarily block further attempts and present retry guidance and a password reset path.\n- WHERE other sensitive actions are repeated excessively within a short time, THE todoApp SHALL provide clear guidance on usage limits and approximate wait time.\n\nAcceptance criteria (Rate Limit):\n- THE todoApp SHALL communicate an approximate remaining wait time in natural language.\n- THE todoApp SHALL aggregate rate limit incidents for monitoring.\n\n### Service Unavailable / Degraded (EARS)\n- WHEN a temporary service issue prevents completing a request, THE todoApp SHALL present retry guidance and suggest waiting briefly before trying again.\n- WHERE a planned maintenance window is active, THE todoApp SHALL indicate limited availability and suggest retry after maintenance ends.\n- WHILE the service is partially degraded, THE todoApp SHALL name the affected feature areas and suggest alternatives if available.\n- IF a request fails but user-entered data can be preserved safely, THEN THE todoApp SHALL preserve the data so the user can resubmit later.\n\nAcceptance criteria (Service Unavailable / Degraded):\n- THE todoApp SHALL notify failure without losing user-entered data and provide a retry path.\n- THE todoApp SHALL support proactive messages for predictable limitations such as scheduled maintenance.\n\n### Cross-Cutting Error Handling Principles (EARS)\n- THE todoApp SHALL avoid exposing technical internals (e.g., internal error codes or identifiers) in user-facing messages.\n- THE todoApp SHALL use consistent tone and language for the same error situations across the service.\n- THE todoApp SHALL preserve the user’s recent working context where feasible so work can continue after recovery.\n- THE todoApp SHALL provide a one-step retry mechanism for recoverable failures where possible.\n- THE todoApp SHALL emit non-identifying audit and monitoring events for every error category.\n\n## Acceptance Test Scenarios (EARS)\n- WHEN a user submits creation without a title, THE todoApp SHALL display title validation guidance immediately and preserve other entered fields.\n- WHEN a user attempts to complete an item after the session has expired, THE todoApp SHALL prompt for sign-in and, upon success, continue with the completion attempt.\n- WHEN two devices save edits to the same item nearly simultaneously, THE todoApp SHALL commit one save and, for the other, show a conflict message with resolution options.\n- WHEN a user exceeds 60 write attempts within a minute, THE todoApp SHALL limit additional attempts and display wait guidance.\n- WHEN the service is temporarily unavailable, THE todoApp SHALL preserve user-entered input and encourage retry after a short interval.\n\n## Glossary (Business-Level)\n- Authentication: Verifying a user’s identity.\n- Authorization: Determining whether a user has permission for an action.\n- Validation: Checking that input values comply with business rules.\n- Conflict: A situation where attempted changes differ from the current resource state.\n- Rate Limit: A business-defined threshold on action frequency to protect users and the service.\n- Service Degraded/Unavailable: A temporary reduction or loss of service capability.\n\n## Traceability\n- Authentication and authorization behaviors align with the [User Roles and Authentication Requirements for todoApp](./02-todoApp-user-roles-and-authentication.md).\n- Validation and not found behaviors align with the [Functional Requirements for todoApp](./03-todoApp-functional-requirements.md).\n- Conflict handling aligns with the [User Flows for todoApp](./05-todoApp-user-flows.md).\n- Retry and service health expectations align with the [Non-Functional Requirements for todoApp](./08-todoApp-non-functional-requirements.md)."},{"reason":"Set performance, security, privacy, reliability, and compliance expectations in user terms.","filename":"08-todoApp-non-functional-requirements.md","documentType":"requirement","outline":["Performance and Responsiveness Expectations","Security and Privacy Principles","Availability and Reliability Expectations","Scalability Expectations","Compliance and Legal Considerations","Operational Monitoring and Alerting (business expectations)","Non-Functional Acceptance Criteria (EARS)"],"audience":"development team","keyQuestions":["What performance is expected for core operations?","What security and privacy standards must be met?","What availability and reliability targets apply?"],"detailLevel":"detailed specification","relatedDocuments":["01-todoApp-service-overview.md","02-todoApp-user-roles-and-authentication.md","07-todoApp-error-handling-and-exception-scenarios.md"],"constraints":["State measurable targets in user terms (e.g., within N seconds)","Avoid technology choices or architectural prescriptions","Use EARS for acceptance criteria"],"content":"# 08 — todoApp Non-Functional Requirements\n\n## Document Purpose\nBusiness-level non-functional requirements for todoApp specifying measurable expectations for performance, security, privacy, availability, reliability, scalability, compliance, and operational monitoring. Content describes WHAT outcomes must be achieved from user and business perspectives without prescribing HOW to implement them. No API specifications, database schemas, or technology choices are included.\n\n## Related Documents\n- Service objectives and KPIs: [Service Overview for todoApp](./01-todoApp-service-overview.md)\n- Roles, permissions, and session behaviors: [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md)\n- User-facing failure behaviors and recovery: [Error Handling and Exception Scenarios](./07-todoApp-error-handling-and-exception-scenarios.md)\n\n## Definitions and Assumptions\n- “Interactive action”: user-triggered operations with immediate feedback (e.g., viewing list, creating/updating/completing/deleting a todo item, logging in/out).\n- Time references: seconds (s) or milliseconds (ms) and percentiles (p50, p95, p99) measured at the boundary where the user perceives completion.\n- “Business day”: 09:00–18:00 in Asia/Seoul (KST) unless stated otherwise. Scheduled maintenance references local time in KST.\n- “Sensitive action”: operations that affect account control or privacy (e.g., password change, email change, account deletion, session revocation).\n- “Peak period”: high-usage windows typical of 19:00–23:00 KST on weekdays and 10:00–23:00 KST on weekends.\n- Confidential and personal data: identifiers (e.g., email), authentication factors, and any user-generated content in todo items or metadata.\n\n---\n\n## Performance and Responsiveness Expectations\nTargets are user-perceived. Unless otherwise noted, targets apply to the 95th percentile and must be met under the scale and concurrency assumptions defined in this document.\n\n### Core Interaction Targets\n- List own todos (paginated up to 50 items): p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Create a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Update a todo (title/description/due date): p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Complete or reopen a todo: p95 ≤ 300 ms; p99 ≤ 600 ms.\n- Delete a todo: p95 ≤ 400 ms; p99 ≤ 800 ms.\n- Bulk complete/reopen up to 50 items: p95 ≤ 1,000 ms; p99 ≤ 2,000 ms.\n- Authentication (enter credentials to signed-in state): p95 ≤ 2,000 ms; p99 ≤ 4,000 ms.\n- Email-based actions (verification or password reset): email dispatched within 60 s p95.\n- Admin lookups for a single user account (non-invasive read): p95 ≤ 800 ms.\n\n### Payload and Result Size Expectations\n- Interactive list retrieval pagination: up to 50 items per request; results include only fields necessary for list view.\n- Todo description length supported up to 1,000 characters without truncation in storage; interactive viewing and editing meet targets above for up to 1,000 characters.\n- Import/export operations that exceed interactive targets SHALL be processed asynchronously with progress or completion notification.\n\n### Throughput and Concurrency Targets (Business-Level)\n- MVP load: sustain 100 requests per second (RPS) aggregate with short bursts up to 300 RPS for 5 minutes without violating p95 targets.\n- Concurrency: support at least 1,000 concurrently active signed-in sessions during peak periods with no degradation beyond p95 targets.\n- Growth headroom: maintain stable performance up to 3× MVP sustained load without user-visible regressions greater than 20% of stated targets.\n\n### Rate Limiting (User-Centric)\n- Write operations (create/update/complete/delete) per account: up to 60 actions per minute without throttling; above this threshold may be rate-limited to protect availability.\n- Read operations (list/search/filter) per account: up to 120 actions per minute without throttling; above this threshold may be rate-limited.\n- Authentication attempts: protections and lockout expectations appear in Security and Privacy.\n\n### Time Zone and Consistency\n- Read-after-write for a user’s own content: subsequent reads reflect changes immediately p95 ≤ 1,000 ms and p99 ≤ 2,000 ms.\n- Cross-device visibility for a user’s own changes: p95 ≤ 3,000 ms.\n\n---\n\n## Security and Privacy Principles\nBusiness-aligned controls for confidentiality, integrity, and proper access, consistent with role definitions and session behaviors in the [User Roles and Authentication Requirements](./02-todoApp-user-roles-and-authentication.md).\n\n### Authentication and Session Management\n- Only verified accounts may perform non-public actions; unverified accounts have strictly limited capabilities per roles policy.\n- Sessions expire after 30 days of inactivity; sensitive actions require recent re-authentication (within the last 15 minutes).\n- Users can revoke all active sessions immediately from an account security control.\n\n### Credential and Account Protection\n- Password policy: minimum 12 characters; acceptance of long passphrases; require at least three of the following: uppercase, lowercase, numbers, special characters; reject top 10,000 common passwords; prevent reuse of the previous 5 passwords.\n- Login protection: after 10 failed attempts within 10 minutes for an account or from a single source, impose a cooling period of 5 minutes with user-facing guidance for secure recovery.\n- Sensitive changes (email/password) require confirmation through a second-factor channel (e.g., a one-time confirmation code via the verified email channel) without prescribing specific technologies.\n\n### Authorization and Least Privilege\n- Users may only access their own content. Admin actions are logged and limited to the minimum necessary for support and policy enforcement.\n- Administrative access is governed by justification and auditability; access beyond minimum necessary is prohibited.\n\n### Data Minimization and Purpose Limitation\n- Collect only data necessary to operate todoApp and provide the service.\n- Prohibit storage of special categories of personal data in system-managed fields (e.g., national ID numbers) and discourage sensitive content in todo text through policy and guidance.\n\n### Data Protection\n- Protect personal data in transit and at rest using strong, industry-accepted safeguards without specifying particular ciphers or libraries.\n- Protect encryption keys and secrets via processes that enforce least privilege, dual control for changes, and auditability.\n\n### Audit Logging and Access Transparency\n- Log security-relevant events: authentication successes/failures, password changes, email changes, session revocations, account deletions, admin support actions, and mass/bulk operations affecting more than 20 items.\n- Provide user-accessible activity history for their own account, retaining at least 90 days of entries.\n\n### Privacy Controls and User Rights\n- Provide accessible Privacy Policy and Terms of Service before account creation and within account settings.\n- Provide self-service account deletion with clear warnings about irreversible effects and data retention timelines.\n- Provide export of user-owned data in a commonly used, machine-readable format within reasonable size limits.\n\n---\n\n## Availability and Reliability Expectations\nUptime, recovery, and continuity behaviors visible to users and administrators.\n\n### Availability Targets\n- Service-level objective (SLO) for user-facing availability: 99.9% monthly.\n- Planned maintenance windows: default window Sundays 02:00–04:00 KST, announced at least 72 hours in advance. Emergency maintenance is allowed with immediate notice and clear user messaging.\n\n### Reliability and Continuity\n- RTO (Recovery Time Objective): critical user operations recover within 60 minutes following an outage.\n- RPO (Recovery Point Objective): no more than 5 minutes of data for committed operations is lost in a disaster scenario.\n- Durability expectation: once a user receives a success confirmation for a write, that data persists and remains retrievable after any transient fault.\n\n### Degradation and Failover Behavior\n- Graceful degradation: non-critical features (e.g., bulk operations, optional analytics) may be temporarily disabled to preserve core CRUD functionality.\n- Read-only mode: during partial outages, the system may enter read-only mode with clear user messaging; write attempts are queued or safely rejected with recovery guidance per the error handling document.\n\n### Consistency and Ordering\n- For a single user’s data, operations that depend on ordering (e.g., marking complete, then deleting) reflect the most recent committed action in subsequent reads.\n- Conflict handling during concurrent updates follows the business rules in the related documents, ensuring users receive clear guidance without exposing technical details.\n\n---\n\n## Scalability Expectations\nPredictable behavior as usage grows.\n\n### Baseline and Growth Assumptions\n- MVP baseline: 50,000 monthly active users (MAU), 5,000 daily active users (DAU), 1,000 peak concurrent sessions, 100 sustained RPS with 300 RPS bursts.\n- Growth: maintain targets up to 3× baseline without user-visible regressions beyond 20% of stated p95 targets and without service downtime for capacity increases.\n\n### Business Limits\n- Maximum todos per user: 10,000 total items across states. Align active-item guidance and caps with the [Business Rules and Constraints](./06-todoApp-business-rules.md) where an active cap of 5,000 may apply.\n- Bulk operations: up to 100 items per interactive bulk action; larger sets are processed asynchronously with user notification upon completion.\n\n### Elasticity and Resource Management\n- Capacity increases and decreases are transparent to users and must not cause outages or data loss.\n\n---\n\n## Compliance and Legal Considerations\nAligned with common privacy frameworks without asserting jurisdiction-specific legal advice.\n\n- Privacy by design: default to the minimum data necessary; privacy-related defaults are the most protective reasonable option.\n- Notice and consent: obtain user consent for optional data uses such as marketing communications; provide easy opt-out.\n- Data subject rights: enable access, rectification, export, and deletion of user data within 30 days of verified request.\n- Child safety: intended for users aged 13+ unless local law imposes a higher age; when required, obtain guardian consent consistent with applicable law.\n- Data retention: business records (e.g., audit logs) retained for 90 days minimum; user data retention after account deletion follows policy in the data lifecycle document.\n- Cross-border data transfer: disclose data processing locations and ensure transfers comply with applicable cross-border requirements.\n\n---\n\n## Operational Monitoring and Alerting (Business Expectations)\nContinuous verification that objectives are met and regressions detected promptly.\n\n### Key Performance Indicators (KPIs)\n- Latency: p50/p95/p99 across core interactions (list, create, update, complete, delete, login).\n- Error rate: percentage of failed interactions per category (authentication, authorization, validation, conflict, not found, service unavailable) as defined in the error handling document.\n- Throughput: sustained and peak RPS; concurrency of active sessions.\n- Availability: monthly uptime against the 99.9% SLO and error budget consumption.\n- Security signals: failed login spikes, password reset spikes, session revocations, admin privileged operations.\n- Data integrity: periodic checks that ensure committed writes are retrievable and uncorrupted.\n\n### Alerting Thresholds and Response Expectations\n- Critical user operation latency breach: if p95 for list/create/update/complete/delete exceeds target by 25% for 5 consecutive minutes, generate a critical alert.\n- Availability breach: if rolling 5-minute availability falls below 99%, generate a critical alert.\n- Error spike: if failed interactions exceed 2% over 10 minutes for any core operation, generate a high-severity alert with categorization.\n- Security anomaly: if there are more than 50 failed logins for a single account or 500 across the service within 10 minutes, generate a high-severity alert and apply protective measures consistent with lockout policy.\n- On-call responsiveness: acknowledge critical alerts within 5 minutes 24/7; initiate mitigation within 15 minutes; communicate user-facing status within 30 minutes of incident start.\n\n### Incident Management Flow\n```mermaid\ngraph LR\n  subgraph \"Detection\"\n    A[\"Monitoring Detects Breach\"] --> B[\"Alert Generated\"]\n  end\n  subgraph \"Triage\"\n    C[\"On-call Acknowledges\"] --> D[\"Severity Classification\"]\n    D --> E[\"User Impact Assessment\"]\n  end\n  subgraph \"Mitigation\"\n    F[\"Apply Safeguards(Degrade/Throttle/Read-only)\"] --> G[\"Restore Core Functions\"]\n  end\n  subgraph \"Communication\"\n    H[\"Post Status Update(KST Time)\"] --> I[\"Customer Support Briefing\"]\n  end\n  subgraph \"Recovery\"\n    J[\"Validate Data Integrity\"] --> K[\"Confirm SLO Recovery\"]\n  end\n  subgraph \"Postmortem\"\n    L[\"Root Cause Analysis\"] --> M[\"Action Items&Owners\"]\n  end\n  B --> C\n  E --> F\n  G --> H\n  H -.-> I\n  G --> J\n  K --> L\n```\n\n---\n\n## Non-Functional Acceptance Criteria (EARS)\nEARS keywords WHEN/WHILE/IF/THEN/WHERE/THE/SHALL remain in English; descriptions are in business terms.\n\n### Performance\n- WHEN a user retrieves a page of their todo list up to 50 items during peak period, THE todoApp SHALL deliver the response within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user creates a todo with title and optional description up to 1,000 characters, THE todoApp SHALL confirm creation within 400 ms at p95 and within 800 ms at p99.\n- WHEN a user completes or reopens a todo, THE todoApp SHALL reflect the change within 300 ms at p95 and within 600 ms at p99.\n- WHEN a user logs in with valid credentials, THE todoApp SHALL transition to a signed-in state within 2,000 ms at p95 and within 4,000 ms at p99.\n- WHERE a bulk action affects up to 50 items, THE todoApp SHALL complete the action within 1,000 ms at p95 and within 2,000 ms at p99.\n- WHERE an operation exceeds interactive thresholds due to size or complexity, THE todoApp SHALL process it asynchronously and notify the user upon completion.\n\n### Consistency and Cross-Device\n- WHEN a user modifies their own todo items, THE todoApp SHALL provide read-after-write consistency for that user with visibility of the change within 1,000 ms at p95 and 2,000 ms at p99.\n- WHILE a user is signed in on multiple devices, THE todoApp SHALL propagate the user’s own changes across devices within 3,000 ms at p95.\n\n### Rate Limiting and Protection\n- WHERE an account issues more than 60 write actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance without blocking critical security actions.\n- WHERE an account issues more than 120 read actions in 1 minute, THE todoApp SHALL apply fair-use throttling and communicate retry guidance.\n\n### Security and Sessions\n- THE todoApp SHALL require account verification before granting non-public capabilities.\n- WHERE a session has been inactive for 30 days, THE todoApp SHALL require re-authentication before any further non-public actions.\n- IF there are 10 failed login attempts within 10 minutes for an account, THEN THE todoApp SHALL impose a 5-minute cooldown and provide secure recovery guidance to the user.\n- IF a user invokes “revoke all sessions”, THEN THE todoApp SHALL invalidate all existing sessions within 60 seconds and require re-authentication on all devices.\n- WHERE a user initiates a sensitive action, THE todoApp SHALL require recent re-authentication within the last 15 minutes.\n- THE todoApp SHALL enforce a password policy with minimum 12 characters and at least three character classes; banned password list and recent-password reuse prevention apply.\n\n### Data Protection and Privacy\n- THE todoApp SHALL protect personal data in transit and at rest using strong safeguards and prevent unauthorized access by design and policy.\n- WHERE audit logs contain personal data, THE todoApp SHALL minimize and redact sensitive fields and retain logs for at least 90 days.\n- WHEN a verified user requests export of their data up to 1 GB in size, THE todoApp SHALL provide a machine-readable export within 24 hours under normal operating conditions.\n- WHERE a verified user’s export exceeds typical size, THE todoApp SHALL communicate progress and deliver the export as soon as preparation completes.\n- WHEN a verified user requests account deletion, THE todoApp SHALL remove user-accessible content promptly and complete deletion workflows within 30 days except where legal retention is required.\n\n### Availability and Reliability\n- THE todoApp SHALL achieve 99.9% monthly availability for core user operations under the defined load assumptions.\n- WHEN a service incident impacts users, THE todoApp SHALL publish a status update within 30 minutes of detection and provide subsequent updates at least every 60 minutes until resolution.\n- WHERE core functionality is impaired, THE todoApp SHALL prioritize read access and safe queuing or rejection of writes with clear guidance.\n- WHEN service is restored after an outage, THE todoApp SHALL meet the stated p95 performance targets within 15 minutes of recovery.\n- THE todoApp SHALL meet an RTO of 60 minutes and an RPO of 5 minutes for committed user operations.\n\n### Monitoring and Alerts\n- WHEN p95 latency for any core operation exceeds its target by 25% for 5 consecutive minutes, THE todoApp SHALL generate a critical alert for the on-call responder.\n- WHEN failed user interactions exceed 2% of attempts over a 10-minute window for any core operation, THE todoApp SHALL generate a high-severity alert with categorization.\n- WHEN security anomalies occur (e.g., more than 50 failed logins for an account or 500 service-wide within 10 minutes), THE todoApp SHALL generate a high-severity alert and apply protective measures.\n- WHERE a critical alert is generated, THE todoApp SHALL ensure on-call acknowledgment within 5 minutes and user-facing communication within 30 minutes.\n\n### Compliance and Legal\n- THE todoApp SHALL present accessible Terms of Service and Privacy Policy before account creation and within settings.\n- WHEN receiving a verified data subject request, THE todoApp SHALL fulfill access, rectification, export, or deletion within 30 days.\n- WHERE local law requires consent for optional data uses, THE todoApp SHALL capture, honor, and provide revocation of such consent.\n\n---\n\n## Appendices\n\n### A. p95/p99 Target Summary\n\n| Category | p95 | p99 |\n|---|---:|---:|\n| List todos (≤50 items) | 300 ms | 600 ms |\n| Create todo | 400 ms | 800 ms |\n| Update todo | 400 ms | 800 ms |\n| Complete/Reopen todo | 300 ms | 600 ms |\n| Bulk action (≤50 items) | 1,000 ms | 2,000 ms |\n| Login (valid credentials) | 2,000 ms | 4,000 ms |\n\n### B. Additional Non-Functional Targets\n\n| Target | Value |\n|---|---|\n| Email dispatch (verification/reset) | ≤ 60 s at p95 |\n| Availability (monthly) | 99.9% |\n| RTO | 60 minutes |\n| RPO | 5 minutes |\n| Session inactivity expiry | 30 days |\n| Sensitive action re-auth window | 15 minutes |\n| Audit log retention | ≥ 90 days |\n| Export SLA (≤1 GB) | ≤ 24 hours under normal conditions |\n\n---\n\nBusiness-requirements-only scope applies. All technical implementation decisions, including architecture, APIs, and data design, belong to the development team. The content defines outcomes and constraints to be met from user and business perspectives."},{"reason":"Describe how information conceptually moves through its lifecycle and the related privacy requirements.","filename":"09-todoApp-data-lifecycle-and-privacy.md","documentType":"requirement","outline":["Conceptual Data Flow Overview (business-level)","Data Creation, Update, and Deletion Lifecycle","Retention and Purging Policies","User-Controlled Export/Portability (optional)","Privacy-by-Design Principles","Data Minimization and Purpose Limitation","Right to Erasure and Account Deletion Behaviors","Traceability to Business Rules and Non-Functional Requirements"],"audience":"development team","keyQuestions":["How is user data handled from creation to deletion?","What privacy safeguards are required across the lifecycle?"],"detailLevel":"moderate detail","relatedDocuments":["06-todoApp-business-rules.md","08-todoApp-non-functional-requirements.md"],"constraints":["Keep descriptions conceptual; do not define database schemas or storage technologies","Use EARS for lifecycle requirements where applicable"],"content":"# todoApp Data Lifecycle and Privacy Requirements\n\nBusiness requirements only; all technical implementation decisions (architecture, APIs, database design, and storage technologies) belong to the development team. The content defines WHAT todoApp must do for data across its lifecycle, not HOW to implement it.\n\n## 1. Conceptual Data Flow Overview (business‑level)\n\nData categories\n- User Account Data: identity and authentication attributes needed to operate an account, plus preferences strictly necessary to provide the service.\n- Todo Item Data: user‑owned task records with required fields (e.g., title, status) and optional fields (e.g., description, due date) per functional scope.\n- Operational Security Data: verification/reset artifacts, sessions, and related metadata necessary for authentication and authorization.\n- Administrative and Audit Data: minimal event logs and administrative actions required for support, safety, fraud control, and compliance oversight.\n- Aggregated Analytics (Non‑Personal): metrics computed so that they cannot be used to re‑identify individuals.\n\nConceptual flow\n```mermaid\ngraph LR\n  subgraph \"User Initiated\"\n    A[\"Account Creation\"] --> B[\"Email Verification\"]\n    B --> C[\"User Login\"]\n    C --> D[\"Create/Update Todo Items\"]\n    D --> E[\"Complete/Reopen/Delete Todo Items\"]\n    C --> I[\"Request Export\"]\n  end\n\n  subgraph \"System Governance\"\n    F[\"Retention Counters\"] --> G[\"Soft Delete Window\"]\n    G --> H[\"Scheduled Purge\"]\n    J[\"Prepare User Data Export\"] --> K[\"Deliver Export Package\"]\n    L[\"Audit Events\"] --> M[\"Time‑bound Retention\"]\n    N[\"Backups/Snapshots\"] --> O[\"Expiry per Policy\"]\n  end\n\n  A --> P[\"Account Profile\"]\n  D --> Q[\"Todo Dataset\"]\n  E --> Q\n  C --> R[\"Session Lifecycle\"]\n  I --> J\n  H --> S[\"Permanent Deletion\"]\n  M --> T[\"Expiry or Legal Hold\"]\n  Q -.-> U[\"Indexes/Caches(Update)\"]\n```\n\nNotes\n- \"Soft Delete Window\" is a reversible state prior to permanent deletion.\n- \"Scheduled Purge\" removes data permanently when retention conditions are met.\n- \"Backups/Snapshots\" are immutable recovery copies; access is restricted to disaster recovery scenarios and expire per policy.\n\n## 2. Data Creation, Read, Update, Completion/Reopen, and Deletion Lifecycle\n\n### 2.1 Ownership and Access\n- Users (role: user) own and control their account data and todo items.\n- Administrators (role: admin) operate under least‑privilege for support, safety, and policy enforcement. Administrative access to user data is limited to specific, auditable actions justified by a legitimate business need.\n\n### 2.2 Creation Requirements (EARS)\n- THE todoApp SHALL record the creator’s user identifier as the immutable owner of each todo item at creation time.\n- WHEN a user creates a todo item, THE todoApp SHALL store only fields defined as necessary by the functional scope and business rules.\n- IF a creation request omits a required business field, THEN THE todoApp SHALL reject the creation with a clear explanation referencing the missing or invalid field.\n- WHERE optional fields are provided at creation, THE todoApp SHALL validate them against business rules before accepting the item.\n\n### 2.3 Read and Listing Requirements (EARS)\n- THE todoApp SHALL allow a user to view only their own todo items and account data, except where an admin performs a permitted support action under audit.\n- WHEN a user lists todo items, THE todoApp SHALL return only items not permanently deleted and within the user’s ownership scope.\n- WHERE filters and sorting are requested, THE todoApp SHALL apply only supported business‑level filters and sorts as defined in the functional requirements.\n\n### 2.4 Update Requirements (EARS)\n- WHEN a user updates a todo item they own, THE todoApp SHALL validate each changed field against business rules and persist only if all validations pass.\n- IF an update conflicts with a more recent change, THEN THE todoApp SHALL prevent silent overwrites and provide guidance for conflict resolution.\n- THE todoApp SHALL record the time and actor for each successful update in an auditable manner without exposing implementation details to end users.\n\n### 2.5 Completion/Reopen Requirements (EARS)\n- WHEN a user marks an item as completed, THE todoApp SHALL set the item’s status to completed and record the completion timestamp.\n- WHEN a user reopens a completed item, THE todoApp SHALL revert the status and clear or update completion metadata as defined by business rules.\n\n### 2.6 Deletion Requirements (EARS)\n- WHEN a user deletes a todo item, THE todoApp SHALL move the item to a soft‑delete state that hides it from normal listings and starts a retention countdown.\n- WHILE a todo item is in soft‑delete, THE todoApp SHALL allow the owner to restore it within the defined retention window.\n- IF the soft‑delete retention window elapses, THEN THE todoApp SHALL permanently delete the item during the next scheduled purge.\n- WHERE an admin flags content for policy violations, THE todoApp SHALL allow immediate soft‑delete with admin justification recorded in audit data.\n\n## 3. Retention and Purging Policies\n\nRetention is purpose‑driven and time‑bound. Policy durations are business requirements and may be changed only through documented policy updates.\n\n### 3.1 Todo Items (EARS)\n- THE todoApp SHALL retain active todo items indefinitely until the owner deletes them or the account is deleted.\n- WHEN a todo item is soft‑deleted by its owner, THE todoApp SHALL retain it for up to 30 days to allow restoration.\n- IF a soft‑deleted todo item reaches 30 days without restoration, THEN THE todoApp SHALL permanently delete it during the next scheduled purge.\n\n### 3.2 Accounts and Profiles (EARS)\n- WHEN an account is created but not verified within 14 days, THE todoApp SHALL purge the unverified account and associated artifacts.\n- WHEN a verified user requests account deletion, THE todoApp SHALL initiate a 14‑day grace period before permanent deletion to allow reversal.\n- IF the grace period elapses without reversal, THEN THE todoApp SHALL permanently delete the account and all user‑owned todo items during the next scheduled purge.\n\n### 3.3 Operational Security Data (EARS)\n- THE todoApp SHALL limit the lifetime of one‑time email verification artifacts to 24 hours from issuance.\n- THE todoApp SHALL limit the lifetime of password reset artifacts to 1 hour from issuance.\n- THE todoApp SHALL limit the lifetime of user sessions according to the authentication policy defined in the roles and authentication requirements.\n\n### 3.4 Administrative and Audit Data (EARS)\n- THE todoApp SHALL retain minimal audit events necessary to reconstruct security‑ and policy‑relevant actions for 180 days unless a longer retention is mandated by documented legal obligations.\n- WHERE a legal hold is in effect, THE todoApp SHALL suspend purge of affected audit records until the hold is lifted.\n\n### 3.5 Aggregated Analytics (EARS)\n- THE todoApp SHALL keep only aggregated, non‑personal metrics that cannot feasibly be re‑identified.\n- WHERE any analytics processing would require personal data, THE todoApp SHALL either minimize and anonymize the input or forego the processing to protect user privacy.\n\n### 3.6 Purge Execution (EARS)\n- THE todoApp SHALL execute purge processes on a predictable schedule (at least daily) to remove data whose retention windows have expired.\n- IF a purge process fails partially, THEN THE todoApp SHALL retry purging the remaining eligible records without duplicating prior deletions.\n\n### 3.7 Backups and Disaster Recovery Copies (Business‑Level)\n- THE todoApp SHALL maintain immutable backup/snapshot copies only for disaster recovery and service continuity.\n- WHERE user data is deleted from active systems, THE todoApp SHALL ensure that any residual presence in immutable backups is inaccessible for normal operations and expires automatically per backup retention policy.\n- IF a disaster recovery event requires restoration from backups, THEN THE todoApp SHALL re‑apply applicable deletion and retention rules to restored data as soon as operationally feasible.\n\n## 4. User‑Controlled Export/Portability (optional)\n\n### 4.1 Scope\nUser export includes user‑owned account data and todo item content within the user’s ownership scope. Audit logs, administrative justifications, and internal security artifacts are excluded from user export unless required by applicable law.\n\n### 4.2 Export Requirements (EARS)\n- WHEN a user requests an export, THE todoApp SHALL prepare a complete, machine‑readable package of the user’s account data and todo items.\n- THE todoApp SHALL deliver the export within 24 hours of the request under normal operating conditions.\n- WHERE an export is large or complex, THE todoApp SHALL communicate progress and provide the completed package once preparation is finished.\n- THE todoApp SHALL limit export requests to once per rolling 7‑day period per user to manage capacity and abuse risk.\n- WHERE identity verification is required, THE todoApp SHALL complete appropriate verification before releasing an export package.\n\n## 5. Privacy‑by‑Design Principles\n\n### 5.1 Foundational Principles (EARS)\n- THE todoApp SHALL default to the most privacy‑preserving state for all new features and data flows (privacy by default).\n- THE todoApp SHALL enforce least privilege for all role‑based access to user data.\n- THE todoApp SHALL ensure purpose limitation by collecting and processing data only for clearly defined, legitimate purposes necessary to operate todoApp.\n- THE todoApp SHALL ensure transparency by documenting data uses and changes to policy in a user‑accessible location.\n\n### 5.2 Administrative Access Governance (EARS)\n- WHERE an admin must access user data for support or policy enforcement, THE todoApp SHALL require an explicit business justification recorded in audit data.\n- IF an admin action impacts a user’s data materially (e.g., forced deletion for policy), THEN THE todoApp SHALL record the action with actor, time, scope, and justification in audit data.\n\n### 5.3 Security Posture at Business Level (EARS)\n- THE todoApp SHALL protect personal data at rest and in transit using industry‑appropriate safeguards without prescribing specific technologies.\n- THE todoApp SHALL restrict access to personal data to authorized roles only, consistent with the defined permission model.\n\n### 5.4 Review Gates for New Data Uses (EARS)\n- WHERE a new data category or use is proposed, THE todoApp SHALL undergo a privacy review to confirm minimization, purpose limitation, and retention alignment before launch.\n- IF a proposed use cannot meet privacy principles, THEN THE todoApp SHALL block the change until a compliant approach is defined.\n\n## 6. Data Minimization and Purpose Limitation\n\n### 6.1 Data Collection Boundaries (EARS)\n- THE todoApp SHALL collect only the minimum personal data required to operate user accounts and manage todo items (e.g., contact identifier and authentication secrets).\n- WHERE optional data is provided by the user (e.g., description, due date), THE todoApp SHALL use it solely to enhance the todo management experience.\n- THE todoApp SHALL avoid collecting special categories of personal data; if such data is inadvertently submitted in free‑text fields, THE todoApp SHALL treat it with heightened protection and refrain from using it for profiling or analytics.\n\n### 6.2 Data Use Boundaries (EARS)\n- THE todoApp SHALL not sell personal data or share it with third parties for independent marketing purposes.\n- WHERE service providers are engaged to operate core functionality, THE todoApp SHALL ensure they process data only on behalf of todoApp for permitted purposes.\n\n### 6.3 Storage Boundaries (EARS)\n- THE todoApp SHALL not store personal data beyond the retention periods defined in this document unless required by legal obligations documented by policy.\n\n## 7. Right to Erasure and Account Deletion Behaviors\n\n### 7.1 Conceptual Deletion Flow\n```mermaid\ngraph LR\n  subgraph \"User Action\"\n    A[\"User Requests Account Deletion\"] --> B[\"Start 14‑day Grace Period\"]\n    B --> C{\"Login During Grace?\"}\n  end\n\n  subgraph \"System Outcomes\"\n    D[\"Cancel Deletion and Restore Access\"]\n    E[\"Maintain Grace and Restricted Access\"]\n    F[\"Permanent Deletion at Purge\"]\n  end\n\n  C -->|\"Yes\"| D\n  C -->|\"No\"| E\n  E --> G{\"Grace Expired?\"}\n  G -->|\"Yes\"| F\n  G -->|\"No\"| E\n```\n\n### 7.2 Erasure Requirements (EARS)\n- WHEN a verified user requests account deletion, THE todoApp SHALL initiate a 14‑day grace period and notify the user of the effective deletion date.\n- WHILE an account is in the grace period, THE todoApp SHALL restrict access to read‑only export and deletion cancellation; normal write operations SHALL be blocked.\n- IF the user logs in and cancels during the grace period, THEN THE todoApp SHALL restore full access and stop the deletion process immediately.\n- IF the grace period ends without cancellation, THEN THE todoApp SHALL permanently delete the account, user‑owned todo items, and user‑specific preferences during the next scheduled purge.\n- WHERE deletion would impact records under legal hold or unresolved disputes, THE todoApp SHALL defer deletion of those specific records while completing deletion of all other user data.\n\n### 7.3 Exceptions and Residual Data (EARS)\n- THE todoApp SHALL preserve non‑identifying, aggregated analytics after account deletion, provided such aggregates cannot be used to re‑identify the user.\n- WHERE audit records must be retained for security or compliance, THE todoApp SHALL retain only the minimum necessary audit data for the mandated period, decoupled from content details where feasible.\n- WHERE immutable backups exist, THE todoApp SHALL allow residual traces to expire per backup policy and SHALL not restore deleted user data for ordinary requests.\n\n## 8. Additional Lifecycle Topics\n\n### 8.1 Data Lineage and Auditability (EARS)\n- THE todoApp SHALL maintain auditable records for materially significant events: account lifecycle, session lifecycle, item creation/update/deletion, admin access with justification, export requests and deliveries, purge executions, and legal hold changes.\n- WHERE feasible, THE todoApp SHALL include actor, timestamp (UTC), target scope, and outcome in audit entries while avoiding sensitive content.\n- IF an audit entry would expose secrets or personal content, THEN THE todoApp SHALL store categorical labels instead of raw content.\n\n### 8.2 Caching and Indexing Propagation (EARS)\n- WHEN todo items change state (create/update/complete/reopen/delete), THE todoApp SHALL propagate visibility changes to derived representations (e.g., caches, indexes) within a user‑perceived short interval aligned with non‑functional targets.\n- IF an index or cache temporarily presents stale results, THEN THE todoApp SHALL converge to the correct state within the non‑functional consistency window and avoid re‑exposing permanently deleted content.\n\n### 8.3 Non‑Production/Test Data Controls (EARS)\n- THE todoApp SHALL prohibit the use of live personal data in non‑production environments unless de‑identified to a level that prevents re‑identification.\n- WHERE test data is needed, THE todoApp SHALL use synthetic or de‑identified datasets and SHALL destroy them when no longer needed.\n\n### 8.4 Third‑Party Processors and Data Transfers (EARS)\n- WHERE subprocessors are used to provide core capabilities (e.g., email delivery), THE todoApp SHALL ensure they act as processors on behalf of todoApp and process only for permitted purposes.\n- WHERE cross‑border transfer is required to operate the service, THE todoApp SHALL disclose the general regions involved and ensure transfers occur under appropriate safeguards consistent with applicable policy.\n\n### 8.5 Consent and Preference Management (EARS)\n- WHERE optional communications or features require consent, THE todoApp SHALL capture, honor, and allow revocation of consent without degrading core functionality.\n- IF a user revokes consent, THEN THE todoApp SHALL cease the associated processing promptly and update preference records accordingly.\n\n### 8.6 Data Subject Requests Beyond Deletion (EARS)\n- WHEN a verified user requests access to their personal data, THE todoApp SHALL provide a summary of user‑owned data and profile attributes in a human‑readable and machine‑readable form within a reasonable timeframe communicated to the user (target within 30 days unless policy dictates faster timelines).\n- WHEN a verified user requests rectification of inaccurate personal data they control (e.g., display name), THE todoApp SHALL allow correction and reflect changes in derived views and caches within the non‑functional consistency window.\n- WHERE a request is manifestly unfounded or excessive under applicable policy, THE todoApp SHALL provide a business‑level explanation and may decline the request consistent with policy.\n\n### 8.7 Data Breach Response Expectations (Business‑Level)\n- WHEN a data incident is suspected to have impacted personal data, THE todoApp SHALL initiate incident response procedures, assess scope and impact, and provide user‑facing communication consistent with applicable policy and timelines.\n- WHERE notification is required, THE todoApp SHALL communicate in clear, user‑centric language describing what happened, what data may be involved, protective steps users can take, and how todoApp is addressing the issue.\n\n## 9. Traceability to Business Rules and Non‑Functional Requirements\n\n- Refer to the [Business Rules and Validation Guide](./06-todoApp-business-rules.md) for field‑level validations, ownership, trash/restore rules, rate limits, and time‑zone handling that complement lifecycle behaviors.\n- Refer to the [Non‑Functional Requirements and Service Expectations](./08-todoApp-non-functional-requirements.md) for performance, availability, security, and operational monitoring expectations that constrain lifecycle operations.\n\nTraceability highlights\n- Creation, update, and deletion validations: Business Rules → Todo Item Validation Rules and Ownership.\n- Export responsiveness and delivery window: Non‑Functional → Performance targets for asynchronous operations.\n- Audit and monitoring expectations: Non‑Functional → Operational Monitoring and Alerting.\n\n## 10. Business‑Level Acceptance and Monitoring Criteria (EARS)\n\n- THE todoApp SHALL complete visible create, update, and delete operations on user data within 2 seconds under normal operating conditions.\n- THE todoApp SHALL execute daily purge cycles that remove all data past retention within 24 hours of eligibility.\n- WHEN a user requests export, THE todoApp SHALL provide the export within 24 hours under normal operating conditions.\n- WHEN a user initiates account deletion, THE todoApp SHALL enforce the 14‑day grace period and execute permanent deletion at the next scheduled purge thereafter.\n- WHERE legal hold or compliance exceptions apply, THE todoApp SHALL document the scope and duration and prevent deletion of the held records until the hold is removed.\n- WHERE backups contain residual copies, THE todoApp SHALL ensure they are inaccessible for ordinary operations and expire automatically per policy.\n- WHEN a user requests access or rectification, THE todoApp SHALL fulfill the request within a reasonable timeframe communicated to the user (target within 30 days unless policy dictates otherwise).\n\n## 11. Error and Recovery Expectations Across the Lifecycle (EARS)\n\n- IF a user attempts to restore a todo item after the retention window has expired, THEN THE todoApp SHALL inform the user that restoration is no longer possible and the item has been permanently deleted.\n- IF an export preparation exceeds the standard 24‑hour window due to exceptional load, THEN THE todoApp SHALL notify the user of delay and deliver the export as soon as preparation completes.\n- IF a purge process encounters inconsistencies, THEN THE todoApp SHALL isolate affected records, log the issue for investigation, and continue purging unaffected eligible records.\n- IF an admin‑initiated action is missing a documented justification, THEN THE todoApp SHALL block the action and request a valid justification entry.\n- IF derived indexes or caches temporarily lag after deletion, THEN THE todoApp SHALL prevent re‑exposure of deleted content and converge to the correct state within the non‑functional consistency window.\n\n## 12. Data Categorization (Business‑Level)\n\n| Category | Examples | Owner | Primary Uses | Retention (Business Policy) | Purge Path |\n|---|---|---|---|---|---|\n| User Account Data | Email, display name, locale/time zone, verification status | User | Authentication, personalization | Unverified: 14 days; Verified: until deletion request + 14‑day grace | Account deletion purge |\n| Todo Item Data | Title, description, due date, status, timestamps | User | Personal task management | Active: indefinite; Soft‑deleted: 30 days | Soft‑delete → scheduled purge |\n| Operational Security Data | Verification tokens, reset tokens, session metadata | System | Authentication and recovery | Verification: 24h; Reset: 1h; Sessions: per auth policy | Expire on schedule |\n| Administrative and Audit Data | Admin actions, access justifications, security‑relevant events | System | Accountability, safety, compliance | 180 days or per legal hold | Scheduled purge or hold release |\n| Aggregated Analytics | De‑identified usage metrics | System | Service improvement | As needed, non‑reidentifiable | Not applicable (non‑personal) |\n| Backups/Snapshots | Immutable copies for DR only | System | Disaster recovery | Per backup policy (time‑bound) | Automatic expiry; re‑apply deletions post‑restore |\n\n## 13. Additional Visuals\n\n### 13.1 Todo Item Soft‑Delete Lifecycle\n```mermaid\ngraph LR\n  A[\"Active Item\"] --> B[\"User Deletes(Item→Soft‑Delete)\"]\n  B --> C{\"Within 30 Days?\"}\n  C -->|\"Yes\"| D[\"User Restores(Item→Active)\"]\n  C -->|\"No\"| E[\"Scheduled Purge(Permanent Deletion)\"]\n```\n\n### 13.2 Export Request Flow (Business‑Level)\n```mermaid\ngraph LR\n  A[\"User Requests Export\"] --> B[\"Verify Identity\"]\n  B --> C{\"Verified?\"}\n  C -->|\"Yes\"| D[\"Prepare Package(Machine‑Readable)\"]\n  C -->|\"No\"| E[\"Request Verification\"]\n  D --> F{\"Large/Complex?\"}\n  F -->|\"Yes\"| G[\"Communicate Progress\"]\n  F -->|\"No\"| H[\"Deliver Export\"]\n  G --> H\n```\n\n## 14. Glossary (Business‑Level)\n\n- Aggregated Analytics: Non‑personal statistical measures that cannot be traced back to an identifiable individual.\n- Audit Event: A recorded business event capturing actor, time, scope, and outcome without sensitive content.\n- Grace Period: A bounded time during which a user may reverse a pending account deletion.\n- Legal Hold: A suspension of purge and deletion for specific records due to legal or compliance obligations.\n- Personal Data: Any information relating to an identified or identifiable natural person within todoApp’s scope (e.g., email, user‑generated todo content).\n- Pseudonymization: Processing data in a manner that it can no longer be attributed to a specific user without additional information kept separately.\n- Soft Delete: A reversible state in which data is hidden from normal operations and scheduled for purge after a retention window.\n- Permanent Deletion (Hard Delete): Irreversible removal of data from active systems following retention rules.\n- Subprocessor: A service provider engaged to process personal data on behalf of todoApp for permitted purposes.\n\n---\n\nBusiness requirements only; developers have full autonomy to determine the technical architecture, interfaces, storage strategies, and operational mechanisms necessary to satisfy these requirements while adhering to organizational standards and applicable laws."},{"reason":"Define go-live readiness, measurable acceptance criteria, and success metrics to align delivery and evaluation.","filename":"10-todoApp-acceptance-criteria-and-success-metrics.md","documentType":"requirement","outline":["Release Readiness Checklist","MVP Acceptance Criteria (EARS)","Post-Launch Monitoring Plan (business-level)","User Satisfaction and Support Plan","Success Metrics and Reporting Cadence","Risks and Mitigations"],"audience":"business stakeholders","keyQuestions":["What constitutes acceptance for MVP release?","How will success be measured after launch?","What risks exist and how will they be mitigated?"],"detailLevel":"moderate detail","relatedDocuments":["01-todoApp-service-overview.md","03-todoApp-functional-requirements.md","08-todoApp-non-functional-requirements.md"],"constraints":["Acceptance criteria must be specific, measurable, and testable (EARS)","No technical implementation details or API specifications"],"content":"# todoApp – Acceptance Criteria and Success Metrics\n\nDocument date: 2025-08-15 (Asia/Seoul)\n\nBusiness requirements only; all technical implementation decisions (architecture, APIs, database design, libraries, infrastructure) are at the discretion of the development team. Content defines WHAT must be satisfied for go‑live and post‑launch success in business terms, not HOW to build it.\n\n## Related Reading\n- Vision, scope, and model context: [todoApp Service Overview](./01-todoApp-service-overview.md)\n- Feature scope and behaviors: [todoApp Functional Requirements](./03-todoApp-functional-requirements.md)\n- Quality targets and constraints: [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md)\n\n## 1) Release Readiness Checklist\nAll items must be satisfied before declaring the MVP “Go‑Live Ready.” Items are business‑measurable and auditable.\n\n1. Scope and Feature Completeness\n   - MVP feature set matches the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md): account registration/login/logout, email verification, password reset/change, session revocation, todo item create/read/update/delete, completion/reopen, optional description and due date, filtering/sorting, timezone handling, data ownership/privacy rules, and optional export.\n   - No open P0/P1 defects affecting core flows: register, verify, login, view list, create todo, edit, complete/reopen, delete, filter/sort.\n   - All acceptance tests in Section 2 pass with documented evidence and traceability to requirements.\n   - Known limitations are documented with mitigation or deferral notes; no hidden scope gaps remain for MVP.\n\n2. Non‑Functional Readiness\n   - Performance sampling under representative load meets p95 ≤ 2 seconds user‑perceived for core actions (register, login, list, add, edit, complete, delete, filter/sort) and aligns with the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n   - Availability plan, on‑call schedule, and escalation matrix prepared for the first 4 weeks; coverage confirmed for the first 72 hours post‑launch.\n   - Monitoring dashboards for KPIs and error categories configured and accessible to stakeholders; alert thresholds tested.\n   - Read‑after‑write and cross‑device visibility behaviors validated against non‑functional targets.\n\n3. Security, Privacy, and Compliance Readiness\n   - Password, rate‑limit, and session policies validated as per [Roles and Authentication] and NFR expectations.\n   - Privacy notices, Terms of Service, and data lifecycle policies published and consistent with [todoApp Data Lifecycle and Privacy Requirements] if applicable.\n   - Audit trail coverage validated for significant account events and todo changes; sampling demonstrates integrity and minimal sensitive exposure.\n   - Access control checks validated for user/admin roles with least‑privilege and justification requirements for admin support access.\n\n4. Operational Readiness\n   - Incident management runbooks completed: severity definitions, triage steps, escalation contacts, user communication templates, and status update cadence.\n   - Backup/restore drill executed successfully within business RTO/RPO expectations defined in NFRs; outcomes documented.\n   - Rollback/disable plan defined at business level: reversible feature toggles or clear revert path available without user‑visible data loss.\n   - Capacity and rate‑limit policies exercised via dry runs; system behavior under throttling meets user‑guidance expectations.\n\n5. Documentation and Training\n   - Stakeholder review of this acceptance set complete; QA test cases trace to EARS acceptance criteria.\n   - User‑facing help content prepared for common tasks and recovery scenarios: registration and verification, login issues, password reset/change, creating and managing todos, completion/reopen, due date/timezone behavior, privacy basics, account deletion, export (if enabled).\n   - Internal support playbooks available for first‑line and admin support actions, including session revocation and account suspension/reinstatement.\n\n6. Launch Logistics\n   - Launch window scheduled with stakeholder sign‑off, including freeze period and change control policy for the launch week.\n   - Pre‑launch dry run executed (day‑in‑the‑life) covering registration‑to‑completion flows with monitoring active; issues resolved.\n   - Communication plan finalized (release notes, internal updates) including MVP scope, known limitations, and support contact channels.\n\n### Go/No‑Go Decision Flow (Business View)\n```mermaid\ngraph LR\n  A[\"All Readiness Items Evaluated\"] --> B{\"All P0/P1 Defects Closed?\"}\n  B -->|\"Yes\"| C{\"Acceptance Tests Passed?\"}\n  B -->|\"No\"| H[\"No‑Go: Fix Critical Defects\"]\n  C -->|\"Yes\"| D{\"Monitoring & Support Ready?\"}\n  C -->|\"No\"| I[\"No‑Go: Complete Tests\"]\n  D -->|\"Yes\"| E{\"Stakeholder Sign‑Off Complete?\"}\n  D -->|\"No\"| J[\"No‑Go: Finalize Ops & Support\"]\n  E -->|\"Yes\"| F[\"Go: Launch Window\"]\n  E -->|\"No\"| G[\"No‑Go: Obtain Approvals\"]\n```\n\n## 2) MVP Acceptance Criteria (EARS)\nKeywords WHEN, WHILE, IF, THEN, WHERE, THE, SHALL remain in English; descriptions are in en‑US.\n\n### 2.1 Authentication and Account Lifecycle\n- WHEN a person registers with valid email and password, THE todoApp SHALL create a new account and send an email verification within 1 minute.\n- IF a person attempts to register with an email already in use, THEN THE todoApp SHALL reject the registration and instruct the person to reset password or use another email.\n- WHEN a person verifies the email within 24 hours, THE todoApp SHALL activate the account and allow login.\n- IF an email verification link is expired, THEN THE todoApp SHALL present a method to request a new verification link.\n- WHEN a user logs in with correct credentials for an active account, THE todoApp SHALL grant access within 2 seconds perceived by the user.\n- IF a user enters incorrect credentials, THEN THE todoApp SHALL deny access and provide actionable guidance to recover (e.g., reset password).\n- WHEN a user logs out, THE todoApp SHALL end the active session immediately from the user perspective.\n- WHEN a user initiates password reset with a registered email, THE todoApp SHALL send reset instructions within 1 minute.\n- IF a password reset token is invalid or expired, THEN THE todoApp SHALL prevent password change and provide a method to request a new reset.\n- WHERE an account is suspended by an admin for policy reasons, THE todoApp SHALL prevent access to protected features and communicate suspension status at next sign‑in attempt.\n- WHEN a user requests account deletion, THE todoApp SHALL schedule deletion in accordance with data lifecycle requirements and confirm request receipt to the user.\n- WHERE a user chooses “revoke all sessions,” THE todoApp SHALL invalidate existing sessions within 60 seconds and require re‑authentication on all devices.\n\n### 2.2 Todo Item Core Operations\n- WHEN a logged‑in user submits a new todo with a non‑empty title up to the allowed length, THE todoApp SHALL create the todo and show it in the user’s list immediately.\n- IF a user attempts to create a todo without a title or exceeding the maximum length, THEN THE todoApp SHALL reject creation and display validation guidance.\n- WHEN a user updates title, description, or due date of their own todo with valid values, THE todoApp SHALL persist the changes and reflect them in the list within 2 seconds perceived by the user.\n- IF a user attempts to update a todo they do not own, THEN THE todoApp SHALL deny the action and retain the original state.\n- WHEN a user marks their own todo as complete, THE todoApp SHALL set the completion state and update list indicators within 2 seconds perceived by the user.\n- WHEN a user reopens a completed todo, THE todoApp SHALL remove the completion state and update the list accordingly within 2 seconds perceived by the user.\n- WHEN a user deletes their own todo, THE todoApp SHALL remove it from the list and confirm deletion within 2 seconds perceived by the user.\n- IF a user attempts to delete a todo they do not own, THEN THE todoApp SHALL deny the action and provide an ownership restriction message.\n\n### 2.3 Filtering, Sorting, and Timezone Behaviors\n- WHEN a user filters todos by status (all, active, completed), THE todoApp SHALL return a filtered list consistent with the selected status within 2 seconds perceived by the user.\n- WHEN a user sorts todos by created time or due date, THE todoApp SHALL present results ordered according to the selected sort within 2 seconds perceived by the user.\n- WHILE a user’s timezone preference is set, THE todoApp SHALL display due dates and times in that timezone consistently in lists and details.\n- IF a due date is provided without time, THEN THE todoApp SHALL interpret it as end‑of‑day in the user’s timezone.\n- IF a due date is invalid or in an unsupported format from the user’s perspective, THEN THE todoApp SHALL reject it and provide clear correction guidance.\n\n### 2.4 Data Ownership, Privacy, and Export\n- THE todoApp SHALL restrict todos so that users can view and modify only their own items.\n- IF an unauthenticated person attempts to access protected todo features, THEN THE todoApp SHALL require authentication before continuing.\n- WHERE an admin needs to assist for support or policy enforcement, THE todoApp SHALL allow admin‑level access to the minimum necessary information for the task and log the access for audit.\n- WHEN a user requests export of their todo data (if enabled in MVP), THE todoApp SHALL provide a complete, human‑readable or machine‑readable export within a timeframe communicated to the user and within 24 hours under normal conditions.\n\n### 2.5 Error Handling and Recovery (Business View)\n- IF an operation fails due to validation errors, THEN THE todoApp SHALL not change data and SHALL present actionable messages enabling the user to correct and retry immediately.\n- IF an operation fails due to conflicting concurrent updates on the same todo, THEN THE todoApp SHALL preserve data integrity and inform the user how to proceed (e.g., refresh to load the latest and reapply changes).\n- IF a temporary service issue prevents completion of a core action, THEN THE todoApp SHALL encourage retry and avoid duplicate creations or updates from a single user action.\n- IF a rate limit is reached, THEN THE todoApp SHALL inform the user in natural language and indicate when they may try again.\n\n### 2.6 Performance and Responsiveness\n- THE todoApp SHALL complete core interactions (login, list load, add, edit, complete, delete, filter/sort) within 2 seconds perceived by the user for the 95th percentile under expected MVP load.\n- WHERE larger lists are present (e.g., 500 todos), THE todoApp SHALL allow the user to access and interact with a subset without undue delay and provide a predictable way to navigate additional items.\n- WHERE a bulk action affects up to 50 items, THE todoApp SHALL complete the action within targets set in NFRs or process asynchronously with clear notification.\n\n### 2.7 Administration (Business Controls)\n- WHEN an admin suspends an account for policy reasons, THE todoApp SHALL prevent further protected actions by that account and record the action for audit.\n- WHEN an admin reinstates a suspended account, THE todoApp SHALL restore access to protected features.\n- WHEN an admin needs to view a user’s account for support, THE todoApp SHALL limit visibility to the minimum necessary data and record the access for audit.\n- WHEN an admin revokes a user’s sessions, THE todoApp SHALL require the user to sign in again on subsequent actions and record the event for audit.\n\n### 2.8 Audit and Activity Logging (Acceptance)\n- THE todoApp SHALL record business‑relevant audit entries for: registration, email verification, login success/failure, logout, password reset request/completion, password change, session creation/refresh/revocation, account suspension/reactivation, account deletion request/completion, admin support access to user data, and modification of more than 20 items in a bulk action.\n- WHEN an audit event is recorded, THE todoApp SHALL capture event type, actor role (user/admin), timestamp (UTC), target (where relevant), outcome (success/failure), and justification (where required) without storing sensitive secrets.\n\n## 3) Post‑Launch Monitoring Plan (Business‑Level)\nMonitoring begins day 0 and relies on dashboards accessible to stakeholders; thresholds initiate incident processes.\n\n1. Availability and Performance (User‑Perceived)\n   - Track success percentage of core actions: login, list, create, update, complete, delete.\n   - Track p95 completion time for core actions; target ≤ 2 seconds; track p99 for regression signals.\n   - Track error rate by category: authentication failures, authorization denials, validation errors, conflicts, rate‑limit denials, temporary service issues.\n   - Track read‑after‑write visibility latency and cross‑device propagation latency per NFR targets.\n\n2. Adoption and Engagement\n   - New accounts per day and percentage verified within 24 hours.\n   - Time‑to‑first‑todo: median ≤ 5 minutes; distribution by cohort.\n   - DAU/WAU/MAU with week‑over‑week growth; engagement distribution across create, update, complete actions.\n   - Task completion ratio: completed/created per cohort; overdue ratio.\n\n3. Data Quality and Privacy Indicators\n   - Ownership violations prevented (successful violations must be zero); denials are counted as attempts and triaged if anomalous.\n   - Admin support accesses with justification logs; outliers flagged for review.\n   - Export delivery success within target windows; export volume trends.\n\n4. Stability and Support Load\n   - Support contacts per 1,000 active users per week; first‑contact resolution rate.\n   - Top 5 user‑reported issues and time‑to‑resolution; recurring themes tracked.\n   - Incident count and duration by severity; availability vs. SLO error budget.\n\nAlerting Thresholds (Business View)\n- WHEN p95 completion time for any core action exceeds 2 seconds for 15 continuous minutes, THE operations process SHALL initiate an incident response and prioritize restoration to target performance.\n- WHEN success rate of any core action drops below 99% for 15 continuous minutes, THE operations process SHALL begin investigation and user communication steps.\n- WHEN verification completion within 24 hours drops below 80% for 2 consecutive days, THE product process SHALL review onboarding guidance and friction points.\n- WHEN rate‑limit denials spike above 2% of attempts in a 10‑minute window, THE product process SHALL evaluate guidance and potential abuse patterns.\n\n## 4) User Satisfaction and Support Plan\n1. Feedback Collection\n   - In‑product lightweight CSAT prompt for key actions (create/complete todo) shown non‑intrusively after completion, no more than once per 30 days per user.\n   - Quarterly NPS and qualitative survey to verified users; open‑ended improvement prompts collected and categorized.\n   - Feedback channels: help center form and dedicated email monitored during business hours; triage categorization aligned to error taxonomy.\n\n2. Support SLAs (Business Commitments)\n   - Severity 1 (core actions unavailable for many users): acknowledgement within 15 minutes; user‑facing update every 60 minutes until resolution.\n   - Severity 2 (significant degradation or feature impairment): acknowledgement within 2 business hours; updates every business day until resolution.\n   - Severity 3 (minor issues or guidance requests): acknowledgement within 2 business days; resolution targeted within 5 business days.\n   - Post‑incident summaries for Sev‑1/Sev‑2 incidents circulated within 5 business days, including user impact and prevention actions.\n\n3. Knowledge and Enablement\n   - Self‑service articles: account creation/verification, login troubleshooting, password reset/change, creating/managing todos, completion/reopen, due date/timezone semantics, privacy/data lifecycle, account deletion, export.\n   - Internal playbooks: admin session revocation and account suspension/reinstatement with justification logging.\n\n4. Launch Support Posture\n   - First 2 weeks: extended support window and increased staffing; proactive monitoring of onboarding funnel and verification completion.\n   - Communication templates ready for common errors and incidents; tone consistent and user‑centric.\n\n## 5) Success Metrics and Reporting Cadence\nTargets for the first 90 days post‑launch; ambitious yet feasible for MVP.\n\n1. Activation and Onboarding\n   - Email verification completion within 24 hours ≥ 85% by day 30; ≥ 90% by day 90.\n   - Time‑to‑first‑todo median ≤ 5 minutes by day 30; ≤ 3 minutes by day 90.\n\n2. Engagement\n   - D7 retention ≥ 25% by day 30; ≥ 30% by day 90.\n   - Task completion ratio (completed/created) ≥ 70% by day 30; ≥ 75% by day 90.\n   - Median todos created per active user per week ≥ 5 by day 90.\n\n3. Satisfaction and Support\n   - CSAT on key actions ≥ 4.3/5 by day 30; ≥ 4.5/5 by day 90.\n   - NPS ≥ +20 by quarter end.\n   - Support contacts ≤ 10 per 1,000 active users per week by day 30; ≤ 7 by day 90; first‑contact resolution ≥ 70% by day 90.\n\n4. Reliability and Performance (User‑Perceived)\n   - p95 completion time for core actions ≤ 2 seconds sustained.\n   - Core action success rate ≥ 99.5% sustained (excluding user‑initiated validation denials).\n   - Zero Sev‑1 incidents in the first 14 days; ≤ 1 Sev‑1 and ≤ 3 Sev‑2 incidents by day 90.\n\nReporting Cadence\n- Weekly: activation, engagement, reliability summary with deltas vs. targets and top issues; action items for the next week.\n- Monthly: cohort analysis, retention and satisfaction trends, export usage, and prioritized improvements.\n- Quarterly: strategic review against Service Overview KPIs and recommendations for roadmap adjustments.\n\n## 6) Risks and Mitigations\nMajor risks relevant to acceptance and sustained success with business mitigations.\n\n1. Performance Risk (User‑Perceived Latency)\n   - Risk: Perceived delays above 2 seconds degrade satisfaction and retention.\n   - Mitigation: Performance budget tracking; phased exposure if needed; prioritize optimization of list load and write actions; temporarily disable non‑critical features during incidents to preserve core actions.\n\n2. Onboarding Friction\n   - Risk: Low email verification rates and complex password resets reduce activation.\n   - Mitigation: Clear messaging for verification; resend link flow; simple reset guidance; monitor verification funnel and test copy improvements.\n\n3. Data Integrity and Concurrency Conflicts\n   - Risk: Lost updates or conflicting edits cause user confusion.\n   - Mitigation: Conflict detection behaviors and user guidance; encourage refresh and reapply; emphasize integrity in acceptance tests.\n\n4. Privacy and Access Control\n   - Risk: Improper access to another user’s data erodes trust.\n   - Mitigation: Strict ownership rules, minimum‑necessary admin access with justification, and audit expectations; periodic review of admin support accesses.\n\n5. Support Overload at Launch\n   - Risk: High contact volume overwhelms support.\n   - Mitigation: Proactive FAQ, clear in‑product guidance for common errors, temporary extended support during first 2 weeks, incident communication templates prepared.\n\n6. Scope Creep Before Go‑Live\n   - Risk: Unplanned features jeopardize schedule and quality.\n   - Mitigation: Enforce MVP scope freeze; redirect additions to post‑MVP backlog with business justification.\n\n7. Insufficient Monitoring or Alert Fatigue\n   - Risk: Missed issues or slow response to degradations.\n   - Mitigation: Focus alerts on user‑perceived metrics (success rate, p95 time); define actionable thresholds; tune based on signal‑to‑noise.\n\n8. Legal/Compliance Changes\n   - Risk: Regulatory changes or regional policies affect privacy, retention, or consent.\n   - Mitigation: Periodic policy reviews; update notices and flows; maintain documented exceptions (e.g., legal hold) as business rules.\n\n9. Dependency Outages\n   - Risk: Email delivery or other third‑party services degrade onboarding or recovery flows.\n   - Mitigation: Transparent user messaging and retry guidance; contingency plans for delayed emails; operational escalation with providers.\n\n---\n\n## Traceability to Acceptance and Success\n- Each acceptance criterion maps to features in the [todoApp Functional Requirements](./03-todoApp-functional-requirements.md) and quality targets in the [todoApp Non‑Functional Requirements](./08-todoApp-non-functional-requirements.md).\n- Release readiness, monitoring, and KPI targets align with the go‑to‑market plan and KPIs in the [todoApp Service Overview](./01-todoApp-service-overview.md).\n\nEnd of document."}],"step":0,"elapsed":752528,"created_at":"2025-08-15T04:02:24.765Z"},"tokenUsage":{"aggregate":{"total":1077148,"input":{"total":919953,"cached":11648},"output":{"total":157195,"reasoning":57728,"accepted_prediction":0,"rejected_prediction":0}},"facade":{"total":2784,"input":{"total":2337,"cached":0},"output":{"total":447,"reasoning":384,"accepted_prediction":0,"rejected_prediction":0}},"analyze":{"total":1074364,"input":{"total":917616,"cached":11648},"output":{"total":156748,"reasoning":57344,"accepted_prediction":0,"rejected_prediction":0}},"prisma":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"interface":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"test":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}},"realize":{"total":0,"input":{"total":0,"cached":0},"output":{"total":0,"reasoning":0,"accepted_prediction":0,"rejected_prediction":0}}}}]